var JSAP;
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/js-xtract/dist/jsXtract.js":
/*!*************************************************!*\
  !*** ./node_modules/js-xtract/dist/jsXtract.js ***!
  \*************************************************/
/***/ (function(module) {

(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else {}
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __nested_webpack_require_539__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __nested_webpack_require_539__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__nested_webpack_require_539__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__nested_webpack_require_539__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__nested_webpack_require_539__.d = function(exports, name, getter) {
/******/ 		if(!__nested_webpack_require_539__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__nested_webpack_require_539__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__nested_webpack_require_539__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __nested_webpack_require_539__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__nested_webpack_require_539__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __nested_webpack_require_539__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__nested_webpack_require_539__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__nested_webpack_require_539__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__nested_webpack_require_539__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__nested_webpack_require_539__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __nested_webpack_require_539__(__nested_webpack_require_539__.s = "./modules/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./modules/freeFFT.js":
/*!****************************!*\
  !*** ./modules/freeFFT.js ***!
  \****************************/
/*! exports provided: transform, inverseTransform, transformRadix2, transformBluestein, convolveComplex */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_4265__) {

"use strict";
__nested_webpack_require_4265__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_4265__.d(__webpack_exports__, "transform", function() { return transform; });
/* harmony export (binding) */ __nested_webpack_require_4265__.d(__webpack_exports__, "inverseTransform", function() { return inverseTransform; });
/* harmony export (binding) */ __nested_webpack_require_4265__.d(__webpack_exports__, "transformRadix2", function() { return transformRadix2; });
/* harmony export (binding) */ __nested_webpack_require_4265__.d(__webpack_exports__, "transformBluestein", function() { return transformBluestein; });
/* harmony export (binding) */ __nested_webpack_require_4265__.d(__webpack_exports__, "convolveComplex", function() { return convolveComplex; });
/*
 * Free FFT and convolution (JavaScript)
 *
 * Copyright (c) 2014 Project Nayuki
 * https://www.nayuki.io/page/free-small-fft-in-multiple-languages
 *
 * (MIT License)
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * - The above copyright notice and this permission notice shall be included in
 *   all copies or substantial portions of the Software.
 * - The Software is provided "as is", without warranty of any kind, express or
 *   implied, including but not limited to the warranties of merchantability,
 *   fitness for a particular purpose and noninfringement. In no event shall the
 *   authors or copyright holders be liable for any claim, damages or other
 *   liability, whether in an action of contract, tort or otherwise, arising from,
 *   out of or in connection with the Software or the use or other dealings in the
 *   Software.
 */


/*
 * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.
 * The vector can have any length. This is a wrapper function.
 */
function transform(real, imag) {
    if (real.length !== imag.length)
        throw "Mismatched lengths";

    var n = real.length;
    if (n === 0)
        return;
    else if ((n & (n - 1)) === 0) // Is power of 2
        transformRadix2(real, imag);
    else // More complicated algorithm for arbitrary sizes
        transformBluestein(real, imag);
}


/*
 * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.
 * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.
 */
function inverseTransform(real, imag) {
    transform(imag, real);
}


/*
 * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.
 * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.
 */

function transformRadix2(real, imag) {
    // Initialization
    if (real.length !== imag.length)
        throw "Mismatched lengths";
    var n = real.length;
    if (n === 1) // Trivial transform
        return;
    var levels = calculateNumberLevels(n);
    if (levels === -1)
        throw "Length is not a power of 2";
    var cosTable = new Float64Array(n / 2);
    var sinTable = new Float64Array(n / 2);
    calculateCosSineTables(cosTable, sinTable);

    // Bit-reversed addressing permutation
    bitReverseMap(real, imag);

    // Cooley-Tukey decimation-in-time radix-2 FFT
    for (var size = 2; size <= n; size *= 2) {
        cooleyTukey(real, imag, sinTable, cosTable, size);
    }

    // Returns the integer whose value is the reverse of the lowest 'bits' bits of the integer 'x'.
    function reverseBits(x, bits) {
        var y = 0;
        for (var i = 0; i < bits; i++) {
            y = (y << 1) | (x & 1);
            x >>>= 1;
        }
        return y;
    }

    function cooleyTukey(real, imag, sinTable, cosTable, size) {
        var i, j, k;
        var n = real.length;
        var halfsize = size / 2;
        var tablestep = n / size;
        for (i = 0; i < n; i += size) {
            for (j = i, k = 0; j < i + halfsize; j++, k += tablestep) {
                var tpre = real[j + halfsize] * cosTable[k] + imag[j + halfsize] * sinTable[k];
                var tpim = -real[j + halfsize] * sinTable[k] + imag[j + halfsize] * cosTable[k];
                real[j + halfsize] = real[j] - tpre;
                imag[j + halfsize] = imag[j] - tpim;
                real[j] += tpre;
                imag[j] += tpim;
            }
        }
    }

    function calculateNumberLevels(N) {
        var i;
        for (i = 0; i < 32; i++) {
            if (1 << i === N) {
                return i;
            }
        }
        return -1;
    }

    function bitReverseMap(real, imag) {
        var i, j, temp;
        for (i = 0; i < n; i++) {
            j = reverseBits(i, levels);
            if (j > i) {
                temp = real[i];
                real[i] = real[j];
                real[j] = temp;
                temp = imag[i];
                imag[i] = imag[j];
                imag[j] = temp;
            }
        }
    }

    function calculateCosSineTables(cosTable, sinTable) {
        var n = cosTable.length,
            i;
        for (i = 0; i < n; i++) {
            cosTable[i] = Math.cos(Math.PI * i / n);
            sinTable[i] = Math.sin(Math.PI * i / n);
        }
    }
}


/*
 * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.
 * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.
 * Uses Bluestein's chirp z-transform algorithm.
 */
function transformBluestein(real, imag) {
    // Find a power-of-2 convolution length m such that m >= n * 2 + 1
    if (real.length !== imag.length)
        throw "Mismatched lengths";
    var i, j;
    var n = real.length;
    var m = 1;
    while (m < n * 2 + 1)
        m *= 2;

    // Trignometric tables
    var cosTable = new Float64Array(n);
    var sinTable = new Float64Array(n);
    (function (cosTable, sinTable) {
        for (i = 0; i < n; i++) {
            j = i * i % (n * 2); // This is more accurate than j = i * i
            cosTable[i] = Math.cos(Math.PI * j / n);
            sinTable[i] = Math.sin(Math.PI * j / n);
        }
    })(cosTable, sinTable);

    // Temporary vectors and preprocessing
    var areal = new Float64Array(m);
    var aimag = new Float64Array(m);

    for (i = 0; i < n; i++) {
        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];
        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];
    }
    var breal = new Float64Array(m);
    var bimag = new Float64Array(m);
    breal[0] = cosTable[0];
    bimag[0] = sinTable[0];
    for (i = 1; i < n; i++) {
        breal[i] = breal[m - i] = cosTable[i];
        bimag[i] = bimag[m - i] = sinTable[i];
    }

    // Convolution
    var creal = new Float64Array(m);
    var cimag = new Float64Array(m);
    convolveComplex(areal, aimag, breal, bimag, creal, cimag);

    // Postprocessing
    for (i = 0; i < n; i++) {
        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];
        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];
    }
}


/*
 * Computes the circular convolution of the given real vectors. Each vector's length must be the same.
 */
function convolveReal(x, y, out) {
    if (x.length !== y.length || x.length !== out.length)
        throw "Mismatched lengths";
    var zeros = new Array(x.length);
    for (var i = 0; i < zeros.length; i++)
        zeros[i] = 0;
    convolveComplex(x, zeros, y, zeros.slice(), out, zeros.slice());
}


/*
 * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.
 */
function convolveComplex(xreal, ximag, yreal, yimag, outreal, outimag) {
    (function () {
        if (xreal.length !== ximag.length || xreal.length !== yreal.length || yreal.length !== yimag.length || xreal.length !== outreal.length || outreal.length !== outimag.length)
            throw "Mismatched lengths";
    })();
    var i;
    var n = xreal.length;
    xreal = xreal.slice();
    ximag = ximag.slice();
    yreal = yreal.slice();
    yimag = yimag.slice();

    transform(xreal, ximag);
    transform(yreal, yimag);
    for (i = 0; i < n; i++) {
        var temp = xreal[i] * yreal[i] - ximag[i] * yimag[i];
        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];
        xreal[i] = temp;
    }
    inverseTransform(xreal, ximag);
    for (i = 0; i < n; i++) { // Scaling (because this FFT implementation omits it)
        outreal[i] = xreal[i] / n;
        outimag[i] = ximag[i] / n;
    }
}


/***/ }),

/***/ "./modules/functions/xtract_amdf.js":
/*!******************************************!*\
  !*** ./modules/functions/xtract_amdf.js ***!
  \******************************************/
/*! exports provided: xtract_amdf */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_13533__) {

"use strict";
__nested_webpack_require_13533__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_13533__.d(__webpack_exports__, "xtract_amdf", function() { return xtract_amdf; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_13533__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_amdf(array) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var n = array.length;
    var result = new Float64Array(n);
    while (n--) {
        var md = 0.0;
        for (var i = 0; i < array.length - n; i++) {
            md += Math.abs(array[i] - array[i + n]);
        }
        result[n] = md / array.length;
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_apply_window.js":
/*!**************************************************!*\
  !*** ./modules/functions/xtract_apply_window.js ***!
  \**************************************************/
/*! exports provided: xtract_apply_window */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_14724__) {

"use strict";
__nested_webpack_require_14724__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_14724__.d(__webpack_exports__, "xtract_apply_window", function() { return xtract_apply_window; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_14724__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_apply_window(X, W) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(X) || !Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(W)) {
        throw ("Both X and W must be defined");
    }
    if (X.length !== W.length) {
        throw ("Both X and W must be the same lengths");
    }
    var N = X.length;
    var Y = new Float64Array(N);
    var n;
    for (n = 0; n < N; n++) {
        Y[n] = X[n] * W[n];
    }
    return Y;
}


/***/ }),

/***/ "./modules/functions/xtract_array_bound.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_array_bound.js ***!
  \*************************************************/
/*! exports provided: xtract_array_bound */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_16010__) {

"use strict";
__nested_webpack_require_16010__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_16010__.d(__webpack_exports__, "xtract_array_bound", function() { return xtract_array_bound; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_16010__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_min__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_16010__(/*! ./xtract_array_min */ "./modules/functions/xtract_array_min.js");
/* harmony import */ var _xtract_array_max__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_16010__(/*! ./xtract_array_max */ "./modules/functions/xtract_array_max.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_array_bound(data, min, max) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (typeof min !== "number") {
        min = Object(_xtract_array_min__WEBPACK_IMPORTED_MODULE_1__["xtract_array_min"])(data);
    }
    if (typeof max !== "number") {
        max = Object(_xtract_array_max__WEBPACK_IMPORTED_MODULE_2__["xtract_array_max"])(data);
    }
    if (min >= max) {
        throw ("Invalid boundaries! Minimum cannot be greater than maximum");
    }
    var result = new data.constructor(data.length);
    for (var n = 0; n < data.length; n++) {
        result[n] = Math.min(Math.max(data[n], min), max);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_array_copy.js":
/*!************************************************!*\
  !*** ./modules/functions/xtract_array_copy.js ***!
  \************************************************/
/*! exports provided: xtract_array_copy */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_17826__) {

"use strict";
__nested_webpack_require_17826__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_17826__.d(__webpack_exports__, "xtract_array_copy", function() { return xtract_array_copy; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_array_copy(src) {
    var N = src.length,
        dst = new src.constructor(N);
    for (var n = 0; n < N; n++)
        dst[n] = src[n];
    return dst;
}


/***/ }),

/***/ "./modules/functions/xtract_array_deinterlace.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_array_deinterlace.js ***!
  \*******************************************************/
/*! exports provided: xtract_array_deinterlace */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_18618__) {

"use strict";
__nested_webpack_require_18618__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_18618__.d(__webpack_exports__, "xtract_array_deinterlace", function() { return xtract_array_deinterlace; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_18618__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_18618__(/*! ./xtract_assert_positive_integer */ "./modules/functions/xtract_assert_positive_integer.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_array_deinterlace(data, num_arrays) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data)) {
        return [];
    }
    var result, N;
    if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_positive_integer"])(num_arrays)) {
        throw ("num_arrays must be a positive integer");
    }
    result = [];
    N = data.length / num_arrays;
    for (var n = 0; n < num_arrays; n++) {
        result[n] = new data.constructor(N);
    }
    for (var k = 0; k < N; k++) {
        for (var j = 0; j < num_arrays; j++) {
            result[j][k] = data[k * num_arrays + j];
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_array_interlace.js":
/*!*****************************************************!*\
  !*** ./modules/functions/xtract_array_interlace.js ***!
  \*****************************************************/
/*! exports provided: xtract_array_interlace */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_20328__) {

"use strict";
__nested_webpack_require_20328__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_20328__.d(__webpack_exports__, "xtract_array_interlace", function() { return xtract_array_interlace; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_20328__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_array_interlace(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data)) {
        return [];
    }
    var num_arrays = data.length,
        length = data[0].length;
    if (data.every(function (a) {
            return a.length === length;
        }) === false) {
        throw ("All argument lengths must be the same");
    }
    var result = new data[0].constructor(num_arrays * length);
    for (var k = 0; k < length; k++) {
        for (var j = 0; j < num_arrays; j++) {
            result[k * num_arrays + j] = data[j][k];
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_array_max.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_array_max.js ***!
  \***********************************************/
/*! exports provided: xtract_array_max */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_21725__) {

"use strict";
__nested_webpack_require_21725__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_21725__.d(__webpack_exports__, "xtract_array_max", function() { return xtract_array_max; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_21725__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_array_max(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return -Infinity;
    if (data.reduce) {
        return data.reduce(function (a, b) {
            if (b > a) {
                return b;
            }
            return a;
        }, data[0]);
    }
    var max = data[0],
        l = data.length;
    for (var n = 1; n < l; n++) {
        if (data[n] > max) {
            max = data[n];
        }
    }
    return max;
}


/***/ }),

/***/ "./modules/functions/xtract_array_min.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_array_min.js ***!
  \***********************************************/
/*! exports provided: xtract_array_min */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_22989__) {

"use strict";
__nested_webpack_require_22989__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_22989__.d(__webpack_exports__, "xtract_array_min", function() { return xtract_array_min; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_22989__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_array_min(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return Infinity;
    if (data.reduce) {
        return data.reduce(function (a, b) {
            if (b < a) {
                return b;
            }
            return a;
        }, data[0]);
    }
    var min = Infinity,
        l = data.length;
    for (var n = 0; n < l; n++) {
        if (data[n] < min) {
            min = data[n];
        }
    }
    return min;
}


/***/ }),

/***/ "./modules/functions/xtract_array_normalise.js":
/*!*****************************************************!*\
  !*** ./modules/functions/xtract_array_normalise.js ***!
  \*****************************************************/
/*! exports provided: xtract_array_normalise */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_24283__) {

"use strict";
__nested_webpack_require_24283__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_24283__.d(__webpack_exports__, "xtract_array_normalise", function() { return xtract_array_normalise; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_24283__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_scale__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_24283__(/*! ./xtract_array_scale */ "./modules/functions/xtract_array_scale.js");
/* harmony import */ var _xtract_array_max__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_24283__(/*! ./xtract_array_max */ "./modules/functions/xtract_array_max.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_array_normalise(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    return Object(_xtract_array_scale__WEBPACK_IMPORTED_MODULE_1__["xtract_array_scale"])(data, 1.0 / Object(_xtract_array_max__WEBPACK_IMPORTED_MODULE_2__["xtract_array_max"])(data));
}


/***/ }),

/***/ "./modules/functions/xtract_array_scale.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_array_scale.js ***!
  \*************************************************/
/*! exports provided: xtract_array_scale */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_25737__) {

"use strict";
__nested_webpack_require_25737__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_25737__.d(__webpack_exports__, "xtract_array_scale", function() { return xtract_array_scale; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_25737__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_copy__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_25737__(/*! ./xtract_array_copy */ "./modules/functions/xtract_array_copy.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_array_scale(data, factor) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (typeof factor !== "number") {
        return 0;
    }
    var i = 0,
        l = data.length,
        a = Object(_xtract_array_copy__WEBPACK_IMPORTED_MODULE_1__["xtract_array_copy"])(data);
    for (i = 0; i < l; i++) {
        a[i] *= factor;
    }
    return a;
}


/***/ }),

/***/ "./modules/functions/xtract_array_sum.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_array_sum.js ***!
  \***********************************************/
/*! exports provided: xtract_array_sum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_27095__) {

"use strict";
__nested_webpack_require_27095__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_27095__.d(__webpack_exports__, "xtract_array_sum", function() { return xtract_array_sum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_27095__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_array_sum(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (data.reduce) {
        return data.reduce(function (a, b) {
            return a + b;
        }, 0);
    }
    var sum = 0,
        l = data.length;
    for (var n = 0; n < l; n++) {
        sum += data[n];
    }
    return sum;
}


/***/ }),

/***/ "./modules/functions/xtract_array_to_JSON.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_array_to_JSON.js ***!
  \***************************************************/
/*! exports provided: xtract_array_to_JSON */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_28256__) {

"use strict";
__nested_webpack_require_28256__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_28256__.d(__webpack_exports__, "xtract_array_to_JSON", function() { return xtract_array_to_JSON; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_array_to_JSON(array) {
    if (array.join) {
        return '[' + array.join(', ') + ']';
    }
    var json = '[';
    var n = 0;
    while (n < this.length) {
        json = json + this[n];
        if (this[n + 1] !== undefined) {
            json = json + ',';
        }
        n++;
    }
    return json + ']';
}


/***/ }),

/***/ "./modules/functions/xtract_asdf.js":
/*!******************************************!*\
  !*** ./modules/functions/xtract_asdf.js ***!
  \******************************************/
/*! exports provided: xtract_asdf */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_29152__) {

"use strict";
__nested_webpack_require_29152__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_29152__.d(__webpack_exports__, "xtract_asdf", function() { return xtract_asdf; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_29152__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_asdf(array) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var n = array.length;
    var result = new Float64Array(n);
    while (n--) {
        var sd = 0.0;
        for (var i = 0; i < array.length - n; i++) {
            sd += Math.pow(array[i] - array[i + n], 2);
        }
        result[n] = sd / array.length;
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_assert_array.js":
/*!**************************************************!*\
  !*** ./modules/functions/xtract_assert_array.js ***!
  \**************************************************/
/*! exports provided: xtract_assert_array */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_30345__) {

"use strict";
__nested_webpack_require_30345__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_30345__.d(__webpack_exports__, "xtract_assert_array", function() { return xtract_assert_array; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_assert_array(array) {
    return (typeof array === "object" && array.length !== undefined && array.length > 0);
}


/***/ }),

/***/ "./modules/functions/xtract_assert_positive_integer.js":
/*!*************************************************************!*\
  !*** ./modules/functions/xtract_assert_positive_integer.js ***!
  \*************************************************************/
/*! exports provided: xtract_assert_positive_integer */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_31130__) {

"use strict";
__nested_webpack_require_31130__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_31130__.d(__webpack_exports__, "xtract_assert_positive_integer", function() { return xtract_assert_positive_integer; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_assert_positive_integer(number) {
    return (typeof number === "number" && number >= 0 && number === Math.round(number));
}


/***/ }),

/***/ "./modules/functions/xtract_autocorrelation.js":
/*!*****************************************************!*\
  !*** ./modules/functions/xtract_autocorrelation.js ***!
  \*****************************************************/
/*! exports provided: xtract_autocorrelation */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_31908__) {

"use strict";
__nested_webpack_require_31908__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_31908__.d(__webpack_exports__, "xtract_autocorrelation", function() { return xtract_autocorrelation; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_31908__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_autocorrelation(array) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var n = array.length;
    var result = new Float64Array(n);
    while (n--) {
        var corr = 0;
        for (var i = 0; i < array.length - n; i++) {
            corr += array[i] * array[i + n];
        }
        result[n] = corr / array.length;
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_average_deviation.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_average_deviation.js ***!
  \*******************************************************/
/*! exports provided: xtract_average_deviation */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_33151__) {

"use strict";
__nested_webpack_require_33151__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_33151__.d(__webpack_exports__, "xtract_average_deviation", function() { return xtract_average_deviation; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_33151__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_mean__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_33151__(/*! ./xtract_mean */ "./modules/functions/xtract_mean.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_average_deviation(array, mean) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof mean !== "number") {
        mean = Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_1__["xtract_mean"])(array);
    }
    var result = 0.0;
    if (array.reduce) {
        result = array.reduce(function (a, b) {
            return a + Math.abs(b - mean);
        }, 0);
    } else {
        for (var n = 0; n < array.length; n++) {
            result += Math.abs(array[n] - mean);
        }
    }
    return result / array.length;
}


/***/ }),

/***/ "./modules/functions/xtract_bark_coefficients.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_bark_coefficients.js ***!
  \*******************************************************/
/*! exports provided: xtract_bark_coefficients */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_34720__) {

"use strict";
__nested_webpack_require_34720__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_34720__.d(__webpack_exports__, "xtract_bark_coefficients", function() { return xtract_bark_coefficients; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_34720__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_bark_coefficients(spectrum, bark_limits) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (bark_limits === undefined) {
        throw ("xtract_bark_coefficients requires compute limits from xtract_init_bark");
    }
    var N = spectrum.length >> 1;
    var bands = bark_limits.length;
    var results = new Float64Array(bands);
    for (var band = 0; band < bands - 1; band++) {
        results[band] = 0.0;
        for (var n = bark_limits[band]; n < bark_limits[band + 1]; n++) {
            results[band] += spectrum[n];
        }
    }
    return results;
}


/***/ }),

/***/ "./modules/functions/xtract_chroma.js":
/*!********************************************!*\
  !*** ./modules/functions/xtract_chroma.js ***!
  \********************************************/
/*! exports provided: xtract_chroma */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_36132__) {

"use strict";
__nested_webpack_require_36132__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_36132__.d(__webpack_exports__, "xtract_chroma", function() { return xtract_chroma; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_36132__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_chroma(spectrum, chromaFilters) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum)) {
        return 0;
    }
    if (chromaFilters.wts === undefined) {
        throw ("xtract_chroma requires chroma filters from xtract_init_chroma");
    }
    if (chromaFilters.nfft !== spectrum.length / 2) {
        throw ("the FFT lengths of the spectrum (" + spectrum.length / 2 + ") and chroma filterbank (" + chromaFilters.nfft + ") do not match");
    }
    var result = new Float64Array(chromaFilters.nbins);
    for (var i = 0; i < chromaFilters.nbins; i++) {
        var sum = 0;
        for (var j = 0; j < chromaFilters.nfft; j++) {
            sum += chromaFilters.wts[i][j] * spectrum[j];
        }
        result[i] = sum;
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_complex_spectrum.js":
/*!******************************************************!*\
  !*** ./modules/functions/xtract_complex_spectrum.js ***!
  \******************************************************/
/*! exports provided: xtract_complex_spectrum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_37730__) {

"use strict";
__nested_webpack_require_37730__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_37730__.d(__webpack_exports__, "xtract_complex_spectrum", function() { return xtract_complex_spectrum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_37730__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _freeFFT__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_37730__(/*! ../freeFFT */ "./modules/freeFFT.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_complex_spectrum(array, sample_rate, withDC) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof sample_rate !== "number") {
        console.error("Sample Rate must be defined");
        return null;
    }
    if (withDC === undefined) {
        withDC = false;
    }
    var N = array.length;
    var result, align = 0,
        amps, freqs;
    if (withDC) {
        result = new Float64Array(3 * (N / 2 + 1));
    } else {
        align = 1;
        result = new Float64Array(3 * (N / 2));
    }
    amps = result.subarray(0, 2 * (result.length / 3));
    freqs = result.subarray(2 * (result.length / 3));
    var reals = new Float64Array(N);
    var imags = new Float64Array(N);
    for (var i = 0; i < N; i++) {
        reals[i] = array[i];
    }
    Object(_freeFFT__WEBPACK_IMPORTED_MODULE_1__["transform"])(reals, imags);
    for (var k = align; k <= reals.length / 2; k++) {
        amps[(k - align) * 2] = reals[k];
        amps[(k - align) * 2 + 1] = imags[k];
        freqs[k - align] = (2 * k / N) * (sample_rate / 2);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_create_window.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_create_window.js ***!
  \***************************************************/
/*! exports provided: xtract_create_window */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_39802__) {

"use strict";
__nested_webpack_require_39802__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_39802__.d(__webpack_exports__, "xtract_create_window", function() { return xtract_create_window; });
/* harmony import */ var _xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_39802__(/*! ./xtract_assert_positive_integer */ "./modules/functions/xtract_assert_positive_integer.js");
/// <reference path="../../typings/functions.d.ts" />


function welch(N) {
    var W = new Float64Array(N);
    var n;
    var N12 = (N - 1) / 2;
    for (n = 0; n < N; n++) {
        W[n] = 1.0 - Math.pow((n - N12) / N12, 2);
    }
    return W;
}

function sine(N) {
    var w = new Float64Array(N),
        n;
    var arga = (Math.PI * n) / (N - 1);
    for (n = 0; n < N; n++) {
        w[n] = Math.sin(arga);
    }
    return w;
}

function hann(N) {
    var w = new Float64Array(N),
        n;
    for (n = 0; n < N; n++) {
        w[n] = 0.5 - (1 - Math.cos((Math.PI * 2 * n) / (N - 1)));
    }
    return w;
}

function hamming(N) {
    var w = new Float64Array(N),
        alpha = 25 / 46,
        beta = 21 / 46,
        n;
    for (n = 0; n < N; n++) {
        w[n] = alpha - beta * Math.cos((Math.PI * 2 * n) / (N - 1));
    }
    return w;
}

function xtract_create_window(N, type) {
    if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_positive_integer"])(N)) {
        throw ("N must be a defined, positive integer");
    }
    if (typeof type !== "string" || type.length === 0) {
        throw ("Type must be defined");
    }
    type = type.toLowerCase();
    switch (type) {
        case "hamming":
            return hamming(N);
        case "welch":
            return welch(N);
        case "sine":
            return sine(N);
        case "hann":
            return hann(N);
        default:
            throw ("Window function\"" + type + "\" not defined");
    }
}


/***/ }),

/***/ "./modules/functions/xtract_crest.js":
/*!*******************************************!*\
  !*** ./modules/functions/xtract_crest.js ***!
  \*******************************************/
/*! exports provided: xtract_crest */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_42050__) {

"use strict";
__nested_webpack_require_42050__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_42050__.d(__webpack_exports__, "xtract_crest", function() { return xtract_crest; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_42050__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_max__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_42050__(/*! ./xtract_array_max */ "./modules/functions/xtract_array_max.js");
/* harmony import */ var _xtract_mean__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_42050__(/*! ./xtract_mean */ "./modules/functions/xtract_mean.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_crest(data, max, mean) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (typeof max !== "number") {
        max = Object(_xtract_array_max__WEBPACK_IMPORTED_MODULE_1__["xtract_array_max"])(data);
    }
    if (typeof mean !== "number") {
        mean = Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_2__["xtract_mean"])(data);
    }
    return max / mean;
}


/***/ }),

/***/ "./modules/functions/xtract_dct.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_dct.js ***!
  \*****************************************/
/*! exports provided: xtract_dct */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_43528__) {

"use strict";
__nested_webpack_require_43528__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_43528__.d(__webpack_exports__, "xtract_dct", function() { return xtract_dct; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_43528__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_dct(array) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var N = array.length;
    var result = new Float64Array(N);
    if (array.reduce) {
        result.forEach(function (e, i, a) {
            var nN = i / N;
            a[i] = array.reduce(function (r, d, m) {
                return r + d * Math.cos(Math.PI * nN * (m + 0.5));
            });
        });
    } else {
        for (var n = 0; n < N; n++) {
            var nN = n / N;
            for (var m = 0; m < N; m++) {
                result[n] += array[m] * Math.cos(Math.PI * nN * (m + 0.5));
            }
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_dct_2.js":
/*!*******************************************!*\
  !*** ./modules/functions/xtract_dct_2.js ***!
  \*******************************************/
/*! exports provided: xtract_dct_2 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_44951__) {

"use strict";
__nested_webpack_require_44951__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_44951__.d(__webpack_exports__, "xtract_dct_2", function() { return xtract_dct_2; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_44951__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_init_dct__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_44951__(/*! ./xtract_init_dct */ "./modules/functions/xtract_init_dct.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_44951__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_dct_2(array, dct) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var N = array.length;
    if (dct === undefined) {
        dct = Object(_xtract_init_dct__WEBPACK_IMPORTED_MODULE_1__["xtract_init_dct"])(N);
    }
    var result = new Float64Array(N);
    result[0] = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_2__["xtract_array_sum"])(array);
    if (result.forEach && array.reduce) {
        result.forEach(function (e, k, ar) {
            ar[k] = array.reduce(function (a, b, n) {
                return a + b * dct.wt[k][n];
            });
        });
    } else {
        for (var k = 1; k < N; k++) {
            for (var n = 0; n < N; n++) {
                result[k] += array[n] * dct.wt[k][n];
            }
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_energy.js":
/*!********************************************!*\
  !*** ./modules/functions/xtract_energy.js ***!
  \********************************************/
/*! exports provided: xtract_energy */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_46862__) {

"use strict";
__nested_webpack_require_46862__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_46862__.d(__webpack_exports__, "xtract_energy", function() { return xtract_energy; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_46862__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_46862__(/*! ./xtract_rms_amplitude */ "./modules/functions/xtract_rms_amplitude.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_energy(array, sample_rate, window_ms) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof sample_rate !== "number") {
        console.error("xtract_energy requires sample_rate to be defined");
        return;
    }
    if (typeof window_ms !== "number") {
        window_ms = 100;
    }
    if (window_ms <= 0) {
        window_ms = 100;
    }
    var N = array.length;
    var L = Math.floor(sample_rate * (window_ms / 1000.0));
    var K = Math.ceil(N / L);
    var result = new Float64Array(K);
    for (var k = 0; k < K; k++) {
        var frame = array.subarray(k * L, k * L + L);
        var rms = Object(_xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_1__["xtract_rms_amplitude"])(frame);
        result[k] = rms;
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_f0.js":
/*!****************************************!*\
  !*** ./modules/functions/xtract_f0.js ***!
  \****************************************/
/*! exports provided: xtract_f0 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_48596__) {

"use strict";
__nested_webpack_require_48596__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_48596__.d(__webpack_exports__, "xtract_f0", function() { return xtract_f0; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_48596__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_copy__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_48596__(/*! ./xtract_array_copy */ "./modules/functions/xtract_array_copy.js");
/* harmony import */ var _xtract_array_max__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_48596__(/*! ./xtract_array_max */ "./modules/functions/xtract_array_max.js");
/* harmony import */ var _xtract_array_bound__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_48596__(/*! ./xtract_array_bound */ "./modules/functions/xtract_array_bound.js");
/// <reference path="../../typings/functions.d.ts" />





function calc_err_tau_x(sub_arr, M, tau) {
    var err_tau = 0.0,
        n;
    for (n = 1; n < M; n++) {
        err_tau += Math.abs(sub_arr[n] - sub_arr[n + tau]);
    }
    return err_tau;
}

function xtract_f0(timeArray, sampleRate) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(timeArray))
        return 0;
    if (typeof sampleRate !== "number") {
        sampleRate = 44100.0;
    }
    var sub_arr = Object(_xtract_array_copy__WEBPACK_IMPORTED_MODULE_1__["xtract_array_copy"])(timeArray);
    var N = sub_arr.length;
    var M = N / 2;
    var n;

    var threshold_peak = 0.8,
        threshold_centre = 0.3,
        array_max = 0;

    array_max = Object(_xtract_array_max__WEBPACK_IMPORTED_MODULE_2__["xtract_array_max"])(sub_arr);
    threshold_peak *= array_max;
    threshold_centre *= array_max;

    sub_arr = Object(_xtract_array_bound__WEBPACK_IMPORTED_MODULE_3__["xtract_array_bound"])(sub_arr, -threshold_peak, threshold_peak);

    sub_arr.forEach(function (v, i, a) {
        a[i] = Math.max(0, v - threshold_centre);
    });

    var err_tau_1 = calc_err_tau_x(sub_arr, M, 1);
    for (var tau = 2; tau < M; tau++) {
        var err_tau_x = calc_err_tau_x(sub_arr, M, tau);
        if (err_tau_x < err_tau_1) {
            return sampleRate / (tau + (err_tau_x / err_tau_1));
        }
    }
    return -0;
}


/***/ }),

/***/ "./modules/functions/xtract_failsafe_f0.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_failsafe_f0.js ***!
  \*************************************************/
/*! exports provided: xtract_failsafe_f0 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_51230__) {

"use strict";
__nested_webpack_require_51230__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_51230__.d(__webpack_exports__, "xtract_failsafe_f0", function() { return xtract_failsafe_f0; });
/* harmony import */ var _xtract_f0__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_51230__(/*! ./xtract_f0 */ "./modules/functions/xtract_f0.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_failsafe_f0(timeArray, sampleRate) {
    return Object(_xtract_f0__WEBPACK_IMPORTED_MODULE_0__["xtract_f0"])(timeArray, sampleRate);
}


/***/ }),

/***/ "./modules/functions/xtract_flatness.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_flatness.js ***!
  \**********************************************/
/*! exports provided: xtract_flatness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_52104__) {

"use strict";
__nested_webpack_require_52104__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_52104__.d(__webpack_exports__, "xtract_flatness", function() { return xtract_flatness; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_52104__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_flatness(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var count = 0,
        denormal_found = false,
        num = 1.0,
        den = 0.0,
        temp = 0.0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    for (var n = 0; n < K; n++) {
        temp = Math.max(1e-32, amps[n]);
        num *= temp;
        den += temp;
        count++;
    }
    if (count === 0) {
        return 0;
    }
    num = Math.pow(num, 1.0 / count);
    den /= count;

    return num / den;
}


/***/ }),

/***/ "./modules/functions/xtract_flatness_db.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_flatness_db.js ***!
  \*************************************************/
/*! exports provided: xtract_flatness_db */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_53488__) {

"use strict";
__nested_webpack_require_53488__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_53488__.d(__webpack_exports__, "xtract_flatness_db", function() { return xtract_flatness_db; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_53488__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_flatness__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_53488__(/*! ./xtract_flatness */ "./modules/functions/xtract_flatness.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_flatness_db(spectrum, flatness) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof flatness !== "number") {
        flatness = Object(_xtract_flatness__WEBPACK_IMPORTED_MODULE_1__["xtract_flatness"])(spectrum);
    }
    return 10.0 * Math.log10(flatness);
}


/***/ }),

/***/ "./modules/functions/xtract_frame_from_array.js":
/*!******************************************************!*\
  !*** ./modules/functions/xtract_frame_from_array.js ***!
  \******************************************************/
/*! exports provided: xtract_frame_from_array */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_54803__) {

"use strict";
__nested_webpack_require_54803__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_54803__.d(__webpack_exports__, "xtract_frame_from_array", function() { return xtract_frame_from_array; });
/* harmony import */ var _xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_54803__(/*! ./xtract_assert_positive_integer */ "./modules/functions/xtract_assert_positive_integer.js");
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_54803__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_get_number_of_frames__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_54803__(/*! ./xtract_get_number_of_frames */ "./modules/functions/xtract_get_number_of_frames.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_frame_from_array(src, dst, index, frame_size, hop_size) {
    if (hop_size === undefined) {
        hop_size = frame_size;
    }
    if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_positive_integer"])(index)) {
        throw ("xtract_get_frame requires the index to be an integer value");
    }
    if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_positive_integer"])(frame_size)) {
        throw ("xtract_get_frame requires the frame_size to be a positive integer");
    }
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_array"])(src)) {
        throw ("Invalid data parameter. Must be item with iterable list");
    }
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_array"])(dst)) {
        throw ("dst must be an Array-like object equal in length to frame_size");
    }
    if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_positive_integer"])(hop_size)) {
        throw ("xtract_get_frame requires the hop_size to be a positive integer");
    }
    var K = Object(_xtract_get_number_of_frames__WEBPACK_IMPORTED_MODULE_2__["xtract_get_number_of_frames"])(src, hop_size);
    if (index >= K) {
        throw ("index number " + index + " out of bounds");
    }
    var n = 0;
    var offset = index * hop_size;
    while (n < dst.length && n < src.length && n < frame_size) {
        dst[n] = src[n + offset];
        n++;
    }
    while (n < dst.length) {
        dst[n] = 0.0;
    }
}


/***/ }),

/***/ "./modules/functions/xtract_get_data_frames.js":
/*!*****************************************************!*\
  !*** ./modules/functions/xtract_get_data_frames.js ***!
  \*****************************************************/
/*! exports provided: xtract_get_data_frames */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_57594__) {

"use strict";
__nested_webpack_require_57594__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_57594__.d(__webpack_exports__, "xtract_get_data_frames", function() { return xtract_get_data_frames; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_57594__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_57594__(/*! ./xtract_assert_positive_integer */ "./modules/functions/xtract_assert_positive_integer.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_get_data_frames(data, frame_size, hop_size, copy) {
    if (hop_size === undefined) {
        hop_size = frame_size;
    }
    (function (data, frame_size, hop_size) {
        if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data)) {
            throw ("Invalid data parameter. Must be item with iterable list");
        }
        if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_positive_integer"])(frame_size)) {
            throw ("xtract_get_data_frames requires the frame_size to be a positive integer");
        }
        if (!Object(_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_positive_integer"])(hop_size)) {
            throw ("xtract_get_data_frames requires the hop_size to be a positive integer");
        }
        return true;
    })(data, frame_size, hop_size);

    var frames = [];
    var N = data.length;
    var K = Math.ceil(N / hop_size);
    var sub_frame;
    for (var k = 0; k < K; k++) {
        var offset = k * hop_size;
        if (copy) {
            sub_frame = new Float64Array(frame_size);
            for (var n = 0; n < frame_size && n + offset < data.length; n++) {
                sub_frame[n] = data[n + offset];
            }
        } else {
            sub_frame = data.subarray(offset, offset + frame_size);
            if (sub_frame.length < frame_size) {
                // Must zero-pad up to the length
                var c_frame = new Float64Array(frame_size);
                for (var i = 0; i < sub_frame.length; i++) {
                    c_frame[i] = sub_frame[i];
                }
                sub_frame = c_frame;
            }
        }
        frames.push(sub_frame);
    }
    return frames;
}


/***/ }),

/***/ "./modules/functions/xtract_get_number_of_frames.js":
/*!**********************************************************!*\
  !*** ./modules/functions/xtract_get_number_of_frames.js ***!
  \**********************************************************/
/*! exports provided: xtract_get_number_of_frames */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_60401__) {

"use strict";
__nested_webpack_require_60401__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_60401__.d(__webpack_exports__, "xtract_get_number_of_frames", function() { return xtract_get_number_of_frames; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_60401__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_get_number_of_frames(data, hop_size) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data)) {
        throw ("Invalid data parameter. Must be item with iterable list");
    }
    if (typeof hop_size !== "number" && hop_size <= 0) {
        throw ("Invalid hop_size. Must be positive integer");
    }
    return Math.floor(data.length / hop_size);
}


/***/ }),

/***/ "./modules/functions/xtract_harmonic_spectrum.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_harmonic_spectrum.js ***!
  \*******************************************************/
/*! exports provided: xtract_harmonic_spectrum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_61625__) {

"use strict";
__nested_webpack_require_61625__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_61625__.d(__webpack_exports__, "xtract_harmonic_spectrum", function() { return xtract_harmonic_spectrum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_61625__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_harmonic_spectrum(peakSpectrum, f0, threshold) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(peakSpectrum))
        return 0;
    var N = peakSpectrum.length;
    var K = N >> 1;
    var result = new Float64Array(N);
    var ampsIn = peakSpectrum.subarray(0, K);
    var freqsIn = peakSpectrum.subarray(K);
    var ampsOut = result.subarray(0, K);
    var freqsOut = result.subarray(K);
    var n = K;
    if (f0 === undefined || threshold === undefined) {
        throw ("harmonic_spectrum requires f0 and threshold to be numbers and defined");
    }
    if (threshold > 1) {
        threshold /= 100.0;
    }
    while (n--) {
        if (freqsIn[n] !== 0.0) {
            var ratio = freqsIn[n] / f0;
            var nearest = Math.round(ratio);
            var distance = Math.abs(nearest - ratio);
            if (distance > threshold) {
                ampsOut[n] = 0.0;
                freqsOut[n] = 0.0;
            } else {
                ampsOut[n] = ampsIn[n];
                freqsOut[n] = freqsIn[n];
            }
        } else {
            result[n] = 0.0;
            freqsOut[n] = 0.0;
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_highest_value.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_highest_value.js ***!
  \***************************************************/
/*! exports provided: xtract_highest_value */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_63620__) {

"use strict";
__nested_webpack_require_63620__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_63620__.d(__webpack_exports__, "xtract_highest_value", function() { return xtract_highest_value; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_63620__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_lowhigh__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_63620__(/*! ./xtract_lowhigh */ "./modules/functions/xtract_lowhigh.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_highest_value(data, threshold) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (typeof threshold !== "number") {
        threshold = +Infinity;
    }
    return Object(_xtract_lowhigh__WEBPACK_IMPORTED_MODULE_1__["xtract_lowhigh"])(data, threshold).max;
}


/***/ }),

/***/ "./modules/functions/xtract_hps.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_hps.js ***!
  \*****************************************/
/*! exports provided: xtract_hps */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_64859__) {

"use strict";
__nested_webpack_require_64859__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_64859__.d(__webpack_exports__, "xtract_hps", function() { return xtract_hps; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_64859__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function get_peak_index(M, amps) {
    var peak_index = 0,
        peak = 0,
        i;
    var tempProduct = new Float64Array(M);
    tempProduct.forEach(function (e, i, a) {
        a[i] = amps[i] * amps[i * 2] * amps[i * 3];
    });
    tempProduct.forEach(function (v, i) {
        if (v > peak) {
            peak = v;
            peak_index = i;
        }
    });
    return peak_index;
}

function xtract_hps(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var peak_index = 0,
        position1_lwr = 0,
        largest1_lwr = 0,
        ratio1 = 0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    var freqs = spectrum.subarray(K);
    var M = Math.ceil(K / 3.0);
    var i;
    if (M <= 1) {
        throw ("Input Data is too short for HPS");
    }

    peak_index = get_peak_index(M, amps);

    for (i = 0; i < K; i++) {
        if (amps[i] > largest1_lwr && i !== peak_index) {
            largest1_lwr = amps[i];
            position1_lwr = i;
        }
    }

    ratio1 = amps[position1_lwr] / amps[peak_index];

    if (position1_lwr > peak_index * 0.4 && position1_lwr < peak_index * 0.6 && ratio1 > 0.1)
        peak_index = position1_lwr;

    return freqs[peak_index];
}


/***/ }),

/***/ "./modules/functions/xtract_init_bark.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_init_bark.js ***!
  \***********************************************/
/*! exports provided: xtract_init_bark */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_66923__) {

"use strict";
__nested_webpack_require_66923__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_66923__.d(__webpack_exports__, "xtract_init_bark", function() { return xtract_init_bark; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_init_bark(N, sampleRate, bands) {
    if (typeof bands !== "number" || bands < 0 || bands > 26) {
        bands = 26;
    }
    var edges = [0, 100, 200, 300, 400, 510, 630, 770, 920, 1080, 1270, 1480, 1720, 2000, 2320, 2700, 3150, 3700, 4400, 5300, 6400, 7700, 9500, 12000, 15500, 20500, 27000];
    var band_limits = new Int32Array(bands);
    while (bands--) {
        band_limits[bands] = (edges[bands] / sampleRate) * N;
    }
    return band_limits;
}


/***/ }),

/***/ "./modules/functions/xtract_init_chroma.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_init_chroma.js ***!
  \*************************************************/
/*! exports provided: xtract_init_chroma */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_67986__) {

"use strict";
__nested_webpack_require_67986__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_67986__.d(__webpack_exports__, "xtract_init_chroma", function() { return xtract_init_chroma; });
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_67986__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_init_chroma(N, sampleRate, nbins, A440, f_ctr, octwidth) {
    /*run arg checks here... (if(nbins=='undefined')*/

    if (typeof nbins !== "number" || nbins <= 1) {
        nbins = 12;
    }
    if (typeof A440 !== "number" || A440 <= 27.5) {
        A440 = 440;
    }
    if (typeof f_ctr !== "number") {
        f_ctr = 1000;
    }
    if (typeof octwidth !== "number") {
        octwidth = 1;
    }
    var A0 = 27.5; // A0 in Hz
    var N2 = N; // ignore freq values returned by xtract_spectrum - this relies on dc-offset being kept
    var ctroct = Math.log(f_ctr / A0) / Math.LN2; // f_ctr in octaves
    var chromaFilters = {
        wts: [],
        nfft: N2,
        nbins: nbins,
    };
    var fftfrqbins = new Float64Array(N2);
    var binwidthbins = new Float64Array(N2);
    // Convert a frequency in Hz into a real number counting the octaves above A0. So hz2octs(440) = 4.0
    var hz2octs = function (freq) {
        return Math.log(freq / (A440 / 16)) / Math.LN2;
    };
    var i, j;
    for (i = 1; i < N2; i++) {
        fftfrqbins[i] = nbins * hz2octs(i / N * sampleRate);
    }
    fftfrqbins[0] = fftfrqbins[1] - 1.5 * nbins; //DC offset bin
    for (i = 0; i < N2 - 1; i++) {
        var diffVal = fftfrqbins[i + 1] - fftfrqbins[i];
        if (diffVal >= 1) {
            binwidthbins[i] = diffVal;
        } else {
            binwidthbins[i] = 1;
        }
    }
    binwidthbins[N2 - 1] = 1;
    var nbins2 = Math.round(nbins / 2.0);
    var wts = [];
    for (i = 0; i < nbins; i++) {
        wts[i] = [];
        for (j = 0; j < N2; j++) {
            var tmpF = fftfrqbins[j] - i;
            var tmpB = binwidthbins[j];
            var remF = ((tmpF + nbins2 + 10 * nbins) % nbins) - nbins2;
            wts[i][j] = Math.exp(-0.5 * Math.pow((2 * remF / tmpB), 2));
        }
    }

    function head(a) {
        return a[0];
    }

    function tail(a) {
        return a.slice(1);
    }

    function transpose(a) {
        if (a === undefined) {
            return [];
        }
        var x = a.length,
            y = a[0].length,
            mtx = [],
            i, j;
        for (i = 0; i < y; i++) {
            mtx[i] = new Float64Array(x);
        }
        for (i = 0; i < x; i++) {
            for (j = 0; j < y; j++) {
                mtx[j][i] = a[i][j];
            }
        }
        return mtx;
    }
    var wtsColumnSums = transpose(wts).map(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_0__["xtract_array_sum"]);
    for (i = 0; i < nbins; i++) {
        for (j = 0; j < N2; j++) {
            wts[i][j] *= 1 / wtsColumnSums[j];
        }
    }
    if (octwidth > 0) {
        for (i = 0; i < nbins; i++) {
            for (j = 0; j < N2; j++) {
                wts[i][j] *= Math.exp(-0.5 * (Math.pow(((fftfrqbins[j] / nbins - ctroct) / octwidth), 2)));
            }
        }
    }
    chromaFilters.wts = wts;
    return chromaFilters;
}


/***/ }),

/***/ "./modules/functions/xtract_init_dct.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_init_dct.js ***!
  \**********************************************/
/*! exports provided: xtract_init_dct */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_71641__) {

"use strict";
__nested_webpack_require_71641__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_71641__.d(__webpack_exports__, "xtract_init_dct", function() { return xtract_init_dct; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_init_dct(N) {
    var dct = {
        N: N,
        wt: []
    };
    for (var k = 0; k < N; k++) {
        dct.wt[k] = new Float64Array(N);
        for (var n = 0; n < N; n++) {
            dct.wt[k][n] = Math.cos(Math.PI * k * (n + 0.5) / N);
        }
    }
    return dct;
}


/***/ }),

/***/ "./modules/functions/xtract_init_dft.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_init_dft.js ***!
  \**********************************************/
/*! exports provided: xtract_init_dft */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_72508__) {

"use strict";
__nested_webpack_require_72508__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_72508__.d(__webpack_exports__, "xtract_init_dft", function() { return xtract_init_dft; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_init_dft(N) {
    var dft = {
        N: N / 2 + 1,
        real: [],
        imag: []
    };
    var power_const = -2.0 * Math.PI / N;
    for (var k = 0; k < dft.N; k++) {
        var power_k = power_const * k;
        dft.real[k] = new Float64Array(N);
        dft.imag[k] = new Float64Array(N);
        for (var n = 0; n < N; n++) {
            var power = power_k * n;
            dft.real[k][n] = Math.cos(power);
            dft.imag[k][n] = Math.sin(power);
        }
    }
    return dft;
}


/***/ }),

/***/ "./modules/functions/xtract_init_mfcc.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_init_mfcc.js ***!
  \***********************************************/
/*! exports provided: xtract_init_mfcc */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_73601__) {

"use strict";
__nested_webpack_require_73601__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_73601__.d(__webpack_exports__, "xtract_init_mfcc", function() { return xtract_init_mfcc; });
/// <reference path="../../typings/functions.d.ts" />

function get_fft_peak(N, freq_max, freq_min, freq_bands, nyquist, style) {
    var norm = 1,
        M = N / 2,
        height, norm_fact, n;
    var mel_freq_max = 1127 * Math.log(1 + freq_max / 700);
    var mel_freq_min = 1127 * Math.log(1 + freq_min / 700);
    var freq_bw_mel = (mel_freq_max - mel_freq_min) / freq_bands;

    var mel_peak = new Float64Array(freq_bands + 2);
    var lin_peak = new Float64Array(freq_bands + 2);
    var fft_peak = new Float64Array(freq_bands + 2);
    var height_norm = new Float64Array(freq_bands);
    mel_peak[0] = mel_freq_min;
    lin_peak[0] = freq_min;
    fft_peak[0] = Math.floor(lin_peak[0] / nyquist * M);

    for (n = 1; n < (freq_bands + 2); ++n) {
        //roll out peak locations - mel, linear and linear on fft window scale
        mel_peak[n] = mel_peak[n - 1] + freq_bw_mel;
        lin_peak[n] = 700 * (Math.exp(mel_peak[n] / 1127) - 1);
        fft_peak[n] = Math.floor(lin_peak[n] / nyquist * M);
    }

    for (n = 0; n < freq_bands; n++) {
        //roll out normalised gain of each peak
        if (style === "XTRACT_EQUAL_GAIN") {
            height = 1;
            norm_fact = norm;
        } else {
            height = 2 / (lin_peak[n + 2] - lin_peak[n]);
            norm_fact = norm / (2 / (lin_peak[2] - lin_peak[0]));
        }
        height_norm[n] = height * norm_fact;
    }
    return {
        f: fft_peak,
        h: height_norm
    };
}

function xtract_init_mfcc(N, nyquist, style, freq_min, freq_max, freq_bands) {
    var mfcc = {
        n_filters: freq_bands,
        filters: []
    };
    var norm = 1,
        M = N / 2,
        height, norm_fact, n;

    if (freq_bands <= 1) {
        return null;
    }

    var i = 0,
        fh = get_fft_peak(N, freq_max, freq_min, freq_bands, nyquist, style),
        inc;
    var fft_peak = fh.f,
        height_norm = fh.h;
    var next_peak;
    for (n = 0; n < freq_bands; n++) {
        // calculate the rise increment
        if (n === 0) {
            inc = height_norm[n] / fft_peak[n];
        } else {
            inc = height_norm[n] / (fft_peak[n] - fft_peak[n - 1]);
        }
        var val = 0;
        // Create array
        mfcc.filters[n] = new Float64Array(N);
        // fill in the rise
        for (; i <= fft_peak[n]; i++) {
            mfcc.filters[n][i] = val;
            val += inc;
        }
        // calculate the fall increment
        inc = height_norm[n] / (fft_peak[n + 1] - fft_peak[n]);

        val = 0;
        next_peak = fft_peak[n + 1];

        // reverse fill the 'fall'
        for (i = Math.floor(next_peak); i > fft_peak[n]; i--) {
            mfcc.filters[n][i] = val;
            val += inc;
        }
    }
    return mfcc;
}


/***/ }),

/***/ "./modules/functions/xtract_init_pcp.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_init_pcp.js ***!
  \**********************************************/
/*! exports provided: xtract_init_pcp */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_76886__) {

"use strict";
__nested_webpack_require_76886__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_76886__.d(__webpack_exports__, "xtract_init_pcp", function() { return xtract_init_pcp; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_init_pcp(N, fs, f_ref) {
    if (typeof fs !== "number" || typeof N !== "number") {
        throw ('The Sample Rate and sample count have to be defined: xtract_init_pcp(N, fs, f_ref)');
    }
    if (N <= 0 || N !== Math.floor(N)) {
        throw ("The sample count, N, must be a positive integer: xtract_init_pcp(N, fs, f_ref)");
    }
    if (fs <= 0.0) {
        throw ('The Sample Rate must be a positive number: xtract_init_pcp(N, fs, f_ref)');
    }
    if (typeof f_ref !== "number" || f_ref <= 0.0 || f_ref >= fs / 2) {
        f_ref = 48.9994294977;
    }

    var M = new Float64Array(N - 1);
    var fs2 = fs / 2;
    for (var l = 1; l < N; l++) {
        var f = (2 * l / N) * fs2;
        M[l - 1] = Math.round(12 * Math.log2((f / N) * f_ref)) % 12;
    }
    return M;
}


/***/ }),

/***/ "./modules/functions/xtract_init_wavelet.js":
/*!**************************************************!*\
  !*** ./modules/functions/xtract_init_wavelet.js ***!
  \**************************************************/
/*! exports provided: xtract_init_wavelet */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_78279__) {

"use strict";
__nested_webpack_require_78279__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_78279__.d(__webpack_exports__, "xtract_init_wavelet", function() { return xtract_init_wavelet; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_init_wavelet() {
    return {
        _prevPitch: -1,
        _pitchConfidence: -1
    };
}


/***/ }),

/***/ "./modules/functions/xtract_irregularity_j.js":
/*!****************************************************!*\
  !*** ./modules/functions/xtract_irregularity_j.js ***!
  \****************************************************/
/*! exports provided: xtract_irregularity_j */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_78997__) {

"use strict";
__nested_webpack_require_78997__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_78997__.d(__webpack_exports__, "xtract_irregularity_j", function() { return xtract_irregularity_j; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_78997__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_irregularity_j(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var num = 0,
        den = 0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    for (var n = 0; n < K - 1; n++) {
        num += Math.pow(amps[n] - amps[n + 1], 2);
        den += Math.pow(amps[n], 2);
    }
    return num / den;
}


/***/ }),

/***/ "./modules/functions/xtract_irregularity_k.js":
/*!****************************************************!*\
  !*** ./modules/functions/xtract_irregularity_k.js ***!
  \****************************************************/
/*! exports provided: xtract_irregularity_k */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_80226__) {

"use strict";
__nested_webpack_require_80226__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_80226__.d(__webpack_exports__, "xtract_irregularity_k", function() { return xtract_irregularity_k; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_80226__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_irregularity_k(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var result = 0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    for (var n = 1; n < K - 1; n++) {
        result += Math.abs(Math.log10(amps[n]) - Math.log10(amps[n - 1] + amps[n] + amps[n + 1]) / 3);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_is_denormal.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_is_denormal.js ***!
  \*************************************************/
/*! exports provided: xtract_is_denormal */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_81439__) {

"use strict";
__nested_webpack_require_81439__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_81439__.d(__webpack_exports__, "xtract_is_denormal", function() { return xtract_is_denormal; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_is_denormal(num) {
    if (Math.abs(num) <= 2.2250738585072014e-308) {
        return true;
    }
    return false;
}


/***/ }),

/***/ "./modules/functions/xtract_kurtosis.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_kurtosis.js ***!
  \**********************************************/
/*! exports provided: xtract_kurtosis */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_82151__) {

"use strict";
__nested_webpack_require_82151__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_82151__.d(__webpack_exports__, "xtract_kurtosis", function() { return xtract_kurtosis; });
/* harmony import */ var _xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_82151__(/*! ./xtract_skewness_kurtosis */ "./modules/functions/xtract_skewness_kurtosis.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_kurtosis(array, mean, standard_deviation) {
    return Object(_xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_0__["xtract_skewness_kurtosis"])(array, mean, standard_deviation)[1];
}


/***/ }),

/***/ "./modules/functions/xtract_loudness.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_loudness.js ***!
  \**********************************************/
/*! exports provided: xtract_loudness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_83114__) {

"use strict";
__nested_webpack_require_83114__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_83114__.d(__webpack_exports__, "xtract_loudness", function() { return xtract_loudness; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_83114__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_loudness(barkBandsArray) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(barkBandsArray))
        return 0;
    var result = 0;
    if (barkBandsArray.reduce) {
        result = barkBandsArray.reduce(function (a, b) {
            return a + Math.pow(b, 0.23);
        }, 0);
    } else {
        for (var n = 0; n < barkBandsArray.length; n++) {
            result += Math.pow(barkBandsArray[n], 0.23);
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_lowest_value.js":
/*!**************************************************!*\
  !*** ./modules/functions/xtract_lowest_value.js ***!
  \**************************************************/
/*! exports provided: xtract_lowest_value */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_84380__) {

"use strict";
__nested_webpack_require_84380__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_84380__.d(__webpack_exports__, "xtract_lowest_value", function() { return xtract_lowest_value; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_84380__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_lowhigh__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_84380__(/*! ./xtract_lowhigh */ "./modules/functions/xtract_lowhigh.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_lowest_value(data, threshold) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    if (typeof threshold !== "number") {
        threshold = -Infinity;
    }
    return Object(_xtract_lowhigh__WEBPACK_IMPORTED_MODULE_1__["xtract_lowhigh"])(data, threshold).min;
}


/***/ }),

/***/ "./modules/functions/xtract_lowhigh.js":
/*!*********************************************!*\
  !*** ./modules/functions/xtract_lowhigh.js ***!
  \*********************************************/
/*! exports provided: xtract_lowhigh */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_85636__) {

"use strict";
__nested_webpack_require_85636__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_85636__.d(__webpack_exports__, "xtract_lowhigh", function() { return xtract_lowhigh; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_lowhigh(data, threshold) {
    var r = {
        min: null,
        max: null
    };
    for (var n = 0; n < data.length; n++) {
        if (data[n] > threshold) {
            r.min = Math.min(r.min, data[n]);
        }
        if (data[n] < threshold) {
            r.max = Math.max(r.max, data[n]);
        }
    }
    return r;
}


/***/ }),

/***/ "./modules/functions/xtract_lpc.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_lpc.js ***!
  \*****************************************/
/*! exports provided: xtract_lpc */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_86530__) {

"use strict";
__nested_webpack_require_86530__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_86530__.d(__webpack_exports__, "xtract_lpc", function() { return xtract_lpc; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_86530__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_lpc(autocorr) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(autocorr))
        return 0;
    var i, j, r, error = autocorr[0];
    var N = autocorr.length;
    var L = N - 1;
    var lpc = new Float64Array(L);
    var ref = new Float64Array(L);
    if (error === 0.0) {
        return lpc;
    }

    (function () {
        for (i = 0; i < L; i++) {
            r = -autocorr[i + 1];
            for (j = 0; j < i; j++) {
                r -= lpc[j] * autocorr[i - j];
            }
            r /= error;
            ref[i] = r;

            lpc[i] = r;
            for (j = 0; j < (i >> 1); j++) {
                var tmp = lpc[j];
                lpc[j] += r * lpc[i - 1 - j];
                lpc[i - 1 - j] += r * tmp;
            }
            if (i % 2) {
                lpc[j] += lpc[j] * r;
            }
            error *= 1.0 - r * r;
        }
    })();
    return lpc;
}


/***/ }),

/***/ "./modules/functions/xtract_lpcc.js":
/*!******************************************!*\
  !*** ./modules/functions/xtract_lpcc.js ***!
  \******************************************/
/*! exports provided: xtract_lpcc */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_88196__) {

"use strict";
__nested_webpack_require_88196__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_88196__.d(__webpack_exports__, "xtract_lpcc", function() { return xtract_lpcc; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_88196__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_lpcc(lpc, Q) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(lpc))
        return 0;
    var N = lpc.length;
    var n, k, sum, order = N - 1,
        cep_length;
    if (typeof Q !== "number") {
        Q = N - 1;
    }
    cep_length = Q;

    var result = new Float64Array(cep_length);
    (function () {
        for (n = 1; n < Q && n < cep_length; n++) {
            sum = 0;
            for (k = 1; k < n; k++) {
                sum += k * result[k - 1] * lpc[n - k];
            }
            result[n - 1] = lpc[n] + sum / n;
        }
    })();
    (function () {
        for (n = order + 1; n <= cep_length; n++) {
            sum = 0.0;
            for (k = n - (order - 1); k < n; k++) {
                sum += k * result[k - 1] * lpc[n - k];
            }
            result[n - 1] = sum / n;
        }
    })();
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_mean.js":
/*!******************************************!*\
  !*** ./modules/functions/xtract_mean.js ***!
  \******************************************/
/*! exports provided: xtract_mean */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_89822__) {

"use strict";
__nested_webpack_require_89822__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_89822__.d(__webpack_exports__, "xtract_mean", function() { return xtract_mean; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_89822__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_89822__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_mean(array) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    return Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(array) / array.length;
}


/***/ }),

/***/ "./modules/functions/xtract_mfcc.js":
/*!******************************************!*\
  !*** ./modules/functions/xtract_mfcc.js ***!
  \******************************************/
/*! exports provided: xtract_mfcc */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_90962__) {

"use strict";
__nested_webpack_require_90962__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_90962__.d(__webpack_exports__, "xtract_mfcc", function() { return xtract_mfcc; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_90962__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_dct__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_90962__(/*! ./xtract_dct */ "./modules/functions/xtract_dct.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_mfcc(spectrum, mfcc) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var K = spectrum.length >> 1;
    if (typeof mfcc !== "object") {
        throw ("Invalid MFCC, must be MFCC object built using xtract_init_mfcc");
    }
    if (mfcc.n_filters === 0) {
        throw ("Invalid MFCC, object must be built using xtract_init_mfcc");
    }
    if (mfcc.filters[0].length !== K) {
        throw ("Lengths do not match");
    }
    var result = new Float64Array(mfcc.n_filters);
    result.forEach(function (v, f, r) {
        r[f] = 0.0;
        var filter = mfcc.filters[f];
        for (var n = 0; n < filter.length; n++) {
            r[f] += spectrum[n] * filter[n];
        }
        r[f] = Math.log(Math.max(r[f], 2e-42));
    });
    return Object(_xtract_dct__WEBPACK_IMPORTED_MODULE_1__["xtract_dct"])(result);
}


/***/ }),

/***/ "./modules/functions/xtract_midicent.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_midicent.js ***!
  \**********************************************/
/*! exports provided: xtract_midicent */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_92759__) {

"use strict";
__nested_webpack_require_92759__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_92759__.d(__webpack_exports__, "xtract_midicent", function() { return xtract_midicent; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_midicent(f0) {
    if (typeof f0 !== "number") {
        return -1;
    }
    var note = 0.0;
    note = 69 + Math.log(f0 / 440.0) * 17.31234;
    note *= 100;
    note = Math.round(0.5 + note);
    return note;
}


/***/ }),

/***/ "./modules/functions/xtract_noisiness.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_noisiness.js ***!
  \***********************************************/
/*! exports provided: xtract_noisiness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_93566__) {

"use strict";
__nested_webpack_require_93566__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_93566__.d(__webpack_exports__, "xtract_noisiness", function() { return xtract_noisiness; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_noisiness(h, p) {
    var i = 0.0;
    if (typeof h !== "number" && typeof p !== "number") {
        return 0;
    }
    i = p - h;
    return i / p;
}


/***/ }),

/***/ "./modules/functions/xtract_nonzero_count.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_nonzero_count.js ***!
  \***************************************************/
/*! exports provided: xtract_nonzero_count */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_94333__) {

"use strict";
__nested_webpack_require_94333__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_94333__.d(__webpack_exports__, "xtract_nonzero_count", function() { return xtract_nonzero_count; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_94333__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_nonzero_count(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    var count = 0;
    if (data.reduce) {
        return data.reduce(function (a, b) {
            if (b !== 0) {
                a++;
            }
            return a;
        });
    }
    for (var n = 0; n < data.length; n++) {
        if (data[n] !== 0) {
            count++;
        }
    }
    return count;
}


/***/ }),

/***/ "./modules/functions/xtract_odd_even_ratio.js":
/*!****************************************************!*\
  !*** ./modules/functions/xtract_odd_even_ratio.js ***!
  \****************************************************/
/*! exports provided: xtract_odd_even_ratio */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_95591__) {

"use strict";
__nested_webpack_require_95591__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_95591__.d(__webpack_exports__, "xtract_odd_even_ratio", function() { return xtract_odd_even_ratio; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_95591__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_odd_even_ratio(harmonicSpectrum, f0) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(harmonicSpectrum))
        return 0;
    (function (f0) {
        if (typeof f0 !== "number") {
            throw ("spectral_inharmonicity requires f0 to be defined.");
        }
    })(f0);
    var h = 0,
        odd = 0.0,
        even = 0.0,
        temp;
    var N = harmonicSpectrum.length;
    var K = N >> 1;
    var amps = harmonicSpectrum.subarray(0, n);
    var freqs = harmonicSpectrum.subarray(n);
    for (var n = 0; n < K; n++) {
        temp = amps[n];
        if (temp !== 0.0) {
            h = Math.floor(freqs[n] / f0 + 0.5);
            if (h % 2 !== 0) {
                odd += temp;
            } else {
                even += temp;
            }
        }
    }

    if (odd === 0.0 || even === 0.0) {
        return 0.0;
    }
    return odd / even;
}


/***/ }),

/***/ "./modules/functions/xtract_onset.js":
/*!*******************************************!*\
  !*** ./modules/functions/xtract_onset.js ***!
  \*******************************************/
/*! exports provided: xtract_onset */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_97257__) {

"use strict";
__nested_webpack_require_97257__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_97257__.d(__webpack_exports__, "xtract_onset", function() { return xtract_onset; });
/* harmony import */ var _freeFFT__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_97257__(/*! ../freeFFT */ "./modules/freeFFT.js");
/* harmony import */ var _xtract_array_interlace__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_97257__(/*! ./xtract_array_interlace */ "./modules/functions/xtract_array_interlace.js");
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_97257__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_97257__(/*! ./xtract_get_data_frames */ "./modules/functions/xtract_get_data_frames.js");
/// <reference path="../../typings/functions.d.ts" />





function angle(real, imag) {
    if (imag === undefined && real.length === 2) {
        return Math.atan2(real[1], real[0]);
    }
    return Math.atan2(imag, real);
}

function abs(real, imag) {
    if (imag === undefined && real.length === 2) {
        return Math.sqrt(Math.pow(real[0], 2) + Math.pow(real[1], 2));
    }
    return Math.sqrt(Math.pow(real, 2) + Math.pow(imag, 2));
}

function princarg(phaseIn) {
    //phase=mod(phasein+pi,-2*pi)+pi;
    return (phaseIn + Math.PI) % (-2 * Math.PI) + Math.PI;
}

function complex_mul(cplx_pair_A, cplx_pair_B) {
    if (cplx_pair_A.length !== 2 || cplx_pair_B.length !== 2) {
        throw ("Both arguments must be numeral arrays of length 2");
    }
    var result = new cplx_pair_A.constructor(2);
    result[0] = cplx_pair_A[0] * cplx_pair_B[0] - cplx_pair_A[1] * cplx_pair_B[1];
    result[1] = cplx_pair_A[0] * cplx_pair_B[1] + cplx_pair_A[1] * cplx_pair_B[0];
    return result;
}

function get_X(frames, frameSize) {
    var N = frames.length;
    var X = [];
    var real = new Float64Array(frameSize);
    var imag = new Float64Array(frameSize);
    var K = frameSize / 2 + 1;
    var n;
    for (var i = 0; i < N; i++) {
        for (n = 0; n < frameSize; n++) {
            real[n] = frames[i][n];
            imag[n] = 0.0;
        }
        Object(_freeFFT__WEBPACK_IMPORTED_MODULE_0__["transform"])(real, imag);
        X[i] = Object(_xtract_array_interlace__WEBPACK_IMPORTED_MODULE_1__["xtract_array_interlace"])([real.subarray(0, K), imag.subarray(0, K)]);
    }
    return X;
}

function xtract_onset(timeData, frameSize) {

    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_array"])(timeData))
        return 0;
    if (frameSize === undefined) {
        throw ("All arguments for xtract_onset must be defined: xtract_onset(timeData, frameSize)");
    }
    var frames = Object(_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_3__["xtract_get_data_frames"])(timeData, frameSize, frameSize, false);
    var N = frames.length;
    var K = frameSize / 2 + 1;
    var X = get_X(frames, frameSize);

    var E = new timeData.constructor(N);
    var n;
    for (var k = 0; k < K; k++) {
        var phase_prev = angle(X[0].subarray(2 * k, 2 * k + 2));
        var phase_delta = angle(X[0].subarray(2 * k, 2 * k + 2));
        for (n = 1; n < N; n++) {
            var phi = princarg(phase_prev + phase_delta);
            var exp = [Math.cos(phi), Math.sin(phi)];
            var XT = complex_mul(X[n].subarray(2 * k, 2 * k + 2), exp);
            XT[0] = X[n][2 * k] - XT[0];
            XT[1] = X[n][2 * k + 1] - XT[1];
            E[n] += abs(XT);
            var phase_now = angle(X[n].subarray(2 * k, 2 * k + 2));
            phase_delta = phase_now - phase_prev;
            phase_prev = phase_now;
        }
    }

    for (n = 0; n < N; n++) {
        E[n] /= frameSize;
    }
    return E;
}


/***/ }),

/***/ "./modules/functions/xtract_pcp.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_pcp.js ***!
  \*****************************************/
/*! exports provided: xtract_pcp */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_101366__) {

"use strict";
__nested_webpack_require_101366__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_101366__.d(__webpack_exports__, "xtract_pcp", function() { return xtract_pcp; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_101366__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_init_pcp__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_101366__(/*! ./xtract_init_pcp */ "./modules/functions/xtract_init_pcp.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_pcp(spectrum, M, fs) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var N = spectrum.length >> 1;
    if (typeof M !== "object") {
        if (typeof fs !== "number" || fs <= 0.0) {
            throw ("Cannot dynamically compute M if fs is undefined / not a valid sample rate");
        }
        M = Object(_xtract_init_pcp__WEBPACK_IMPORTED_MODULE_1__["xtract_init_pcp"])(N, fs);
    }
    var amps = spectrum.subarray(1, N);
    var PCP = new Float64Array(12);
    for (var l = 0; l < amps.length; l++) {
        var p = M[l];
        PCP[l] += Math.pow(Math.abs(amps[l]), 2);
    }
    return PCP;
}


/***/ }),

/***/ "./modules/functions/xtract_peak_spectrum.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_peak_spectrum.js ***!
  \***************************************************/
/*! exports provided: xtract_peak_spectrum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_102987__) {

"use strict";
__nested_webpack_require_102987__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_102987__.d(__webpack_exports__, "xtract_peak_spectrum", function() { return xtract_peak_spectrum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_102987__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_max__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_102987__(/*! ./xtract_array_max */ "./modules/functions/xtract_array_max.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_peak_spectrum(spectrum, q, threshold) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var N = spectrum.length;
    var K = N >> 1;
    var max = 0.0,
        y = 0.0,
        y2 = 0.0,
        y3 = 0.0,
        p = 0.0;
    if (typeof q !== "number") {
        throw ("xtract_peak_spectrum requires second argument to be sample_rate/N");
    }
    if (threshold < 0 || threshold > 100) {
        threshold = 0;
    }
    var result = new Float64Array(N);
    var ampsIn = spectrum.subarray(0, K);
    var freqsIn = spectrum.subarray(K);
    var ampsOut = result.subarray(0, K);
    var freqsOut = result.subarray(K);
    max = Object(_xtract_array_max__WEBPACK_IMPORTED_MODULE_1__["xtract_array_max"])(ampsIn);
    threshold *= 0.01 * max;
    for (var n = 1; n < N - 1; n++) {
        if (ampsIn[n] >= threshold) {
            if (ampsIn[n] > ampsIn[n - 1] && ampsIn[n] > ampsIn[n + 1]) {
                y = ampsIn[n - 1];
                y2 = ampsIn[n];
                y3 = ampsIn[n + 1];
                p = 0.5 * (y - y3) / (ampsIn[n - 1] - 2 * (y2 + ampsIn[n + 1]));
                freqsOut[n] = q * (n + 1 + p);
                ampsOut[n] = y2 - 0.25 * (y - y3) * p;
            } else {
                ampsOut[n] = 0;
                freqsOut[n] = 0;
            }
        } else {
            ampsOut[n] = 0;
            freqsOut[n] = 0;
        }
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_power.js":
/*!*******************************************!*\
  !*** ./modules/functions/xtract_power.js ***!
  \*******************************************/
/*! exports provided: xtract_power */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_105374__) {

"use strict";
__nested_webpack_require_105374__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_105374__.d(__webpack_exports__, "xtract_power", function() { return xtract_power; });
/// <reference path="../../typings/functions.d.ts" />
function xtract_power(magnitudeArray) {
    return null;
}


/***/ }),

/***/ "./modules/functions/xtract_process_frame_data.js":
/*!********************************************************!*\
  !*** ./modules/functions/xtract_process_frame_data.js ***!
  \********************************************************/
/*! exports provided: xtract_process_frame_data */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_106049__) {

"use strict";
__nested_webpack_require_106049__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_106049__.d(__webpack_exports__, "xtract_process_frame_data", function() { return xtract_process_frame_data; });
/* harmony import */ var _xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_106049__(/*! ./xtract_get_data_frames */ "./modules/functions/xtract_get_data_frames.js");
/* harmony import */ var _xtract_spectrum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_106049__(/*! ./xtract_spectrum */ "./modules/functions/xtract_spectrum.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_process_frame_data(array, func, sample_rate, frame_size, hop_size, arg_this) {
    var frames = Object(_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_0__["xtract_get_data_frames"])(array, frame_size, hop_size);
    var result = {
        num_frames: frames.length,
        results: []
    };
    var frame_time = 0;
    var data = {
        frame_size: frame_size,
        hop_size: hop_size,
        sample_rate: sample_rate,
        TimeData: undefined,
        SpectrumData: undefined
    };
    var prev_data;
    var prev_result;
    for (var fn = 0; fn < frames.length; fn++) {
        var frame = frames[fn];
        data.TimeData = frame;
        data.SpectrumData = Object(_xtract_spectrum__WEBPACK_IMPORTED_MODULE_1__["xtract_spectrum"])(frame, sample_rate, true, false);
        prev_result = func.call(arg_this || this, data, prev_data, prev_result);
        var frame_result = {
            time_start: frame_time,
            result: prev_result
        };
        frame_time += frame_size / sample_rate;
        prev_data = data;
        data = {
            frame_size: frame_size,
            hop_size: hop_size,
            sample_rate: sample_rate,
            TimeData: undefined,
            SpectrumData: undefined
        };
        result.results.push(frame_result);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_resample.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_resample.js ***!
  \**********************************************/
/*! exports provided: xtract_resample */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_108322__) {

"use strict";
__nested_webpack_require_108322__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_108322__.d(__webpack_exports__, "xtract_resample", function() { return xtract_resample; });
/* harmony import */ var _freeFFT__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_108322__(/*! ../freeFFT */ "./modules/freeFFT.js");
/* harmony import */ var _xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_108322__(/*! ./xtract_get_data_frames */ "./modules/functions/xtract_get_data_frames.js");
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_108322__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />




function filter(N, c) {
    var c_b, Re, Im, b;
    c_b = Math.floor(c * N);
    Re = new Float64Array(N);
    Im = new Float64Array(N);
    var i, j;
    for (i = 0; i < c_b; i++) {
        Re[i] = 1;
    }
    for (i = N - c_b + 1; i < N; i++) {
        Re[i] = 1;
    }
    Object(_freeFFT__WEBPACK_IMPORTED_MODULE_0__["inverseTransform"])(Re, Im);
    // Scale and shift into Im
    for (i = 0; i < N; i++) {
        j = (i + (N >> 1)) % N;
        Im[i] = Re[j] / N;
        // Apply compute blackman-harris to Im
        var rad = (Math.PI * i) / (N);
        Im[i] *= 0.35875 - 0.48829 * Math.cos(2 * rad) + 0.14128 * Math.cos(4 * rad) - 0.01168 * Math.cos(6 * rad);
    }
    return Im;
}

function polyn(data, K) {
    var N = data.length;
    var x = [0, data[0], data[1]];
    var dst = new Float64Array(K);
    var ratio = K / N;
    var tinc = 1 / ratio;
    var n = 0,
        t = 0,
        k;
    for (k = 0; k < K; k++) {
        if (t === n) {
            // Points lie on same time
            dst[k] = data[n];
        } else {
            var y = (t - n - 1) * (t - n) * x[0] - 2 * (t - n - 1) * (t - n + 1) * x[1] + (t - n) * (t - n + 1) * x[2];
            dst[k] = y / 2;
        }
        t += tinc;
        if (t >= n + 1) {
            n = Math.floor(t);
            x[0] = data[n - 1];
            x[1] = data[n];
            if (n + 1 < N) {
                x[2] = data[n + 1];
            } else {
                x[2] = 0.0;
            }
        }
    }
    return dst;
}

function zp(a) {
    var b = new Float64Array(a.length * 2);
    for (var n = 0; n < a.length; n++) {
        b[n] = a[n];
    }
    return b;
}

function r2c(x) {
    var real = zp(x);
    var imag = new Float64Array(real.length);
    Object(_freeFFT__WEBPACK_IMPORTED_MODULE_0__["transform"])(real, imag);
    return {
        real: real,
        imag: imag
    };
}

function W(N) {
    var w = new Float64Array(N),
        i;
    for (i = 0; i < N; i++) {
        var rad = (Math.PI * i) / (N);
        w[i] = 0.35875 - 0.48829 * Math.cos(2 * rad) + 0.14128 * Math.cos(4 * rad) - 0.01168 * Math.cos(6 * rad);
    }
    return w;
}

function overlap(X, b) { // eslint-disable-line max-statements
    var i, f;
    var Y = new Float64Array(X.length);
    var N = b.length;
    var N2 = 2 * N;
    var B = r2c(b);
    var Xi = Object(_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_1__["xtract_get_data_frames"])(X, N, N, false);
    var Yi = Object(_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_1__["xtract_get_data_frames"])(Y, N, N, false);
    var x_last = new Float64Array(N);
    var y_last = new Float64Array(N);
    var w = W(N2);
    var xF = {
        real: new Float64Array(N2),
        imag: new Float64Array(N2)
    };
    var yF = {
        real: new Float64Array(N2),
        imag: new Float64Array(N2)
    };
    for (f = 0; f < Xi.length; f++) {
        for (i = 0; i < N; i++) {
            xF.real[i] = x_last[i] * w[i];
            xF.real[i + N] = Xi[f][i] * w[i + N];
            x_last[i] = Xi[f][i];
            xF.imag[i] = 0;
            xF.imag[i + N] = 0;
        }
        Object(_freeFFT__WEBPACK_IMPORTED_MODULE_0__["transform"])(xF.real, xF.imag);
        for (i = 0; i < N2; i++) {
            yF.real[i] = xF.real[i] * B.real[i] - xF.imag[i] * B.imag[i];
            yF.imag[i] = xF.imag[i] * B.real[i] + xF.real[i] * B.imag[i];
        }
        Object(_freeFFT__WEBPACK_IMPORTED_MODULE_0__["transform"])(yF.imag, yF.real);
        // Perform fft_shift and scale
        for (i = 0; i < N; i++) {
            var h = yF.real[i + N] / N;
            yF.real[i + N] = yF.real[i] / N;
            yF.real[i] = h;
        }
        for (i = 0; i < N; i++) {
            Yi[f][i] = (yF.real[i] + y_last[i]);
            y_last[i] = yF.real[i + N];
        }
    }
    return Y;
}

function xtract_resample(data, p, q, n) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_array"])(data))
        return 0;
    // Same function call as matlab:
    // data is the array
    // p is the target sample rate
    // q is the source sample rate
    // n is the desired filter order, n==1024 if undefined

    // Determine which way to go
    var b, N = data.length;
    if (typeof n !== "number" || n <= 0) {
        n = 512;
    }
    if (p === q) {
        return data;
    }
    var ratio = (p / q);
    var K = Math.floor(N * ratio);
    var dst;
    if (p > q) {
        // Upsampling
        // 1. Expand Data range
        dst = polyn(data, K);
        // 2. Filter out spurious energy above q
        b = filter(n, 1 / ratio);
        overlap(data, b);
    } else {
        // Downsampling
        // 1. Filter out energy above p
        b = filter(n, ratio / 2);
        var ds1 = overlap(data, b);
        // 2. Decrease data range
        dst = polyn(ds1, K);
    }
    return dst;
}


/***/ }),

/***/ "./modules/functions/xtract_rms_amplitude.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_rms_amplitude.js ***!
  \***************************************************/
/*! exports provided: xtract_rms_amplitude */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_114266__) {

"use strict";
__nested_webpack_require_114266__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_114266__.d(__webpack_exports__, "xtract_rms_amplitude", function() { return xtract_rms_amplitude; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_114266__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_rms_amplitude(timeArray) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(timeArray))
        return 0;
    var result = 0;
    if (timeArray.reduce) {
        result = timeArray.reduce(function (a, b) {
            return a + b * b;
        }, 0);
    } else {
        for (var n = 0; n < timeArray.length; n++) {
            result += timeArray[n] * timeArray[n];
        }
    }
    return Math.sqrt(result / timeArray.length);
}


/***/ }),

/***/ "./modules/functions/xtract_rolloff.js":
/*!*********************************************!*\
  !*** ./modules/functions/xtract_rolloff.js ***!
  \*********************************************/
/*! exports provided: xtract_rolloff */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_115510__) {

"use strict";
__nested_webpack_require_115510__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_115510__.d(__webpack_exports__, "xtract_rolloff", function() { return xtract_rolloff; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_115510__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_115510__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_rolloff(spectrum, sampleRate, threshold) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof sampleRate !== "number" || typeof threshold !== "number") {
        console.log("xtract_rolloff requires sampleRate and threshold to be defined");
        return null;
    }
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);

    var pivot = 0,
        temp = 0;

    pivot = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(amps);

    pivot *= threshold / 100.0;
    var n = 0;
    while (temp < pivot) {
        temp += amps[n];
        n++;
    }
    return n * (sampleRate / (spectrum.length));
}


/***/ }),

/***/ "./modules/functions/xtract_sharpness.js":
/*!***********************************************!*\
  !*** ./modules/functions/xtract_sharpness.js ***!
  \***********************************************/
/*! exports provided: xtract_sharpness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_117184__) {

"use strict";
__nested_webpack_require_117184__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_117184__.d(__webpack_exports__, "xtract_sharpness", function() { return xtract_sharpness; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_117184__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_sharpness(barkBandsArray) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(barkBandsArray))
        return 0;
    var N = barkBandsArray.length;

    var rv, sl = 0.0,
        g = 0.0,
        temp = 0.0;
    for (var n = 0; n < N; n++) {
        sl = Math.pow(barkBandsArray[n], 0.23);
        g = (n < 15 ? 1.0 : 0.066 * Math.exp(0.171 * n));
        temp += n * g * sl;
    }
    temp = 0.11 * temp / N;
    return temp;
}


/***/ }),

/***/ "./modules/functions/xtract_skewness.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_skewness.js ***!
  \**********************************************/
/*! exports provided: xtract_skewness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_118418__) {

"use strict";
__nested_webpack_require_118418__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_118418__.d(__webpack_exports__, "xtract_skewness", function() { return xtract_skewness; });
/* harmony import */ var _xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_118418__(/*! ./xtract_skewness_kurtosis */ "./modules/functions/xtract_skewness_kurtosis.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_skewness(array, mean, standard_deviation) {
    return Object(_xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_0__["xtract_skewness_kurtosis"])(array, mean, standard_deviation)[0];
}


/***/ }),

/***/ "./modules/functions/xtract_skewness_kurtosis.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_skewness_kurtosis.js ***!
  \*******************************************************/
/*! exports provided: xtract_skewness_kurtosis */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_119425__) {

"use strict";
__nested_webpack_require_119425__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_119425__.d(__webpack_exports__, "xtract_skewness_kurtosis", function() { return xtract_skewness_kurtosis; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_119425__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_mean__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_119425__(/*! ./xtract_mean */ "./modules/functions/xtract_mean.js");
/* harmony import */ var _xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_119425__(/*! ./xtract_standard_deviation */ "./modules/functions/xtract_standard_deviation.js");
/* harmony import */ var _xtract_variance__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_119425__(/*! ./xtract_variance */ "./modules/functions/xtract_variance.js");
/// <reference path="../../typings/functions.d.ts" />





function xtract_skewness_kurtosis(array, mean, standard_deviation) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return [0.0, 0.0];
    if (typeof mean !== "number") {
        mean = Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_1__["xtract_mean"])(array);
    }
    if (typeof standard_deviation !== "number") {
        standard_deviation = Object(_xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_2__["xtract_standard_deviation"])(array, Object(_xtract_variance__WEBPACK_IMPORTED_MODULE_3__["xtract_variance"])(array, mean));
    }
    if (standard_deviation === 0) {
        return [0.0, 0.0];
    }
    var result = [0.0, 0.0];
    for (var n = 0; n < array.length; n++) {
        result[0] += Math.pow((array[n] - mean) / standard_deviation, 3);
        result[1] += Math.pow((array[n] - mean) / standard_deviation, 4);
    }
    result[0] /= array.length;
    result[1] /= array.length;
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_smoothness.js":
/*!************************************************!*\
  !*** ./modules/functions/xtract_smoothness.js ***!
  \************************************************/
/*! exports provided: xtract_smoothness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_121681__) {

"use strict";
__nested_webpack_require_121681__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_121681__.d(__webpack_exports__, "xtract_smoothness", function() { return xtract_smoothness; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_121681__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_smoothness(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var prev = 0,
        current = 0,
        next = 0,
        temp = 0;
    var N = spectrum.length;
    var K = N >> 1;
    prev = Math.max(1e-5, spectrum[0]);
    current = Math.max(1e-5, spectrum[1]);
    for (var n = 1; n < K - 1; n++) {
        next = Math.max(1e-5, spectrum[n + 1]);
        temp += Math.abs(20.0 * Math.log(current) - (20.0 * Math.log(prev) + 20.0 * Math.log(current) + 20.0 * Math.log(next)) / 3.0);
        prev = current;
        current = next;
    }
    return temp;
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_centroid.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_spectral_centroid.js ***!
  \*******************************************************/
/*! exports provided: xtract_spectral_centroid */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_123136__) {

"use strict";
__nested_webpack_require_123136__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_123136__.d(__webpack_exports__, "xtract_spectral_centroid", function() { return xtract_spectral_centroid; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_123136__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_123136__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_spectral_centroid(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var N = spectrum.length;
    var n = N >> 1;
    var amps = spectrum.subarray(0, n);
    var freqs = spectrum.subarray(n);
    var A_d = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(amps);
    if (A_d === 0.0) {
        return 0.0;
    }
    var sum = 0.0;
    while (n--) {
        sum += freqs[n] * (amps[n] / A_d);
    }
    return sum;
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_fundamental.js":
/*!**********************************************************!*\
  !*** ./modules/functions/xtract_spectral_fundamental.js ***!
  \**********************************************************/
/*! exports provided: xtract_spectral_fundamental */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_124666__) {

"use strict";
__nested_webpack_require_124666__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_124666__.d(__webpack_exports__, "xtract_spectral_fundamental", function() { return xtract_spectral_fundamental; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_124666__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _freeFFT_js__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_124666__(/*! ../freeFFT.js */ "./modules/freeFFT.js");
/// <reference path="../../typings/functions.d.ts" />


function peak_picking(E, window) {
    var o = [],
        N = E.length,
        n;
    if (window === undefined) {
        window = 5;
    }
    for (n = window; n < N - window - 1; n++) {
        var max = 1,
            m;
        for (m = -window; m < window - 1; m++) {
            if (E[n + m] > E[n]) {
                max = 0;
                break;
            }
        }
        if (max === 1) {
            o.push(n);
        }
    }
    return o;
}

function xtract_spectral_fundamental(spectrum, sample_rate) {
    // Based on work by Motegi and Shimamura
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;

    var N = spectrum.length >> 1;
    var amps = spectrum.subarray(0, N);
    var freqs = spectrum.subarray(N);
    var K = N * 2;

    // Create the power spectrum
    var power = new Float64Array(K);
    var n;
    for (n = 0; n < N; n++) {
        power[n] = Math.pow(amps[n], 2);
        power[K - 1 - n] = power[n];
    }

    // Perform autocorrelation using IFFT
    var R = new Float64Array(K);
    Object(_freeFFT_js__WEBPACK_IMPORTED_MODULE_1__["inverseTransform"])(power, R);
    R = undefined;
    R = power;
    power = undefined;

    // Get the peaks
    var p = peak_picking(R, 5);
    if (p.length === 0) {
        return 0;
    }
    p = p[0];

    p = p / sample_rate;
    p = 1 / p;
    return p;
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_inharmonicity.js":
/*!************************************************************!*\
  !*** ./modules/functions/xtract_spectral_inharmonicity.js ***!
  \************************************************************/
/*! exports provided: xtract_spectral_inharmonicity */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_127050__) {

"use strict";
__nested_webpack_require_127050__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_127050__.d(__webpack_exports__, "xtract_spectral_inharmonicity", function() { return xtract_spectral_inharmonicity; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_127050__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_spectral_inharmonicity(peakSpectrum, f0) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(peakSpectrum))
        return 0;
    if (typeof f0 !== "number") {
        console.error("spectral_inharmonicity requires f0 to be defined.");
        return null;
    }
    var h = 0,
        num = 0.0,
        den = 0.0;
    var N = peakSpectrum.length;
    var K = N >> 1;
    var amps = peakSpectrum.subarray(0, n);
    var freqs = peakSpectrum.subarray(n);
    for (var n = 0; n < K; n++) {
        if (amps[n] !== 0.0) {
            h = Math.floor(freqs[n] / f0 + 0.5);
            var mag_sq = Math.pow(amps[n], 2);
            num += Math.abs(freqs[n] - h * f0) * mag_sq;
            den += mag_sq;
        }
    }
    return (2 * num) / (f0 * den);
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_kurtosis.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_spectral_kurtosis.js ***!
  \*******************************************************/
/*! exports provided: xtract_spectral_kurtosis */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_128679__) {

"use strict";
__nested_webpack_require_128679__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_128679__.d(__webpack_exports__, "xtract_spectral_kurtosis", function() { return xtract_spectral_kurtosis; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_128679__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_128679__(/*! ./xtract_spectral_centroid */ "./modules/functions/xtract_spectral_centroid.js");
/* harmony import */ var _xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_128679__(/*! ./xtract_spectral_standard_deviation */ "./modules/functions/xtract_spectral_standard_deviation.js");
/* harmony import */ var _xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_128679__(/*! ./xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_4__ = __nested_webpack_require_128679__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />






function xtract_spectral_kurtosis(spectrum, spectral_centroid, spectral_standard_deviation) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof spectral_centroid !== "number") {
        spectral_centroid = Object(_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__["xtract_spectral_centroid"])(spectrum);
    }
    if (typeof spectral_standard_deviation !== "number") {
        spectral_standard_deviation = Object(_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_2__["xtract_spectral_standard_deviation"])(spectrum, Object(_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_3__["xtract_spectral_variance"])(spectrum, spectral_centroid));
    }
    if (spectral_standard_deviation === 0) {
        return Infinity;
    }
    var result = 0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    var freqs = spectrum.subarray(K);
    var A_d = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_4__["xtract_array_sum"])(amps);
    for (var n = 0; n < K; n++) {
        result += Math.pow(freqs[n] - spectral_centroid, 4) * (amps[n] / A_d);
    }
    return result / Math.pow(spectral_standard_deviation, 4);
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_mean.js":
/*!***************************************************!*\
  !*** ./modules/functions/xtract_spectral_mean.js ***!
  \***************************************************/
/*! exports provided: xtract_spectral_mean */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_131477__) {

"use strict";
__nested_webpack_require_131477__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_131477__.d(__webpack_exports__, "xtract_spectral_mean", function() { return xtract_spectral_mean; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_131477__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_131477__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_spectral_mean(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var N = spectrum.length;
    var n = N >> 1;
    var amps = spectrum.subarray(0, n);
    var sum = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(amps);
    var result = sum / n;
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_skewness.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_spectral_skewness.js ***!
  \*******************************************************/
/*! exports provided: xtract_spectral_skewness */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_132837__) {

"use strict";
__nested_webpack_require_132837__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_132837__.d(__webpack_exports__, "xtract_spectral_skewness", function() { return xtract_spectral_skewness; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_132837__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_132837__(/*! ./xtract_spectral_centroid */ "./modules/functions/xtract_spectral_centroid.js");
/* harmony import */ var _xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_132837__(/*! ./xtract_spectral_standard_deviation */ "./modules/functions/xtract_spectral_standard_deviation.js");
/* harmony import */ var _xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_132837__(/*! ./xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_4__ = __nested_webpack_require_132837__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />






function xtract_spectral_skewness(spectrum, spectral_centroid, spectral_standard_deviation) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof spectral_mean !== "number") {
        spectral_centroid = Object(_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__["xtract_spectral_centroid"])(spectrum);
    }
    if (typeof spectral_standard_deviation !== "number") {
        spectral_standard_deviation = Object(_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_2__["xtract_spectral_standard_deviation"])(spectrum, Object(_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_3__["xtract_spectral_variance"])(spectrum, spectral_centroid));
    }
    if (spectral_standard_deviation === 0) {
        return 0;
    }
    var result = 0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    var freqs = spectrum.subarray(K);
    var A_d = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_4__["xtract_array_sum"])(amps);
    for (var n = 0; n < K; n++) {
        result += Math.pow(freqs[n] - spectral_centroid, 3) * (amps[n] / A_d);
    }
    result /= Math.pow(spectral_standard_deviation, 3);
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_slope.js":
/*!****************************************************!*\
  !*** ./modules/functions/xtract_spectral_slope.js ***!
  \****************************************************/
/*! exports provided: xtract_spectral_slope */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_135642__) {

"use strict";
__nested_webpack_require_135642__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_135642__.d(__webpack_exports__, "xtract_spectral_slope", function() { return xtract_spectral_slope; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_135642__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_135642__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_spectral_slope(spectrum) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    var F = 0.0,
        FA = 0.0,
        A = 0.0,
        FXTRACT_SQ = 0.0;
    var N = spectrum.length;
    var M = N >> 1;
    var amps = spectrum.subarray(0, M);
    var freqs = spectrum.subarray(M);
    F = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(freqs);
    A = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(amps);
    for (var n = 0; n < M; n++) {
        FA += freqs[n] * amps[n];
        FXTRACT_SQ += freqs[n] * freqs[n];
    }
    return (1.0 / A) * (M * FA - F * A) / (M * FXTRACT_SQ - F * F);
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_spread.js":
/*!*****************************************************!*\
  !*** ./modules/functions/xtract_spectral_spread.js ***!
  \*****************************************************/
/*! exports provided: xtract_spectral_spread */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_137336__) {

"use strict";
__nested_webpack_require_137336__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_137336__.d(__webpack_exports__, "xtract_spectral_spread", function() { return xtract_spectral_spread; });
/* harmony import */ var _xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_137336__(/*! ./xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_spectral_spread(spectrum, spectral_centroid) {
    return Object(_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_0__["xtract_spectral_variance"])(spectrum, spectral_centroid);
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_standard_deviation.js":
/*!*****************************************************************!*\
  !*** ./modules/functions/xtract_spectral_standard_deviation.js ***!
  \*****************************************************************/
/*! exports provided: xtract_spectral_standard_deviation */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_138403__) {

"use strict";
__nested_webpack_require_138403__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_138403__.d(__webpack_exports__, "xtract_spectral_standard_deviation", function() { return xtract_spectral_standard_deviation; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_138403__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_138403__(/*! ./xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_spectral_standard_deviation(spectrum, spectral_variance) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof spectral_variance !== "number") {
        spectral_variance = Object(_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_1__["xtract_spectral_variance"])(spectrum);
    }
    return Math.sqrt(spectral_variance);
}


/***/ }),

/***/ "./modules/functions/xtract_spectral_variance.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_spectral_variance.js ***!
  \*******************************************************/
/*! exports provided: xtract_spectral_variance */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_139843__) {

"use strict";
__nested_webpack_require_139843__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_139843__.d(__webpack_exports__, "xtract_spectral_variance", function() { return xtract_spectral_variance; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_139843__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_139843__(/*! ./xtract_spectral_centroid */ "./modules/functions/xtract_spectral_centroid.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_139843__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_spectral_variance(spectrum, spectral_centroid) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof spectral_centroid !== "number") {
        spectral_centroid = Object(_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_1__["xtract_spectral_centroid"])(spectrum);
    }
    var A = 0,
        result = 0;
    var N = spectrum.length;
    var n = N >> 1;
    var amps = spectrum.subarray(0, n);
    var freqs = spectrum.subarray(n, N);
    var A_d = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_2__["xtract_array_sum"])(amps);
    while (n--) {
        result += Math.pow(freqs[n] - spectral_centroid, 2) * (amps[n] / A_d);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_spectrum.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_spectrum.js ***!
  \**********************************************/
/*! exports provided: xtract_spectrum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_141715__) {

"use strict";
__nested_webpack_require_141715__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_141715__.d(__webpack_exports__, "xtract_spectrum", function() { return xtract_spectrum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_141715__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_normalise__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_141715__(/*! ./xtract_array_normalise */ "./modules/functions/xtract_array_normalise.js");
/* harmony import */ var _freeFFT__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_141715__(/*! ../freeFFT */ "./modules/freeFFT.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_spectrum(array, sample_rate, withDC, normalise) {
    (function (array, sample_rate) {
        if (typeof sample_rate !== "number") {
            throw ("Sample Rate must be defined");
        }
    })(array, sample_rate);
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array)) {
        return 0;
    }
    withDC = (withDC === true);
    normalise = (normalise === true);

    var N = array.length;
    var result, align = 0;
    var amps;
    var freqs;
    if (withDC) {
        result = new Float64Array(N + 2);
    } else {
        align = 1;
        result = new Float64Array(N);
    }
    amps = result.subarray(0, result.length / 2);
    freqs = result.subarray(result.length / 2);
    var reals = new Float64Array(N);
    var imags = new Float64Array(N);
    array.forEach(function (v, i) {
        reals[i] = v;
    });
    Object(_freeFFT__WEBPACK_IMPORTED_MODULE_2__["transform"])(reals, imags);
    for (var k = align; k <= result.length / 2; k++) {
        amps[k - align] = Math.sqrt((reals[k] * reals[k]) + (imags[k] * imags[k])) / array.length;
        freqs[k - align] = (2 * k / N) * (sample_rate / 2);
    }
    if (normalise) {
        amps = Object(_xtract_array_normalise__WEBPACK_IMPORTED_MODULE_1__["xtract_array_normalise"])(amps);
    }
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_standard_deviation.js":
/*!********************************************************!*\
  !*** ./modules/functions/xtract_standard_deviation.js ***!
  \********************************************************/
/*! exports provided: xtract_standard_deviation */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_144169__) {

"use strict";
__nested_webpack_require_144169__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_144169__.d(__webpack_exports__, "xtract_standard_deviation", function() { return xtract_standard_deviation; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_144169__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_variance__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_144169__(/*! ./xtract_variance */ "./modules/functions/xtract_variance.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_standard_deviation(array, variance) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof variance !== "number") {
        variance = Object(_xtract_variance__WEBPACK_IMPORTED_MODULE_1__["xtract_variance"])(array);
    }
    return Math.sqrt(variance);
}


/***/ }),

/***/ "./modules/functions/xtract_sum.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_sum.js ***!
  \*****************************************/
/*! exports provided: xtract_sum */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_145422__) {

"use strict";
__nested_webpack_require_145422__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_145422__.d(__webpack_exports__, "xtract_sum", function() { return xtract_sum; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_145422__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_145422__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_sum(data) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(data))
        return 0;
    return Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(data);
}


/***/ }),

/***/ "./modules/functions/xtract_temporal_centroid.js":
/*!*******************************************************!*\
  !*** ./modules/functions/xtract_temporal_centroid.js ***!
  \*******************************************************/
/*! exports provided: xtract_temporal_centroid */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_146607__) {

"use strict";
__nested_webpack_require_146607__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_146607__.d(__webpack_exports__, "xtract_temporal_centroid", function() { return xtract_temporal_centroid; });
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_146607__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_temporal_centroid(energyArray, sample_rate, window_ms) {
    if (typeof sample_rate !== "number") {
        console.error("xtract_temporal_centroid requires sample_rate to be a number");
        return;
    }
    if (typeof window_ms !== "number") {
        console.log("xtract_temporal_centroid assuming window_ms = 100ms");
        window_ms = 100.0;
    }
    if (window_ms <= 0) {
        window_ms = 100.0;
    }
    var ts = 1.0 / sample_rate;
    var L = sample_rate * (window_ms / 1000.0);
    var den = Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_0__["xtract_array_sum"])(energyArray);
    var num = 0.0;
    for (var n = 0; n < energyArray.length; n++) {
        num += energyArray[n] * (n * L * ts);
    }
    var result = num / den;
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_tonality.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_tonality.js ***!
  \**********************************************/
/*! exports provided: xtract_tonality */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_148150__) {

"use strict";
__nested_webpack_require_148150__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_148150__.d(__webpack_exports__, "xtract_tonality", function() { return xtract_tonality; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_148150__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_flatness_db__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_148150__(/*! ./xtract_flatness_db */ "./modules/functions/xtract_flatness_db.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_tonality(spectrum, flatness_db) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return 0;
    if (typeof flatness_db !== "number") {
        flatness_db = Object(_xtract_flatness_db__WEBPACK_IMPORTED_MODULE_1__["xtract_flatness_db"])(spectrum);
    }
    return Math.min(flatness_db / -60.0, 1);
}


/***/ }),

/***/ "./modules/functions/xtract_tristimulus.js":
/*!*************************************************!*\
  !*** ./modules/functions/xtract_tristimulus.js ***!
  \*************************************************/
/*! exports provided: xtract_tristimulus, xtract_tristimulus_1, xtract_tristimulus_2, xtract_tristimulus_3 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_149526__) {

"use strict";
__nested_webpack_require_149526__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_149526__.d(__webpack_exports__, "xtract_tristimulus", function() { return xtract_tristimulus; });
/* harmony export (binding) */ __nested_webpack_require_149526__.d(__webpack_exports__, "xtract_tristimulus_1", function() { return xtract_tristimulus_1; });
/* harmony export (binding) */ __nested_webpack_require_149526__.d(__webpack_exports__, "xtract_tristimulus_2", function() { return xtract_tristimulus_2; });
/* harmony export (binding) */ __nested_webpack_require_149526__.d(__webpack_exports__, "xtract_tristimulus_3", function() { return xtract_tristimulus_3; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_149526__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_tristimulus(spectrum, f0) {
    var trist = [0.0, 0.0, 0.0];
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(spectrum))
        return trist;
    if (typeof f0 !== "number") {
        throw ("xtract_tristimulus requires f0 to be defined and a number");
    }
    var h = 0,
        den = 0.0,
        p = [0, 0, 0, 0, 0],
        temp = 0.0,
        num = 0.0;
    var N = spectrum.length;
    var K = N >> 1;
    var amps = spectrum.subarray(0, K);
    var freqs = spectrum.subarray(K);

    for (var i = 0; i < K; i++) {
        temp = amps[i];
        if (temp !== 0) {
            den += temp;
            h = Math.floor(freqs[i] / f0 + 0.5);
            p[h - 1] += temp;
        }
    }

    if (den !== 0.0) {
        trist[0] = p[0] / den;
        trist[1] = (p[1] + p[2] + p[3]) / den;
        trist[2] = p[4] / den;
    }
    return trist;
}

function xtract_tristimulus_1(spectrum, f0) {
    return xtract_tristimulus(spectrum, f0)[0];
}

function xtract_tristimulus_2(spectrum, f0) {
    return xtract_tristimulus(spectrum, f0)[1];
}

function xtract_tristimulus_3(spectrum, f0) {
    return xtract_tristimulus(spectrum, f0)[2];
}


/***/ }),

/***/ "./modules/functions/xtract_variance.js":
/*!**********************************************!*\
  !*** ./modules/functions/xtract_variance.js ***!
  \**********************************************/
/*! exports provided: xtract_variance */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_151911__) {

"use strict";
__nested_webpack_require_151911__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_151911__.d(__webpack_exports__, "xtract_variance", function() { return xtract_variance; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_151911__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_mean__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_151911__(/*! ./xtract_mean */ "./modules/functions/xtract_mean.js");
/// <reference path="../../typings/functions.d.ts" />



function xtract_variance(array, mean) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof mean !== "number") {
        mean = Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_1__["xtract_mean"])(array);
    }
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    if (typeof mean !== "number") {
        mean = Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_1__["xtract_mean"])(array);
    }
    var result = 0.0;
    if (array.reduce) {
        result = array.reduce(function (a, b) {
            a += Math.pow(b - mean, 2);
            return a;
        }, 0);
    } else {
        for (var n = 0; n < array.length; n++) {
            result += Math.pow(array[n] - mean, 2);
        }
    }
    result /= (array.length - 1);
    return result;
}


/***/ }),

/***/ "./modules/functions/xtract_wavelet_f0.js":
/*!************************************************!*\
  !*** ./modules/functions/xtract_wavelet_f0.js ***!
  \************************************************/
/*! exports provided: xtract_wavelet_f0 */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_153706__) {

"use strict";
__nested_webpack_require_153706__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_153706__.d(__webpack_exports__, "xtract_wavelet_f0", function() { return xtract_wavelet_f0; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_153706__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony import */ var _xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_153706__(/*! ./xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/* harmony import */ var _xtract_mean__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_153706__(/*! ./xtract_mean */ "./modules/functions/xtract_mean.js");
/// <reference path="../../typings/functions.d.ts" />




function xtract_wavelet_f0(timeArray, sampleRate, pitchtracker) { // eslint-disable-line max-statements
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(timeArray))
        return 0;
    if (pitchtracker === undefined) {
        throw ("xtract_wavelet_f0 requires pitchtracker to be defined");
    }
    if (Object(_xtract_array_sum__WEBPACK_IMPORTED_MODULE_1__["xtract_array_sum"])(timeArray) === 0) {
        return;
    }

    function _power2p(value) {
        if (value === 0) {
            return 1;
        }
        if (value === 2) {
            return 1;
        }
        if (value & 0x1) {
            return 0;
        }
        return (_power2p(value >> 1));
    }

    function _bitcount(value) {
        if (value === 0) {
            return 0;
        }
        if (value === 1) {
            return 1;
        }
        if (value === 2) {
            return 2;
        }
        return _bitcount(value >> 1) + 1;
    }

    function _ceil_power2(value) {
        if (_power2p(value)) {
            return value;
        }

        if (value === 1) {
            return 2;
        }
        var j, i = _bitcount(value);
        var res = 1;
        for (j = 0; j < i; j++) {
            res <<= 1;
        }
        return res;
    }

    function _floor_power2(value) {
        if (_power2p(value)) {
            return value;
        }
        return _ceil_power2(value) / 2;
    }

    function _iabs(x) {
        if (x >= 0) return x;
        return -x;
    }

    function _2power(i) {
        var res = 1,
            j;
        for (j = 0; j < i; j++) {
            res <<= 1;
        }
        return res;
    }

    function dywapitch_neededsamplecount(minFreq) {
        var nbSam = 3 * 44100 / minFreq; // 1017. for 130 Hz
        nbSam = _ceil_power2(nbSam); // 1024
        return nbSam;
    }

    function bodyLoop() { // eslint-disable-line max-statements
        delta = Math.floor(44100 / (_2power(curLevel) * 3000));
        if (curSamNb < 2) {
            cont = false;
            return;
        }
        var dv, previousDV = -1000;
        var nbMins = 0,
            nbMaxs = 0;
        var lastMinIndex = -1000000;
        var lastmaxIndex = -1000000;
        var findMax = 0;
        var findMin = 0;
        (function () { // eslint-disable-line complexity
            for (i = 2; i < curSamNb; i++) {
                si = sam[i] - theDC;
                si1 = sam[i - 1] - theDC;

                if (si1 <= 0 && si > 0) {
                    findMax = 1;
                }
                if (si1 >= 0 && si < 0) {
                    findMin = 1;
                }

                // min or max ?
                dv = si - si1;

                if (previousDV > -1000) {

                    if (findMin && previousDV < 0 && dv >= 0) {
                        // minimum
                        if (Math.abs(si) >= ampltitudeThreshold) {
                            if (i > lastMinIndex + delta) {
                                mins[nbMins++] = i;
                                lastMinIndex = i;
                                findMin = 0;
                            }
                        }
                    }

                    if (findMax && previousDV > 0 && dv <= 0) {
                        // maximum
                        if (Math.abs(si) >= ampltitudeThreshold) {
                            if (i > lastmaxIndex + delta) {
                                maxs[nbMaxs++] = i;
                                lastmaxIndex = i;
                                findMax = 0;
                            }
                        }
                    }
                }

                previousDV = dv;
            }
        })();

        if (nbMins === 0 && nbMaxs === 0) {
            cont = false;
            return;
        }

        var d;
        //memset(distances, 0, samplecount*sizeof(int));
        var distances = new Int32Array(samplecount);
        (function () {
            for (i = 0; i < nbMins; i++) {
                for (j = 1; j < 3; j++) {
                    if (i + j < nbMins) {
                        d = _iabs(mins[i] - mins[i + j]);
                        distances[d] = distances[d] + 1;
                    }
                }
            }
            for (i = 0; i < nbMaxs; i++) {
                for (j = 1; j < 3; j++) {
                    if (i + j < nbMaxs) {
                        d = _iabs(maxs[i] - maxs[i + j]);
                        //asLog("dywapitch i=%ld j=%ld d=%ld\n", i, j, d);
                        distances[d] = distances[d] + 1;
                    }
                }
            }
        })();

        var bestDistance = -1;
        var bestValue = -1;
        (function () {
            for (i = 0; i < curSamNb; i++) {
                var summed = 0;
                for (j = -delta; j <= delta; j++) {
                    if (i + j >= 0 && i + j < curSamNb)
                        summed += distances[i + j];
                }
                //asLog("dywapitch i=%ld summed=%ld bestDistance=%ld\n", i, summed, bestDistance);
                if (summed === bestValue) {
                    if (i === 2 * bestDistance)
                        bestDistance = i;

                } else if (summed > bestValue) {
                    bestValue = summed;
                    bestDistance = i;
                }
            }
        })();
        var distAvg = 0.0;
        var nbDists = 0;
        (function () {
            for (j = -delta; j <= delta; j++) {
                if (bestDistance + j >= 0 && bestDistance + j < samplecount) {
                    var nbDist = distances[bestDistance + j];
                    if (nbDist > 0) {
                        nbDists += nbDist;
                        distAvg += (bestDistance + j) * nbDist;
                    }
                }
            }
        })();
        // this is our mode distance !
        distAvg /= nbDists;

        // continue the levels ?
        if (curModeDistance > -1.0) {
            var similarity = Math.abs(distAvg * 2 - curModeDistance);
            if (similarity <= 2 * delta) {
                //if DEBUGG then put "similarity="&similarity&&"delta="&delta&&"ok"
                //asLog("dywapitch similarity=%f OK !\n", similarity);
                // two consecutive similar mode distances : ok !
                pitchF = 44100 / (_2power(curLevel - 1) * curModeDistance);
                cont = false;
                return;
            }
            //if DEBUGG then put "similarity="&similarity&&"delta="&delta&&"not"
        }

        // not similar, continue next level
        curModeDistance = distAvg;

        curLevel = curLevel + 1;
        if (curLevel >= 6) {
            // put "max levels reached, exiting"
            //asLog("dywapitch max levels reached, exiting\n");
            cont = false;
            return;
        }

        // downsample
        if (curSamNb < 2) {
            //asLog("dywapitch not enough samples, exiting\n");
            cont = false;
            return;
        }
        (function () {
            for (i = 0; i < curSamNb / 2; i++) {
                sam[i] = (sam[2 * i] + sam[2 * i + 1]) / 2.0;
            }
        })();
        curSamNb /= 2;
    }

    function _dywapitch_dynamicprocess(pitchtracker, pitch) { // eslint-disable-line complexity
        if (pitch === 0.0) {
            return -1.0;
        }

        var estimatedPitch = -1,
            acceptedError = 0.2,
            maxConfidence = 5;
        if (pitch !== -1) {
            // I have a pitch here

            if (pitchtracker._prevPitch === -1) {
                // no Previous
                estimatedPitch = pitch;
                pitchtracker._prevPitch = pitch;
                pitchtracker._pitchConfidence = 1;
            } else if (Math.abs(pitchtracker._prevPitch - pitch) / pitch < acceptedError) {
                // similar: remember and increment
                pitchtracker._prevPitch = pitch;
                estimatedPitch = pitch;
                pitchtracker._pitchConfidence = Math.min(maxConfidence, pitchtracker._pitchConfidence + 1);
            } else if ((pitchtracker._pitchConfidence >= maxConfidence - 2) && Math.abs(pitchtracker._pitchConfidence - 2 * pitch) / (2 * pitch) < acceptedError) {
                // close to half the last pitch, which is trusted
                estimatedPitch = 2 * pitch;
                pitchtracker._prevPitch = estimatedPitch;
            } else if ((pitchtracker._pitchConfidence >= maxConfidence - 2) && Math.abs(pitchtracker._pitchConfidence - 0.5 * pitch) / (0.5 * pitch) < acceptedError) {
                estimatedPitch = 0.5 * pitch;
                pitchtracker._prevPitch = estimatedPitch;
            } else {
                // Very different value
                if (pitchtracker._pitchConfidence >= 1) {
                    // previous trusted
                    estimatedPitch = pitchtracker._prevPitch;
                    pitchtracker._pitchConfidence = Math.max(0, pitchtracker._pitchConfidence - 1);
                } else {
                    estimatedPitch = pitch;
                    pitchtracker._prevPitch = pitch;
                    pitchtracker._pitchConfidence = 1;
                }
            }
        } else {
            // No pitch
            if (pitchtracker._prevPitch !== -1) {
                // was a pitch before
                if (pitchtracker._pitchConfidence >= 1) {
                    // previous trusted
                    estimatedPitch = pitchtracker._prevPitch;
                    pitchtracker._pitchConfidence = Math.max(0, pitchtracker._pitchConfidence - 1);
                } else {
                    pitchtracker._prevPitch = -1;
                    estimatedPitch = -1;
                    pitchtracker._pitchConfidence = 0;
                }
            }
        }

        if (pitchtracker._pitchConfidence >= 1) {
            pitch = estimatedPitch;
        } else {
            pitch = -1;
        }
        if (pitch === -1) {
            pitch = 0.0;
        }
        return pitch;
    }

    var _minmax = {
        index: undefined,
        next: undefined
    };
    //_dywapitch_computeWaveletPitch(samples, startsample, samplecount)
    var samples = timeArray,
        startsample = 0,
        samplecount = timeArray.length;
    var pitchF = 0.0;
    var i, j, si, si1;

    samplecount = _floor_power2(samplecount);
    var sam = new Float64Array(samplecount);
    for (i = 0; i < samplecount; i++) {
        sam[i] = samples[i];
    }

    var curSamNb = samplecount;

    var mins = new Int32Array(samplecount);
    var maxs = new Int32Array(samplecount);

    //var maxFLWTlevels = 6;
    //var maxF = 3000;
    //var differenceLevelsN = 3;
    //var maximaThresholdRatio = 0.75;
    var theDC = getTheDC(sam, samplecount);

    function getTheDC(sam, samplecount) {
        return Object(_xtract_mean__WEBPACK_IMPORTED_MODULE_2__["xtract_mean"])(sam.subarray(samplecount));
    }

    function getamplitudeMax(sam, samplecount) {
        var si, i;
        var minValue = 0.0,
            maxValue = 0.0;
        for (i = 0; i < samplecount; i++) {
            si = sam[i];
            if (si > maxValue) {
                maxValue = si;
            }
            if (si < minValue) {
                minValue = si;
            }
        }
        maxValue = maxValue - theDC;
        minValue = minValue - theDC;
        return (maxValue > -minValue ? maxValue : -minValue);
    }
    var ampltitudeThreshold = getamplitudeMax(sam, samplecount) * 0.75;

    var curLevel = 0;
    var curModeDistance = -1;
    var delta;

    var cont = true;

    while (cont) {
        bodyLoop();
    }

    //_dywapitch_dynamicprocess(pitchtracker, pitch)
    return _dywapitch_dynamicprocess(pitchtracker, pitchF);
}


/***/ }),

/***/ "./modules/functions/xtract_yin.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_yin.js ***!
  \*****************************************/
/*! exports provided: xtract_yin */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_166605__) {

"use strict";
__nested_webpack_require_166605__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_166605__.d(__webpack_exports__, "xtract_yin", function() { return xtract_yin; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_166605__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />


function xtract_yin(array) {
    // Uses the YIN process
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(array))
        return 0;
    var T = array.length;
    var d = new Float64Array(array.length);
    var r = new array.constructor(array.length);

    var d_sigma = 0;
    for (var tau = 1; tau < T; tau++) {
        var sigma = 0;
        for (var t = 1; t < T - tau; t++) {
            sigma += Math.pow(array[t] - array[t + tau], 2);
        }
        d[tau] = sigma;
        d_sigma += sigma;
        r[tau] = d[tau] / ((1 / tau) * d_sigma);
    }
    return r;
}


/***/ }),

/***/ "./modules/functions/xtract_zcr.js":
/*!*****************************************!*\
  !*** ./modules/functions/xtract_zcr.js ***!
  \*****************************************/
/*! exports provided: xtract_zcr */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_167930__) {

"use strict";
__nested_webpack_require_167930__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_167930__.d(__webpack_exports__, "xtract_zcr", function() { return xtract_zcr; });
/* harmony import */ var _xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_167930__(/*! ./xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/// <reference path="../../typings/functions.d.ts" />

function xtract_zcr(timeArray) {
    if (!Object(_xtract_assert_array__WEBPACK_IMPORTED_MODULE_0__["xtract_assert_array"])(timeArray))
        return 0;
    var result = 0;
    for (var n = 1; n < timeArray.length; n++) {
        if (timeArray[n] * timeArray[n - 1] < 0) {
            result++;
        }
    }
    return result / timeArray.length;
}


/***/ }),

/***/ "./modules/index.js":
/*!**************************!*\
  !*** ./modules/index.js ***!
  \**************************/
/*! exports provided: xtract_is_denormal, xtract_assert_array, xtract_assert_positive_integer, xtract_array_sum, xtract_array_copy, xtract_array_min, xtract_array_max, xtract_array_scale, xtract_array_normalise, xtract_array_bound, xtract_array_interlace, xtract_array_deinterlace, xtract_get_number_of_frames, xtract_get_data_frames, xtract_process_frame_data, xtract_array_to_JSON, xtract_frame_from_array, xtract_mean, xtract_temporal_centroid, xtract_variance, xtract_standard_deviation, xtract_average_deviation, xtract_skewness_kurtosis, xtract_skewness, xtract_kurtosis, xtract_spectral_centroid, xtract_spectral_mean, xtract_spectral_variance, xtract_spectral_spread, xtract_spectral_standard_deviation, xtract_spectral_skewness, xtract_spectral_kurtosis, xtract_irregularity_k, xtract_irregularity_j, xtract_tristimulus, xtract_tristimulus_1, xtract_tristimulus_2, xtract_tristimulus_3, xtract_smoothness, xtract_zcr, xtract_rolloff, xtract_loudness, xtract_flatness, xtract_flatness_db, xtract_tonality, xtract_crest, xtract_noisiness, xtract_rms_amplitude, xtract_spectral_inharmonicity, xtract_power, xtract_odd_even_ratio, xtract_sharpness, xtract_spectral_slope, xtract_lowhigh, xtract_lowest_value, xtract_highest_value, xtract_sum, xtract_nonzero_count, xtract_hps, xtract_f0, xtract_failsafe_f0, xtract_wavelet_f0, xtract_midicent, xtract_spectral_fundamental, xtract_energy, xtract_spectrum, xtract_complex_spectrum, xtract_mfcc, xtract_dct, xtract_dct_2, xtract_autocorrelation, xtract_amdf, xtract_asdf, xtract_bark_coefficients, xtract_peak_spectrum, xtract_harmonic_spectrum, xtract_lpc, xtract_lpcc, xtract_pcp, xtract_yin, xtract_onset, xtract_resample, xtract_init_dft, xtract_init_dct, xtract_init_mfcc, xtract_init_wavelet, xtract_init_pcp, xtract_init_bark, xtract_init_chroma, xtract_apply_window, xtract_create_window, xtract_chroma, HarmonicSpectrumData, PeakSpectrumData, SpectrumData, TimeData */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_170826__) {

"use strict";
__nested_webpack_require_170826__.r(__webpack_exports__);
/* harmony import */ var _functions_xtract_is_denormal__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_170826__(/*! ./functions/xtract_is_denormal */ "./modules/functions/xtract_is_denormal.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_is_denormal", function() { return _functions_xtract_is_denormal__WEBPACK_IMPORTED_MODULE_0__["xtract_is_denormal"]; });

/* harmony import */ var _functions_xtract_assert_array__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_170826__(/*! ./functions/xtract_assert_array */ "./modules/functions/xtract_assert_array.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_assert_array", function() { return _functions_xtract_assert_array__WEBPACK_IMPORTED_MODULE_1__["xtract_assert_array"]; });

/* harmony import */ var _functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_170826__(/*! ./functions/xtract_assert_positive_integer */ "./modules/functions/xtract_assert_positive_integer.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_assert_positive_integer", function() { return _functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"]; });

/* harmony import */ var _functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_sum", function() { return _functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_3__["xtract_array_sum"]; });

/* harmony import */ var _functions_xtract_array_copy__WEBPACK_IMPORTED_MODULE_4__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_copy */ "./modules/functions/xtract_array_copy.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_copy", function() { return _functions_xtract_array_copy__WEBPACK_IMPORTED_MODULE_4__["xtract_array_copy"]; });

/* harmony import */ var _functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_5__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_min */ "./modules/functions/xtract_array_min.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_min", function() { return _functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_5__["xtract_array_min"]; });

/* harmony import */ var _functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_6__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_max */ "./modules/functions/xtract_array_max.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_max", function() { return _functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_6__["xtract_array_max"]; });

/* harmony import */ var _functions_xtract_array_scale__WEBPACK_IMPORTED_MODULE_7__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_scale */ "./modules/functions/xtract_array_scale.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_scale", function() { return _functions_xtract_array_scale__WEBPACK_IMPORTED_MODULE_7__["xtract_array_scale"]; });

/* harmony import */ var _functions_xtract_array_normalise__WEBPACK_IMPORTED_MODULE_8__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_normalise */ "./modules/functions/xtract_array_normalise.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_normalise", function() { return _functions_xtract_array_normalise__WEBPACK_IMPORTED_MODULE_8__["xtract_array_normalise"]; });

/* harmony import */ var _functions_xtract_array_bound__WEBPACK_IMPORTED_MODULE_9__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_bound */ "./modules/functions/xtract_array_bound.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_bound", function() { return _functions_xtract_array_bound__WEBPACK_IMPORTED_MODULE_9__["xtract_array_bound"]; });

/* harmony import */ var _functions_xtract_array_interlace__WEBPACK_IMPORTED_MODULE_10__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_interlace */ "./modules/functions/xtract_array_interlace.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_interlace", function() { return _functions_xtract_array_interlace__WEBPACK_IMPORTED_MODULE_10__["xtract_array_interlace"]; });

/* harmony import */ var _functions_xtract_array_deinterlace__WEBPACK_IMPORTED_MODULE_11__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_deinterlace */ "./modules/functions/xtract_array_deinterlace.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_deinterlace", function() { return _functions_xtract_array_deinterlace__WEBPACK_IMPORTED_MODULE_11__["xtract_array_deinterlace"]; });

/* harmony import */ var _functions_xtract_get_number_of_frames__WEBPACK_IMPORTED_MODULE_12__ = __nested_webpack_require_170826__(/*! ./functions/xtract_get_number_of_frames */ "./modules/functions/xtract_get_number_of_frames.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_get_number_of_frames", function() { return _functions_xtract_get_number_of_frames__WEBPACK_IMPORTED_MODULE_12__["xtract_get_number_of_frames"]; });

/* harmony import */ var _functions_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_13__ = __nested_webpack_require_170826__(/*! ./functions/xtract_get_data_frames */ "./modules/functions/xtract_get_data_frames.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_get_data_frames", function() { return _functions_xtract_get_data_frames__WEBPACK_IMPORTED_MODULE_13__["xtract_get_data_frames"]; });

/* harmony import */ var _functions_xtract_process_frame_data__WEBPACK_IMPORTED_MODULE_14__ = __nested_webpack_require_170826__(/*! ./functions/xtract_process_frame_data */ "./modules/functions/xtract_process_frame_data.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_process_frame_data", function() { return _functions_xtract_process_frame_data__WEBPACK_IMPORTED_MODULE_14__["xtract_process_frame_data"]; });

/* harmony import */ var _functions_xtract_array_to_JSON__WEBPACK_IMPORTED_MODULE_15__ = __nested_webpack_require_170826__(/*! ./functions/xtract_array_to_JSON */ "./modules/functions/xtract_array_to_JSON.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_array_to_JSON", function() { return _functions_xtract_array_to_JSON__WEBPACK_IMPORTED_MODULE_15__["xtract_array_to_JSON"]; });

/* harmony import */ var _functions_xtract_frame_from_array__WEBPACK_IMPORTED_MODULE_16__ = __nested_webpack_require_170826__(/*! ./functions/xtract_frame_from_array */ "./modules/functions/xtract_frame_from_array.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_frame_from_array", function() { return _functions_xtract_frame_from_array__WEBPACK_IMPORTED_MODULE_16__["xtract_frame_from_array"]; });

/* harmony import */ var _functions_xtract_mean__WEBPACK_IMPORTED_MODULE_17__ = __nested_webpack_require_170826__(/*! ./functions/xtract_mean */ "./modules/functions/xtract_mean.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_mean", function() { return _functions_xtract_mean__WEBPACK_IMPORTED_MODULE_17__["xtract_mean"]; });

/* harmony import */ var _functions_xtract_temporal_centroid__WEBPACK_IMPORTED_MODULE_18__ = __nested_webpack_require_170826__(/*! ./functions/xtract_temporal_centroid */ "./modules/functions/xtract_temporal_centroid.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_temporal_centroid", function() { return _functions_xtract_temporal_centroid__WEBPACK_IMPORTED_MODULE_18__["xtract_temporal_centroid"]; });

/* harmony import */ var _functions_xtract_variance__WEBPACK_IMPORTED_MODULE_19__ = __nested_webpack_require_170826__(/*! ./functions/xtract_variance */ "./modules/functions/xtract_variance.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_variance", function() { return _functions_xtract_variance__WEBPACK_IMPORTED_MODULE_19__["xtract_variance"]; });

/* harmony import */ var _functions_xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_20__ = __nested_webpack_require_170826__(/*! ./functions/xtract_standard_deviation */ "./modules/functions/xtract_standard_deviation.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_standard_deviation", function() { return _functions_xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_20__["xtract_standard_deviation"]; });

/* harmony import */ var _functions_xtract_average_deviation__WEBPACK_IMPORTED_MODULE_21__ = __nested_webpack_require_170826__(/*! ./functions/xtract_average_deviation */ "./modules/functions/xtract_average_deviation.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_average_deviation", function() { return _functions_xtract_average_deviation__WEBPACK_IMPORTED_MODULE_21__["xtract_average_deviation"]; });

/* harmony import */ var _functions_xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_22__ = __nested_webpack_require_170826__(/*! ./functions/xtract_skewness_kurtosis */ "./modules/functions/xtract_skewness_kurtosis.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_skewness_kurtosis", function() { return _functions_xtract_skewness_kurtosis__WEBPACK_IMPORTED_MODULE_22__["xtract_skewness_kurtosis"]; });

/* harmony import */ var _functions_xtract_skewness__WEBPACK_IMPORTED_MODULE_23__ = __nested_webpack_require_170826__(/*! ./functions/xtract_skewness */ "./modules/functions/xtract_skewness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_skewness", function() { return _functions_xtract_skewness__WEBPACK_IMPORTED_MODULE_23__["xtract_skewness"]; });

/* harmony import */ var _functions_xtract_kurtosis__WEBPACK_IMPORTED_MODULE_24__ = __nested_webpack_require_170826__(/*! ./functions/xtract_kurtosis */ "./modules/functions/xtract_kurtosis.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_kurtosis", function() { return _functions_xtract_kurtosis__WEBPACK_IMPORTED_MODULE_24__["xtract_kurtosis"]; });

/* harmony import */ var _functions_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_25__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_centroid */ "./modules/functions/xtract_spectral_centroid.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_centroid", function() { return _functions_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_25__["xtract_spectral_centroid"]; });

/* harmony import */ var _functions_xtract_spectral_mean__WEBPACK_IMPORTED_MODULE_26__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_mean */ "./modules/functions/xtract_spectral_mean.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_mean", function() { return _functions_xtract_spectral_mean__WEBPACK_IMPORTED_MODULE_26__["xtract_spectral_mean"]; });

/* harmony import */ var _functions_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_27__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_variance", function() { return _functions_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_27__["xtract_spectral_variance"]; });

/* harmony import */ var _functions_xtract_spectral_spread__WEBPACK_IMPORTED_MODULE_28__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_spread */ "./modules/functions/xtract_spectral_spread.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_spread", function() { return _functions_xtract_spectral_spread__WEBPACK_IMPORTED_MODULE_28__["xtract_spectral_spread"]; });

/* harmony import */ var _functions_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_29__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_standard_deviation */ "./modules/functions/xtract_spectral_standard_deviation.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_standard_deviation", function() { return _functions_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_29__["xtract_spectral_standard_deviation"]; });

/* harmony import */ var _functions_xtract_spectral_skewness__WEBPACK_IMPORTED_MODULE_30__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_skewness */ "./modules/functions/xtract_spectral_skewness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_skewness", function() { return _functions_xtract_spectral_skewness__WEBPACK_IMPORTED_MODULE_30__["xtract_spectral_skewness"]; });

/* harmony import */ var _functions_xtract_spectral_kurtosis__WEBPACK_IMPORTED_MODULE_31__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_kurtosis */ "./modules/functions/xtract_spectral_kurtosis.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_kurtosis", function() { return _functions_xtract_spectral_kurtosis__WEBPACK_IMPORTED_MODULE_31__["xtract_spectral_kurtosis"]; });

/* harmony import */ var _functions_xtract_irregularity_k__WEBPACK_IMPORTED_MODULE_32__ = __nested_webpack_require_170826__(/*! ./functions/xtract_irregularity_k */ "./modules/functions/xtract_irregularity_k.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_irregularity_k", function() { return _functions_xtract_irregularity_k__WEBPACK_IMPORTED_MODULE_32__["xtract_irregularity_k"]; });

/* harmony import */ var _functions_xtract_irregularity_j__WEBPACK_IMPORTED_MODULE_33__ = __nested_webpack_require_170826__(/*! ./functions/xtract_irregularity_j */ "./modules/functions/xtract_irregularity_j.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_irregularity_j", function() { return _functions_xtract_irregularity_j__WEBPACK_IMPORTED_MODULE_33__["xtract_irregularity_j"]; });

/* harmony import */ var _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_34__ = __nested_webpack_require_170826__(/*! ./functions/xtract_tristimulus */ "./modules/functions/xtract_tristimulus.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_tristimulus", function() { return _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_34__["xtract_tristimulus"]; });

/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_tristimulus_1", function() { return _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_34__["xtract_tristimulus_1"]; });

/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_tristimulus_2", function() { return _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_34__["xtract_tristimulus_2"]; });

/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_tristimulus_3", function() { return _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_34__["xtract_tristimulus_3"]; });

/* harmony import */ var _functions_xtract_smoothness__WEBPACK_IMPORTED_MODULE_35__ = __nested_webpack_require_170826__(/*! ./functions/xtract_smoothness */ "./modules/functions/xtract_smoothness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_smoothness", function() { return _functions_xtract_smoothness__WEBPACK_IMPORTED_MODULE_35__["xtract_smoothness"]; });

/* harmony import */ var _functions_xtract_zcr__WEBPACK_IMPORTED_MODULE_36__ = __nested_webpack_require_170826__(/*! ./functions/xtract_zcr */ "./modules/functions/xtract_zcr.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_zcr", function() { return _functions_xtract_zcr__WEBPACK_IMPORTED_MODULE_36__["xtract_zcr"]; });

/* harmony import */ var _functions_xtract_rolloff__WEBPACK_IMPORTED_MODULE_37__ = __nested_webpack_require_170826__(/*! ./functions/xtract_rolloff */ "./modules/functions/xtract_rolloff.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_rolloff", function() { return _functions_xtract_rolloff__WEBPACK_IMPORTED_MODULE_37__["xtract_rolloff"]; });

/* harmony import */ var _functions_xtract_loudness__WEBPACK_IMPORTED_MODULE_38__ = __nested_webpack_require_170826__(/*! ./functions/xtract_loudness */ "./modules/functions/xtract_loudness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_loudness", function() { return _functions_xtract_loudness__WEBPACK_IMPORTED_MODULE_38__["xtract_loudness"]; });

/* harmony import */ var _functions_xtract_flatness__WEBPACK_IMPORTED_MODULE_39__ = __nested_webpack_require_170826__(/*! ./functions/xtract_flatness */ "./modules/functions/xtract_flatness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_flatness", function() { return _functions_xtract_flatness__WEBPACK_IMPORTED_MODULE_39__["xtract_flatness"]; });

/* harmony import */ var _functions_xtract_flatness_db__WEBPACK_IMPORTED_MODULE_40__ = __nested_webpack_require_170826__(/*! ./functions/xtract_flatness_db */ "./modules/functions/xtract_flatness_db.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_flatness_db", function() { return _functions_xtract_flatness_db__WEBPACK_IMPORTED_MODULE_40__["xtract_flatness_db"]; });

/* harmony import */ var _functions_xtract_tonality__WEBPACK_IMPORTED_MODULE_41__ = __nested_webpack_require_170826__(/*! ./functions/xtract_tonality */ "./modules/functions/xtract_tonality.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_tonality", function() { return _functions_xtract_tonality__WEBPACK_IMPORTED_MODULE_41__["xtract_tonality"]; });

/* harmony import */ var _functions_xtract_crest__WEBPACK_IMPORTED_MODULE_42__ = __nested_webpack_require_170826__(/*! ./functions/xtract_crest */ "./modules/functions/xtract_crest.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_crest", function() { return _functions_xtract_crest__WEBPACK_IMPORTED_MODULE_42__["xtract_crest"]; });

/* harmony import */ var _functions_xtract_noisiness__WEBPACK_IMPORTED_MODULE_43__ = __nested_webpack_require_170826__(/*! ./functions/xtract_noisiness */ "./modules/functions/xtract_noisiness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_noisiness", function() { return _functions_xtract_noisiness__WEBPACK_IMPORTED_MODULE_43__["xtract_noisiness"]; });

/* harmony import */ var _functions_xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_44__ = __nested_webpack_require_170826__(/*! ./functions/xtract_rms_amplitude */ "./modules/functions/xtract_rms_amplitude.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_rms_amplitude", function() { return _functions_xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_44__["xtract_rms_amplitude"]; });

/* harmony import */ var _functions_xtract_spectral_inharmonicity__WEBPACK_IMPORTED_MODULE_45__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_inharmonicity */ "./modules/functions/xtract_spectral_inharmonicity.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_inharmonicity", function() { return _functions_xtract_spectral_inharmonicity__WEBPACK_IMPORTED_MODULE_45__["xtract_spectral_inharmonicity"]; });

/* harmony import */ var _functions_xtract_power__WEBPACK_IMPORTED_MODULE_46__ = __nested_webpack_require_170826__(/*! ./functions/xtract_power */ "./modules/functions/xtract_power.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_power", function() { return _functions_xtract_power__WEBPACK_IMPORTED_MODULE_46__["xtract_power"]; });

/* harmony import */ var _functions_xtract_odd_even_ratio__WEBPACK_IMPORTED_MODULE_47__ = __nested_webpack_require_170826__(/*! ./functions/xtract_odd_even_ratio */ "./modules/functions/xtract_odd_even_ratio.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_odd_even_ratio", function() { return _functions_xtract_odd_even_ratio__WEBPACK_IMPORTED_MODULE_47__["xtract_odd_even_ratio"]; });

/* harmony import */ var _functions_xtract_sharpness__WEBPACK_IMPORTED_MODULE_48__ = __nested_webpack_require_170826__(/*! ./functions/xtract_sharpness */ "./modules/functions/xtract_sharpness.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_sharpness", function() { return _functions_xtract_sharpness__WEBPACK_IMPORTED_MODULE_48__["xtract_sharpness"]; });

/* harmony import */ var _functions_xtract_spectral_slope__WEBPACK_IMPORTED_MODULE_49__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_slope */ "./modules/functions/xtract_spectral_slope.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_slope", function() { return _functions_xtract_spectral_slope__WEBPACK_IMPORTED_MODULE_49__["xtract_spectral_slope"]; });

/* harmony import */ var _functions_xtract_lowhigh__WEBPACK_IMPORTED_MODULE_50__ = __nested_webpack_require_170826__(/*! ./functions/xtract_lowhigh */ "./modules/functions/xtract_lowhigh.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_lowhigh", function() { return _functions_xtract_lowhigh__WEBPACK_IMPORTED_MODULE_50__["xtract_lowhigh"]; });

/* harmony import */ var _functions_xtract_lowest_value__WEBPACK_IMPORTED_MODULE_51__ = __nested_webpack_require_170826__(/*! ./functions/xtract_lowest_value */ "./modules/functions/xtract_lowest_value.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_lowest_value", function() { return _functions_xtract_lowest_value__WEBPACK_IMPORTED_MODULE_51__["xtract_lowest_value"]; });

/* harmony import */ var _functions_xtract_highest_value__WEBPACK_IMPORTED_MODULE_52__ = __nested_webpack_require_170826__(/*! ./functions/xtract_highest_value */ "./modules/functions/xtract_highest_value.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_highest_value", function() { return _functions_xtract_highest_value__WEBPACK_IMPORTED_MODULE_52__["xtract_highest_value"]; });

/* harmony import */ var _functions_xtract_sum__WEBPACK_IMPORTED_MODULE_53__ = __nested_webpack_require_170826__(/*! ./functions/xtract_sum */ "./modules/functions/xtract_sum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_sum", function() { return _functions_xtract_sum__WEBPACK_IMPORTED_MODULE_53__["xtract_sum"]; });

/* harmony import */ var _functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_54__ = __nested_webpack_require_170826__(/*! ./functions/xtract_nonzero_count */ "./modules/functions/xtract_nonzero_count.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_nonzero_count", function() { return _functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_54__["xtract_nonzero_count"]; });

/* harmony import */ var _functions_xtract_hps__WEBPACK_IMPORTED_MODULE_55__ = __nested_webpack_require_170826__(/*! ./functions/xtract_hps */ "./modules/functions/xtract_hps.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_hps", function() { return _functions_xtract_hps__WEBPACK_IMPORTED_MODULE_55__["xtract_hps"]; });

/* harmony import */ var _functions_xtract_f0__WEBPACK_IMPORTED_MODULE_56__ = __nested_webpack_require_170826__(/*! ./functions/xtract_f0 */ "./modules/functions/xtract_f0.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_f0", function() { return _functions_xtract_f0__WEBPACK_IMPORTED_MODULE_56__["xtract_f0"]; });

/* harmony import */ var _functions_xtract_failsafe_f0__WEBPACK_IMPORTED_MODULE_57__ = __nested_webpack_require_170826__(/*! ./functions/xtract_failsafe_f0 */ "./modules/functions/xtract_failsafe_f0.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_failsafe_f0", function() { return _functions_xtract_failsafe_f0__WEBPACK_IMPORTED_MODULE_57__["xtract_failsafe_f0"]; });

/* harmony import */ var _functions_xtract_wavelet_f0__WEBPACK_IMPORTED_MODULE_58__ = __nested_webpack_require_170826__(/*! ./functions/xtract_wavelet_f0 */ "./modules/functions/xtract_wavelet_f0.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_wavelet_f0", function() { return _functions_xtract_wavelet_f0__WEBPACK_IMPORTED_MODULE_58__["xtract_wavelet_f0"]; });

/* harmony import */ var _functions_xtract_midicent__WEBPACK_IMPORTED_MODULE_59__ = __nested_webpack_require_170826__(/*! ./functions/xtract_midicent */ "./modules/functions/xtract_midicent.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_midicent", function() { return _functions_xtract_midicent__WEBPACK_IMPORTED_MODULE_59__["xtract_midicent"]; });

/* harmony import */ var _functions_xtract_spectral_fundamental__WEBPACK_IMPORTED_MODULE_60__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectral_fundamental */ "./modules/functions/xtract_spectral_fundamental.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectral_fundamental", function() { return _functions_xtract_spectral_fundamental__WEBPACK_IMPORTED_MODULE_60__["xtract_spectral_fundamental"]; });

/* harmony import */ var _functions_xtract_energy__WEBPACK_IMPORTED_MODULE_61__ = __nested_webpack_require_170826__(/*! ./functions/xtract_energy */ "./modules/functions/xtract_energy.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_energy", function() { return _functions_xtract_energy__WEBPACK_IMPORTED_MODULE_61__["xtract_energy"]; });

/* harmony import */ var _functions_xtract_spectrum__WEBPACK_IMPORTED_MODULE_62__ = __nested_webpack_require_170826__(/*! ./functions/xtract_spectrum */ "./modules/functions/xtract_spectrum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_spectrum", function() { return _functions_xtract_spectrum__WEBPACK_IMPORTED_MODULE_62__["xtract_spectrum"]; });

/* harmony import */ var _functions_xtract_complex_spectrum__WEBPACK_IMPORTED_MODULE_63__ = __nested_webpack_require_170826__(/*! ./functions/xtract_complex_spectrum */ "./modules/functions/xtract_complex_spectrum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_complex_spectrum", function() { return _functions_xtract_complex_spectrum__WEBPACK_IMPORTED_MODULE_63__["xtract_complex_spectrum"]; });

/* harmony import */ var _functions_xtract_mfcc__WEBPACK_IMPORTED_MODULE_64__ = __nested_webpack_require_170826__(/*! ./functions/xtract_mfcc */ "./modules/functions/xtract_mfcc.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_mfcc", function() { return _functions_xtract_mfcc__WEBPACK_IMPORTED_MODULE_64__["xtract_mfcc"]; });

/* harmony import */ var _functions_xtract_dct__WEBPACK_IMPORTED_MODULE_65__ = __nested_webpack_require_170826__(/*! ./functions/xtract_dct */ "./modules/functions/xtract_dct.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_dct", function() { return _functions_xtract_dct__WEBPACK_IMPORTED_MODULE_65__["xtract_dct"]; });

/* harmony import */ var _functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_66__ = __nested_webpack_require_170826__(/*! ./functions/xtract_dct_2 */ "./modules/functions/xtract_dct_2.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_dct_2", function() { return _functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_66__["xtract_dct_2"]; });

/* harmony import */ var _functions_xtract_autocorrelation__WEBPACK_IMPORTED_MODULE_67__ = __nested_webpack_require_170826__(/*! ./functions/xtract_autocorrelation */ "./modules/functions/xtract_autocorrelation.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_autocorrelation", function() { return _functions_xtract_autocorrelation__WEBPACK_IMPORTED_MODULE_67__["xtract_autocorrelation"]; });

/* harmony import */ var _functions_xtract_amdf__WEBPACK_IMPORTED_MODULE_68__ = __nested_webpack_require_170826__(/*! ./functions/xtract_amdf */ "./modules/functions/xtract_amdf.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_amdf", function() { return _functions_xtract_amdf__WEBPACK_IMPORTED_MODULE_68__["xtract_amdf"]; });

/* harmony import */ var _functions_xtract_asdf__WEBPACK_IMPORTED_MODULE_69__ = __nested_webpack_require_170826__(/*! ./functions/xtract_asdf */ "./modules/functions/xtract_asdf.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_asdf", function() { return _functions_xtract_asdf__WEBPACK_IMPORTED_MODULE_69__["xtract_asdf"]; });

/* harmony import */ var _functions_xtract_bark_coefficients__WEBPACK_IMPORTED_MODULE_70__ = __nested_webpack_require_170826__(/*! ./functions/xtract_bark_coefficients */ "./modules/functions/xtract_bark_coefficients.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_bark_coefficients", function() { return _functions_xtract_bark_coefficients__WEBPACK_IMPORTED_MODULE_70__["xtract_bark_coefficients"]; });

/* harmony import */ var _functions_xtract_peak_spectrum__WEBPACK_IMPORTED_MODULE_71__ = __nested_webpack_require_170826__(/*! ./functions/xtract_peak_spectrum */ "./modules/functions/xtract_peak_spectrum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_peak_spectrum", function() { return _functions_xtract_peak_spectrum__WEBPACK_IMPORTED_MODULE_71__["xtract_peak_spectrum"]; });

/* harmony import */ var _functions_xtract_harmonic_spectrum__WEBPACK_IMPORTED_MODULE_72__ = __nested_webpack_require_170826__(/*! ./functions/xtract_harmonic_spectrum */ "./modules/functions/xtract_harmonic_spectrum.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_harmonic_spectrum", function() { return _functions_xtract_harmonic_spectrum__WEBPACK_IMPORTED_MODULE_72__["xtract_harmonic_spectrum"]; });

/* harmony import */ var _functions_xtract_lpc__WEBPACK_IMPORTED_MODULE_73__ = __nested_webpack_require_170826__(/*! ./functions/xtract_lpc */ "./modules/functions/xtract_lpc.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_lpc", function() { return _functions_xtract_lpc__WEBPACK_IMPORTED_MODULE_73__["xtract_lpc"]; });

/* harmony import */ var _functions_xtract_lpcc__WEBPACK_IMPORTED_MODULE_74__ = __nested_webpack_require_170826__(/*! ./functions/xtract_lpcc */ "./modules/functions/xtract_lpcc.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_lpcc", function() { return _functions_xtract_lpcc__WEBPACK_IMPORTED_MODULE_74__["xtract_lpcc"]; });

/* harmony import */ var _functions_xtract_pcp__WEBPACK_IMPORTED_MODULE_75__ = __nested_webpack_require_170826__(/*! ./functions/xtract_pcp */ "./modules/functions/xtract_pcp.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_pcp", function() { return _functions_xtract_pcp__WEBPACK_IMPORTED_MODULE_75__["xtract_pcp"]; });

/* harmony import */ var _functions_xtract_yin__WEBPACK_IMPORTED_MODULE_76__ = __nested_webpack_require_170826__(/*! ./functions/xtract_yin */ "./modules/functions/xtract_yin.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_yin", function() { return _functions_xtract_yin__WEBPACK_IMPORTED_MODULE_76__["xtract_yin"]; });

/* harmony import */ var _functions_xtract_onset__WEBPACK_IMPORTED_MODULE_77__ = __nested_webpack_require_170826__(/*! ./functions/xtract_onset */ "./modules/functions/xtract_onset.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_onset", function() { return _functions_xtract_onset__WEBPACK_IMPORTED_MODULE_77__["xtract_onset"]; });

/* harmony import */ var _functions_xtract_resample__WEBPACK_IMPORTED_MODULE_78__ = __nested_webpack_require_170826__(/*! ./functions/xtract_resample */ "./modules/functions/xtract_resample.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_resample", function() { return _functions_xtract_resample__WEBPACK_IMPORTED_MODULE_78__["xtract_resample"]; });

/* harmony import */ var _functions_xtract_init_dft__WEBPACK_IMPORTED_MODULE_79__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_dft */ "./modules/functions/xtract_init_dft.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_dft", function() { return _functions_xtract_init_dft__WEBPACK_IMPORTED_MODULE_79__["xtract_init_dft"]; });

/* harmony import */ var _functions_xtract_init_dct__WEBPACK_IMPORTED_MODULE_80__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_dct */ "./modules/functions/xtract_init_dct.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_dct", function() { return _functions_xtract_init_dct__WEBPACK_IMPORTED_MODULE_80__["xtract_init_dct"]; });

/* harmony import */ var _functions_xtract_init_mfcc__WEBPACK_IMPORTED_MODULE_81__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_mfcc */ "./modules/functions/xtract_init_mfcc.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_mfcc", function() { return _functions_xtract_init_mfcc__WEBPACK_IMPORTED_MODULE_81__["xtract_init_mfcc"]; });

/* harmony import */ var _functions_xtract_init_wavelet__WEBPACK_IMPORTED_MODULE_82__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_wavelet */ "./modules/functions/xtract_init_wavelet.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_wavelet", function() { return _functions_xtract_init_wavelet__WEBPACK_IMPORTED_MODULE_82__["xtract_init_wavelet"]; });

/* harmony import */ var _functions_xtract_init_pcp__WEBPACK_IMPORTED_MODULE_83__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_pcp */ "./modules/functions/xtract_init_pcp.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_pcp", function() { return _functions_xtract_init_pcp__WEBPACK_IMPORTED_MODULE_83__["xtract_init_pcp"]; });

/* harmony import */ var _functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_84__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_bark */ "./modules/functions/xtract_init_bark.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_bark", function() { return _functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_84__["xtract_init_bark"]; });

/* harmony import */ var _functions_xtract_init_chroma__WEBPACK_IMPORTED_MODULE_85__ = __nested_webpack_require_170826__(/*! ./functions/xtract_init_chroma */ "./modules/functions/xtract_init_chroma.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_init_chroma", function() { return _functions_xtract_init_chroma__WEBPACK_IMPORTED_MODULE_85__["xtract_init_chroma"]; });

/* harmony import */ var _functions_xtract_apply_window__WEBPACK_IMPORTED_MODULE_86__ = __nested_webpack_require_170826__(/*! ./functions/xtract_apply_window */ "./modules/functions/xtract_apply_window.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_apply_window", function() { return _functions_xtract_apply_window__WEBPACK_IMPORTED_MODULE_86__["xtract_apply_window"]; });

/* harmony import */ var _functions_xtract_create_window__WEBPACK_IMPORTED_MODULE_87__ = __nested_webpack_require_170826__(/*! ./functions/xtract_create_window */ "./modules/functions/xtract_create_window.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_create_window", function() { return _functions_xtract_create_window__WEBPACK_IMPORTED_MODULE_87__["xtract_create_window"]; });

/* harmony import */ var _functions_xtract_chroma__WEBPACK_IMPORTED_MODULE_88__ = __nested_webpack_require_170826__(/*! ./functions/xtract_chroma */ "./modules/functions/xtract_chroma.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "xtract_chroma", function() { return _functions_xtract_chroma__WEBPACK_IMPORTED_MODULE_88__["xtract_chroma"]; });

/* harmony import */ var _objects_HarmonicSpectrumData__WEBPACK_IMPORTED_MODULE_89__ = __nested_webpack_require_170826__(/*! ./objects/HarmonicSpectrumData */ "./modules/objects/HarmonicSpectrumData.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "HarmonicSpectrumData", function() { return _objects_HarmonicSpectrumData__WEBPACK_IMPORTED_MODULE_89__["HarmonicSpectrumData"]; });

/* harmony import */ var _objects_PeakSpectrumData__WEBPACK_IMPORTED_MODULE_90__ = __nested_webpack_require_170826__(/*! ./objects/PeakSpectrumData */ "./modules/objects/PeakSpectrumData.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "PeakSpectrumData", function() { return _objects_PeakSpectrumData__WEBPACK_IMPORTED_MODULE_90__["PeakSpectrumData"]; });

/* harmony import */ var _objects_SpectrumData__WEBPACK_IMPORTED_MODULE_91__ = __nested_webpack_require_170826__(/*! ./objects/SpectrumData */ "./modules/objects/SpectrumData.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "SpectrumData", function() { return _objects_SpectrumData__WEBPACK_IMPORTED_MODULE_91__["SpectrumData"]; });

/* harmony import */ var _objects_TimeData__WEBPACK_IMPORTED_MODULE_92__ = __nested_webpack_require_170826__(/*! ./objects/TimeData */ "./modules/objects/TimeData.js");
/* harmony reexport (safe) */ __nested_webpack_require_170826__.d(__webpack_exports__, "TimeData", function() { return _objects_TimeData__WEBPACK_IMPORTED_MODULE_92__["TimeData"]; });

































































































if (typeof AnalyserNode !== "undefined") {

    AnalyserNode.prototype.timeData = undefined;
    AnalyserNode.prototype.spectrumData = undefined;
    AnalyserNode.prototype.callbackObject = undefined;
    AnalyserNode.prototype.fooGain = undefined;
    AnalyserNode.prototype.getXtractData = function () {
        if (this.timeData === undefined || this.scpectrumData === undefined) {
            this.timeData = new _objects_TimeData__WEBPACK_IMPORTED_MODULE_92__["TimeData"](this.fftSize, this.context.sampleRate);
            this.spectrumData = new _objects_SpectrumData__WEBPACK_IMPORTED_MODULE_91__["SpectrumData"](this.frequencyBinCount, this.context.sampleRate);
        }
        var dst = new Float32Array(this.fftSize);
        var i;
        if (this.getFloatTimeDomainData) {
            this.getFloatTimeDomainData(dst);
        } else {
            var view = new Uint8Array(this.fftSize);
            this.getByteTimeDomainData(view);
            for (i = 0; i < this.fftSize; i++) {
                dst[i] = view[i];
                dst[i] = (dst[i] / 127.5) - 1;
            }
        }
        this.timeData.copyDataFrom(dst);
        this.timeData.result.spectrum = this.spectrumData;
        var LogStore = new Float32Array(this.frequencyBinCount);
        this.getFloatFrequencyData(LogStore);
        for (i = 0; i < this.frequencyBinCount; i++) {
            LogStore[i] = Math.pow(10.0, LogStore[i] / 20);
        }
        this.spectrumData.copyDataFrom(LogStore);
        return this.timeData;
    };
    AnalyserNode.prototype.previousFrame = undefined;
    AnalyserNode.prototype.previousResult = undefined;
    AnalyserNode.prototype.frameCallback = function (func, arg_this) {
        // Perform a callback on each frame
        // The function callback has the arguments (current_frame, previous_frame, previous_result)
        if (this.callbackObject === undefined) {
            this.callbackObject = this.context.createScriptProcessor(this.fftSize, 1, 1);
            this.connect(this.callbackObject);
        }
        var _func = func;
        var _arg_this = arg_this;
        var self = this;
        this.callbackObject.onaudioprocess = function (e) {
            var current_frame = self.getXtractData();
            this.previousResult = _func.call(_arg_this, current_frame, this.previousFrame, this.previousResult);
            this.previousFrame = current_frame;
            var N = e.outputBuffer.length;
            var output = new Float32Array(N);
            var result = this.previousResult;
            if (typeof this.previousResult !== "number") {
                result = 0.0;
            }
            for (var i = 0; i < N; i++) {
                output[i] = result;
            }
            e.outputBuffer.copyToChannel(output, 0, 0);
        };

        // For chrome and other efficiency browsers
        if (!this.fooGain) {
            this.fooGain = this.context.createGain();
            this.fooGain.gain.value = 0;
            this.callbackObject.connect(this.fooGain);
            this.fooGain.connect(this.context.destination);
        }
    };

    AnalyserNode.prototype.clearCallback = function () {
        this.disconnect(this.callbackObject);
        this.callbackObject.onaudioprocess = undefined;
    };

    AnalyserNode.prototype.xtractFrame = function (func, arg_this) {
        // Collect the current frame of data and perform the callback function
        func.call(arg_this, this.getXtractData());
    };
}

if (typeof AudioBuffer !== "undefined") {

    AudioBuffer.prototype.xtract_get_data_frames = function (frame_size, hop_size) {
        if (hop_size === undefined) {
            hop_size = frame_size;
        }
        (function () {
            if (!Object(_functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"])(frame_size)) {
                throw ("xtract_get_data_frames requires the frame_size to be defined, positive integer");
            }
            if (!Object(_functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"])(hop_size)) {
                throw ("xtract_get_data_frames requires the hop_size to be a positive integer");
            }
        })();
        this.frames = [];
        var N = this.length;
        var K = this.xtract_get_number_of_frames(hop_size);
        for (var c = 0; c < this.numberOfChannels; c++) {
            var data = this.getChannelData(c);
            this.frames[c] = [];
            for (var k = 0; k < K; k++) {
                var frame = new _objects_TimeData__WEBPACK_IMPORTED_MODULE_92__["TimeData"](frame_size, this.sampleRate);
                frame.copyDataFrom(data.subarray(hop_size * k, hop_size * k + frame_size));
                this.frames[c].push(frame);
                frame = undefined;
            }
            data = undefined;
        }
        return this.frames;
    };

    AudioBuffer.prototype.xtract_get_number_of_frames = function (hop_size) {
        return Object(_functions_xtract_get_number_of_frames__WEBPACK_IMPORTED_MODULE_12__["xtract_get_number_of_frames"])(this, hop_size);
    };

    AudioBuffer.prototype.xtract_get_frame = function (dst, channel, index, frame_size) {
        (function () {
            if (typeof dst !== "object" || dst.constructor !== Float32Array) {
                throw ("dst must be a Float32Array object equal in length to hop_size");
            }
            if (!Object(_functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"])(channel)) {
                throw ("xtract_get_frame requires the channel to be an integer value");
            }
            if (!Object(_functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"])(index)) {
                throw ("xtract_get_frame requires the index to be an integer value");
            }
            if (!Object(_functions_xtract_assert_positive_integer__WEBPACK_IMPORTED_MODULE_2__["xtract_assert_positive_integer"])(frame_size)) {
                throw ("xtract_get_frame requires the frame_size to be defined, positive integer");
            }
        })();
        if (channel < 0 || channel > this.numberOfChannels) {
            throw ("channel number " + channel + " out of bounds");
        }
        var K = this.xtract_get_number_of_frames(frame_size);
        if (index < 0 || index >= K) {
            throw ("index number " + index + " out of bounds");
        }
        return this.copyFromChannel(dst, channel, frame_size * index);
    };

    AudioBuffer.prototype.xtract_process_frame_data = function () {
        throw ("AudioBuffer::xtract_process_frame_data has been deprecated");
    };
}





/***/ }),

/***/ "./modules/objects/CommonMemory.js":
/*!*****************************************!*\
  !*** ./modules/objects/CommonMemory.js ***!
  \*****************************************/
/*! exports provided: createDctCoefficients, createMfccCoefficients, createBarkCoefficients, createChromaCoefficients */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_215223__) {

"use strict";
__nested_webpack_require_215223__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_215223__.d(__webpack_exports__, "createDctCoefficients", function() { return createDctCoefficients; });
/* harmony export (binding) */ __nested_webpack_require_215223__.d(__webpack_exports__, "createMfccCoefficients", function() { return createMfccCoefficients; });
/* harmony export (binding) */ __nested_webpack_require_215223__.d(__webpack_exports__, "createBarkCoefficients", function() { return createBarkCoefficients; });
/* harmony export (binding) */ __nested_webpack_require_215223__.d(__webpack_exports__, "createChromaCoefficients", function() { return createChromaCoefficients; });
/* harmony import */ var _functions_xtract_init_dct__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_215223__(/*! ../functions/xtract_init_dct */ "./modules/functions/xtract_init_dct.js");
/* harmony import */ var _functions_xtract_init_mfcc__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_215223__(/*! ../functions/xtract_init_mfcc */ "./modules/functions/xtract_init_mfcc.js");
/* harmony import */ var _functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_215223__(/*! ../functions/xtract_init_bark */ "./modules/functions/xtract_init_bark.js");
/* harmony import */ var _functions_xtract_init_chroma__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_215223__(/*! ../functions/xtract_init_chroma */ "./modules/functions/xtract_init_chroma.js");
/// <reference path="../../typings/objects/CommonMemory.d.ts" />






function searchMapProperties(map, properties) {
    var match = map.find(function (e) {
        for (var prop in properties) {
            if (e[prop] !== properties[prop]) {
                return false;
            }
        }
        return true;
    });
    return match;
}

var dct_map = {
    parent: undefined,
    store: [],
    createCoefficients: function (N) {
        var match = searchMapProperties(this.store, {
            N: N
        });
        if (!match) {
            match = {
                N: N,
                data: Object(_functions_xtract_init_dct__WEBPACK_IMPORTED_MODULE_0__["xtract_init_dct"])(N)
            };
            this.store.push(match);
        }
        return match.data;
    }
};

var mfcc_map = {
    parent: undefined,
    store: [],
    createCoefficients: function (N, nyquist, style, freq_min, freq_max, freq_bands) {
        var search = {
            N: N,
            nyquist: nyquist,
            style: style,
            freq_min: freq_min,
            freq_max: freq_max,
            freq_bands: freq_bands
        };
        var match = searchMapProperties(this.store, search);
        if (!match) {
            match = search;
            match.data = Object(_functions_xtract_init_mfcc__WEBPACK_IMPORTED_MODULE_1__["xtract_init_mfcc"])(N, nyquist, style, freq_min, freq_max, freq_bands);
            this.store.push(match);
        }
        return match.data;
    }
};

var bark_map = {
    parent: undefined,
    store: [],
    createCoefficients: function (N, sampleRate, numBands) {
        var search = {
            N: N,
            sampleRate: sampleRate,
            numBands: numBands
        };
        var match = searchMapProperties(this.store, search);
        if (!match) {
            match = search;
            match.data = Object(_functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_2__["xtract_init_bark"])(N, sampleRate, numBands);
            this.store.push(match);
        }
        return match.data;
    }
};


var chroma_map = {
    parent: undefined,
    store: [],
    createCoefficients: function (N, sampleRate, nbins, A440, f_ctr, octwidth) {
        var search = {
            N: N,
            sampleRate: sampleRate,
            nbins: nbins,
            A440: A440,
            f_ctr: f_ctr,
            octwidth: octwidth
        };
        var match = searchMapProperties(this.store, search);
        if (!match) {
            match = search;
            match.data = Object(_functions_xtract_init_chroma__WEBPACK_IMPORTED_MODULE_3__["xtract_init_chroma"])(N, sampleRate, nbins, A440, f_ctr, octwidth);
            this.store.push(match);
        }
        return match.data;
    }
};

function createDctCoefficients(N) {
    return dct_map.createCoefficients(N);
}

function createMfccCoefficients(N, nyquist, style, freq_min, freq_max, freq_bands) {
    return mfcc_map.createCoefficients(N, nyquist, style, freq_min, freq_max, freq_bands);
}

function createBarkCoefficients(N, sampleRate, numBands) {
    if (typeof numBands !== "number" || numBands < 0 || numBands > 26) {
        numBands = 26;
    }
    return bark_map.createCoefficients(N, sampleRate, numBands);
}

function createChromaCoefficients(N, sampleRate, nbins, A440, f_ctr, octwidth) {
    return chroma_map.createCoefficients(N, sampleRate, nbins, A440, f_ctr, octwidth);
}


/***/ }),

/***/ "./modules/objects/DataPrototype.js":
/*!******************************************!*\
  !*** ./modules/objects/DataPrototype.js ***!
  \******************************************/
/*! exports provided: DataPrototype */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_220341__) {

"use strict";
__nested_webpack_require_220341__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_220341__.d(__webpack_exports__, "DataPrototype", function() { return DataPrototype; });
/* harmony import */ var _functions_xtract_array_to_JSON__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_220341__(/*! ../functions/xtract_array_to_JSON */ "./modules/functions/xtract_array_to_JSON.js");
/* harmony import */ var _CommonMemory__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_220341__(/*! ./CommonMemory */ "./modules/objects/CommonMemory.js");
/// <reference path="../../typings/objects/DataPrototype.d.ts" />



function recursiveDelta(a, b) {
    //a and b are objects of Time/Spectrum/PeakS/HarmonicS Data
    //a and b are the .result object
    var param, delta = {};
    for (param in a) {
        if (b[param]) {
            if (typeof a[param] === "number") {
                delta[param] = a[param] - b[param];
            } else {
                delta[param] = deltaObject(a, b, param);
            }
        }
    }
    return delta;
}

function deltaObject(a, b, param) {
    if (a.result && b.result) {
        return recursiveDelta(a[param].result, b[param].result);
    } else if (a.length && b.length) {
        return deltaArray(a[param], b[param]);
    }
    return undefined;
}

function deltaArray(a, b) {
    var d;
    if (a.length === b.length) {
        d = new Float64Array(a.length);
    } else {
        d = [];
    }
    var n = 0;
    while (n < a.length && n < b.length) {
        d[n] = a[n] - b[n];
        n++;
    }
    return d;
}

class DataPrototype {
    constructor(N, sampleRate) {
        this.result = {};
        this._sampleRate = sampleRate;
        this.data = new Float64Array(N);
    }
    get sampleRate() {
        return this._sampleRate;
    }
    set sampleRate(fs) {
        this._sampleRate = fs;
    }
    clearResult() {
        this.result = {};
    }
    getData() {
        return this.data;
    }
    zeroDataRange(start, end) {
        if (this.data.fill) {
            this.data.fill(0, start, end);
        } else {
            for (var n = start; n < end; n++) {
                this.data[n] = 0;
            }
        }
        this.clearResult();
    }
    zeroData () {
        this.zeroDataRange(0, this.data.length);
    }
    copyDataFrom(src, N, offset) {
        if (typeof src !== "object" || src.length === undefined) {
            throw ("copyDataFrom requires src to be an Array or TypedArray");
        }
        if (offset === undefined) {
            offset = 0;
        }
        if (N === undefined) {
            N = Math.min(src.length, this.data.length);
        }
        N = Math.min(N + offset, this.data.length);
        for (var n = 0; n < N; n++) {
            this.data[n + offset] = src[n];
        }
        this.clearResult();
    }

    duplicate() {
        var copy = this.prototype.constructor(this.data.length, this.sampleRate);
        copy.copyDataFrom(this.data);
    }

    toJSON() {
        function lchar(str) {
            var lastchar = str[str.length - 1];
            if (lastchar !== '{' && lastchar !== ',') {
                str = str + ', ';
            }
            return str;
        }

        function getJSONString(self, p, n) {
            var str = "";
            if (typeof p === "number" && isFinite(p)) {
                str = '"' + n + '": ' + p;
            } else if (typeof p === "object") {
                if (p.toJSON) {
                    str = '"' + n + '": ' + p.toJSON(p);
                } else if (p.length) {
                    str = '"' + n + '": ' + Object(_functions_xtract_array_to_JSON__WEBPACK_IMPORTED_MODULE_0__["xtract_array_to_JSON"])(p);
                } else {
                    str = '"' + n + '": ' + self.toJSON(p);
                }
            } else {
                str = '"' + n + '": "' + p.toString() + '"';
            }
            return str;
        }
        var json = '{';
        for (var property in this.result) {
            if (this.result.hasOwnProperty(property)) {
                json = lchar(json);
                json = json + getJSONString(this, this.result[property], property);
            }
        }
        return json + '}';
    }

    computeDelta(compare) {
        this.result.delta = recursiveDelta(this.result, compare.result);
        return this.result.delta;
    }

    computeDeltaDelta(compare) {
        if (!compare.result.delta || !this.result.delta) {
            throw ("Cannot compute delta-delta without both objects having deltas");
        }
        this.result.delta.delta = recursiveDelta(this.result.delta, compare.result.delta);
        return this.result.delta.delta;
    }

    createDctCoefficients(N) {
        return Object(_CommonMemory__WEBPACK_IMPORTED_MODULE_1__["createDctCoefficients"])(Number(N));
    }

    createMfccCoefficients(N, nyquist, style, freq_min, freq_max, freq_bands) {
        N = Number(N);
        nyquist = Number(nyquist);
        freq_min = Number(freq_min);
        freq_max = Number(freq_max);
        freq_bands = Number(freq_bands);
        return Object(_CommonMemory__WEBPACK_IMPORTED_MODULE_1__["createMfccCoefficients"])(N, nyquist, style, freq_min, freq_max, freq_bands);
    }

    createBarkCoefficients(N, sampleRate, numBands) {
        N = Number(N);
        sampleRate = Number(sampleRate);
        numBands = Number(numBands);
        return Object(_CommonMemory__WEBPACK_IMPORTED_MODULE_1__["createBarkCoefficients"])(N, sampleRate, numBands);
    }

    createChromaCoefficients(N, sampleRate, nbins, A440, f_ctr, octwidth) {
        N = Number(N);
        sampleRate = Number(sampleRate);
        nbins = Number(nbins);
        A440 = Number(A440);
        f_ctr = Number(f_ctr);
        octwidth = Number(octwidth);
        return Object(_CommonMemory__WEBPACK_IMPORTED_MODULE_1__["createChromaCoefficients"])(N, sampleRate, nbins, A440, f_ctr, octwidth);
    }
}


/***/ }),

/***/ "./modules/objects/HarmonicSpectrumData.js":
/*!*************************************************!*\
  !*** ./modules/objects/HarmonicSpectrumData.js ***!
  \*************************************************/
/*! exports provided: HarmonicSpectrumData */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_226612__) {

"use strict";
__nested_webpack_require_226612__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_226612__.d(__webpack_exports__, "HarmonicSpectrumData", function() { return HarmonicSpectrumData; });
/* harmony import */ var _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_226612__(/*! ./PeakSpectrumData */ "./modules/objects/PeakSpectrumData.js");
/* harmony import */ var _functions_xtract_odd_even_ratio__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_226612__(/*! ../functions/xtract_odd_even_ratio */ "./modules/functions/xtract_odd_even_ratio.js");
/* harmony import */ var _functions_xtract_noisiness__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_226612__(/*! ../functions/xtract_noisiness */ "./modules/functions/xtract_noisiness.js");
/// <reference path="../../typings/objects/PeakSpectrumData.d.ts" />




class HarmonicSpectrumData extends _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_0__["PeakSpectrumData"] {
    odd_even_ratio () {
        if (this.result.odd_even_ratio === undefined) {
            if (this.f0 === undefined) {
                this.spectral_fundamental(this.data, this.sampleRate);
            }
            this.result.odd_even_ratio = Object(_functions_xtract_odd_even_ratio__WEBPACK_IMPORTED_MODULE_1__["xtract_odd_even_ratio"])(this.data, this.f0);
        }
        return this.result.odd_even_ratio;
    }

    noisiness() {
        if (parent.constructor !== _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_0__["PeakSpectrumData"]) {
            this.result.noisiness = null;
        } else {
            this.result.noisiness = Object(_functions_xtract_noisiness__WEBPACK_IMPORTED_MODULE_2__["xtract_noisiness"])(this.nonzero_count(), parent.nonzero_count());
        }
        return this.result.noisiness;
    }
}

HarmonicSpectrumData.prototype.features = _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_0__["PeakSpectrumData"].prototype.features.concat([
    {
        name: "Odd Even Ration",
        function: "odd_even_ratio",
        sub_features: [],
        parameters: [],
        returns: "number"
    },
    {
        name: "Noisiness",
        function: "noisiness",
        sub_features: [],
        parameters: [],
        returns: "number"
    }
]);


/***/ }),

/***/ "./modules/objects/PeakSpectrumData.js":
/*!*********************************************!*\
  !*** ./modules/objects/PeakSpectrumData.js ***!
  \*********************************************/
/*! exports provided: PeakSpectrumData */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_229136__) {

"use strict";
__nested_webpack_require_229136__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_229136__.d(__webpack_exports__, "PeakSpectrumData", function() { return PeakSpectrumData; });
/* harmony import */ var _SpectrumData__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_229136__(/*! ./SpectrumData */ "./modules/objects/SpectrumData.js");
/* harmony import */ var _HarmonicSpectrumData__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_229136__(/*! ./HarmonicSpectrumData */ "./modules/objects/HarmonicSpectrumData.js");
/* harmony import */ var _functions_xtract_spectral_inharmonicity__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_229136__(/*! ../functions/xtract_spectral_inharmonicity */ "./modules/functions/xtract_spectral_inharmonicity.js");
/* harmony import */ var _functions_xtract_harmonic_spectrum__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_229136__(/*! ../functions/xtract_harmonic_spectrum */ "./modules/functions/xtract_harmonic_spectrum.js");
/// <reference path="../../typings/objects/PeakSpectrumData.d.ts" />






class PeakSpectrumData extends _SpectrumData__WEBPACK_IMPORTED_MODULE_0__["SpectrumData"] {
    spectral_inharmonicity() {
        if (this.result.spectral_inharmonicity === undefined) {
            this.result.spectral_inharmonicity = Object(_functions_xtract_spectral_inharmonicity__WEBPACK_IMPORTED_MODULE_2__["xtract_spectral_inharmonicity"])(this.data, this.sampleRate);
        }
        return this.result.spectral_inharmonicity;
    }

    harmonic_spectrum(threshold) {
        if (this.result.harmonic_spectrum === undefined) {
            if (this.f0 === undefined) {
                this.spectral_fundamental(this.data, this.sampleRate);
            }
            this.result.harmonic_spectrum = new _HarmonicSpectrumData__WEBPACK_IMPORTED_MODULE_1__["HarmonicSpectrumData"](this.length, this.sampleRate, this);
            var hs = Object(_functions_xtract_harmonic_spectrum__WEBPACK_IMPORTED_MODULE_3__["xtract_harmonic_spectrum"])(this.data, this.f0, threshold);
            this.result.harmonic_spectrum.copyDataFrom(hs.subarray(0, this.length));
        }
        return this.result.harmonic_spectrum;
    }
}

PeakSpectrumData.prototype.features = _SpectrumData__WEBPACK_IMPORTED_MODULE_0__["SpectrumData"].prototype.features.concat([
    {
        name: "Spectral Inharmonicity",
        function: "spectral_inharmonicity",
        sub_features: ["f0"],
        parameters: [],
        returns: "number"
}, {
        name: "Harmonic Spectrum",
        function: "harmonic_spectrum",
        sub_features: [],
        parameters: [{
            name: "Threshold",
            unit: "",
            type: "number",
            minimum: 0,
            maximum: 100,
            default: 30
    }],
        returns: "HarmonicSpectrumData"
}]);


/***/ }),

/***/ "./modules/objects/SpectrumData.js":
/*!*****************************************!*\
  !*** ./modules/objects/SpectrumData.js ***!
  \*****************************************/
/*! exports provided: SpectrumData */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_232224__) {

"use strict";
__nested_webpack_require_232224__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_232224__.d(__webpack_exports__, "SpectrumData", function() { return SpectrumData; });
/* harmony import */ var _DataPrototype__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_232224__(/*! ./DataPrototype */ "./modules/objects/DataPrototype.js");
/* harmony import */ var _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_232224__(/*! ./PeakSpectrumData */ "./modules/objects/PeakSpectrumData.js");
/* harmony import */ var _functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_232224__(/*! ../functions/xtract_init_bark */ "./modules/functions/xtract_init_bark.js");
/* harmony import */ var _functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_232224__(/*! ../functions/xtract_array_min */ "./modules/functions/xtract_array_min.js");
/* harmony import */ var _functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_4__ = __nested_webpack_require_232224__(/*! ../functions/xtract_array_max */ "./modules/functions/xtract_array_max.js");
/* harmony import */ var _functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_5__ = __nested_webpack_require_232224__(/*! ../functions/xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/* harmony import */ var _functions_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_6__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_centroid */ "./modules/functions/xtract_spectral_centroid.js");
/* harmony import */ var _functions_xtract_spectral_mean__WEBPACK_IMPORTED_MODULE_7__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_mean */ "./modules/functions/xtract_spectral_mean.js");
/* harmony import */ var _functions_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_8__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_variance */ "./modules/functions/xtract_spectral_variance.js");
/* harmony import */ var _functions_xtract_spectral_spread__WEBPACK_IMPORTED_MODULE_9__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_spread */ "./modules/functions/xtract_spectral_spread.js");
/* harmony import */ var _functions_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_10__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_standard_deviation */ "./modules/functions/xtract_spectral_standard_deviation.js");
/* harmony import */ var _functions_xtract_spectral_skewness__WEBPACK_IMPORTED_MODULE_11__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_skewness */ "./modules/functions/xtract_spectral_skewness.js");
/* harmony import */ var _functions_xtract_spectral_kurtosis__WEBPACK_IMPORTED_MODULE_12__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_kurtosis */ "./modules/functions/xtract_spectral_kurtosis.js");
/* harmony import */ var _functions_xtract_irregularity_k__WEBPACK_IMPORTED_MODULE_13__ = __nested_webpack_require_232224__(/*! ../functions/xtract_irregularity_k */ "./modules/functions/xtract_irregularity_k.js");
/* harmony import */ var _functions_xtract_irregularity_j__WEBPACK_IMPORTED_MODULE_14__ = __nested_webpack_require_232224__(/*! ../functions/xtract_irregularity_j */ "./modules/functions/xtract_irregularity_j.js");
/* harmony import */ var _functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_15__ = __nested_webpack_require_232224__(/*! ../functions/xtract_tristimulus */ "./modules/functions/xtract_tristimulus.js");
/* harmony import */ var _functions_xtract_smoothness__WEBPACK_IMPORTED_MODULE_16__ = __nested_webpack_require_232224__(/*! ../functions/xtract_smoothness */ "./modules/functions/xtract_smoothness.js");
/* harmony import */ var _functions_xtract_rolloff__WEBPACK_IMPORTED_MODULE_17__ = __nested_webpack_require_232224__(/*! ../functions/xtract_rolloff */ "./modules/functions/xtract_rolloff.js");
/* harmony import */ var _functions_xtract_loudness__WEBPACK_IMPORTED_MODULE_18__ = __nested_webpack_require_232224__(/*! ../functions/xtract_loudness */ "./modules/functions/xtract_loudness.js");
/* harmony import */ var _functions_xtract_sharpness__WEBPACK_IMPORTED_MODULE_19__ = __nested_webpack_require_232224__(/*! ../functions/xtract_sharpness */ "./modules/functions/xtract_sharpness.js");
/* harmony import */ var _functions_xtract_flatness__WEBPACK_IMPORTED_MODULE_20__ = __nested_webpack_require_232224__(/*! ../functions/xtract_flatness */ "./modules/functions/xtract_flatness.js");
/* harmony import */ var _functions_xtract_flatness_db__WEBPACK_IMPORTED_MODULE_21__ = __nested_webpack_require_232224__(/*! ../functions/xtract_flatness_db */ "./modules/functions/xtract_flatness_db.js");
/* harmony import */ var _functions_xtract_tonality__WEBPACK_IMPORTED_MODULE_22__ = __nested_webpack_require_232224__(/*! ../functions/xtract_tonality */ "./modules/functions/xtract_tonality.js");
/* harmony import */ var _functions_xtract_crest__WEBPACK_IMPORTED_MODULE_23__ = __nested_webpack_require_232224__(/*! ../functions/xtract_crest */ "./modules/functions/xtract_crest.js");
/* harmony import */ var _functions_xtract_spectral_slope__WEBPACK_IMPORTED_MODULE_24__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_slope */ "./modules/functions/xtract_spectral_slope.js");
/* harmony import */ var _functions_xtract_spectral_fundamental__WEBPACK_IMPORTED_MODULE_25__ = __nested_webpack_require_232224__(/*! ../functions/xtract_spectral_fundamental */ "./modules/functions/xtract_spectral_fundamental.js");
/* harmony import */ var _functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_26__ = __nested_webpack_require_232224__(/*! ../functions/xtract_nonzero_count */ "./modules/functions/xtract_nonzero_count.js");
/* harmony import */ var _functions_xtract_hps__WEBPACK_IMPORTED_MODULE_27__ = __nested_webpack_require_232224__(/*! ../functions/xtract_hps */ "./modules/functions/xtract_hps.js");
/* harmony import */ var _functions_xtract_mfcc__WEBPACK_IMPORTED_MODULE_28__ = __nested_webpack_require_232224__(/*! ../functions/xtract_mfcc */ "./modules/functions/xtract_mfcc.js");
/* harmony import */ var _functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_29__ = __nested_webpack_require_232224__(/*! ../functions/xtract_dct_2 */ "./modules/functions/xtract_dct_2.js");
/* harmony import */ var _functions_xtract_bark_coefficients__WEBPACK_IMPORTED_MODULE_30__ = __nested_webpack_require_232224__(/*! ../functions/xtract_bark_coefficients */ "./modules/functions/xtract_bark_coefficients.js");
/* harmony import */ var _functions_xtract_chroma__WEBPACK_IMPORTED_MODULE_31__ = __nested_webpack_require_232224__(/*! ../functions/xtract_chroma */ "./modules/functions/xtract_chroma.js");
/* harmony import */ var _functions_xtract_peak_spectrum__WEBPACK_IMPORTED_MODULE_32__ = __nested_webpack_require_232224__(/*! ../functions/xtract_peak_spectrum */ "./modules/functions/xtract_peak_spectrum.js");
/// <reference path="../../typings/objects/SpectrumData.d.ts" />


































class SpectrumData extends _DataPrototype__WEBPACK_IMPORTED_MODULE_0__["DataPrototype"] {
    constructor(N, sampleRate, parent) {
        if (N === undefined || N <= 0) {
            throw ("SpectrumData constructor requires N to be a defined, whole number");
        }
        if (sampleRate === undefined) {
            sampleRate = Math.PI;
        }
        super(2*N, sampleRate);
        this._amps = this.data.subarray(0, N);
        this._freqs = this.data.subarray(N, 2 * N);
        this._length = N;
        this._f0 = undefined;
        this._mfcc = undefined;
        this._bark = undefined;
        this._dct = undefined;
        this._chroma = undefined;

        this.computeFrequencies();
    }
    computeFrequencies () {
        for (let i = 0; i < this._length; i++) {
            this._freqs[i] = (i / this._length) * (this.sampleRate / 2);
        }
    }
    get sampleRate() {
        return this._sampleRate;
    }
    set sampleRate(fs) {
        if (this._sampleRate === Math.PI) {
            this._sampleRate = fs;
            this.computeFrequencies();
            if (this._bark !== undefined) {
                this._bark = Object(_functions_xtract_init_bark__WEBPACK_IMPORTED_MODULE_2__["xtract_init_bark"])(this._length, this._sampleRate );
            }

        } else {
            throw ("Cannot set one-time variable");
        }
    }

    get f0() {
        return this._f0;
    }

    set f0(f0) {
        if (typeof f0 === "number") {
            this._f0 = f0;
        }
    }

    get length() {
        return this._length;
    }

    init_mfcc(num_bands, freq_min, freq_max, style) {
        this._mfcc = this.createMfccCoefficients(this._length, this.sampleRate * 0.5, style, freq_min, freq_max, num_bands);
        this.result.mfcc = undefined;
        return this._mfcc;
    }

    init_bark(numBands) {
        if (typeof numBands !== "number" || numBands < 0 || numBands > 26) {
            numBands = 26;
        }
        this._bark = this.createBarkCoefficients(this._length, this._Fs, numBands);
        return this._bark;
    }

    init_chroma(nbins, A440, f_ctr, octwidth) {
        if (typeof nbins !== "number" || nbins <= 1) {
            nbins = 12;
        }
        if (typeof A440 !== "number" || A440 <= 27.5) {
               A440 = 440;
        }
        if (typeof f_ctr !== "number") {
               f_ctr = 1000;
        }
        if (typeof octwidth !== "number") {
               octwidth = 1;
        }
        this._chroma = this.createChromaCoefficients(this._length, this._Fs, nbins, A440, f_ctr, octwidth);
        this.result.chroma = undefined;
        return this._chroma;
    }

    minimum() {
        if (this.result.minimum === undefined) {
            this.result.minimum = Object(_functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_3__["xtract_array_min"])(this._amps);
        }
        return this.result.minimum;
    }

    maximum() {
        if (this.result.maximum === undefined) {
            this.result.maximum = Object(_functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_4__["xtract_array_max"])(this._amps);
        }
        return this.result.maximum;
    }

    sum() {
        if (this.result.sum === undefined) {
            this.result.sum = Object(_functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_5__["xtract_array_sum"])(this._amps);
        }
        return this.result.sum;
    }

    spectral_centroid() {
        if (this.result.spectral_centroid === undefined) {
            this.result.spectral_centroid = Object(_functions_xtract_spectral_centroid__WEBPACK_IMPORTED_MODULE_6__["xtract_spectral_centroid"])(this.data);
        }
        return this.result.spectral_centroid;
    }

    spectral_mean () {
        if (this.result.spectral_mean === undefined) {
            this.result.spectral_mean = Object(_functions_xtract_spectral_mean__WEBPACK_IMPORTED_MODULE_7__["xtract_spectral_mean"])(this.data);
        }
        return this.result.spectral_mean;
    }

    spectral_variance () {
        if (this.result.spectral_variance === undefined) {
            this.result.spectral_variance = Object(_functions_xtract_spectral_variance__WEBPACK_IMPORTED_MODULE_8__["xtract_spectral_variance"])(this.data, this.spectral_centroid());
        }
        return this.result.spectral_variance;
    }

    spectral_spread() {
        if (this.result.spectral_spread === undefined) {
            this.result.spectral_spread = Object(_functions_xtract_spectral_spread__WEBPACK_IMPORTED_MODULE_9__["xtract_spectral_spread"])(this.data, this.spectral_centroid());
        }
        return this.result.spectral_spread;
    }

    spectral_standard_deviation() {
        if (this.result.spectral_standard_deviation === undefined) {
            this.result.spectral_standard_deviation = Object(_functions_xtract_spectral_standard_deviation__WEBPACK_IMPORTED_MODULE_10__["xtract_spectral_standard_deviation"])(this.data, this.spectral_variance());
        }
        return this.result.spectral_standard_deviation;
    }

    spectral_skewness() {
        if (this.result.spectral_skewness === undefined) {
            this.result.spectral_skewness = Object(_functions_xtract_spectral_skewness__WEBPACK_IMPORTED_MODULE_11__["xtract_spectral_skewness"])(this.data, this.spectral_centroid(), this.spectral_standard_deviation());
        }
        return this.result.spectral_skewness;
    }

    spectral_kurtosis() {
        if (this.result.spectral_kurtosis === undefined) {
            this.result.spectral_kurtosis = Object(_functions_xtract_spectral_kurtosis__WEBPACK_IMPORTED_MODULE_12__["xtract_spectral_kurtosis"])(this.data, this.spectral_centroid(), this.spectral_standard_deviation());
        }
        return this.result.spectral_kurtosis;
    }

    irregularity_k () {
        if (this.result.irregularity_k === undefined) {
            this.result.irregularity_k = Object(_functions_xtract_irregularity_k__WEBPACK_IMPORTED_MODULE_13__["xtract_irregularity_k"])(this.data);
        }
        return this.result.irregularity_k;
    }

    irregularity_j () {
        if (this.result.irregularity_j === undefined) {
            this.result.irregularity_j = Object(_functions_xtract_irregularity_j__WEBPACK_IMPORTED_MODULE_14__["xtract_irregularity_j"])(this.data);
        }
        return this.result.irregularity_j;
    }

    tristimulus_1 () {
        if (this._f0 === undefined) {
            this.spectral_fundamental();
        }
        if (this.result.tristimulus_1 === undefined) {
            this.result.tristimulus_1 = Object(_functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_15__["xtract_tristimulus_1"])(this.data, this._f0);
        }
        return this.result.tristimulus_1;
    }
    tristimulus_2 () {
        if (this._f0 === undefined) {
            this.spectral_fundamental();
        }
        if (this.result.tristimulus_2 === undefined) {
            this.result.tristimulus_2 = Object(_functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_15__["xtract_tristimulus_2"])(this.data, this._f0);
        }
        return this.result.tristimulus_2;
    }
    tristimulus_3 () {
        if (this._f0 === undefined) {
            this.spectral_fundamental();
        }
        if (this.result.tristimulus_3 === undefined) {
            this.result.tristimulus_3 = Object(_functions_xtract_tristimulus__WEBPACK_IMPORTED_MODULE_15__["xtract_tristimulus_3"])(this.data, this._f0);
        }
        return this.result.tristimulus_3;
    }

    smoothness() {
        if (this.result.smoothness === undefined) {
            this.result.smoothness = Object(_functions_xtract_smoothness__WEBPACK_IMPORTED_MODULE_16__["xtract_smoothness"])(this.data);
        }
        return this.result.smoothness;
    }

    rolloff(threshold) {
        if (this.result.rolloff === undefined) {
            this.result.rolloff = Object(_functions_xtract_rolloff__WEBPACK_IMPORTED_MODULE_17__["xtract_rolloff"])(this.data, this.sampleRate, threshold);
        }
        return this.result.rolloff;
    }

    loudness() {
        if (this.result.loudness === undefined) {
            this.result.loudness = Object(_functions_xtract_loudness__WEBPACK_IMPORTED_MODULE_18__["xtract_loudness"])(this.bark_coefficients());
        }
        return this.result.loudness;
    }

    sharpness () {
        if (this.result.sharpness === undefined) {
            this.result.sharpness = Object(_functions_xtract_sharpness__WEBPACK_IMPORTED_MODULE_19__["xtract_sharpness"])(this.bark_coefficients());
        }
        return this.result.sharpness;
    }

    flatness () {
        if (this.result.flatness === undefined) {
            this.result.flatness = Object(_functions_xtract_flatness__WEBPACK_IMPORTED_MODULE_20__["xtract_flatness"])(this.data);
        }
        return this.result.flatness;
    }

    flatness_db () {
        if (this.result.flatness_db === undefined) {
            this.result.flatness_db = Object(_functions_xtract_flatness_db__WEBPACK_IMPORTED_MODULE_21__["xtract_flatness_db"])(this.data, this.flatness());
        }
        return this.result.flatness_db;
    }

    tonality() {
        if (this.result.tonality === undefined) {
            this.result.tonality = Object(_functions_xtract_tonality__WEBPACK_IMPORTED_MODULE_22__["xtract_tonality"])(this.data, this.flatness_db());
        }
        return this.result.tonality;
    }

    spectral_crest_factor () {
        if (this.result.spectral_crest_factor === undefined) {
            this.result.spectral_crest_factor = Object(_functions_xtract_crest__WEBPACK_IMPORTED_MODULE_23__["xtract_crest"])(this._amps, this.maximum(), this.spectral_mean());
        }
        return this.result.spectral_crest_factor;
    }

    spectral_slope() {
        if (this.result.spectral_slope === undefined) {
            this.result.spectral_slope = Object(_functions_xtract_spectral_slope__WEBPACK_IMPORTED_MODULE_24__["xtract_spectral_slope"])(this.data);
        }
        return this.result.spectral_slope;
    }

    spectral_fundamental() {
        if (this.result.spectral_fundamental === undefined) {
            this.result.spectral_fundamental = Object(_functions_xtract_spectral_fundamental__WEBPACK_IMPORTED_MODULE_25__["xtract_spectral_fundamental"])(this.data, _Fs);
            this.f0 = this.result.spectral_fundamental;
        }
        return this.result.spectral_fundamental;
    }

    nonzero_count () {
        if (this.result.nonzero_count === undefined) {
            this.result.nonzero_count = Object(_functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_26__["xtract_nonzero_count"])(_amps);
        }
        return this.result.nonzero_count;
    }

    hps () {
        if (this.result.hps === undefined) {
            this.result.hps = Object(_functions_xtract_hps__WEBPACK_IMPORTED_MODULE_27__["xtract_hps"])(this.data);
        }
        return this.result.hps;
    }

    mfcc(num_bands, freq_min, freq_max) {
        if (this._mfcc === undefined) {
            if (freq_min === undefined) {
                throw ("Run init_mfcc(num_bands, freq_min, freq_max, style) first");
            } else {
                this._mfcc = this.init_mfcc(num_bands, freq_min, freq_max);
            }
        }
        if (this.result.mfcc === undefined) {
            this.result.mfcc = Object(_functions_xtract_mfcc__WEBPACK_IMPORTED_MODULE_28__["xtract_mfcc"])(this.data, this._mfcc);
        }
        return this.result.mfcc;
    }

    dct () {
        if (this._dct === undefined) {
            this._dct = this.createDctCoefficients(this._length);
        }
        if (this.result.dct === undefined) {
            this.result.dct = Object(_functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_29__["xtract_dct_2"])(this._amps,this._dct);
        }
        return this.result.dct;
    }

    bark_coefficients(num_bands) {
        if (this.result.bark_coefficients === undefined) {
            if (this._bark === undefined) {
                this._bark = this.init_bark(num_bands);
            }
            this.result.bark_coefficients = Object(_functions_xtract_bark_coefficients__WEBPACK_IMPORTED_MODULE_30__["xtract_bark_coefficients"])(this.data, this._bark);
        }
        return this.result.bark_coefficients;
    }

    chroma(nbins, A440, f_ctr, octwidth) {
        if(this.result.chroma === undefined) {
            if (this._chroma === undefined) {
                this._chroma = this.init_chroma(nbins, A440, f_ctr, octwidth);
            }
            this.result.chroma = Object(_functions_xtract_chroma__WEBPACK_IMPORTED_MODULE_31__["xtract_chroma"])(this.data, this._chroma);
        }
        return this.result.chroma;
    }

    peak_spectrum(threshold) {
        if (this.result.peak_spectrum === undefined) {
            this.result.peak_spectrum = new _PeakSpectrumData__WEBPACK_IMPORTED_MODULE_1__["PeakSpectrumData"](this._length, this.sampleRate, this);
            var ps = Object(_functions_xtract_peak_spectrum__WEBPACK_IMPORTED_MODULE_32__["xtract_peak_spectrum"])(this.data, this.sampleRate / this._length, threshold);
            this.result.peak_spectrum.copyDataFrom(ps.subarray(0, this._length));
        }
        return this.result.peak_spectrum;
    }
}

SpectrumData.prototype.features = [
    {
        name: "Minimum",
        function: "minimum",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Maximum",
        function: "maximum",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Sum",
        function: "sum",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Centroid",
        function: "spectral_centroid",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Mean",
        function: "spectral_mean",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Variance",
        function: "spectral_variance",
        sub_features: ["spectral_mean"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Spread",
        function: "spectral_spread",
        sub_features: ["spectral_centroid"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Standard Deviation",
        function: "spectral_standard_deviation",
        sub_features: ["spectral_variance"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Skewness",
        function: "spectral_skewness",
        sub_features: ["spectral_mean", "spectral_standard_deviation"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Kurtosis",
        function: "spectral_kurtosis",
        sub_features: ["spectral_mean", "spectral_standard_deviation"],
        parameters: [],
        returns: "number"
}, {
        name: "Irregularity K",
        function: "irregularity_k",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Irregularity J",
        function: "irregularity_j",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Tristimulus 1",
        function: "tristimulus_1",
        sub_features: ["spectral_fundamental"],
        parameters: [],
        returns: "number"
}, {
        name: "Tristimulus 2",
        function: "tristimulus_2",
        sub_features: ["spectral_fundamental"],
        parameters: [],
        returns: "number"
}, {
        name: "Tristimulus 3",
        function: "tristimulus_3",
        sub_features: ["spectral_fundamental"],
        parameters: [],
        returns: "number"
}, {
        name: "Smoothness",
        function: "smoothness",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Rolloff",
        function: "rolloff",
        sub_features: [],
        parameters: [{
            name: "Threshold",
            unit: "%",
            type: "number",
            minimum: 0,
            maximum: 100,
            default: 90
    }],
        returns: "number"
}, {
        name: "Loudness",
        function: "loudness",
        sub_features: ["bark_coefficients"],
        parameters: [],
        returns: "number"
}, {
        name: "Sharpness",
        function: "sharpness",
        sub_features: ["bark_coefficients"],
        parameters: [],
        returns: "number"
}, {
        name: "Flatness",
        function: "flatness",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Flatness DB",
        function: "flatness_db",
        sub_features: ["flatness"],
        parameters: [],
        returns: "number"
}, {
        name: "Tonality",
        function: "tonality",
        sub_features: ["flatness_db"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Crest Factor",
        function: "spectral_crest_factor",
        sub_features: ["maximum", "spectral_mean"],
        parameters: [],
        returns: "number"
}, {
        name: "Spectral Slope",
        function: "spectral_slope",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Fundamental Frequency",
        function: "spectral_fundamental",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "Non-Zero count",
        function: "nonzero_count",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "HPS",
        function: "hps",
        sub_features: [],
        parameters: [],
        returns: "number"
}, {
        name: "MFCC",
        function: "mfcc",
        sub_features: [],
        parameters: [{
            name: "Band Count",
            unit: "",
            type: "number",
            minimum: 0,
            maximum: undefined,
            default: 26
    }, {
            name: "Minimum Frequency",
            unit: "Hz",
            type: "number",
            minimum: 0,
            maximum: undefined,
            default: 400
    }, {
            name: "Maximum Frequency",
            unit: "Hz",
            minimum: 0,
            maximum: undefined,
            default: 20000
    }],
        returns: "array"
}, {
        name: "Chroma",
        function: "chroma",
        sub_features: [],
        parameters: [{
            name: "nbins",
            unit: "",
            type: "number",
            minimum: 2,
            maximum: undefined,
            default: 12
    }, {
            name: "A440",
            unit: "",
            type: "number",
            minimum: 220,
            maximum: 880,
            default: 440
    }, {
            name: "f_ctr",
            unit: "",
            type: "number",
            minimum: undefined,
            maximum: undefined,
            default: 1000
    }, {
            name: "octwidth",
            unit: "",
            type: "number",
            minimum: undefined,
            maximum: undefined,
            default: 1
    }],
        returns: "array"
}, {
        name: "DCT",
        function: "dct",
        sub_features: [],
        parameters: [],
        returns: "array"
}, {
        name: "Bark Coefficients",
        function: "bark_coefficients",
        sub_features: [],
        parameters: [{
            name: "Band Count",
            unit: "",
            type: "number",
            minimum: 0,
            maximum: 26,
            default: 26
    }],
        returns: "array"
}, {
        name: "Peak Spectrum",
        function: "peak_spectrum",
        sub_features: [],
        parameters: [{
            name: "Threshold",
            unit: "",
            type: "number",
            minimum: 0,
            maximum: 100,
            default: 30
    }],
        returns: "PeakSpectrumData"
}];


/***/ }),

/***/ "./modules/objects/TimeData.js":
/*!*************************************!*\
  !*** ./modules/objects/TimeData.js ***!
  \*************************************/
/*! exports provided: TimeData */
/***/ (function(module, __webpack_exports__, __nested_webpack_require_258971__) {

"use strict";
__nested_webpack_require_258971__.r(__webpack_exports__);
/* harmony export (binding) */ __nested_webpack_require_258971__.d(__webpack_exports__, "TimeData", function() { return TimeData; });
/* harmony import */ var _DataPrototype__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_258971__(/*! ./DataPrototype */ "./modules/objects/DataPrototype.js");
/* harmony import */ var _SpectrumData__WEBPACK_IMPORTED_MODULE_1__ = __nested_webpack_require_258971__(/*! ./SpectrumData */ "./modules/objects/SpectrumData.js");
/* harmony import */ var _functions_xtract_init_wavelet__WEBPACK_IMPORTED_MODULE_2__ = __nested_webpack_require_258971__(/*! ../functions/xtract_init_wavelet */ "./modules/functions/xtract_init_wavelet.js");
/* harmony import */ var _functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_3__ = __nested_webpack_require_258971__(/*! ../functions/xtract_array_min */ "./modules/functions/xtract_array_min.js");
/* harmony import */ var _functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_4__ = __nested_webpack_require_258971__(/*! ../functions/xtract_array_max */ "./modules/functions/xtract_array_max.js");
/* harmony import */ var _functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_5__ = __nested_webpack_require_258971__(/*! ../functions/xtract_array_sum */ "./modules/functions/xtract_array_sum.js");
/* harmony import */ var _functions_xtract_mean__WEBPACK_IMPORTED_MODULE_6__ = __nested_webpack_require_258971__(/*! ../functions/xtract_mean */ "./modules/functions/xtract_mean.js");
/* harmony import */ var _functions_xtract_temporal_centroid__WEBPACK_IMPORTED_MODULE_7__ = __nested_webpack_require_258971__(/*! ../functions/xtract_temporal_centroid */ "./modules/functions/xtract_temporal_centroid.js");
/* harmony import */ var _functions_xtract_variance__WEBPACK_IMPORTED_MODULE_8__ = __nested_webpack_require_258971__(/*! ../functions/xtract_variance */ "./modules/functions/xtract_variance.js");
/* harmony import */ var _functions_xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_9__ = __nested_webpack_require_258971__(/*! ../functions/xtract_standard_deviation */ "./modules/functions/xtract_standard_deviation.js");
/* harmony import */ var _functions_xtract_average_deviation__WEBPACK_IMPORTED_MODULE_10__ = __nested_webpack_require_258971__(/*! ../functions/xtract_average_deviation */ "./modules/functions/xtract_average_deviation.js");
/* harmony import */ var _functions_xtract_skewness__WEBPACK_IMPORTED_MODULE_11__ = __nested_webpack_require_258971__(/*! ../functions/xtract_skewness */ "./modules/functions/xtract_skewness.js");
/* harmony import */ var _functions_xtract_kurtosis__WEBPACK_IMPORTED_MODULE_12__ = __nested_webpack_require_258971__(/*! ../functions/xtract_kurtosis */ "./modules/functions/xtract_kurtosis.js");
/* harmony import */ var _functions_xtract_zcr__WEBPACK_IMPORTED_MODULE_13__ = __nested_webpack_require_258971__(/*! ../functions/xtract_zcr */ "./modules/functions/xtract_zcr.js");
/* harmony import */ var _functions_xtract_crest__WEBPACK_IMPORTED_MODULE_14__ = __nested_webpack_require_258971__(/*! ../functions/xtract_crest */ "./modules/functions/xtract_crest.js");
/* harmony import */ var _functions_xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_15__ = __nested_webpack_require_258971__(/*! ../functions/xtract_rms_amplitude */ "./modules/functions/xtract_rms_amplitude.js");
/* harmony import */ var _functions_xtract_lowest_value__WEBPACK_IMPORTED_MODULE_16__ = __nested_webpack_require_258971__(/*! ../functions/xtract_lowest_value */ "./modules/functions/xtract_lowest_value.js");
/* harmony import */ var _functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_17__ = __nested_webpack_require_258971__(/*! ../functions/xtract_nonzero_count */ "./modules/functions/xtract_nonzero_count.js");
/* harmony import */ var _functions_xtract_wavelet_f0__WEBPACK_IMPORTED_MODULE_18__ = __nested_webpack_require_258971__(/*! ../functions/xtract_wavelet_f0 */ "./modules/functions/xtract_wavelet_f0.js");
/* harmony import */ var _functions_xtract_energy__WEBPACK_IMPORTED_MODULE_19__ = __nested_webpack_require_258971__(/*! ../functions/xtract_energy */ "./modules/functions/xtract_energy.js");
/* harmony import */ var _functions_xtract_spectrum__WEBPACK_IMPORTED_MODULE_20__ = __nested_webpack_require_258971__(/*! ../functions/xtract_spectrum */ "./modules/functions/xtract_spectrum.js");
/* harmony import */ var _functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_21__ = __nested_webpack_require_258971__(/*! ../functions/xtract_dct_2 */ "./modules/functions/xtract_dct_2.js");
/* harmony import */ var _functions_xtract_autocorrelation__WEBPACK_IMPORTED_MODULE_22__ = __nested_webpack_require_258971__(/*! ../functions/xtract_autocorrelation */ "./modules/functions/xtract_autocorrelation.js");
/* harmony import */ var _functions_xtract_amdf__WEBPACK_IMPORTED_MODULE_23__ = __nested_webpack_require_258971__(/*! ../functions/xtract_amdf */ "./modules/functions/xtract_amdf.js");
/* harmony import */ var _functions_xtract_asdf__WEBPACK_IMPORTED_MODULE_24__ = __nested_webpack_require_258971__(/*! ../functions/xtract_asdf */ "./modules/functions/xtract_asdf.js");
/* harmony import */ var _functions_xtract_yin__WEBPACK_IMPORTED_MODULE_25__ = __nested_webpack_require_258971__(/*! ../functions/xtract_yin */ "./modules/functions/xtract_yin.js");
/* harmony import */ var _functions_xtract_onset__WEBPACK_IMPORTED_MODULE_26__ = __nested_webpack_require_258971__(/*! ../functions/xtract_onset */ "./modules/functions/xtract_onset.js");
/* harmony import */ var _functions_xtract_resample__WEBPACK_IMPORTED_MODULE_27__ = __nested_webpack_require_258971__(/*! ../functions/xtract_resample */ "./modules/functions/xtract_resample.js");
/// <reference path="../../typings/objects/TimeData.d.ts" />





























class TimeData extends _DataPrototype__WEBPACK_IMPORTED_MODULE_0__["DataPrototype"] {
    constructor(input, sampleRate) {
        if (sampleRate <= 0) {
            sampleRate = undefined;
            console.log("Invalid parameter for 'sampleRate' for TimeData");
        }

        if (typeof input === "object") {
            var src, src_data;
            if (input instanceof TimeData) {
                src = src.getData();
                super(src.length, sampleRate);
                this.copyDataFrom(src, src.length, 0);
            } else if (input instanceof Float32Array || input instanceof Float64Array) {
                src = input;
                super(src.length, sampleRate);
                this.copyDataFrom(src, src.length, 0);
            } else {
                throw ("TimeData: Invalid object passed as first argument.");
            }

        } else if (typeof input === "number") {
            if (input <= 0 || input !== Math.floor(input)) {
                throw ("TimeData: Invalid number passed as first argument.");
            }
            super(input, sampleRate);
        } else {
            throw ("TimeData: Constructor has invalid operators!");
        }

        this._dct = undefined;
        this._wavelet = Object(_functions_xtract_init_wavelet__WEBPACK_IMPORTED_MODULE_2__["xtract_init_wavelet"])();
    }
    getFrames(frameSize, hopSize) {
        if (typeof frameSize !== "number" || frameSize <= 0 || frameSize !== Math.floor(frameSize)) {
            throw ("frameSize must be a defined, positive integer");
        }
        if (typeof hopSize !== "number") {
            hopSize = frameSize;
        }
        var num_frames = Math.ceil(this.data.length / frameSize);
        var result_frames = [];
        for (var i = 0; i < num_frames; i++) {
            var frame = new TimeData(hopSize, this.sampleRate);
            frame.copyDataFrom(this.data.subarray(frameSize * i, frameSize * i + hopSize));
            result_frames.push(frame);
        }
        return result_frames;
    }

    // Features
    minimum() {
        if (this.result.minimum === undefined) {
            this.result.minimum = Object(_functions_xtract_array_min__WEBPACK_IMPORTED_MODULE_3__["xtract_array_min"])(this.data);
        }
        return this.result.minimum;
    }

    maximum() {
        if (this.result.maximum === undefined) {
            this.result.maximum = Object(_functions_xtract_array_max__WEBPACK_IMPORTED_MODULE_4__["xtract_array_max"])(this.data);
        }
        return this.result.maximum;
    }

    sum() {
        if (this.result.sum === undefined) {
            this.result.sum = Object(_functions_xtract_array_sum__WEBPACK_IMPORTED_MODULE_5__["xtract_array_sum"])(this.data);
        }
        return this.result.sum;
    }

    mean() {
        if (this.result.mean === undefined) {
            this.result.mean = Object(_functions_xtract_mean__WEBPACK_IMPORTED_MODULE_6__["xtract_mean"])(this.data);
        }
        return this.result.mean;
    }

    temporal_centroid(window_ms) {
        if (this.result.temporal_centroid === undefined) {
            this.energy(window_ms);
            this.result.temporal_centroid = Object(_functions_xtract_temporal_centroid__WEBPACK_IMPORTED_MODULE_7__["xtract_temporal_centroid"])(this.result.energy.data, this.sampleRate, window_ms);
        }
        return this.result.temporal_centroid;
    }

    variance() {
        if (this.result.variance === undefined) {
            this.result.variance = Object(_functions_xtract_variance__WEBPACK_IMPORTED_MODULE_8__["xtract_variance"])(this.data, this.mean());
        }
        return this.result.variance;
    }

    standard_deviation() {
        if (this.result.standard_deviation === undefined) {
            this.result.standard_deviation = Object(_functions_xtract_standard_deviation__WEBPACK_IMPORTED_MODULE_9__["xtract_standard_deviation"])(this.data, this.variance());
        }
        return this.result.standard_deviation;
    }

    average_deviation () {
        if (this.result.average_deviation === undefined) {
            this.result.average_deviation = Object(_functions_xtract_average_deviation__WEBPACK_IMPORTED_MODULE_10__["xtract_average_deviation"])(this.data, this.mean());
        }
        return this.result.average_deviation;
    }

    skewness () {
        if (this.result.skewness === undefined) {
            this.result.skewness = Object(_functions_xtract_skewness__WEBPACK_IMPORTED_MODULE_11__["xtract_skewness"])(this.data, this.mean(), this.standard_deviation());
        }
        return this.result.skewness;
    }

    kurtosis () {
        if (this.result.kurtosis === undefined) {
            this.result.kurtosis = Object(_functions_xtract_kurtosis__WEBPACK_IMPORTED_MODULE_12__["xtract_kurtosis"])(this.data, this.mean(), this.standard_deviation());
        }
        return this.result.kurtosis;
    }

    zcr  () {
        if (this.result.zcr === undefined) {
            this.result.zcr = Object(_functions_xtract_zcr__WEBPACK_IMPORTED_MODULE_13__["xtract_zcr"])(this.data);
        }
        return this.result.zcr;
    }

    crest_factor () {
        if (this.result.crest_factor === undefined) {
            this.result.crest_factor = Object(_functions_xtract_crest__WEBPACK_IMPORTED_MODULE_14__["xtract_crest"])(this.data, this.maximum(), this.mean());
        }
        return this.result.crest_factor;
    }

    rms_amplitude () {
        if (this.result.rms_amplitude === undefined) {
            this.result.rms_amplitude = Object(_functions_xtract_rms_amplitude__WEBPACK_IMPORTED_MODULE_15__["xtract_rms_amplitude"])(this.data);
        }
        return this.result.rms_amplitude;
    }

    lowest_value (threshold) {
        if (this.result.lowest_value === undefined) {
            this.result.lowest_value = Object(_functions_xtract_lowest_value__WEBPACK_IMPORTED_MODULE_16__["xtract_lowest_value"])(this.data, threshold);
        }
        return this.result.lowest_value;
    }

    highest_value () {
        if (this.result.nonzero_count === undefined) {
            this.result.nonzero_count = Object(_functions_xtract_nonzero_count__WEBPACK_IMPORTED_MODULE_17__["xtract_nonzero_count"])(this.data);
        }
        return this.result.nonzero_count;
    }

    f0 () {
        if (this._wavelet === undefined) {
            this._wavelet = this.init_wavelet();
        }
        if (this.result.f0 === undefined) {
            this.result.f0 = Object(_functions_xtract_wavelet_f0__WEBPACK_IMPORTED_MODULE_18__["xtract_wavelet_f0"])(this.data, this.sampleRate, this._wavelet);
        }
        return this.result.f0;
    }

    energy (window_ms) {
        if (this.result.energy === undefined || this.result.energy.window_ms !== window_ms) {
            this.result.energy = {
                'data': Object(_functions_xtract_energy__WEBPACK_IMPORTED_MODULE_19__["xtract_energy"])(this.data, this.sampleRate, window_ms),
                'window_ms': window_ms
            };
        }
        return this.result.energy;
    }

    spectrum() {
        if (this.result.spectrum === undefined) {
            var _spec = Object(_functions_xtract_spectrum__WEBPACK_IMPORTED_MODULE_20__["xtract_spectrum"])(this.data, this.sampleRate, true, false);
            this.result.spectrum = new _SpectrumData__WEBPACK_IMPORTED_MODULE_1__["SpectrumData"](_spec.length / 2, this.sampleRate);
            this.result.spectrum.copyDataFrom(_spec);
            return this.result.spectrum;
        }
    }

    dct() {
        if (this._dct === undefined) {
            this._dct = this.createDctCoefficients(this.data.length);
        }
        if (this.result.dct === undefined) {
            this.result.dct = Object(_functions_xtract_dct_2__WEBPACK_IMPORTED_MODULE_21__["xtract_dct_2"])(this.data, this._dct);
        }
        return this.result.dct;
    }

    autocorrelation () {
        if (this.result.autocorrelation === undefined) {
            this.result.autocorrelation = Object(_functions_xtract_autocorrelation__WEBPACK_IMPORTED_MODULE_22__["xtract_autocorrelation"])(this.data);
        }
        return this.result.autocorrelation;
    }

    amdf () {
        if (this.result.amdf === undefined) {
            this.result.amdf = Object(_functions_xtract_amdf__WEBPACK_IMPORTED_MODULE_23__["xtract_amdf"])(this.data);
        }
        return this.result.amdf;
    }

    asdf () {
        if (this.result.asdf === undefined) {
            this.result.asdf = Object(_functions_xtract_asdf__WEBPACK_IMPORTED_MODULE_24__["xtract_asdf"])(this.data);
        }
        return this.result.asdf;
    }

    yin() {
        if (this.result.yin === undefined) {
            this.result.yin = Object(_functions_xtract_yin__WEBPACK_IMPORTED_MODULE_25__["xtract_yin"])(this.data);
        }
        return this.result.yin;
    }

    onset(frameSize) {
        if (this.result.onset === undefined || this.result.onset.frameSize !== frameSize) {
            this.result.onset = {
                'data': Object(_functions_xtract_onset__WEBPACK_IMPORTED_MODULE_26__["xtract_onset"])(this.data, frameSize),
                'frameSize': frameSize
            };
        }
        return this.result.onset;
    }

    resample(targetSampleRate) {
        if (this.sampleRate === undefined) {
            throw ("Source sampleRate must be defined");
        }
        if (typeof targetSampleRate !== "number" || targetSampleRate <= 0) {
            throw ("Target sampleRate must be a positive number");
        }
        var resampled = Object(_functions_xtract_resample__WEBPACK_IMPORTED_MODULE_27__["xtract_resample"])(this.data, targetSampleRate, this.sampleRate);
        var reply = new TimeData(resampled.length, targetSampleRate);
        reply.copyDataFrom(resampled);
        this.result.resample = reply;
        return reply;
    }
}

TimeData.prototype.features = [
    {
        name: "Minimum",
        function: "minimum",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Maximum",
        function: "maximum",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Sum",
        function: "sum",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Mean",
        function: "mean",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Temporal Centroid",
        function: "temporal_centroid",
        sub_features: ["energy"],
        parameters: [{
            name: "Window Time",
            unit: "ms",
            type: "number",
            minimum: 1,
            maximum: undefined,
            default: 100
        }],
        returns: "number"
    }, {
        name: "Variance",
        function: "variance",
        sub_features: ["mean"],
        parameters: [],
        returns: "number"
    }, {
        name: "Standard Deviation",
        function: "standard_deviation",
        sub_features: ["variance"],
        parameters: [],
        returns: "number"
    }, {
        name: "Average Deviation",
        function: "average_deviation",
        sub_features: ["mean"],
        parameters: [],
        returns: "number"
    }, {
        name: "Skewness",
        function: "skewness",
        sub_features: ["mean", "standard_deviation"],
        parameters: [],
        returns: "number"
    }, {
        name: "Kurtosis",
        function: "kurtosis",
        sub_features: ["mean", "standard_deviation"],
        parameters: [],
        returns: "number"
    }, {
        name: "Zero Crossing Rate",
        function: "zcr",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Crest Factor",
        function: "crest_factor",
        sub_features: ["maximum", "mean"],
        parameters: [],
        returns: "number"
    }, {
        name: "RMS Amplitude",
        function: "rms_amplitude",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Lowest Value",
        function: "lowest_value",
        sub_features: [],
        parameters: [{
            name: "Threshold",
            unit: "",
            type: "number",
            minimum: undefined,
            maximum: undefined,
            default: undefined
        }],
        returns: "number"
    }, {
        name: "Highest Value",
        function: "highest_value",
        sub_features: [],
        parameters: [{
            name: "Threshold",
            unit: "",
            type: "number",
            minimum: undefined,
            maximum: undefined,
            default: undefined
        }],
        returns: "number"
    }, {
        name: "Non-Zero Count",
        function: "nonzero_count",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Fundamental Frequency",
        function: "f0",
        sub_features: [],
        parameters: [],
        returns: "number"
    }, {
        name: "Energy",
        function: "energy",
        sub_features: [],
        parameters: [{
            name: "Window",
            unit: "ms",
            type: "number",
            minimum: 1,
            maximum: undefined,
            default: 100
        }],
        returns: "object"
    }, {
        name: "Spectrum",
        function: "spectrum",
        sub_features: [],
        parameters: [],
        returns: "SpectrumData"
    }, {
        name: "DCT",
        function: "dct",
        sub_features: [],
        parameters: [],
        returns: "array"
    }, {
        name: "Autocorrelation",
        function: "autocorrelation",
        sub_features: [],
        parameters: [],
        returns: "array"
    }, {
        name: "AMDF",
        function: "amdf",
        sub_features: [],
        parameters: [],
        returns: "array"
    }, {
        name: "ASDF",
        function: "asdf",
        sub_features: [],
        parameters: [],
        returns: "array"
    }, {
        name: "YIN Pitch",
        function: "yin",
        sub_features: [],
        parameters: [],
        returns: "array"
    }, {
        name: "Onset Detection",
        function: "onset",
        sub_features: [],
        parameters: [{
            name: "Frame Size",
            unit: "samples",
            type: "number",
            minimum: 1,
            maximum: undefined,
            default: 1024
        }],
        returns: "array"
    }, {
        name: "Resample",
        function: "resample",
        sub_features: [],
        parameters: [{
            name: "Target Sample Rate",
            unit: "Hz",
            type: "number",
            minimum: 0,
            maximum: undefined,
            default: 8000
        }],
        returns: "TimeData"
    }];


/***/ })

/******/ });
});


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/NotificationFactories.js":
/*!***********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/NotificationFactories.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "COMPLETE_NOTIFICATION": () => (/* binding */ COMPLETE_NOTIFICATION),
/* harmony export */   "errorNotification": () => (/* binding */ errorNotification),
/* harmony export */   "nextNotification": () => (/* binding */ nextNotification),
/* harmony export */   "createNotification": () => (/* binding */ createNotification)
/* harmony export */ });
var COMPLETE_NOTIFICATION = (function () { return createNotification('C', undefined, undefined); })();
function errorNotification(error) {
    return createNotification('E', undefined, error);
}
function nextNotification(value) {
    return createNotification('N', value, undefined);
}
function createNotification(kind, value, error) {
    return {
        kind: kind,
        value: value,
        error: error,
    };
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/Observable.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/Observable.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Observable": () => (/* binding */ Observable)
/* harmony export */ });
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Subscriber */ "./node_modules/rxjs/dist/esm5/internal/Subscriber.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./symbol/observable */ "./node_modules/rxjs/dist/esm5/internal/symbol/observable.js");
/* harmony import */ var _util_pipe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/pipe */ "./node_modules/rxjs/dist/esm5/internal/util/pipe.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config */ "./node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_errorContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/errorContext */ "./node_modules/rxjs/dist/esm5/internal/util/errorContext.js");







var Observable = (function () {
    function Observable(subscribe) {
        if (subscribe) {
            this._subscribe = subscribe;
        }
    }
    Observable.prototype.lift = function (operator) {
        var observable = new Observable();
        observable.source = this;
        observable.operator = operator;
        return observable;
    };
    Observable.prototype.subscribe = function (observerOrNext, error, complete) {
        var _this = this;
        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new _Subscriber__WEBPACK_IMPORTED_MODULE_0__.SafeSubscriber(observerOrNext, error, complete);
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_1__.errorContext)(function () {
            var _a = _this, operator = _a.operator, source = _a.source;
            subscriber.add(operator
                ?
                    operator.call(subscriber, source)
                : source
                    ?
                        _this._subscribe(subscriber)
                    :
                        _this._trySubscribe(subscriber));
        });
        return subscriber;
    };
    Observable.prototype._trySubscribe = function (sink) {
        try {
            return this._subscribe(sink);
        }
        catch (err) {
            sink.error(err);
        }
    };
    Observable.prototype.forEach = function (next, promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var subscription;
            subscription = _this.subscribe(function (value) {
                try {
                    next(value);
                }
                catch (err) {
                    reject(err);
                    subscription === null || subscription === void 0 ? void 0 : subscription.unsubscribe();
                }
            }, reject, resolve);
        });
    };
    Observable.prototype._subscribe = function (subscriber) {
        var _a;
        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);
    };
    Observable.prototype[_symbol_observable__WEBPACK_IMPORTED_MODULE_2__.observable] = function () {
        return this;
    };
    Observable.prototype.pipe = function () {
        var operations = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            operations[_i] = arguments[_i];
        }
        return (0,_util_pipe__WEBPACK_IMPORTED_MODULE_3__.pipeFromArray)(operations)(this);
    };
    Observable.prototype.toPromise = function (promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var value;
            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });
        });
    };
    Observable.create = function (subscribe) {
        return new Observable(subscribe);
    };
    return Observable;
}());

function getPromiseCtor(promiseCtor) {
    var _a;
    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : _config__WEBPACK_IMPORTED_MODULE_4__.config.Promise) !== null && _a !== void 0 ? _a : Promise;
}
function isObserver(value) {
    return value && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.next) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.error) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.complete);
}
function isSubscriber(value) {
    return (value && value instanceof _Subscriber__WEBPACK_IMPORTED_MODULE_0__.Subscriber) || (isObserver(value) && (0,_Subscription__WEBPACK_IMPORTED_MODULE_6__.isSubscription)(value));
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/Subscriber.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/Subscriber.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Subscriber": () => (/* binding */ Subscriber),
/* harmony export */   "SafeSubscriber": () => (/* binding */ SafeSubscriber),
/* harmony export */   "EMPTY_OBSERVER": () => (/* binding */ EMPTY_OBSERVER)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config */ "./node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./util/reportUnhandledError */ "./node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js");
/* harmony import */ var _util_noop__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/noop */ "./node_modules/rxjs/dist/esm5/internal/util/noop.js");
/* harmony import */ var _NotificationFactories__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./NotificationFactories */ "./node_modules/rxjs/dist/esm5/internal/NotificationFactories.js");
/* harmony import */ var _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./scheduler/timeoutProvider */ "./node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js");
/* harmony import */ var _util_errorContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./util/errorContext */ "./node_modules/rxjs/dist/esm5/internal/util/errorContext.js");









var Subscriber = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(Subscriber, _super);
    function Subscriber(destination) {
        var _this = _super.call(this) || this;
        _this.isStopped = false;
        if (destination) {
            _this.destination = destination;
            if ((0,_Subscription__WEBPACK_IMPORTED_MODULE_1__.isSubscription)(destination)) {
                destination.add(_this);
            }
        }
        else {
            _this.destination = EMPTY_OBSERVER;
        }
        return _this;
    }
    Subscriber.create = function (next, error, complete) {
        return new SafeSubscriber(next, error, complete);
    };
    Subscriber.prototype.next = function (value) {
        if (this.isStopped) {
            handleStoppedNotification((0,_NotificationFactories__WEBPACK_IMPORTED_MODULE_2__.nextNotification)(value), this);
        }
        else {
            this._next(value);
        }
    };
    Subscriber.prototype.error = function (err) {
        if (this.isStopped) {
            handleStoppedNotification((0,_NotificationFactories__WEBPACK_IMPORTED_MODULE_2__.errorNotification)(err), this);
        }
        else {
            this.isStopped = true;
            this._error(err);
        }
    };
    Subscriber.prototype.complete = function () {
        if (this.isStopped) {
            handleStoppedNotification(_NotificationFactories__WEBPACK_IMPORTED_MODULE_2__.COMPLETE_NOTIFICATION, this);
        }
        else {
            this.isStopped = true;
            this._complete();
        }
    };
    Subscriber.prototype.unsubscribe = function () {
        if (!this.closed) {
            this.isStopped = true;
            _super.prototype.unsubscribe.call(this);
            this.destination = null;
        }
    };
    Subscriber.prototype._next = function (value) {
        this.destination.next(value);
    };
    Subscriber.prototype._error = function (err) {
        try {
            this.destination.error(err);
        }
        finally {
            this.unsubscribe();
        }
    };
    Subscriber.prototype._complete = function () {
        try {
            this.destination.complete();
        }
        finally {
            this.unsubscribe();
        }
    };
    return Subscriber;
}(_Subscription__WEBPACK_IMPORTED_MODULE_1__.Subscription));

var SafeSubscriber = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(SafeSubscriber, _super);
    function SafeSubscriber(observerOrNext, error, complete) {
        var _this = _super.call(this) || this;
        var next;
        if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_3__.isFunction)(observerOrNext)) {
            next = observerOrNext;
        }
        else if (observerOrNext) {
            (next = observerOrNext.next, error = observerOrNext.error, complete = observerOrNext.complete);
            var context_1;
            if (_this && _config__WEBPACK_IMPORTED_MODULE_4__.config.useDeprecatedNextContext) {
                context_1 = Object.create(observerOrNext);
                context_1.unsubscribe = function () { return _this.unsubscribe(); };
            }
            else {
                context_1 = observerOrNext;
            }
            next = next === null || next === void 0 ? void 0 : next.bind(context_1);
            error = error === null || error === void 0 ? void 0 : error.bind(context_1);
            complete = complete === null || complete === void 0 ? void 0 : complete.bind(context_1);
        }
        _this.destination = {
            next: next ? wrapForErrorHandling(next, _this) : _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
            error: wrapForErrorHandling(error !== null && error !== void 0 ? error : defaultErrorHandler, _this),
            complete: complete ? wrapForErrorHandling(complete, _this) : _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
        };
        return _this;
    }
    return SafeSubscriber;
}(Subscriber));

function wrapForErrorHandling(handler, instance) {
    return function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        try {
            handler.apply(void 0, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(args)));
        }
        catch (err) {
            if (_config__WEBPACK_IMPORTED_MODULE_4__.config.useDeprecatedSynchronousErrorHandling) {
                (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_6__.captureError)(err);
            }
            else {
                (0,_util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_7__.reportUnhandledError)(err);
            }
        }
    };
}
function defaultErrorHandler(err) {
    throw err;
}
function handleStoppedNotification(notification, subscriber) {
    var onStoppedNotification = _config__WEBPACK_IMPORTED_MODULE_4__.config.onStoppedNotification;
    onStoppedNotification && _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_8__.timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });
}
var EMPTY_OBSERVER = {
    closed: true,
    next: _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
    error: defaultErrorHandler,
    complete: _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
};


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/Subscription.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/Subscription.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Subscription": () => (/* binding */ Subscription),
/* harmony export */   "EMPTY_SUBSCRIPTION": () => (/* binding */ EMPTY_SUBSCRIPTION),
/* harmony export */   "isSubscription": () => (/* binding */ isSubscription)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/UnsubscriptionError */ "./node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js");
/* harmony import */ var _util_arrRemove__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/arrRemove */ "./node_modules/rxjs/dist/esm5/internal/util/arrRemove.js");




var Subscription = (function () {
    function Subscription(initialTeardown) {
        this.initialTeardown = initialTeardown;
        this.closed = false;
        this._parentage = null;
        this._teardowns = null;
    }
    Subscription.prototype.unsubscribe = function () {
        var e_1, _a, e_2, _b;
        var errors;
        if (!this.closed) {
            this.closed = true;
            var _parentage = this._parentage;
            if (_parentage) {
                this._parentage = null;
                if (Array.isArray(_parentage)) {
                    try {
                        for (var _parentage_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {
                            var parent_1 = _parentage_1_1.value;
                            parent_1.remove(this);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                else {
                    _parentage.remove(this);
                }
            }
            var initialTeardown = this.initialTeardown;
            if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(initialTeardown)) {
                try {
                    initialTeardown();
                }
                catch (e) {
                    errors = e instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError ? e.errors : [e];
                }
            }
            var _teardowns = this._teardowns;
            if (_teardowns) {
                this._teardowns = null;
                try {
                    for (var _teardowns_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(_teardowns), _teardowns_1_1 = _teardowns_1.next(); !_teardowns_1_1.done; _teardowns_1_1 = _teardowns_1.next()) {
                        var teardown_1 = _teardowns_1_1.value;
                        try {
                            execTeardown(teardown_1);
                        }
                        catch (err) {
                            errors = errors !== null && errors !== void 0 ? errors : [];
                            if (err instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError) {
                                errors = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(errors)), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(err.errors));
                            }
                            else {
                                errors.push(err);
                            }
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_teardowns_1_1 && !_teardowns_1_1.done && (_b = _teardowns_1.return)) _b.call(_teardowns_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            if (errors) {
                throw new _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError(errors);
            }
        }
    };
    Subscription.prototype.add = function (teardown) {
        var _a;
        if (teardown && teardown !== this) {
            if (this.closed) {
                execTeardown(teardown);
            }
            else {
                if (teardown instanceof Subscription) {
                    if (teardown.closed || teardown._hasParent(this)) {
                        return;
                    }
                    teardown._addParent(this);
                }
                (this._teardowns = (_a = this._teardowns) !== null && _a !== void 0 ? _a : []).push(teardown);
            }
        }
    };
    Subscription.prototype._hasParent = function (parent) {
        var _parentage = this._parentage;
        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));
    };
    Subscription.prototype._addParent = function (parent) {
        var _parentage = this._parentage;
        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;
    };
    Subscription.prototype._removeParent = function (parent) {
        var _parentage = this._parentage;
        if (_parentage === parent) {
            this._parentage = null;
        }
        else if (Array.isArray(_parentage)) {
            (0,_util_arrRemove__WEBPACK_IMPORTED_MODULE_3__.arrRemove)(_parentage, parent);
        }
    };
    Subscription.prototype.remove = function (teardown) {
        var _teardowns = this._teardowns;
        _teardowns && (0,_util_arrRemove__WEBPACK_IMPORTED_MODULE_3__.arrRemove)(_teardowns, teardown);
        if (teardown instanceof Subscription) {
            teardown._removeParent(this);
        }
    };
    Subscription.EMPTY = (function () {
        var empty = new Subscription();
        empty.closed = true;
        return empty;
    })();
    return Subscription;
}());

var EMPTY_SUBSCRIPTION = Subscription.EMPTY;
function isSubscription(value) {
    return (value instanceof Subscription ||
        (value && 'closed' in value && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.remove) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.add) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.unsubscribe)));
}
function execTeardown(teardown) {
    if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(teardown)) {
        teardown();
    }
    else {
        teardown.unsubscribe();
    }
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/config.js":
/*!********************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/config.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "config": () => (/* binding */ config)
/* harmony export */ });
var config = {
    onUnhandledError: null,
    onStoppedNotification: null,
    Promise: undefined,
    useDeprecatedSynchronousErrorHandling: false,
    useDeprecatedNextContext: false,
};


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/observable/from.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/observable/from.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "from": () => (/* binding */ from),
/* harmony export */   "innerFrom": () => (/* binding */ innerFrom),
/* harmony export */   "fromArrayLike": () => (/* binding */ fromArrayLike)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isArrayLike__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/isArrayLike */ "./node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js");
/* harmony import */ var _util_isPromise__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/isPromise */ "./node_modules/rxjs/dist/esm5/internal/util/isPromise.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/dist/esm5/internal/symbol/observable.js");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var _scheduled_scheduled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scheduled/scheduled */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../util/isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../util/reportUnhandledError */ "./node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js");
/* harmony import */ var _util_isInteropObservable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isInteropObservable */ "./node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js");
/* harmony import */ var _util_isAsyncIterable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../util/isAsyncIterable */ "./node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js");
/* harmony import */ var _util_throwUnobservableError__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../util/throwUnobservableError */ "./node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js");
/* harmony import */ var _util_isIterable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../util/isIterable */ "./node_modules/rxjs/dist/esm5/internal/util/isIterable.js");
/* harmony import */ var _util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../util/isReadableStreamLike */ "./node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js");













function from(input, scheduler) {
    return scheduler ? (0,_scheduled_scheduled__WEBPACK_IMPORTED_MODULE_0__.scheduled)(input, scheduler) : innerFrom(input);
}
function innerFrom(input) {
    if (input instanceof _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable) {
        return input;
    }
    if (input != null) {
        if ((0,_util_isInteropObservable__WEBPACK_IMPORTED_MODULE_2__.isInteropObservable)(input)) {
            return fromInteropObservable(input);
        }
        if ((0,_util_isArrayLike__WEBPACK_IMPORTED_MODULE_3__.isArrayLike)(input)) {
            return fromArrayLike(input);
        }
        if ((0,_util_isPromise__WEBPACK_IMPORTED_MODULE_4__.isPromise)(input)) {
            return fromPromise(input);
        }
        if ((0,_util_isAsyncIterable__WEBPACK_IMPORTED_MODULE_5__.isAsyncIterable)(input)) {
            return fromAsyncIterable(input);
        }
        if ((0,_util_isIterable__WEBPACK_IMPORTED_MODULE_6__.isIterable)(input)) {
            return fromIterable(input);
        }
        if ((0,_util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_7__.isReadableStreamLike)(input)) {
            return fromReadableStreamLike(input);
        }
    }
    throw (0,_util_throwUnobservableError__WEBPACK_IMPORTED_MODULE_8__.createInvalidObservableTypeError)(input);
}
function fromInteropObservable(obj) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable(function (subscriber) {
        var obs = obj[_symbol_observable__WEBPACK_IMPORTED_MODULE_9__.observable]();
        if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_10__.isFunction)(obs.subscribe)) {
            return obs.subscribe(subscriber);
        }
        throw new TypeError('Provided object does not correctly implement Symbol.observable');
    });
}
function fromArrayLike(array) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable(function (subscriber) {
        for (var i = 0; i < array.length && !subscriber.closed; i++) {
            subscriber.next(array[i]);
        }
        subscriber.complete();
    });
}
function fromPromise(promise) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable(function (subscriber) {
        promise
            .then(function (value) {
            if (!subscriber.closed) {
                subscriber.next(value);
                subscriber.complete();
            }
        }, function (err) { return subscriber.error(err); })
            .then(null, _util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_11__.reportUnhandledError);
    });
}
function fromIterable(iterable) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable(function (subscriber) {
        var e_1, _a;
        try {
            for (var iterable_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_12__.__values)(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {
                var value = iterable_1_1.value;
                subscriber.next(value);
                if (subscriber.closed) {
                    return;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        subscriber.complete();
    });
}
function fromAsyncIterable(asyncIterable) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable(function (subscriber) {
        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });
    });
}
function fromReadableStreamLike(readableStream) {
    return fromAsyncIterable((0,_util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_7__.readableStreamLikeToAsyncGenerator)(readableStream));
}
function process(asyncIterable, subscriber) {
    var asyncIterable_1, asyncIterable_1_1;
    var e_2, _a;
    return (0,tslib__WEBPACK_IMPORTED_MODULE_12__.__awaiter)(this, void 0, void 0, function () {
        var value, e_2_1;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_12__.__generator)(this, function (_b) {
            switch (_b.label) {
                case 0:
                    _b.trys.push([0, 5, 6, 11]);
                    asyncIterable_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_12__.__asyncValues)(asyncIterable);
                    _b.label = 1;
                case 1: return [4, asyncIterable_1.next()];
                case 2:
                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];
                    value = asyncIterable_1_1.value;
                    subscriber.next(value);
                    if (subscriber.closed) {
                        return [2];
                    }
                    _b.label = 3;
                case 3: return [3, 1];
                case 4: return [3, 11];
                case 5:
                    e_2_1 = _b.sent();
                    e_2 = { error: e_2_1 };
                    return [3, 11];
                case 6:
                    _b.trys.push([6, , 9, 10]);
                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];
                    return [4, _a.call(asyncIterable_1)];
                case 7:
                    _b.sent();
                    _b.label = 8;
                case 8: return [3, 10];
                case 9:
                    if (e_2) throw e_2.error;
                    return [7];
                case 10: return [7];
                case 11:
                    subscriber.complete();
                    return [2];
            }
        });
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/observable/fromArray.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/observable/fromArray.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "internalFromArray": () => (/* binding */ internalFromArray)
/* harmony export */ });
/* harmony import */ var _scheduled_scheduleArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scheduled/scheduleArray */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from */ "./node_modules/rxjs/dist/esm5/internal/observable/from.js");


function internalFromArray(input, scheduler) {
    return scheduler ? (0,_scheduled_scheduleArray__WEBPACK_IMPORTED_MODULE_0__.scheduleArray)(input, scheduler) : (0,_from__WEBPACK_IMPORTED_MODULE_1__.fromArrayLike)(input);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/observable/of.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/observable/of.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "of": () => (/* binding */ of)
/* harmony export */ });
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/dist/esm5/internal/observable/fromArray.js");
/* harmony import */ var _scheduled_scheduleArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../scheduled/scheduleArray */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js");
/* harmony import */ var _util_args__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/args */ "./node_modules/rxjs/dist/esm5/internal/util/args.js");



function of() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var scheduler = (0,_util_args__WEBPACK_IMPORTED_MODULE_0__.popScheduler)(args);
    return scheduler ? (0,_scheduled_scheduleArray__WEBPACK_IMPORTED_MODULE_1__.scheduleArray)(args, scheduler) : (0,_fromArray__WEBPACK_IMPORTED_MODULE_2__.internalFromArray)(args);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js":
/*!*************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduleArray": () => (/* binding */ scheduleArray)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");

function scheduleArray(input, scheduler) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(function (subscriber) {
        var i = 0;
        return scheduler.schedule(function () {
            if (i === input.length) {
                subscriber.complete();
            }
            else {
                subscriber.next(input[i++]);
                if (!subscriber.closed) {
                    this.schedule();
                }
            }
        });
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduleAsyncIterable": () => (/* binding */ scheduleAsyncIterable)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/dist/esm5/internal/Subscription.js");


function scheduleAsyncIterable(input, scheduler) {
    if (!input) {
        throw new Error('Iterable cannot be null');
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(function (subscriber) {
        var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__.Subscription();
        sub.add(scheduler.schedule(function () {
            var iterator = input[Symbol.asyncIterator]();
            sub.add(scheduler.schedule(function () {
                var _this = this;
                iterator.next().then(function (result) {
                    if (result.done) {
                        subscriber.complete();
                    }
                    else {
                        subscriber.next(result.value);
                        _this.schedule();
                    }
                });
            }));
        }));
        return sub;
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js":
/*!****************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduleIterable": () => (/* binding */ scheduleIterable)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/dist/esm5/internal/symbol/iterator.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_caughtSchedule__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/caughtSchedule */ "./node_modules/rxjs/dist/esm5/internal/util/caughtSchedule.js");




function scheduleIterable(input, scheduler) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(function (subscriber) {
        var iterator;
        subscriber.add(scheduler.schedule(function () {
            iterator = input[_symbol_iterator__WEBPACK_IMPORTED_MODULE_1__.iterator]();
            (0,_util_caughtSchedule__WEBPACK_IMPORTED_MODULE_2__.caughtSchedule)(subscriber, scheduler, function () {
                var _a = iterator.next(), value = _a.value, done = _a.done;
                if (done) {
                    subscriber.complete();
                }
                else {
                    subscriber.next(value);
                    this.schedule();
                }
            });
        }));
        return function () { return (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_3__.isFunction)(iterator === null || iterator === void 0 ? void 0 : iterator.return) && iterator.return(); };
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js":
/*!******************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduleObservable": () => (/* binding */ scheduleObservable)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/dist/esm5/internal/symbol/observable.js");



function scheduleObservable(input, scheduler) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(function (subscriber) {
        var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__.Subscription();
        sub.add(scheduler.schedule(function () {
            var observable = input[_symbol_observable__WEBPACK_IMPORTED_MODULE_2__.observable]();
            sub.add(observable.subscribe({
                next: function (value) { sub.add(scheduler.schedule(function () { return subscriber.next(value); })); },
                error: function (err) { sub.add(scheduler.schedule(function () { return subscriber.error(err); })); },
                complete: function () { sub.add(scheduler.schedule(function () { return subscriber.complete(); })); },
            }));
        }));
        return sub;
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js":
/*!***************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "schedulePromise": () => (/* binding */ schedulePromise)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/dist/esm5/internal/Observable.js");

function schedulePromise(input, scheduler) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(function (subscriber) {
        return scheduler.schedule(function () {
            return input.then(function (value) {
                subscriber.add(scheduler.schedule(function () {
                    subscriber.next(value);
                    subscriber.add(scheduler.schedule(function () { return subscriber.complete(); }));
                }));
            }, function (err) {
                subscriber.add(scheduler.schedule(function () { return subscriber.error(err); }));
            });
        });
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduleReadableStreamLike": () => (/* binding */ scheduleReadableStreamLike)
/* harmony export */ });
/* harmony import */ var _scheduleAsyncIterable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scheduleAsyncIterable */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js");
/* harmony import */ var _util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isReadableStreamLike */ "./node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js");


function scheduleReadableStreamLike(input, scheduler) {
    return (0,_scheduleAsyncIterable__WEBPACK_IMPORTED_MODULE_0__.scheduleAsyncIterable)((0,_util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_1__.readableStreamLikeToAsyncGenerator)(input), scheduler);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "scheduled": () => (/* binding */ scheduled)
/* harmony export */ });
/* harmony import */ var _scheduleObservable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./scheduleObservable */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js");
/* harmony import */ var _schedulePromise__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./schedulePromise */ "./node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js");
/* harmony import */ var _scheduleArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scheduleArray */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js");
/* harmony import */ var _scheduleIterable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./scheduleIterable */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js");
/* harmony import */ var _scheduleAsyncIterable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scheduleAsyncIterable */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js");
/* harmony import */ var _util_isInteropObservable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/isInteropObservable */ "./node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js");
/* harmony import */ var _util_isPromise__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/isPromise */ "./node_modules/rxjs/dist/esm5/internal/util/isPromise.js");
/* harmony import */ var _util_isArrayLike__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArrayLike */ "./node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js");
/* harmony import */ var _util_isIterable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../util/isIterable */ "./node_modules/rxjs/dist/esm5/internal/util/isIterable.js");
/* harmony import */ var _util_isAsyncIterable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../util/isAsyncIterable */ "./node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js");
/* harmony import */ var _util_throwUnobservableError__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../util/throwUnobservableError */ "./node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js");
/* harmony import */ var _util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../util/isReadableStreamLike */ "./node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js");
/* harmony import */ var _scheduleReadableStreamLike__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./scheduleReadableStreamLike */ "./node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js");













function scheduled(input, scheduler) {
    if (input != null) {
        if ((0,_util_isInteropObservable__WEBPACK_IMPORTED_MODULE_0__.isInteropObservable)(input)) {
            return (0,_scheduleObservable__WEBPACK_IMPORTED_MODULE_1__.scheduleObservable)(input, scheduler);
        }
        if ((0,_util_isArrayLike__WEBPACK_IMPORTED_MODULE_2__.isArrayLike)(input)) {
            return (0,_scheduleArray__WEBPACK_IMPORTED_MODULE_3__.scheduleArray)(input, scheduler);
        }
        if ((0,_util_isPromise__WEBPACK_IMPORTED_MODULE_4__.isPromise)(input)) {
            return (0,_schedulePromise__WEBPACK_IMPORTED_MODULE_5__.schedulePromise)(input, scheduler);
        }
        if ((0,_util_isAsyncIterable__WEBPACK_IMPORTED_MODULE_6__.isAsyncIterable)(input)) {
            return (0,_scheduleAsyncIterable__WEBPACK_IMPORTED_MODULE_7__.scheduleAsyncIterable)(input, scheduler);
        }
        if ((0,_util_isIterable__WEBPACK_IMPORTED_MODULE_8__.isIterable)(input)) {
            return (0,_scheduleIterable__WEBPACK_IMPORTED_MODULE_9__.scheduleIterable)(input, scheduler);
        }
        if ((0,_util_isReadableStreamLike__WEBPACK_IMPORTED_MODULE_10__.isReadableStreamLike)(input)) {
            return (0,_scheduleReadableStreamLike__WEBPACK_IMPORTED_MODULE_11__.scheduleReadableStreamLike)(input, scheduler);
        }
    }
    throw (0,_util_throwUnobservableError__WEBPACK_IMPORTED_MODULE_12__.createInvalidObservableTypeError)(input);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js":
/*!***************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "timeoutProvider": () => (/* binding */ timeoutProvider)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var timeoutProvider = {
    setTimeout: function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var delegate = timeoutProvider.delegate;
        return ((delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) || setTimeout).apply(void 0, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(args)));
    },
    clearTimeout: function (handle) {
        var delegate = timeoutProvider.delegate;
        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);
    },
    delegate: undefined,
};


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/symbol/iterator.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/symbol/iterator.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getSymbolIterator": () => (/* binding */ getSymbolIterator),
/* harmony export */   "iterator": () => (/* binding */ iterator)
/* harmony export */ });
function getSymbolIterator() {
    if (typeof Symbol !== 'function' || !Symbol.iterator) {
        return '@@iterator';
    }
    return Symbol.iterator;
}
var iterator = getSymbolIterator();


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/symbol/observable.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/symbol/observable.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "observable": () => (/* binding */ observable)
/* harmony export */ });
var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js":
/*!**************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UnsubscriptionError": () => (/* binding */ UnsubscriptionError)
/* harmony export */ });
/* harmony import */ var _createErrorClass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./createErrorClass */ "./node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js");

var UnsubscriptionError = (0,_createErrorClass__WEBPACK_IMPORTED_MODULE_0__.createErrorClass)(function (_super) {
    return function UnsubscriptionErrorImpl(errors) {
        _super(this);
        this.message = errors
            ? errors.length + " errors occurred during unsubscription:\n" + errors.map(function (err, i) { return i + 1 + ") " + err.toString(); }).join('\n  ')
            : '';
        this.name = 'UnsubscriptionError';
        this.errors = errors;
    };
});


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/args.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/args.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "popResultSelector": () => (/* binding */ popResultSelector),
/* harmony export */   "popScheduler": () => (/* binding */ popScheduler),
/* harmony export */   "popNumber": () => (/* binding */ popNumber)
/* harmony export */ });
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _isScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./isScheduler */ "./node_modules/rxjs/dist/esm5/internal/util/isScheduler.js");


function last(arr) {
    return arr[arr.length - 1];
}
function popResultSelector(args) {
    return (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(last(args)) ? args.pop() : undefined;
}
function popScheduler(args) {
    return (0,_isScheduler__WEBPACK_IMPORTED_MODULE_1__.isScheduler)(last(args)) ? args.pop() : undefined;
}
function popNumber(args, defaultValue) {
    return typeof last(args) === 'number' ? args.pop() : defaultValue;
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/arrRemove.js":
/*!****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/arrRemove.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "arrRemove": () => (/* binding */ arrRemove)
/* harmony export */ });
function arrRemove(arr, item) {
    if (arr) {
        var index = arr.indexOf(item);
        0 <= index && arr.splice(index, 1);
    }
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/caughtSchedule.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/caughtSchedule.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "caughtSchedule": () => (/* binding */ caughtSchedule)
/* harmony export */ });
function caughtSchedule(subscriber, scheduler, execute, delay) {
    if (delay === void 0) { delay = 0; }
    var subscription = scheduler.schedule(function () {
        try {
            execute.call(this);
        }
        catch (err) {
            subscriber.error(err);
        }
    }, delay);
    subscriber.add(subscription);
    return subscription;
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js":
/*!***********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createErrorClass": () => (/* binding */ createErrorClass)
/* harmony export */ });
function createErrorClass(createImpl) {
    var _super = function (instance) {
        Error.call(instance);
        instance.stack = new Error().stack;
    };
    var ctorFunc = createImpl(_super);
    ctorFunc.prototype = Object.create(Error.prototype);
    ctorFunc.prototype.constructor = ctorFunc;
    return ctorFunc;
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/errorContext.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/errorContext.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "errorContext": () => (/* binding */ errorContext),
/* harmony export */   "captureError": () => (/* binding */ captureError)
/* harmony export */ });
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config */ "./node_modules/rxjs/dist/esm5/internal/config.js");

var context = null;
function errorContext(cb) {
    if (_config__WEBPACK_IMPORTED_MODULE_0__.config.useDeprecatedSynchronousErrorHandling) {
        var isRoot = !context;
        if (isRoot) {
            context = { errorThrown: false, error: null };
        }
        cb();
        if (isRoot) {
            var _a = context, errorThrown = _a.errorThrown, error = _a.error;
            context = null;
            if (errorThrown) {
                throw error;
            }
        }
    }
    else {
        cb();
    }
}
function captureError(err) {
    if (_config__WEBPACK_IMPORTED_MODULE_0__.config.useDeprecatedSynchronousErrorHandling && context) {
        context.errorThrown = true;
        context.error = err;
    }
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/identity.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/identity.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "identity": () => (/* binding */ identity)
/* harmony export */ });
function identity(x) {
    return x;
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isArrayLike": () => (/* binding */ isArrayLike)
/* harmony export */ });
var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isAsyncIterable": () => (/* binding */ isAsyncIterable)
/* harmony export */ });
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");

function isAsyncIterable(obj) {
    return Symbol.asyncIterator && (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isFunction.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isFunction": () => (/* binding */ isFunction)
/* harmony export */ });
function isFunction(value) {
    return typeof value === 'function';
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js":
/*!**************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isInteropObservable": () => (/* binding */ isInteropObservable)
/* harmony export */ });
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/dist/esm5/internal/symbol/observable.js");
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");


function isInteropObservable(input) {
    return (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(input[_symbol_observable__WEBPACK_IMPORTED_MODULE_1__.observable]);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isIterable.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isIterable.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isIterable": () => (/* binding */ isIterable)
/* harmony export */ });
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/dist/esm5/internal/symbol/iterator.js");
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");


function isIterable(input) {
    return (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(input === null || input === void 0 ? void 0 : input[_symbol_iterator__WEBPACK_IMPORTED_MODULE_1__.iterator]);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isPromise.js":
/*!****************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isPromise.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isPromise": () => (/* binding */ isPromise)
/* harmony export */ });
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");

function isPromise(value) {
    return (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(value === null || value === void 0 ? void 0 : value.then);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js":
/*!***************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "readableStreamLikeToAsyncGenerator": () => (/* binding */ readableStreamLikeToAsyncGenerator),
/* harmony export */   "isReadableStreamLike": () => (/* binding */ isReadableStreamLike)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");


function readableStreamLikeToAsyncGenerator(readableStream) {
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__asyncGenerator)(this, arguments, function readableStreamLikeToAsyncGenerator_1() {
        var reader, _a, value, done;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
            switch (_b.label) {
                case 0:
                    reader = readableStream.getReader();
                    _b.label = 1;
                case 1:
                    _b.trys.push([1, , 9, 10]);
                    _b.label = 2;
                case 2:
                    if (false) {}
                    return [4, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__await)(reader.read())];
                case 3:
                    _a = _b.sent(), value = _a.value, done = _a.done;
                    if (!done) return [3, 5];
                    return [4, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__await)(void 0)];
                case 4: return [2, _b.sent()];
                case 5: return [4, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__await)(value)];
                case 6: return [4, _b.sent()];
                case 7:
                    _b.sent();
                    return [3, 2];
                case 8: return [3, 10];
                case 9:
                    reader.releaseLock();
                    return [7];
                case 10: return [2];
            }
        });
    });
}
function isReadableStreamLike(obj) {
    return (0,_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(obj === null || obj === void 0 ? void 0 : obj.getReader);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/isScheduler.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/isScheduler.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isScheduler": () => (/* binding */ isScheduler)
/* harmony export */ });
/* harmony import */ var _isFunction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isFunction */ "./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");

function isScheduler(value) {
    return value && (0,_isFunction__WEBPACK_IMPORTED_MODULE_0__.isFunction)(value.schedule);
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/noop.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/noop.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "noop": () => (/* binding */ noop)
/* harmony export */ });
function noop() { }


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/pipe.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/pipe.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "pipe": () => (/* binding */ pipe),
/* harmony export */   "pipeFromArray": () => (/* binding */ pipeFromArray)
/* harmony export */ });
/* harmony import */ var _identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./identity */ "./node_modules/rxjs/dist/esm5/internal/util/identity.js");

function pipe() {
    var fns = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        fns[_i] = arguments[_i];
    }
    return pipeFromArray(fns);
}
function pipeFromArray(fns) {
    if (fns.length === 0) {
        return _identity__WEBPACK_IMPORTED_MODULE_0__.identity;
    }
    if (fns.length === 1) {
        return fns[0];
    }
    return function piped(input) {
        return fns.reduce(function (prev, fn) { return fn(prev); }, input);
    };
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js":
/*!***************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "reportUnhandledError": () => (/* binding */ reportUnhandledError)
/* harmony export */ });
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config */ "./node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scheduler/timeoutProvider */ "./node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js");


function reportUnhandledError(err) {
    _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_0__.timeoutProvider.setTimeout(function () {
        var onUnhandledError = _config__WEBPACK_IMPORTED_MODULE_1__.config.onUnhandledError;
        if (onUnhandledError) {
            onUnhandledError(err);
        }
        else {
            throw err;
        }
    });
}


/***/ }),

/***/ "./node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createInvalidObservableTypeError": () => (/* binding */ createInvalidObservableTypeError)
/* harmony export */ });
function createInvalidObservableTypeError(input) {
    return new TypeError("You provided " + (input !== null && typeof input === 'object' ? 'an invalid object' : "'" + input + "'") + " where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.");
}


/***/ }),

/***/ "./node_modules/tslib/tslib.es6.js":
/*!*****************************************!*\
  !*** ./node_modules/tslib/tslib.es6.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "__extends": () => (/* binding */ __extends),
/* harmony export */   "__assign": () => (/* binding */ __assign),
/* harmony export */   "__rest": () => (/* binding */ __rest),
/* harmony export */   "__decorate": () => (/* binding */ __decorate),
/* harmony export */   "__param": () => (/* binding */ __param),
/* harmony export */   "__metadata": () => (/* binding */ __metadata),
/* harmony export */   "__awaiter": () => (/* binding */ __awaiter),
/* harmony export */   "__generator": () => (/* binding */ __generator),
/* harmony export */   "__createBinding": () => (/* binding */ __createBinding),
/* harmony export */   "__exportStar": () => (/* binding */ __exportStar),
/* harmony export */   "__values": () => (/* binding */ __values),
/* harmony export */   "__read": () => (/* binding */ __read),
/* harmony export */   "__spread": () => (/* binding */ __spread),
/* harmony export */   "__spreadArrays": () => (/* binding */ __spreadArrays),
/* harmony export */   "__spreadArray": () => (/* binding */ __spreadArray),
/* harmony export */   "__await": () => (/* binding */ __await),
/* harmony export */   "__asyncGenerator": () => (/* binding */ __asyncGenerator),
/* harmony export */   "__asyncDelegator": () => (/* binding */ __asyncDelegator),
/* harmony export */   "__asyncValues": () => (/* binding */ __asyncValues),
/* harmony export */   "__makeTemplateObject": () => (/* binding */ __makeTemplateObject),
/* harmony export */   "__importStar": () => (/* binding */ __importStar),
/* harmony export */   "__importDefault": () => (/* binding */ __importDefault),
/* harmony export */   "__classPrivateFieldGet": () => (/* binding */ __classPrivateFieldGet),
/* harmony export */   "__classPrivateFieldSet": () => (/* binding */ __classPrivateFieldSet)
/* harmony export */ });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    if (typeof b !== "function" && b !== null)
        throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

var __createBinding = Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
});

function __exportStar(m, o) {
    for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);
}

function __values(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

/** @deprecated */
function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

/** @deprecated */
function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
}

function __spreadArray(to, from) {
    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)
        to[j] = from[i];
    return to;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

var __setModuleDefault = Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}

function __classPrivateFieldGet(receiver, privateMap) {
    if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to get private field on non-instance");
    }
    return privateMap.get(receiver);
}

function __classPrivateFieldSet(receiver, privateMap, value) {
    if (!privateMap.has(receiver)) {
        throw new TypeError("attempted to set private field on non-instance");
    }
    privateMap.set(receiver, value);
    return value;
}


/***/ }),

/***/ "./src/BasePlugin/AudioPlugin.ts":
/*!***************************************!*\
  !*** ./src/BasePlugin/AudioPlugin.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioPlugin": () => (/* binding */ AudioPlugin)
/* harmony export */ });
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index */ "./src/BasePlugin/index.ts");

class AudioPlugin extends _index__WEBPACK_IMPORTED_MODULE_0__.BasePlugin {
    constructor(factory, pluginOwner, prototypeObject) {
        super(factory, pluginOwner, prototypeObject);
        this.factory = factory;
        this.prototypeObject = prototypeObject;
    }
}


/***/ }),

/***/ "./src/BasePlugin/LinkedStoreInterface.ts":
/*!************************************************!*\
  !*** ./src/BasePlugin/LinkedStoreInterface.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LinkedStoreInterface": () => (/* binding */ LinkedStoreInterface)
/* harmony export */ });
class LinkedStoreInterface {
    constructor(owner, linkedStore) {
        this.owner = owner;
        this.linkedStore = linkedStore;
        this.listeners = new Map();
        linkedStore.addEventListener("altered", this);
    }
    handleEvent(e) {
        const term = e.detail.term;
        const value = e.detail.value;
        if (this.listeners[term] && typeof this.listeners[term] == "function") {
            this.listeners[term].call(this.owner, value);
        }
    }
    destroy() {
        this.linkedStore.removeEventListener("altered", this);
        this.listeners.clear();
    }
    requestTerm(term) {
        return this.linkedStore.getTerm(term);
    }
    listenForTerm(term, callback) {
        if (this.listeners.hasOwnProperty(term)) {
            throw "Listener already exists";
        }
        this.listeners.set(term, callback);
    }
    releaseListenerForTerm(term) {
        this.listeners.delete(term);
    }
}


/***/ }),

/***/ "./src/BasePlugin/ParameterManager.ts":
/*!********************************************!*\
  !*** ./src/BasePlugin/ParameterManager.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParameterManager": () => (/* binding */ ParameterManager)
/* harmony export */ });
/* harmony import */ var _parameters_NumberParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parameters/NumberParameter */ "./src/BasePlugin/parameters/NumberParameter.ts");
/* harmony import */ var _parameters_StringParameter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./parameters/StringParameter */ "./src/BasePlugin/parameters/StringParameter.ts");
/* harmony import */ var _parameters_ButtonParameter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./parameters/ButtonParameter */ "./src/BasePlugin/parameters/ButtonParameter.ts");
/* harmony import */ var _parameters_SwitchParameter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./parameters/SwitchParameter */ "./src/BasePlugin/parameters/SwitchParameter.ts");
/* harmony import */ var _parameters_ListParameter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./parameters/ListParameter */ "./src/BasePlugin/parameters/ListParameter.ts");
/* harmony import */ var _parameters_URLParameter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./parameters/URLParameter */ "./src/BasePlugin/parameters/URLParameter.ts");
/* harmony import */ var _parameters_AssetParameter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./parameters/AssetParameter */ "./src/BasePlugin/parameters/AssetParameter.ts");
/* harmony import */ var _parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./parameters/IPluginParameter */ "./src/BasePlugin/parameters/IPluginParameter.ts");
/* jshint esversion: 6 */








function formatParameterName(name) {
    name = name.toLowerCase();
    name = name.replace("/", "_");
    return name;
}
class ParameterManager {
    constructor(owner, pluginExternalInterface, name = "default", exposed = true) {
        this.owner = owner;
        this.pluginExternalInterface = pluginExternalInterface;
        this.name = name;
        this.exposed = exposed;
        this.parameterList = [];
        this.eventTarget = new EventTarget();
        this.visibleName = this.name;
    }
    findParameter(baseName) {
        let name = baseName.replace("/", "_").split(".").reverse();
        const lowerCaseParameterNames = this.parameterList.map(i => formatParameterName(i.name));
        const param = this.parameterList[lowerCaseParameterNames.indexOf(name.pop().toLowerCase())];
        if (param instanceof ParameterManager && name.length > 0) {
            return param.getParameterByName(name.reverse().join("."));
        }
        else {
            return param;
        }
    }
    isParameterNameAvailable(name) {
        name = formatParameterName(name);
        if (!/^\w+( \w+)*(-\w+)*(_\w+)*$/.test(name)) {
            console.warn("Invalid string for name", name, "Will not expose as dot notations");
            return true;
        }
        if (self.hasOwnProperty(name)) {
            throw new Error("Name is reserved or already defined");
        }
        return true;
    }
    buildParameterObject() {
        const obj = {};
        this.parameterList.filter(function (p) {
            return p.exposed;
        }).forEach(function (e) {
            obj[e.name] = e.getParameterObject();
        });
        return obj;
    }
    addParameter(param) {
        if (param.name.includes(".")) {
            throw ("Name cannot include a period");
        }
        var exists = this.parameterList.findIndex(function (e) {
            return e === param;
        }, param);
        if (exists === -1) {
            Object.defineProperty(this, param.name, {
                value: param
            });
            this.parameterList.push(param);
        }
        return param;
    }
    addEventListener(type, listener, options) {
        return this.eventTarget.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.eventTarget.removeEventListener(type, listener, options);
    }
    handleEvent(e) {
        let detail = e.detail;
        if (detail.updateInterfaces === true) {
            this.pluginExternalInterface.updateInterfaces();
        }
        if (this.name !== "default") {
            detail.parameter.name = `${this.name}.${detail.parameter.name}`;
        }
        if (e.type == "parameterset" && detail !== undefined) {
            this.eventTarget.dispatchEvent(new CustomEvent("parameterset", { detail: detail }));
        }
    }
    destroy() {
        this.deleteAllParameters();
    }
    createNumberParameter(name, defaultValue, minimum, maximum, toStringFunc, visibleName, exposed) {
        if (typeof name !== "string" || typeof defaultValue !== "number" || (minimum !== undefined && typeof minimum !== "number") || (maximum !== undefined && typeof maximum !== "number")) {
            throw ("Invlid constructor");
        }
        if (typeof toStringFunc != "function" && toStringFunc !== undefined) {
            throw ("toStringFunc must be a function or undefined");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            const param = new _parameters_NumberParameter__WEBPACK_IMPORTED_MODULE_0__.NumberParameter(this.owner, name, defaultValue, minimum, maximum, toStringFunc, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createStringParameter(name, defaultValue, maxLength, toStringFunc, visibleName, exposed) {
        if (typeof name !== "string" || typeof defaultValue !== "string" || (maxLength !== undefined && typeof maxLength !== "number")) {
            throw ("Invlid constructor");
        }
        if (typeof toStringFunc != "function" && toStringFunc !== undefined) {
            throw ("toStringFunc must be a function or undefined");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            var param = new _parameters_StringParameter__WEBPACK_IMPORTED_MODULE_1__.StringParameter(this.owner, name, defaultValue, maxLength, toStringFunc, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createButtonParameter(name, visibleName, exposed) {
        if (typeof name !== "string") {
            throw ("Invalid constructor");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            const param = new _parameters_ButtonParameter__WEBPACK_IMPORTED_MODULE_2__.ButtonParameter(this.owner, name, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createSwitchParameter(name, defaultValue, minState, maxState, toStringFunc, visibleName, exposed) {
        if (typeof name !== "string" || typeof defaultValue !== "number" || typeof minState !== "number" || typeof maxState !== "number") {
            throw ("Invlid constructor");
        }
        if (typeof toStringFunc != "function" && toStringFunc !== undefined) {
            throw ("toStringFunc must be a function or undefined");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            const param = new _parameters_SwitchParameter__WEBPACK_IMPORTED_MODULE_3__.SwitchParameter(this.owner, name, defaultValue, minState, maxState, toStringFunc, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createListParameter(name, defaultValue, listOfValues, toStringFunc, visibleName, exposed) {
        if (typeof name !== "string" || typeof defaultValue === "undefined" || !Array.isArray(listOfValues)) {
            throw ("Invlid constructor");
        }
        if (typeof toStringFunc != "function" && toStringFunc !== undefined) {
            throw ("toStringFunc must be a function or undefined");
        }
        if (listOfValues.includes(defaultValue) === false) {
            throw ("Invlid constructor - default value missing");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            const param = new _parameters_ListParameter__WEBPACK_IMPORTED_MODULE_4__.ListParameter(this.owner, name, defaultValue, listOfValues, toStringFunc, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createURLParameter(name, defaultValue, maxLength, toStringFunc, visibleName, exposed) {
        if (typeof name !== "string" || (maxLength !== undefined && typeof maxLength !== "number")) {
            throw ("Invlid constructor");
        }
        if (typeof toStringFunc != "function" && toStringFunc !== undefined) {
            throw ("toStringFunc must be a function or undefined");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(name)) {
            const param = new _parameters_URLParameter__WEBPACK_IMPORTED_MODULE_5__.URLParameter(this.owner, name, defaultValue, maxLength, toStringFunc, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createAssetParameter(name, visibleName, exposed) {
        if (typeof name !== "string") {
            throw ("Invlid constructor");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(this)) {
            const param = new _parameters_AssetParameter__WEBPACK_IMPORTED_MODULE_6__.AssetParameter(this.owner, name, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    createParameterManager(name, visibleName, exposed) {
        if (typeof name !== "string") {
            throw ("Invlid constructor");
        }
        name = name.toLowerCase();
        if (this.isParameterNameAvailable(this)) {
            const param = new _parameters_AssetParameter__WEBPACK_IMPORTED_MODULE_6__.AssetParameter(this.owner, name, visibleName, exposed);
            this.addParameter(param);
            param.addEventListener("parameterset", this);
            return param;
        }
    }
    getParameterByName(name) {
        return this.findParameter(name);
    }
    getParameterObject() {
        return this.buildParameterObject();
    }
    getParameterNames() {
        return this.parameterList.filter((p) => {
            return p.exposed;
        }).map((p) => {
            if (p instanceof ParameterManager) {
                return p.getParameterNames().map(recursiveName => `${p.name}.${recursiveName}`);
            }
            else {
                return [p.name];
            }
        }).flat();
    }
    setParameterByName(name, value, updateInterfaces = true) {
        var parameter = this.findParameter(name);
        if (!parameter) {
            return;
        }
        if (parameter.exposed === false) {
            console.warn("Cannot set hidden parameter");
            return;
        }
        if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_7__.isPluginParameter)(parameter)) {
            parameter.setValue(value, updateInterfaces);
        }
    }
    deleteParameter(parameter) {
        const index = this.parameterList.findIndex(e => e === parameter);
        if (index >= 0) {
            // Does exist
            this.parameterList.splice(index, 1);
            Object.defineProperty(this, parameter.name, {
                value: undefined
            });
            parameter.destroy();
            return true;
        }
        return false;
    }
    deleteAllParameters() {
        for (const parameter of Array.from(this.parameterList)) {
            this.deleteParameter(parameter);
        }
        return true;
    }
    setParametersByObject(object, updateInterfaces = true) {
        for (const key in object) {
            if (object.hasOwnProperty(key)) {
                const entry = object[key];
                if (typeof entry === 'object') {
                    let parameter = this.findParameter(key);
                    if (parameter instanceof ParameterManager) {
                        // Nested Parameter store
                        parameter.setParametersByObject(entry, updateInterfaces);
                    }
                    else if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_7__.isPluginParameter)(parameter) && entry.hasOwnProperty("value")) {
                        this.setParameterByName(key, entry.value, updateInterfaces);
                    }
                    else {
                        this.setParameterByName(key, entry, updateInterfaces);
                    }
                }
                else if (typeof entry == "number" || typeof entry == "string") {
                    this.setParameterByName(key, entry, updateInterfaces);
                }
                else {
                    throw ("Cannot set " + key + ": Not a valid object");
                }
            }
        }
    }
    toJSON() {
        return this.parameterList.filter(p => p.exposed)
            .reduce(function (obj, e) {
            if (e instanceof ParameterManager) {
                obj[e.name] = e.toJSON();
            }
            else if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_7__.isPluginParameter)(e)) {
                obj[e.name] = e.getParameterObject();
            }
            return obj;
        }, {});
    }
    get parameters() { return this.buildParameterObject(); }
    get numParameters() { return this.parameterList.length; }
}


/***/ }),

/***/ "./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceReceiver.ts":
/*!*********************************************************************************!*\
  !*** ./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceReceiver.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginFeatureInterfaceReceiver": () => (/* binding */ PluginFeatureInterfaceReceiver)
/* harmony export */ });
function checkFeatureArgs(source, featureObject) {
    if (source === undefined) {
        throw ("Source plugin must be defined");
    }
    if (featureObject === undefined) {
        throw ("FeatureObject must be defined");
    }
    if (typeof featureObject.outputIndex !== "number" || typeof featureObject.frameSize !== "number" || typeof featureObject.features !== "object") {
        throw ("Malformed featureObject");
    }
    return true;
}
/* jshint esversion: 6 */
class PluginFeatureInterfaceReceiver {
    constructor(FeatureInterfaceInstance, FactoryFeatureMap) {
        this.FeatureInterfaceInstance = FeatureInterfaceInstance;
        this.FactoryFeatureMap = FactoryFeatureMap;
    }
    requestFeatures(featureList) {
        for (let i = 0; i < featureList.length; i++) {
            this.requestFeaturesFromPlugin(featureList[i].plugin, {
                'outputIndex': featureList[i].outputIndex,
                'frameSize': featureList[i].frameSize,
                'features': featureList[i].features
            });
        }
    }
    requestFeaturesFromPlugin(source, featureObject) {
        checkFeatureArgs(source, featureObject);
        this.FactoryFeatureMap.requestFeatures(this, source.featureMap.Sender, featureObject);
    }
    cancelFeaturesFromPlugin(source, featureObject) {
        checkFeatureArgs(source, featureObject);
        this.FactoryFeatureMap.deleteFeatures(this, source.featureMap.Sender, featureObject);
    }
    cancelAllFeaturesFromPlugin(source) {
        if (source === undefined) {
            throw ("Source plugin must be defined");
        }
        this.FactoryFeatureMap.deleteFeatures(this, source.featureMap.Sender);
    }
    cancelAllFeatures() {
        this.FactoryFeatureMap.deleteFeatures(this);
    }
    postFeatures(message) {
        /*
            Called by the Plugin Factory with the feature message
            message = {
                'plugin': sourcePluginInstance,
                'outputIndex': outputIndex,
                'frameSize': frameSize,
                'features': {} JS-Xtract feature results object
            }
        */
        if (typeof this.c_features === "function") {
            this.c_features(message);
        }
    }
    ;
    get onfeatures() { return this.c_features; }
    set onfeatures(func) { this.c_features = func; }
}


/***/ }),

/***/ "./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceSender.ts":
/*!*******************************************************************************!*\
  !*** ./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceSender.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginFeatureInterfaceSender": () => (/* binding */ PluginFeatureInterfaceSender)
/* harmony export */ });
/* harmony import */ var _Factory_Extractors_OutputNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Factory/Extractors/OutputNode */ "./src/Factory/Extractors/OutputNode.ts");

class PluginFeatureInterfaceSender {
    constructor(FeatureInterfaceInstance, FactoryFeatureMap) {
        this.FeatureInterfaceInstance = FeatureInterfaceInstance;
        this.FactoryFeatureMap = FactoryFeatureMap;
        this.outputNodes = [];
    }
    updateFeatures(featureObject, outputIndex = 0) {
        if (this.outputNodes[outputIndex] === undefined) {
            if (outputIndex > this.FeatureInterfaceInstance.numOutputs) {
                throw new Error("Requested an output that does not exist");
            }
            this.outputNodes[outputIndex] = new _Factory_Extractors_OutputNode__WEBPACK_IMPORTED_MODULE_0__.OutputNode(this, this.FeatureInterfaceInstance.outputs[outputIndex], outputIndex);
        }
        for (let si = 0; si < featureObject.length; si++) {
            let extractor = this.outputNodes[outputIndex].findExtractor(featureObject[si].frameSize);
            if (!extractor) {
                extractor = this.outputNodes[outputIndex].addExtractor(featureObject[si].frameSize);
            }
            extractor.setFeatures(featureObject[si].features);
        }
    }
    postFeatures(featureObject) {
        /*
            Called by the individual extractor instances:
            featureObject = {'frameSize': frameSize,
            'outputIndex': outputIndex,
            'results':[]}
        */
        this.FeatureInterfaceInstance.factory.FeatureMap.postFeatures({
            'source': this,
            'outputIndex': featureObject.outputIndex,
            'frameSize': featureObject.frameSize,
            'results': featureObject.results
        });
    }
    ;
}


/***/ }),

/***/ "./src/BasePlugin/PluginFeatureInterface/index.ts":
/*!********************************************************!*\
  !*** ./src/BasePlugin/PluginFeatureInterface/index.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginFeatureInterface": () => (/* binding */ PluginFeatureInterface)
/* harmony export */ });
/* harmony import */ var _PluginFeatureInterfaceReceiver__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginFeatureInterfaceReceiver */ "./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceReceiver.ts");
/* harmony import */ var _PluginFeatureInterfaceSender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PluginFeatureInterfaceSender */ "./src/BasePlugin/PluginFeatureInterface/PluginFeatureInterfaceSender.ts");


class PluginFeatureInterface {
    constructor(plugin) {
        this.plugin = plugin;
        this.Receiver = new _PluginFeatureInterfaceReceiver__WEBPACK_IMPORTED_MODULE_0__.PluginFeatureInterfaceReceiver(this.plugin, this.plugin.factory.FeatureMap);
        this.Sender = new _PluginFeatureInterfaceSender__WEBPACK_IMPORTED_MODULE_1__.PluginFeatureInterfaceSender(this.plugin, this.plugin.factory.FeatureMap);
    }
    get onfeatures() { return this.Receiver.onfeatures; }
    set onfeatures(func) { this.Receiver.onfeatures = func; }
}


/***/ }),

/***/ "./src/BasePlugin/PluginInterfaceMessageHub.ts":
/*!*****************************************************!*\
  !*** ./src/BasePlugin/PluginInterfaceMessageHub.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginInterfaceMessageHub": () => (/* binding */ PluginInterfaceMessageHub)
/* harmony export */ });
/* harmony import */ var _parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parameters/IPluginParameter */ "./src/BasePlugin/parameters/IPluginParameter.ts");

class PluginInterfaceMessageHub {
    constructor(owner) {
        this.owner = owner;
        this.windowMessageList = [];
        this.eventTarget = new EventTarget();
        window.addEventListener("message", this);
    }
    buildPluginParameterJSON(sources) {
        const names = this.owner.parameters.getParameterNames();
        const O = {};
        if (sources.length == 0) {
            sources = names;
        }
        names.filter((name) => sources.includes(name)).forEach((name) => {
            const param = this.owner.parameters.getParameterByName(name);
            if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_0__.isPluginParameter)(param)) {
                O[name] = param.getParameterObject();
                O[name].name = name;
                if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_0__.isAutomatedPluginParameter)(param)) {
                    O[name].automated = param.enabled;
                }
            }
        });
        return O;
    }
    buildParameterUpdatePayload(sender_id, sources = []) {
        const msg = {
            sender_id,
            message: "updateParameters",
            parameters: this.buildPluginParameterJSON(sources)
        };
        return msg;
    }
    sendParameterUpdates(channel, sources = []) {
        channel.postMessage(this.buildParameterUpdatePayload(undefined, sources), location.origin);
    }
    broadcastParameterUpdates(sender_id, sources) {
        const msg = this.buildParameterUpdatePayload(sender_id, sources);
        this.windowMessageList.forEach(function (w) {
            w.postMessage(msg, location.origin);
        });
    }
    broadcastStateChange(level, term, value) {
        var msg = {
            message: "updateState",
            level,
            term,
            value
        };
        this.windowMessageList.forEach(function (w) {
            w.postMessage(msg, location.origin);
        });
    }
    setParameterMessage(e) {
        const updateObjects = [];
        const parameters = JSON.parse(e.data.parameters);
        Object.keys(parameters).forEach((name) => {
            const parameterObject = this.owner.parameters.getParameterByName(name);
            if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_0__.isPluginParameter)(parameterObject)) {
                parameterObject.setValue(parameters[name].value, false);
                updateObjects.push(name);
            }
        });
        return updateObjects;
    }
    destroy() {
        window.removeEventListener("message", this);
    }
    addEventListener(type, listener, options) {
        this.eventTarget.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        this.eventTarget.removeEventListener(type, listener, options);
    }
    handleEvent(e) {
        if (!this.windowMessageList.includes(e.source)) {
            return;
        }
        const window = e.source;
        switch (e.data.message) {
            case "setParameterByName":
                if (e.data.parameter.name) {
                    const parameterObject = this.owner.parameters.getParameterByName(e.data.parameter.name);
                    if ((0,_parameters_IPluginParameter__WEBPACK_IMPORTED_MODULE_0__.isPluginParameter)(parameterObject)) {
                        parameterObject.setValue(e.data.parameter.value, false);
                        this.broadcastParameterUpdates(e.data.sender_id, [e.data.parameter.name]);
                    }
                }
                break;
            case "setParametersByObject":
                if (e.data.parameter) {
                    const updateObjects = this.setParameterMessage(e);
                    this.broadcastParameterUpdates(e.data.sender_id, updateObjects);
                }
                break;
            case "requestParameters":
                if (typeof e.data.name == "string") {
                    this.sendParameterUpdates(window, [e.data.name]);
                }
                else {
                    this.sendParameterUpdates(window);
                }
                break;
            case "requestSessionState":
                this.broadcastStateChange("session", e.data.term, this.owner.sessionDataInterface.requestTerm(e.data.term));
                break;
            case "requestTrackState":
                this.broadcastStateChange("track", e.data.term, this.owner.trackDataInterface.requestTerm(e.data.term));
                break;
            case "requestUserState":
                this.broadcastStateChange("user", e.data.term, this.owner.userDataInterface.requestTerm(e.data.term));
                break;
            case "requestPluginState":
                this.broadcastStateChange("plugin", e.data.term, this.owner.pluginDataInterface.requestTerm(e.data.term));
                break;
            case "customMessage":
                break;
            default:
                throw ("Unknown message type \"" + e.data.message + "\"");
        }
    }
    sendState(level, term) {
        if (level == "session") {
            this.broadcastStateChange("session", term, this.owner.sessionDataInterface.requestTerm(term));
        }
        else if (level == "track") {
            this.broadcastStateChange("track", term, this.owner.trackDataInterface.requestTerm(term));
        }
        else if (level == "user") {
            this.broadcastStateChange("user", term, this.owner.userDataInterface.requestTerm(term));
        }
        else if (level == "plugin") {
            this.broadcastStateChange("plugin", term, this.owner.pluginDataInterface.requestTerm(term));
        }
        else {
            throw "Invalid state level option";
        }
    }
    updateInterfaces(automationOnly = false) {
        if (automationOnly === undefined) {
            automationOnly = false;
        }
        if (automationOnly) {
            const parameterNames = this.owner.parameters.getParameterNames();
            const sources = parameterNames.filter(function (name) {
                var param = this.owner.parameters.getParameterByName(name);
                return (param.automatable && param.enabled === true);
            });
            if (sources.length > 0) {
                this.broadcastParameterUpdates(undefined, sources);
            }
        }
        else {
            this.broadcastParameterUpdates();
        }
    }
    closeWindows() {
        while (this.windowMessageList.length > 0) {
            const w = this.windowMessageList.pop();
            w.close();
        }
        window.removeEventListener("message", this);
    }
    registerWindow(w) {
        if (this.windowMessageList.includes(w)) {
            this.windowMessageList.splice(this.windowMessageList.indexOf(w), 1);
        }
        this.windowMessageList.push(w);
        w.pluginInstance = this.owner;
        this.sendParameterUpdates(w);
        return true;
    }
    removeWindow(w) {
        if (this.windowMessageList.includes(w)) {
            this.windowMessageList.splice(this.windowMessageList.indexOf(w), 1);
        }
    }
}


/***/ }),

/***/ "./src/BasePlugin/index.ts":
/*!*********************************!*\
  !*** ./src/BasePlugin/index.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BasePlugin": () => (/* binding */ BasePlugin)
/* harmony export */ });
/* harmony import */ var _ParameterManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ParameterManager */ "./src/BasePlugin/ParameterManager.ts");
/* harmony import */ var _PluginInterfaceMessageHub__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PluginInterfaceMessageHub */ "./src/BasePlugin/PluginInterfaceMessageHub.ts");
/* harmony import */ var _PluginFeatureInterface_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PluginFeatureInterface/index */ "./src/BasePlugin/PluginFeatureInterface/index.ts");
/* harmony import */ var _LinkedStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../LinkedStore */ "./src/LinkedStore.ts");
/* harmony import */ var _LinkedStoreInterface__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./LinkedStoreInterface */ "./src/BasePlugin/LinkedStoreInterface.ts");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/dist/esm5/internal/observable/of.js");
// Add getInputs to all AudioNodes to ease deployment
/*globals AudioNode, Worker, console, window, document, Promise, XMLHttpRequest */
/*eslint-env browser */
/*jshint esversion: 6 */






// if (typeof AudioNode === "function" && window.importScripts === undefined) {
//     AudioNode.prototype.getInputs = function () {
//         return [this];
//     };
// }
class BasePlugin {
    constructor(factory, pluginOwner, prototypeObject) {
        this.factory = factory;
        this.pluginOwner = pluginOwner;
        this.prototypeObject = prototypeObject;
        this.inputList = [];
        this.outputList = [];
        this.delaySamples = 0;
        this.eventTarget = new EventTarget();
        this.externalInterface = new _PluginInterfaceMessageHub__WEBPACK_IMPORTED_MODULE_1__.PluginInterfaceMessageHub(this);
        this.context = this.factory.context;
        this.featureMap = new _PluginFeatureInterface_index__WEBPACK_IMPORTED_MODULE_2__.PluginFeatureInterface(this);
        this.parameters = new _ParameterManager__WEBPACK_IMPORTED_MODULE_0__.ParameterManager(this, this.externalInterface);
        this.PluginData = new _LinkedStore__WEBPACK_IMPORTED_MODULE_3__.LinkedStore("Plugin");
        this.sessionDataInterface = new _LinkedStoreInterface__WEBPACK_IMPORTED_MODULE_4__.LinkedStoreInterface(this, this.factory.SessionData);
        this.userDataInterface = new _LinkedStoreInterface__WEBPACK_IMPORTED_MODULE_4__.LinkedStoreInterface(this, this.factory.UserData);
        this.trackDataInterface = new _LinkedStoreInterface__WEBPACK_IMPORTED_MODULE_4__.LinkedStoreInterface(this, this.TrackData);
        this.pluginDataInterface = new _LinkedStoreInterface__WEBPACK_IMPORTED_MODULE_4__.LinkedStoreInterface(this, this.PluginData);
        this.SessionData = this.factory.SessionData;
        this.UserData = this.factory.UserData;
        this.name = this.prototypeObject.name;
        this.uniqueID = this.prototypeObject.uniqueID;
        this.version = this.prototypeObject.version;
        this.parameters.addEventListener("parameterset", function (e) {
            this.eventTarget.dispatchEvent(new CustomEvent("parameterset", { detail: e.detail }));
        });
    }
    start() { }
    stop() { }
    onloaded() { }
    onunloaded() { }
    deconstruct() { }
    deleteIO(node, list) {
        var i = list.findIndex(function (e) {
            return e === this;
        }, node);
        if (i === -1) {
            return false;
        }
        list.splice(i, 1);
        return true;
    }
    changeOwner(newOwner) {
        this.pluginOwner = newOwner;
    }
    delete() {
        this.sessionDataInterface.destroy();
        this.userDataInterface.destroy();
        this.trackDataInterface.destroy();
        this.pluginDataInterface.destroy();
        this.stop();
        this.onunloaded();
        if (this.deconstruct && typeof this.deconstruct == "function") {
            this.deconstruct();
        }
    }
    // Depcrecated - Use .delete() instead
    destroy() {
        console.error("DEPRECATED - Use .delete() instead");
        this.delete();
    }
    addInput(node) {
        this.inputList.push(node);
        return this.inputList;
    }
    deleteInput(node) {
        this.deleteIO(node, this.inputList);
        return this.inputList;
    }
    addOutput(node) {
        this.outputList.push(node);
        return this.outputList;
    }
    ;
    deleteOutput(node) {
        this.deleteIO(node, this.outputList);
        return this.outputList;
    }
    ;
    setProcessingDelayAsSeconds(seconds) {
        const fs = this.factory.context.sampleRate;
        if (typeof seconds == "number" && isFinite(seconds) && seconds >= 0) {
            return this.setProcessingDelayAsSamples(seconds * fs) / fs;
        }
        throw new Error("setProcessingDelayAsSeconds Invalid argument");
    }
    setProcessingDelayAsSamples(samples) {
        if (typeof samples == "number" && isFinite(samples) && samples >= 0) {
            this.delaySamples = samples;
            const e = new Event("alterdelay");
            this.eventTarget.dispatchEvent(e);
            return this.delaySamples;
        }
        else {
            throw new Error("setProcessingDelayAsSamples Invalid argument");
        }
    }
    connect(dest, output, input) {
        if (dest instanceof AudioParam) {
            this.outputs[0].connect(dest, output);
        }
        else {
            this.outputs[0].connect(dest, output, input);
        }
    }
    disconnect(dest, output, input) {
        if (dest === undefined) {
            this.outputs[0].disconnect();
        }
        else {
            if (dest instanceof AudioParam) {
                this.outputs[0].disconnect(dest, output);
            }
            else {
                this.outputs[0].disconnect(dest, output, input);
            }
        }
    }
    getInputs() { return this.inputList; }
    getOutputs() { return this.outputList; }
    getParameterNames() { return this.parameters.getParameterNames(); }
    getParameterByName(name) { return this.parameters.getParameterByName(name); }
    getParameterObject() { return this.parameters.getParameterObject(); }
    setParameterByName(name, value, updateInterfaces = true) { return this.parameters.setParameterByName(name, value, updateInterfaces); }
    setParametersByObject(object, updateInterfaces) { return this.parameters.setParametersByObject(object, updateInterfaces); }
    addEventListener(type, listener, options) {
        return this.eventTarget.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.eventTarget.removeEventListener(type, listener, options);
    }
    isReadyPromise() {
        return Promise.resolve(true);
    }
    loadingProgress$() {
        return (0,rxjs__WEBPACK_IMPORTED_MODULE_5__.of)({
            numberOfAssets: 0,
            loaded: true,
            numberOfAssetsLoaded: 0
        });
    }
    get owner() { return this.pluginOwner; }
    get numInputs() { return this.inputList.length; }
    get numOutputs() { return this.outputList.length; }
    get numParameters() { return this.parameters.numParameters; }
    get inputs() { return this.inputList; }
    get outputs() { return this.outputList; }
    get processingDelayAsSamples() { return this.delaySamples; }
    set processingDelayAsSamples(samples) { this.setProcessingDelayAsSamples(samples); }
    get processingDelayAsSeconds() { return this.delaySamples / this.factory.context.sampleRate; }
    set processingDelayAsSeconds(seconds) { this.setProcessingDelayAsSeconds(seconds); }
    get TrackData() { var _a; return (_a = this.pluginOwner) === null || _a === void 0 ? void 0 : _a.TrackData; }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/AssetParameter.ts":
/*!*****************************************************!*\
  !*** ./src/BasePlugin/parameters/AssetParameter.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AssetParameter": () => (/* binding */ AssetParameter)
/* harmony export */ });
/* harmony import */ var _Factory_PluginAssets_PluginAsset__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Factory/PluginAssets/PluginAsset */ "./src/Factory/PluginAssets/PluginAsset.ts");
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");


class AssetParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_1__.PluginParameter {
    constructor(owner, name, visibleName, exposed = true) {
        super(owner, name, "String", visibleName, exposed);
    }
    loadAsset() {
        this.loadAssetPromise = this.selectedAsset.fetch()
            .then((buffer) => {
            this.audioBuffer = buffer;
            this.selectedAsset.registerToPlugin(this.owner);
            if (typeof this.onloadCallback == "function") {
                this.onloadCallback(buffer);
            }
            return this;
        }, (e) => {
            if (typeof this.onerrorCallback == "function") {
                this.onerrorCallback(e);
            }
            return this;
        });
        return this.loadAssetPromise;
    }
    setValue(v, updateInterfaces = true) {
        let newSelectedAsset;
        if (v instanceof _Factory_PluginAssets_PluginAsset__WEBPACK_IMPORTED_MODULE_0__.PluginAsset) {
            newSelectedAsset = v;
        }
        else if (typeof v === "string" || typeof v === "number") {
            newSelectedAsset = this.owner.factory.pluginAssets.findAssetById(Number(v));
            if (newSelectedAsset === undefined) {
                newSelectedAsset = this.owner.factory.pluginAssets.findAssetByUrl(v.toString());
            }
        }
        else {
            if (v.hasOwnProperty('asset')) {
                newSelectedAsset = this.owner.factory.pluginAssets.findAssetByUrl(v.asset);
            }
            else if (v.hasOwnProperty('id')) {
                newSelectedAsset = this.owner.factory.pluginAssets.findAssetById(v.id);
            }
        }
        if (newSelectedAsset === undefined) {
            console.warn("No asset given, ", v);
            return this.selectedAsset;
        }
        if (this.selectedAsset === undefined || this.selectedAsset.id != newSelectedAsset.id) {
            // asset has changed url.
            if (this.selectedAsset !== undefined) {
                this.selectedAsset.deregisterFromPlugin(this.owner);
            }
            this.selectedAsset = newSelectedAsset;
            this.loadAsset();
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return this.selectedAsset;
    }
    destroy() {
    }
    getResource() {
        if (this.loadAssetPromise) {
            return this.loadAssetPromise;
        }
        else {
            return this.loadAsset();
        }
    }
    toString() {
        return this.selectedAsset.toString();
    }
    getParameterObject() {
        return {
            value: this.selectedAsset ? this.selectedAsset.toJSON() : undefined,
            loaded: (this.audioBuffer !== undefined),
            visibleName: this.name,
            type: "AssetParameter",
            name: this.name
        };
    }
    get onload() {
        return this.onloadCallback;
    }
    set onload(f) {
        this.onloadCallback = f;
    }
    get onerror() {
        return this.onerrorCallback;
    }
    set onerror(f) {
        this.onerrorCallback = f;
    }
    get isReadyPromise() {
        return this.loadAssetPromise;
    }
    get type() {
        return `Asset`;
    }
    get buffer() {
        return this.audioBuffer;
    }
    get value() {
        if (this.selectedAsset) {
            return this.selectedAsset.id;
        }
        else {
            return undefined;
        }
    }
    set value(v) {
        this.setValue(v, true);
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/ButtonParameter.ts":
/*!******************************************************!*\
  !*** ./src/BasePlugin/parameters/ButtonParameter.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ButtonParameter": () => (/* binding */ ButtonParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");

/* jshint esversion: 6 */
class ButtonParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, visibleName, exposed = true) {
        super(owner, name, "Button", visibleName, exposed);
        this.onclickFunction = () => { };
    }
    destroy() {
    }
    getParameterObject() {
        return {
            visibleName: this.visibleName,
            type: "ButtonParameter",
            name: this.name
        };
    }
    get type() {
        return "Button";
    }
    ;
    get onclick() {
        return this.onclickFunction;
    }
    set onclick(f) {
        this.onclickFunction = f;
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/IPluginParameter.ts":
/*!*******************************************************!*\
  !*** ./src/BasePlugin/parameters/IPluginParameter.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isPluginBaseParameter": () => (/* binding */ isPluginBaseParameter),
/* harmony export */   "isPluginParameter": () => (/* binding */ isPluginParameter),
/* harmony export */   "isAutomatedPluginParameter": () => (/* binding */ isAutomatedPluginParameter)
/* harmony export */ });
function isPluginBaseParameter(object) {
    return 'getParameterObject' in object;
}
function isPluginParameter(object) {
    return isPluginBaseParameter(object) && 'setValue' in object;
}
function isAutomatedPluginParameter(object) {
    return isPluginParameter(object) && 'getValueAtTimePoint' in object;
}


/***/ }),

/***/ "./src/BasePlugin/parameters/ListParameter.ts":
/*!****************************************************!*\
  !*** ./src/BasePlugin/parameters/ListParameter.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ListParameter": () => (/* binding */ ListParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");
/* harmony import */ var _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ParameterAutomation */ "./src/BasePlugin/parameters/ParameterAutomation.ts");
/* jshint esversion: 6 */


class ListParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, _defaultValue, listOfValues, toStringFunc, visibleName, exposed = true) {
        super(owner, name, "Button", visibleName, exposed);
        this._defaultValue = _defaultValue;
        this.listOfValues = listOfValues;
        this.toStringFunc = toStringFunc;
        this.listIndex = listOfValues.indexOf(_defaultValue);
    }
    setV(v, updateInterfaces = true) {
        const i = this.listOfValues.indexOf(v);
        if (i === undefined || i < 0) {
            throw ("Not in list range");
        }
        if (this.boundAudioParam) {
            this.boundAudioParam.value = this.update(v);
        }
        if (this.listIndex !== i) {
            this.listIndex = i;
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return this.listOfValues[this.listIndex];
    }
    isAutomatable() {
        if (!this.automatable) {
            throw new Error(`${this.type} is not automatable`);
        }
        return true;
    }
    destroy() {
    }
    setValue(v) {
        this.setV(v, true);
        return this.value;
    }
    increment() {
        var v = this.listIndex + 1;
        if (v >= this.listOfValues.length) {
            v = 0;
        }
        return this.setValue(this.listOfValues[this.listIndex]);
    }
    decrement() {
        var v = this.listIndex - 1;
        if (v < 0) {
            v = this.listOfValues.length - 1;
        }
        return this.setValue(this.listOfValues[this.listIndex]);
    }
    addOptionToList(t) {
        if (this.listOfValues.includes(t) === false) {
            this.listOfValues.push(t);
        }
        return this.listOfValues;
    }
    deleteOptionFromList(t) {
        const index = this.listOfValues.indexOf(t);
        const _value = this.listOfValues[this.listIndex];
        if (index == -1) {
            return;
        }
        const removedValue = this.listOfValues.splice(index, 1);
        if (_value === removedValue[0]) {
            this.listIndex = this.listIndex % this.listOfValues.length;
        }
        else {
            this.listIndex = this.listOfValues.indexOf(_value);
        }
        return this.listOfValues;
    }
    toString() {
        const v = this.value;
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc(v);
        }
        else if (typeof v.toString == "function") {
            return v.toString();
        }
        else {
            return String(v);
        }
    }
    getParameterObject() {
        return {
            value: this.value,
            options: this.listOfValues,
            defaultValue: this._defaultValue,
            minimum: 0,
            maximum: this.listOfValues.length,
            visibleName: this.name,
            type: "ListParameter",
            name: this.name
        };
    }
    getValueAtTimePoint(time) {
        if (this.isAutomatable()) {
            return this.automation.getValueAtTimePoint(time);
        }
    }
    start(time, contextTime) {
        if (this.isAutomatable()) {
            return this.automation.start(time, contextTime);
        }
    }
    stop(contextTime) {
        if (this.isAutomatable()) {
            return this.automation.stop(contextTime);
        }
    }
    bindToAudioParam(ap) {
        if (ap instanceof AudioParam) {
            this.audioParameter = ap;
            this.audioParameter.value = this.update(this.listOfValues[this.listIndex]);
            if (ap.setValueAtTime) {
                this.automation = new _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__.ParameterStepAutomation(this, this.audioParameter, 0, this.listValues.length, this.toStringFunc);
            }
            else {
                console.warn("Cannot bind automation as AudioParameter is not automatable");
            }
        }
        else {
            throw ("Argument 1 is not a valid AudioParameter object");
        }
    }
    get type() {
        return "List";
    }
    get defaultValue() {
        return this._defaultValue;
    }
    get listValues() {
        return this.listOfValues;
    }
    get value() {
        if (this.audioParameter) {
            return this.translate(this.audioParameter.value);
        }
        return this.listOfValues[this.listIndex];
    }
    set value(v) {
        this.setValue(v);
    }
    get boundAudioParam() {
        return this.audioParameter;
    }
    get automatable() {
        return this.automation !== undefined;
    }
    get automationPoints() {
        return this.automation;
    }
    get enabled() {
        return this.automation.enabled;
    }
    set enabled(e) {
        this.automation.enabled = (e === true);
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/NumberParameter.ts":
/*!******************************************************!*\
  !*** ./src/BasePlugin/parameters/NumberParameter.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NumberParameter": () => (/* binding */ NumberParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");
/* harmony import */ var _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ParameterAutomation */ "./src/BasePlugin/parameters/ParameterAutomation.ts");
/* jshint esversion: 6 */


class NumberParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, defaultValue, minimum, maximum, toStringFunc, visibleName, exposed = true) {
        super(owner, name, "Number", visibleName, exposed);
        this.defaultValue = defaultValue;
        this.minimum = minimum;
        this.maximum = maximum;
        this.toStringFunc = toStringFunc;
        this.type = "Number";
        this._stepSize = 0;
        this._value = this.defaultValue;
    }
    setValue(v, updateInterfaces = true) {
        if (this.automation && this.automation.enabled) {
            throw new Error("Automation is enabled, cannot set the value!");
        }
        if (this.minimum) {
            v = Math.max(v, this.minimum);
        }
        if (this.maximum) {
            v = Math.min(v, this.maximum);
        }
        if (this._stepSize > 0) {
            v = Math.round(v / this._stepSize);
            v = v * this._stepSize;
        }
        v = this.update(v);
        if (this.audioParameter) {
            if (this.automation) {
                if (this.owner.factory.context.state == 'suspended') {
                    this.audioParameter.value = v;
                }
                else {
                    this.audioParameter.setValueAtTime(v, this.owner.factory.context.currentTime);
                }
            }
            else {
                this.audioParameter.value = v;
            }
        }
        if (this._value !== v) {
            this._value = v;
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return this._value;
    }
    destroy() {
    }
    getValueAtTimePoint(time) {
        return this.automation.getValueAtTimePoint(time);
    }
    start(time, contextTime) {
        this.automation.start(time, contextTime);
    }
    stop(time) {
        this.automation.stop(time);
    }
    bindToAudioParam(ap) {
        if (typeof ap == "object" && ap.value != undefined) {
            this.audioParameter = ap;
            this.audioParameter.value = this.update(this._value);
            if (ap.setValueAtTime) {
                this.automation = new _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__.ParameterLinearAutomation(this, this.audioParameter, this.minimum, this.maximum, this.toStringFunc);
            }
            else {
                console.warn("Cannot bind automation as AudioParameter is not automatable");
            }
        }
        else {
            throw new Error("Argument 1 is not a valid AudioParameter object");
        }
    }
    toString() {
        const v = this.value;
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc(v);
        }
        else {
            return String(v);
        }
    }
    getParameterObject() {
        return {
            value: this.value,
            defaultValue: this.defaultValue,
            minimum: this.minimum,
            maximum: this.maximum,
            visibleName: this.name,
            type: "NumberParameter",
            name: this.name
        };
    }
    get value() {
        if (this.audioParameter) {
            if (this.automation && this.automation.length > 0) {
                const t = this.owner.factory.getCurrentProgramTime();
                return this.automation.getCurrentTimeValue(t);
            }
            return this.translate(this.audioParameter.value);
        }
        return this._value;
    }
    set value(v) {
        this.setValue(v, true);
    }
    get stepSize() { return this._stepSize; }
    set stepSize(n) {
        if (!isFinite(n) || n < 0) {
            throw new Error("Invalid step size");
        }
        this._stepSize = n;
    }
    get boundAudioParam() { return this.audioParameter; }
    get automatable() { return this.automation !== undefined; }
    get automationPoints() { return this.automation; }
    get enabled() { var _a; return (_a = this.automation) === null || _a === void 0 ? void 0 : _a.enabled; }
    set enabled(t) {
        if (this.automatable) {
            this.automation.enabled = (t === true);
        }
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/ParameterAutomation.ts":
/*!**********************************************************!*\
  !*** ./src/BasePlugin/parameters/ParameterAutomation.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParameterLinearAutomation": () => (/* binding */ ParameterLinearAutomation),
/* harmony export */   "ParameterStepAutomation": () => (/* binding */ ParameterStepAutomation)
/* harmony export */ });
/* jshint esversion: 6 */
class TimePoint {
    constructor(owner, _time, _value, toStringFunc) {
        this.owner = owner;
        this._time = _time;
        this._value = _value;
        this.toStringFunc = toStringFunc;
        if (typeof this._time != "number" || !isFinite(this._time) || this._time < 0) {
            throw new Error("Invalid Constructor: Time must be a positive number");
        }
        if (typeof this._value != "number" || !isFinite(this._value)) {
            throw new Error("Invalid Constructor: Value must be a number");
        }
    }
    setValue(v) {
        if (typeof v != "number" || !isFinite(v)) {
            throw ("Value must be a number");
        }
        return this._value;
    }
    setTime(t) {
        if (typeof t == "number" && isFinite(t) && t >= 0) {
            this._time = t;
        }
        return this._time;
    }
    toString() {
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc(this._value);
        }
        return String(this._value);
    }
    get time() {
        return this.time;
    }
    set time(t) {
        this.setTime(t);
    }
    get value() {
        return this.value;
    }
    set value(v) {
        this.setValue(v);
    }
}
class TimePointList {
    constructor(min_value, max_value, toStringFunc) {
        this.toStringFunc = toStringFunc;
        this.automationPoints = [];
        if (typeof min_value != "number" || !isFinite(min_value)) {
            throw ("Invalid Constructor: min_value be a number");
        }
        if (typeof max_value != "number" || !isFinite(max_value)) {
            throw ("Invalid Constructor: max_value be a number");
        }
        if (min_value == max_value) {
            throw ("Invalid Constructor: max_value cannot equal to min_value");
        }
        if (max_value < min_value) {
            throw ("Invalid Constructor: min_value cannot be greater than max_value");
        }
        this.minimum = min_value;
        this.maximum = max_value;
    }
    getPointAtTime(time) {
        return this.automationPoints.find((p) => {
            p.time == time;
        });
    }
    hasPointAtTime(time) {
        return this.getPointAtTime(time) !== undefined;
    }
    sortPoints() {
        return this.automationPoints.sort(function (a, b) {
            if (a.time > b.time) {
                return 1;
            }
            else {
                return -1;
            }
        });
    }
    insertPoint(time, value) {
        if (typeof time != "number" || !isFinite(time) || time < 0) {
            throw ("Time must be a positive number");
        }
        if (typeof value != "number" || !isFinite(value)) {
            throw ("Value must be a number");
        }
        if (this.hasPointAtTime(time)) {
            throw ("Already a value entry at time " + time);
        }
        var point = new TimePoint(this, time, value, this.toStringFunc);
        this.automationPoints.push(point);
        this.automationPoints = this.sortPoints();
        return point;
    }
    getPoints(start_time, end_time) {
        if (start_time === undefined) {
            start_time = 0;
        }
        if (end_time === undefined) {
            end_time = Infinity;
        }
        return this.automationPoints.filter(function (point) {
            return point.time >= start_time && point.time < end_time;
        });
    }
    deletePoint(time) {
        var index = this.automationPoints.findIndex(function (point) {
            return point.time == time;
        });
        if (index >= 0) {
            this.automationPoints.splice(index, 1);
        }
        return this.automationPoints.length;
    }
    getStaticValueAsString(value) {
        if (this.toStringFunc) {
            return this.toStringFunc(value);
        }
        return String(value);
    }
    getValueAtTimePoint(time) {
        return this.getPointAtTime(time);
    }
    updatePoint(time, options) {
        const point = this.automationPoints.find(point => point.time == time);
        if (point) {
            if (typeof options.time == "number" && options.time != point.time) {
                if (this.hasPointAtTime(time)) {
                    throw new Error(`A time-point already exists at ${String(options.time)} seconds`);
                }
                else {
                    point.time = options.time;
                    this.automationPoints = this.sortPoints();
                }
            }
            point.value = options.value;
        }
        return point;
    }
    get length() {
        return this.automationPoints.length;
    }
}
class ParameterAutomation extends TimePointList {
    constructor(parameter, min_value, max_value, toStringFunc) {
        super(min_value, max_value, toStringFunc);
        this.parameter = parameter;
        this.isEnabled = false;
    }
    get enabled() {
        return this.isEnabled;
    }
    set enabled(t) {
        if (this.length > 0) {
            this.isEnabled = (t === true);
        }
    }
}
class ParameterLinearAutomation extends ParameterAutomation {
    constructor(owner, parameter, min_value, max_value, toStringFunc) {
        super(parameter, min_value, max_value, toStringFunc);
        this.owner = owner;
    }
    linearInterpolation(time, pointA, pointB) {
        let t1 = pointA.time;
        let t2 = pointB.time;
        time -= t1;
        t2 -= t1;
        t1 = 0;
        const p = time / t2;
        return pointA.value * (1 - p) + pointB.value * p;
    }
    getCurrentTimeValue(time) {
        if (this.automationPoints.length == 0) {
            return this.owner.value;
        }
        if (this.automationPoints.length == 1) {
            return this.automationPoints[0].value;
        }
        var firstPoint = this.automationPoints.reduce(function (point, nextPoint) {
            if (nextPoint.time <= time) {
                return nextPoint;
            }
            else {
                return point;
            }
        }, this.automationPoints[0]);
        var secondPoint = this.automationPoints.find(function (point) {
            return point.time > firstPoint.time;
        });
        if (secondPoint === undefined || firstPoint.time > time) {
            return firstPoint.value;
        }
        return this.linearInterpolation(time, firstPoint, secondPoint);
    }
    start(time, contextTime) {
        if (this.enabled) {
            const startPosition = this.owner.update(this.getCurrentTimeValue(time));
            this.parameter.setValueAtTime(startPosition, contextTime);
            this.automationPoints.forEach((p) => {
                if (p.time > time) {
                    const t = p.time - time;
                    const v = this.owner.update(p.value);
                    this.parameter.linearRampToValueAtTime(v, t + contextTime);
                }
            });
        }
    }
    stop(contextTime) {
        if (contextTime === undefined) {
            contextTime = 0;
        }
        this.parameter.cancelScheduledValues(contextTime);
    }
}
class ParameterStepAutomation extends ParameterAutomation {
    constructor(owner, parameter, min_value, max_value, toStringFunc) {
        super(parameter, min_value, max_value, toStringFunc);
        this.owner = owner;
    }
    getCurrentTimeValue(time) {
        if (this.automationPoints.length == 0) {
            throw ("No automation points available");
        }
        if (this.automationPoints.length == 1) {
            return this.automationPoints[0].value;
        }
        const nearestPoint = this.automationPoints.reduce(function (point, nextPoint) {
            if (nextPoint.time <= time) {
                return nextPoint;
            }
            else {
                return point;
            }
        }, this.automationPoints[0]);
        return nearestPoint.value;
    }
    start(time, contextTime) {
        var startPosition = this.owner.update(this.getCurrentTimeValue(time));
        this.parameter.setValueAtTime(startPosition, contextTime);
        this.automationPoints.forEach(p => {
            if (p.time > time) {
                var t = p.time - time;
                var v = this.owner.update(p.value);
                this.parameter.setValueAtTime(v, t + contextTime);
            }
        });
    }
    stop(contextTime) {
        this.parameter.cancelScheduledValues(contextTime);
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/PluginParameter.ts":
/*!******************************************************!*\
  !*** ./src/BasePlugin/parameters/PluginParameter.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginParameter": () => (/* binding */ PluginParameter)
/* harmony export */ });
class PluginParameter {
    constructor(owner, _name, dataType, _visibleName, _exposed = true) {
        this.owner = owner;
        this._name = _name;
        this._visibleName = _visibleName;
        this._exposed = _exposed;
        this.eventTarget = new EventTarget();
        this._updateFunction = (v) => {
            return v;
        };
        this._translateFunction = (v) => {
            return v;
        };
        this._triggerFunction = () => { };
        var update, translate, trigger;
        var eventTarget = new EventTarget();
        update = translate = function (v) {
            return v;
        };
        trigger = function () { };
    }
    destroy() { }
    setValue(v) {
        throw new Error('Cannot set this parameter');
    }
    toString() {
        return "PluginParameter";
    }
    ;
    getParameterObject() {
        return {
            name: this.name,
            visibleName: this.visibleName,
            type: "PluginParameter"
        };
    }
    addEventListener(type, listener, options) {
        return this.eventTarget.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.eventTarget.removeEventListener(type, listener, options);
    }
    triggerParameterSet(updateInterfaces = true) {
        if (updateInterfaces === undefined) {
            updateInterfaces = true;
        }
        const opts = {
            detail: {
                parameter: this.getParameterObject(),
                updateInterfaces: updateInterfaces
            }
        };
        this.eventTarget.dispatchEvent(new CustomEvent("parameterset", opts));
    }
    bindToAudioParam(ap) {
        throw ("Cannot bind this parameter type to an audio parameter");
    }
    get boundAudioParam() {
        return undefined;
    }
    get name() {
        return this._name;
    }
    get visibleName() {
        if (this._visibleName !== undefined && this._visibleName.length > 0) {
            return this.visibleName;
        }
        else {
            return this.name;
        }
    }
    get exposed() {
        return this._exposed;
    }
    set exposed(e) {
        this._exposed = e === true;
    }
    get update() {
        return this._updateFunction;
    }
    set update(f) {
        this._updateFunction = f;
    }
    get translate() {
        return this._translateFunction;
    }
    set translate(f) {
        this._translateFunction = f;
    }
    get trigger() {
        return this._triggerFunction;
    }
    set trigger(f) {
        this._triggerFunction = f;
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/StringParameter.ts":
/*!******************************************************!*\
  !*** ./src/BasePlugin/parameters/StringParameter.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "StringParameter": () => (/* binding */ StringParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");

class StringParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, defaultValue, maxLength, toStringFunc, visibleName, exposed = true) {
        super(owner, name, "String", visibleName, exposed);
        this.defaultValue = defaultValue;
        this.maxLength = maxLength;
        this.toStringFunc = toStringFunc;
        this.type = "String";
        this._value = defaultValue;
    }
    setValue(v, updateInterfaces = true) {
        let newValue;
        if (typeof v === "string") {
            newValue = v;
        }
        else {
            newValue = JSON.stringify(v);
        }
        if (this.maxLength && newValue.length > this.maxLength) {
            throw new Error(`String longer than ${this.maxLength} characters`);
        }
        if (this.boundAudioParam) {
            this.boundAudioParam.value = this.update(v);
        }
        if (this._value !== v) {
            this._value = v;
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return this._value;
    }
    destroy() { }
    bindToAudioParam(ap) {
        if (typeof ap == "object" && ap.value != undefined) {
            this.audioParameter = ap;
            this.audioParameter.value = this.update(this._value);
        }
        else {
            throw new Error("Argument 1 is not a valid AudioParameter object");
        }
    }
    toString() {
        const v = this._value;
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc.call(this, v);
        }
        else {
            return v;
        }
    }
    getParameterObject() {
        return {
            value: this.value,
            defaultValue: this.defaultValue,
            maxLength: this.maxLength,
            visibleName: this.name,
            type: "StringParameter",
            name: this.name
        };
    }
    get value() {
        if (this.boundAudioParam) {
            return this.translate(this.boundAudioParam.value);
        }
        return this._value;
    }
    set value(t) { this.setValue(t, true); }
    get boundAudioParam() { return this.audioParameter; }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/SwitchParameter.ts":
/*!******************************************************!*\
  !*** ./src/BasePlugin/parameters/SwitchParameter.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SwitchParameter": () => (/* binding */ SwitchParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");
/* harmony import */ var _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ParameterAutomation */ "./src/BasePlugin/parameters/ParameterAutomation.ts");
/* jshint esversion: 6 */


class SwitchParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, defaultValue, minState, maxState, toStringFunc, visibleName, exposed = true) {
        super(owner, name, "Number", visibleName, exposed);
        this.defaultValue = defaultValue;
        this.minState = minState;
        this.maxState = maxState;
        this.toStringFunc = toStringFunc;
        this.type = "Switch";
        this._value = this.defaultValue;
    }
    setValue(v, updateInterfaces = true) {
        if (v < this.minState) {
            throw new Error("Set value is less than " + this.minState);
        }
        if (v > this.maxState) {
            throw new Error("Set value is greater than " + this.maxState);
        }
        if (this.audioParameter) {
            this.audioParameter.value = this.update(v);
        }
        if (this._value !== v) {
            this._value = v;
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return v;
    }
    destroy() { }
    increment() {
        let v = this._value - 1;
        if (v < this.minState) {
            v = this.maxState;
        }
        return this.setValue(v);
    }
    decrement() {
        let v = this._value - 1;
        if (v < this.minState) {
            v = this.maxState;
        }
        return this.setValue(v);
    }
    bindToAudioParam(ap) {
        if (typeof ap == "object" && ap.value != undefined) {
            this.audioParameter = ap;
            this.audioParameter.value = this.update(this._value);
            if (ap.setValueAtTime) {
                this.automation = new _ParameterAutomation__WEBPACK_IMPORTED_MODULE_1__.ParameterStepAutomation(this, this.audioParameter, this.minState, this.maxState, this.toStringFunc);
            }
            else {
                console.warn("Cannot bind automation as AudioParameter is not automatable");
            }
        }
        else {
            throw new Error("Argument 1 is not a valid AudioParameter object");
        }
    }
    toString() {
        const v = this._value;
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc.call(this, v);
        }
        else {
            return String(v);
        }
    }
    getParameterObject() {
        return {
            value: this.value,
            defaultValue: this.defaultValue,
            minimum: this.minState,
            maximum: this.maxState,
            visibleName: this.name,
            type: "SwitchParameter",
            name: this.name
        };
    }
    get value() {
        if (this.audioParameter) {
            return this.translate(this.audioParameter.value);
        }
        return this._value;
    }
    set value(v) { this.setValue(v, true); }
    get boundAudioParam() { return this.audioParameter; }
    get automatable() { return this.automation !== undefined; }
    get automationPoints() { return this.automation; }
    get enabled() { var _a; return (_a = this.automation) === null || _a === void 0 ? void 0 : _a.enabled; }
    set enabled(t) {
        if (this.automatable) {
            this.automation.enabled = (t === true);
        }
    }
    getValueAtTimePoint(time) {
        return this.automation.getValueAtTimePoint(time);
    }
    start(time, contextTime) {
        this.automation.start(time, contextTime);
    }
    stop(time) {
        this.automation.stop(time);
    }
}


/***/ }),

/***/ "./src/BasePlugin/parameters/URLParameter.ts":
/*!***************************************************!*\
  !*** ./src/BasePlugin/parameters/URLParameter.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "URLParameter": () => (/* binding */ URLParameter)
/* harmony export */ });
/* harmony import */ var _PluginParameter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginParameter */ "./src/BasePlugin/parameters/PluginParameter.ts");

class URLParameter extends _PluginParameter__WEBPACK_IMPORTED_MODULE_0__.PluginParameter {
    constructor(owner, name, defaultValue, maxLength, toStringFunc, visibleName, exposed = true) {
        super(owner, name, "String", visibleName, exposed);
        this.defaultValue = defaultValue;
        this.maxLength = maxLength;
        this.toStringFunc = toStringFunc;
        this.type = "URL";
    }
    getResource(type) {
        if (this.resourceObject == undefined) {
            this.resourceObject = new Promise(function (resolve, reject) {
                const xhr = new XMLHttpRequest();
                xhr.open("GET", this._value);
                xhr.responseType = type;
                xhr.onload = function (e) {
                    if (xhr.status == 200) {
                        resolve(xhr.response);
                    }
                    else {
                        reject({
                            code: xhr.status,
                            message: e.target
                        });
                    }
                };
                xhr.onerror = function (e) {
                    reject({
                        code: xhr.status,
                        message: "error"
                    });
                };
                xhr.ontimeout = function (e) {
                    reject({
                        code: xhr.status,
                        message: "timeout"
                    });
                };
                xhr.send();
            });
        }
        return this.resourceObject;
    }
    setValue(v, updateInterfaces = true) {
        if (this.maxLength && v.length > this.maxLength) {
            throw new Error(`String longer than ${this.maxLength} characters`);
        }
        if (this._value !== v) {
            this.resourceObject = undefined;
            this._value = v;
            this.triggerParameterSet(updateInterfaces);
        }
        this.trigger();
        return this._value;
    }
    toString() {
        if (typeof this.toStringFunc == "function") {
            return this.toStringFunc.call(this, this._value);
        }
        else {
            return this._value;
        }
    }
    getParameterObject() {
        return {
            value: this.value,
            defaultValue: this.defaultValue,
            maxLength: this.maxLength,
            visibleName: this.name,
            type: "URLParameter",
            name: this.name
        };
    }
    get value() { return this._value; }
    ;
    set value(t) { this.setValue(t); }
}


/***/ }),

/***/ "./src/Factory/AudioPluginChainManager/SubFactoryFeatureSender/index.ts":
/*!******************************************************************************!*\
  !*** ./src/Factory/AudioPluginChainManager/SubFactoryFeatureSender/index.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SubFactoryFeatureSender": () => (/* binding */ SubFactoryFeatureSender)
/* harmony export */ });
/* harmony import */ var _Extractors_OutputNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Extractors/OutputNode */ "./src/Factory/Extractors/OutputNode.ts");
/* jshint esversion: 6 */

class SubFactoryFeatureSender {
    constructor(owner, FactoryFeatureMap) {
        this.owner = owner;
        this.FactoryFeatureMap = FactoryFeatureMap;
        this.outputNodes = [];
        this.FactoryFeatureMap.createSourceMap(this, undefined);
    }
    updateFeatures(featureObject, outputIndex = 0) {
        if (this.outputNodes[outputIndex] === undefined) {
            if (outputIndex > 1) {
                throw ("Requested an output that does not exist");
            }
            this.outputNodes[outputIndex] = new _Extractors_OutputNode__WEBPACK_IMPORTED_MODULE_0__.OutputNode(this, this.owner.chainStart, outputIndex);
        }
        for (let si = 0; si < featureObject.length; si++) {
            let extractor = this.outputNodes[outputIndex].findExtractor(featureObject[si].frameSize);
            if (!extractor) {
                extractor = this.outputNodes[outputIndex].addExtractor(featureObject[si].frameSize);
            }
            extractor.setFeatures(featureObject[si].features);
        }
    }
    ;
    rejoinExtractors() {
        for (const outputNode of this.outputNodes) {
            outputNode.rejoinExtractors();
        }
    }
    postFeatures(featureObject) {
        /*
            Called by the individual extractor instances:
            featureObject = {'frameSize': frameSize,
            'outputIndex': outputIndex,
            'results':[]}
        */
        this.FactoryFeatureMap.postFeatures({
            'plugin': this,
            'outputIndex': featureObject.outputIndex,
            'frameSize': featureObject.frameSize,
            'results': featureObject.results
        });
    }
    ;
    destroy() {
        this.FactoryFeatureMap.deleteSourceMap(this);
    }
}


/***/ }),

/***/ "./src/Factory/AudioPluginChainManager/index.ts":
/*!******************************************************!*\
  !*** ./src/Factory/AudioPluginChainManager/index.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioPluginChainManager": () => (/* binding */ AudioPluginChainManager)
/* harmony export */ });
/* harmony import */ var _LinkedStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../LinkedStore */ "./src/LinkedStore.ts");
/* harmony import */ var _SubFactoryFeatureSender_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubFactoryFeatureSender/index */ "./src/Factory/AudioPluginChainManager/SubFactoryFeatureSender/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* jshint esversion: 6 */


var AudioPluginChainManagerState;
(function (AudioPluginChainManagerState) {
    AudioPluginChainManagerState[AudioPluginChainManagerState["READY"] = 0] = "READY";
    AudioPluginChainManagerState[AudioPluginChainManagerState["CLOSED"] = 1] = "CLOSED";
})(AudioPluginChainManagerState || (AudioPluginChainManagerState = {}));
class AudioPluginChainManager {
    constructor(PluginFactory, chainStart, chainStop) {
        this.PluginFactory = PluginFactory;
        this.chainStart = chainStart;
        this.chainStop = chainStop;
        this.plugin_list = [];
        this.state = AudioPluginChainManagerState.READY;
        this.delaySamples = 0;
        this.featureSender = new _SubFactoryFeatureSender_index__WEBPACK_IMPORTED_MODULE_1__.SubFactoryFeatureSender(this, this.PluginFactory.FeatureMap);
        this.semanticStores = [];
        this.eventTarget = new EventTarget();
        this.factoryName = '';
        this.TrackData = new _LinkedStore__WEBPACK_IMPORTED_MODULE_0__.LinkedStore("Track");
        chainStart.disconnect();
        chainStart.connect(chainStop);
    }
    rebuild() {
        let i = 0, l = this.plugin_list.length - 1;
        while (i < l) {
            const currentNode = this.plugin_list[i++];
            const nextNode = this.plugin_list[i];
            currentNode.reconnect(nextNode);
        }
    }
    isolate() {
        this.plugin_list.forEach((e) => {
            e.disconnect();
        });
    }
    cutChain() {
        try {
            if (this.plugin_list.length > 0) {
                this.chainStart.disconnect(this.plugin_list[0].input);
                this.plugin_list[this.plugin_list.length - 1].output.disconnect(this.chainStop);
            }
            else {
                this.chainStart.disconnect(this.chainStop);
            }
        }
        catch (_a) {
            console.warn('could not disconnect plugin chain!');
        }
        return true;
    }
    joinChain() {
        if (this.plugin_list.length > 0) {
            this.chainStart.connect(this.plugin_list[0].input);
            this.plugin_list[this.plugin_list.length - 1].output.connect(this.chainStop);
        }
        else {
            this.chainStart.connect(this.chainStop);
        }
        this.featureSender.rejoinExtractors();
    }
    buildNewPlugin(prototypeObject) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.state === AudioPluginChainManagerState.CLOSED) {
                throw new Error("SubFactory has been destroyed! Cannot add new plugins");
            }
            const node = yield prototypeObject.createPluginInstance(this);
            return node;
        });
    }
    getDelayCompensation() {
        let sum = 0;
        for (const plugin of this.plugin_list) {
            if (!plugin.isBypassed()) {
                sum += plugin.node.processingDelayAsSamples;
            }
        }
        return sum;
    }
    bypassPlugin(plugin_instance, state) {
        // Check is a member of this chain
        if (this.plugin_list.includes(plugin_instance) === false) {
            return;
        }
        plugin_instance.bypass(state);
    }
    getPrototypes() {
        return this.PluginFactory.getPrototypes();
    }
    getFactory() {
        return this.PluginFactory;
    }
    ;
    destroy(reconnect = false) {
        if (this.state === AudioPluginChainManagerState.READY) {
            for (const pluginInstanceo of this.plugin_list) {
                this.destroyPlugin(pluginInstanceo);
            }
            this.chainStart.disconnect();
            if (reconnect === true) {
                this.chainStart.connect(this.chainStop);
            }
            this.featureSender.destroy();
            this.state = AudioPluginChainManagerState.CLOSED;
        }
    }
    createPlugin(prototypeObject) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.state === AudioPluginChainManagerState.CLOSED) {
                return;
            }
            let node;
            try {
                node = yield this.buildNewPlugin(prototypeObject);
            }
            catch (e) {
            }
            this.cutChain();
            this.plugin_list.push(node);
            this.isolate();
            this.rebuild();
            this.joinChain();
            node.addEventListener("alterdelay", this);
            node.node.onloaded.call(node.node);
            this.updateDelayCompensation();
            this.eventTarget.dispatchEvent(new Event("change"));
            return node;
        });
    }
    removePlugin(plugin_object) {
        if (this.state === AudioPluginChainManagerState.CLOSED) {
            return;
        }
        var index = this.getPluginIndex(plugin_object);
        if (index >= 0) {
            this.cutChain();
            plugin_object.removeEventListener("alterdelay", this);
            plugin_object.node.stop.call(plugin_object.node);
            plugin_object.node.onunloaded.call(plugin_object.node);
            this.plugin_list.splice(index, 1);
            this.isolate();
            this.rebuild();
            this.joinChain();
            this.updateDelayCompensation();
            this.eventTarget.dispatchEvent(new Event("change"));
        }
    }
    destroyPlugin(plugin_object) {
        if (this.state === AudioPluginChainManagerState.CLOSED) {
            return;
        }
        this.removePlugin(plugin_object);
        this.PluginFactory.deletePlugin(plugin_object);
        this.updateDelayCompensation();
    }
    getPlugins() {
        return this.plugin_list;
    }
    getAllPlugins() {
        return this.PluginFactory.getAllPluginsObject();
    }
    ;
    getPluginIndex(plugin_object) {
        if (this.state === AudioPluginChainManagerState.CLOSED) {
            return;
        }
        return this.plugin_list.indexOf(plugin_object);
    }
    movePlugin(plugin_object, new_index) {
        if (this.state === AudioPluginChainManagerState.CLOSED) {
            return;
        }
        if (this.PluginFactory.getAllPlugins().includes(plugin_object) === false) {
            throw new Error("Plugin does not exist");
        }
        const index = this.getPluginIndex(plugin_object);
        let obj;
        this.cutChain();
        this.isolate();
        if (plugin_object.node.owner !== this) {
            // Different sub-factory
            plugin_object.node.owner.removePlugin(plugin_object);
            plugin_object.node.changeOwner(this);
            obj = [plugin_object];
        }
        else {
            obj = this.plugin_list.splice(index, 1);
            plugin_object.node.onunloaded.call(plugin_object.node);
        }
        if (new_index === 0) {
            this.plugin_list = obj.concat(this.plugin_list);
        }
        else if (new_index >= this.plugin_list.length) {
            this.plugin_list = this.plugin_list.concat(obj);
        }
        else {
            const holdLow = this.plugin_list.slice(0, new_index);
            const holdHigh = this.plugin_list.slice(new_index);
            this.plugin_list = holdLow.concat(obj.concat(holdHigh));
        }
        this.rebuild();
        this.joinChain();
        plugin_object.node.onloaded.call(plugin_object.node);
        this.updateDelayCompensation();
        this.eventTarget.dispatchEvent(new Event("change"));
    }
    copyPlugin(plugin_object, copy_index) {
        return __awaiter(this, void 0, void 0, function* () {
            if (copy_index === undefined) {
                copy_index = this.plugin_list.length;
            }
            if (typeof copy_index != "number" || copy_index < 0 || copy_index > this.plugin_list.length) {
                throw ("Plugin copy index outside of the chain scope.");
            }
            let node;
            try {
                node = yield this.buildNewPlugin(plugin_object.prototypeObject);
            }
            catch (e) {
                console.log(e);
                throw new Error("Plugin did not get created! Aborting");
            }
            node.node.parameters.setParametersByObject(plugin_object.node.parameters.getParameterObject(), false);
            this.cutChain();
            this.isolate();
            this.plugin_list.splice(copy_index, 0, node);
            this.rebuild();
            this.joinChain();
            this.updateDelayCompensation();
            node.node.onloaded.call(node.node);
            this.eventTarget.dispatchEvent(new Event("change"));
            return node;
        });
    }
    duplicateAudioPluginChainManager(sourceAudioPluginChainManager) {
        return __awaiter(this, void 0, void 0, function* () {
            for (const plugin of sourceAudioPluginChainManager.getPlugins()) {
                yield this.copyPlugin(plugin);
            }
            return this;
        });
    }
    recursiveProcessing(base, list) {
        const l = list.length;
        for (let i = 0; i < l; i++) {
            const entry = list[i];
            base[entry.name].apply(base, entry.parameters);
            if (entry.features && entry.features.length > 0) {
                this.recursiveProcessing(base.result[entry.name], entry.features);
            }
        }
    }
    updateDelayCompensation() {
        const sum = this.getDelayCompensation();
        if (this.delaySamples != sum) {
            this.delaySamples = sum;
            this.eventTarget.dispatchEvent(new Event("alterdelay"));
        }
        return this.delaySamples;
    }
    handleEvent(e) {
        if (e.type == "alterdelay") {
            this.updateDelayCompensation();
        }
    }
    addEventListener(type, listener, options) {
        return this.eventTarget.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.eventTarget.removeEventListener(type, listener, options);
    }
    get SessionData() { return this.PluginFactory.SessionData; }
    get UserData() { return this.PluginFactory.UserData; }
    get processingDelayAsSamples() { return this.updateDelayCompensation(); }
    get processingDelayAsSeconds() { return this.processingDelayAsSamples / this.PluginFactory.context.sampleRate; }
}


/***/ }),

/***/ "./src/Factory/Extractors/Extractor.ts":
/*!*********************************************!*\
  !*** ./src/Factory/Extractors/Extractor.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Extractor": () => (/* binding */ Extractor)
/* harmony export */ });
/* harmony import */ var js_xtract__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! js-xtract */ "./node_modules/js-xtract/dist/jsXtract.js");
/* harmony import */ var js_xtract__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(js_xtract__WEBPACK_IMPORTED_MODULE_0__);

class Extractor {
    constructor(parent, frameSize) {
        this.parent = parent;
        this.frameSize = frameSize;
        this.features = [];
        this.context = this.parent.output.context;
        this.analyser = parent.output.context.createAnalyser();
        this.analyser.fftSize = frameSize;
        parent.output.connect(this.analyser);
    }
    getXtractData() {
        if (this.timeData === undefined) {
            this.timeData = new js_xtract__WEBPACK_IMPORTED_MODULE_0__.TimeData(this.analyser.fftSize, this.context.sampleRate);
        }
        const dst = new Float32Array(this.analyser.fftSize);
        if (this.analyser.getFloatTimeDomainData) {
            this.analyser.getFloatTimeDomainData(dst);
        }
        else {
            const view = new Uint8Array(this.analyser.fftSize);
            this.analyser.getByteTimeDomainData(view);
            for (let i = 0; i < this.analyser.fftSize; i++) {
                dst[i] = view[i];
                dst[i] = (dst[i] / 127.5) - 1;
            }
        }
        this.timeData.copyDataFrom(dst);
        return this.timeData;
    }
    frameCallback() {
        // Perform a callback on each frame
        // The function callback has the arguments (current_frame, previous_frame, previous_result)
        if (this.callbackObject === undefined) {
            this.callbackObject = this.parent.output.context.createScriptProcessor(this.analyser.fftSize, 1, 1);
            this.analyser.connect(this.callbackObject);
            this.callbackObject.onaudioprocess = (e) => {
                const current_frame = this.getXtractData();
                const message = {
                    'numberOfChannels': 1,
                    'results': []
                };
                message.results[0] = {
                    'channel': 0,
                    'results': []
                };
                this.postFeatures(message);
                for (let c = 0; c < e.outputBuffer.numberOfChannels && c < e.inputBuffer.numberOfChannels; c++) {
                    e.outputBuffer.copyToChannel(e.inputBuffer.getChannelData(c), c);
                }
            };
        }
        // For chrome and other efficiency browsers
        if (!this.fooGain) {
            this.fooGain = this.context.createGain();
            this.fooGain.gain.value = 0;
            this.callbackObject.connect(this.fooGain);
            this.fooGain.connect(this.context.destination);
        }
    }
    clearCallback() {
        //this === Extractor
        if (this.callbackObject) {
            this.callbackObject.disconnect();
            this.fooGain.disconnect();
            this.fooGain = undefined;
            this.callbackObject.onaudioprocess = undefined;
            this.callbackObject = undefined;
        }
    }
    setFeatures(featureList) {
        this.features = featureList;
        if (this.features.length === 0) {
            this.clearCallback();
        }
        else {
            this.frameCallback();
        }
    }
    rejoinExtractor() {
        this.parent.output.connect(this.extractor);
    }
    postFeatures(resultsJSON) {
        const obj = {
            'outputIndex': this.parent.index,
            'frameSize': this.frameSize,
            'results': resultsJSON
        };
        this.parent.postFeatures(obj);
    }
    get extractor() { return this.analyser; }
}


/***/ }),

/***/ "./src/Factory/Extractors/OutputNode.ts":
/*!**********************************************!*\
  !*** ./src/Factory/Extractors/OutputNode.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OutputNode": () => (/* binding */ OutputNode)
/* harmony export */ });
/* harmony import */ var _Extractor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Extractor */ "./src/Factory/Extractors/Extractor.ts");
/* harmony import */ var _WorkerExtractor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./WorkerExtractor */ "./src/Factory/Extractors/WorkerExtractor.ts");


class OutputNode {
    constructor(parent, output, index) {
        this.parent = parent;
        this.output = output;
        this.index = index;
        this.extractors = [];
    }
    addExtractor(frameSize) {
        let obj;
        if (window.Worker) {
            obj = new _WorkerExtractor__WEBPACK_IMPORTED_MODULE_1__.WorkerExtractor(this, frameSize);
        }
        else {
            obj = new _Extractor__WEBPACK_IMPORTED_MODULE_0__.Extractor(this, frameSize);
        }
        this.extractors.push(obj);
        return obj;
    }
    findExtractor(frameSize) {
        return this.extractors.find((e) => e.frameSize === frameSize);
    }
    deleteExtractor(frameSize) {
        const extractor = this.findExtractor(frameSize);
        if (extractor) {
            const index = this.extractors.indexOf(extractor);
            this.extractors.splice(index, 1);
        }
    }
    rejoinExtractors() {
        this.extractors.forEach(function (e) {
            e.rejoinExtractor();
        });
    }
    postFeatures(resultObject) {
        this.parent.postFeatures(resultObject);
    }
}


/***/ }),

/***/ "./src/Factory/Extractors/WorkerExtractor.ts":
/*!***************************************************!*\
  !*** ./src/Factory/Extractors/WorkerExtractor.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WorkerExtractor": () => (/* binding */ WorkerExtractor)
/* harmony export */ });
class WorkerExtractor {
    constructor(parent, frameSize) {
        this.parent = parent;
        this.frameSize = frameSize;
        this.worker = new Worker("../feature-worker.js", { type: "module" });
        this.features = [];
        this.analyser = parent.output.context.createScriptProcessor(frameSize, parent.output.numberOfOutputs, 1);
        parent.output.connect(this.analyser);
        this.worker.onerror = (errorEvent) => {
            console.error(errorEvent);
        };
        this.worker.onmessage = (e) => {
            if (e.data.state === 2) {
                this.response(e);
            }
            else if (e.data.state === 1) {
                this.extractor.onaudioprocess = this.onaudiocallback;
            }
        };
    }
    onaudiocallback(e) {
        var c, frames = [];
        for (c = 0; c < e.inputBuffer.numberOfChannels; c++) {
            frames[c] = e.inputBuffer.getChannelData(c);
        }
        this.worker.postMessage({
            'state': 2,
            'frames': frames
        });
    }
    response(msg) {
        this.postFeatures(msg.data.response);
    }
    postFeatures(resultsJSON) {
        const obj = {
            'outputIndex': this.parent.index,
            'frameSize': this.frameSize,
            'results': resultsJSON
        };
        this.parent.postFeatures(obj);
    }
    rejoinExtractor() {
        this.parent.output.connect(this.extractor);
    }
    ;
    setFeatures(featureList) {
        var self = this;
        var configMessage = {
            'state': 1,
            'sampleRate': this.parent.output.context.sampleRate,
            'featureList': featureList,
            'numChannels': this.parent.output.numberOfOutputs,
            'frameSize': this.frameSize
        };
        this.features = featureList;
        if (featureList && featureList.length > 0) {
            this.worker.postMessage({ 'state': 0 });
            this.worker.postMessage(configMessage);
        }
        else {
            this.extractor.onaudioprocess = undefined;
        }
    }
    get extractor() { return this.analyser; }
}


/***/ }),

/***/ "./src/Factory/FeatureMap/index.ts":
/*!*****************************************!*\
  !*** ./src/Factory/FeatureMap/index.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FeatureMap": () => (/* binding */ FeatureMap)
/* harmony export */ });
/* harmony import */ var _utility_uniqueMergeArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utility/uniqueMergeArray */ "./src/utility/uniqueMergeArray.ts");

class FrameSizeToFeatures {
    constructor() {
        this.receiverMap = new Map();
    }
    requestFeatures(frameSize, receiver, features) {
        if (this.receiverMap.has(frameSize) === false) {
            this.receiverMap.set(frameSize, new Map());
        }
        const receiverMapFeatures = this.receiverMap.get(frameSize);
        if (receiverMapFeatures.has(receiver)) {
            receiverMapFeatures.set(receiver, (0,_utility_uniqueMergeArray__WEBPACK_IMPORTED_MODULE_0__.uniqueMergeArray)(receiverMapFeatures.get(receiver), features));
        }
        else {
            receiverMapFeatures.set(receiver, features);
        }
        // Now get all the features we need to export
        let allFeatures = [];
        for (const [receiver, receiverFeatures] of receiverMapFeatures) {
            allFeatures = (0,_utility_uniqueMergeArray__WEBPACK_IMPORTED_MODULE_0__.uniqueMergeArray)(receiverFeatures, allFeatures);
        }
        return allFeatures;
    }
    revokeAllFeatures(frameSize) {
        return this.revokeFeatures(frameSize, undefined, undefined);
    }
    revokeAllReceiverFeatures(frameSize, receiver) {
        return this.revokeFeatures(frameSize, receiver, undefined);
    }
    revokeFeatures(frameSize, receiver, featuresToRemove) {
        if (this.receiverMap.has(frameSize) === false) {
            return;
        }
        const receiverMapFeatures = this.receiverMap.get(frameSize);
        if (receiver === undefined) {
            // If receiver is undefined, then we are killing the whole frameSize map
            for (const [receiverFromMap, receiverFeatures] of receiverMapFeatures) {
                this.revokeFeatures(frameSize, receiverFromMap, receiverFeatures);
            }
            return this.getFeatures(frameSize);
        }
        if (receiverMapFeatures.has(receiver) === false) {
            return;
        }
        const featureList = receiverMapFeatures.get(receiver);
        if (featuresToRemove === undefined) {
            // If features is undefined, remove all features
            // But, an empty list is valid
            featuresToRemove = featureList;
        }
        const reducedFeatureList = featureList.filter(feature => featuresToRemove.includes(feature) === false);
        if (reducedFeatureList.length === 0) {
            // Have no features!
            receiverMapFeatures.delete(receiver);
        }
        else {
            receiverMapFeatures.set(receiver, reducedFeatureList);
        }
        const remainingFeatures = this.getFeatures(frameSize);
        if (remainingFeatures.length === 0) {
            // The frameSize has no features left
            this.receiverMap.delete(frameSize);
        }
        return remainingFeatures;
    }
    getFeatures(frameSize) {
        const receiverMapFeatures = this.receiverMap.get(frameSize);
        if (receiverMapFeatures === undefined) {
            return [];
        }
        let allFeatures = [];
        for (const [receiver, receiverFeatures] of receiverMapFeatures) {
            allFeatures = (0,_utility_uniqueMergeArray__WEBPACK_IMPORTED_MODULE_0__.uniqueMergeArray)(receiverFeatures, allFeatures);
        }
        return allFeatures;
    }
}
class SourceMap {
    constructor(source) {
        this.source = source;
        this.outputMap = new Map();
    }
    getOutputMap(outputIndex) {
        return this.outputMap.get(outputIndex);
    }
    keys() {
        return this.outputMap.keys();
    }
    values() {
        return this.outputMap.values();
    }
    entries() {
        return this.outputMap.entries();
    }
    getFeatures(outputIndex, frameSize) {
        const output = this.getOutputMap(outputIndex);
        if (output === undefined) {
            return undefined;
        }
        return output.getFeatures(frameSize);
    }
    getOrAddOutputMap(outputIndex) {
        const output = this.getOutputMap(outputIndex);
        if (output === undefined) {
            this.outputMap.set(outputIndex, new FrameSizeToFeatures());
            return this.getOutputMap(outputIndex);
        }
        return output;
    }
    requestFeatures(outputIndex, frameSize, features, receiver) {
        const output = this.getOrAddOutputMap(outputIndex);
        const featureRequest = {
            outputIndex: outputIndex,
            frameSize: frameSize,
            features: []
        };
        featureRequest.features = output.requestFeatures(frameSize, receiver, features);
        this.source.updateFeatures([featureRequest]);
    }
    revokeFeatures(outputIndex, frameSize, receiver, featuresToRemove) {
        if (outputIndex === undefined) {
            for (const _outputIndex of this.outputMap.keys()) {
                this.revokeFeatures(_outputIndex, frameSize, receiver, featuresToRemove);
            }
            return;
        }
        const output = this.getOutputMap(outputIndex);
        if (output === undefined) {
            return;
        }
        if (frameSize === undefined) {
            for (const _frameSize of output.receiverMap.keys()) {
                this.revokeFeatures(outputIndex, _frameSize, receiver, featuresToRemove);
            }
            return;
        }
        const featureRequest = {
            outputIndex: outputIndex,
            frameSize: frameSize,
            features: []
        };
        featureRequest.features = output.revokeFeatures(frameSize, receiver, featuresToRemove);
        if (featureRequest.features.length === 0) {
            this.outputMap.delete(outputIndex);
        }
        this.source.updateFeatures([featureRequest]);
    }
}
class FeatureMap {
    constructor(factory) {
        this.factory = factory;
        this.Mappings = new Map();
    }
    findOrCreateSourceRequestMap(pluginSender) {
        const requests = this.Mappings.get(pluginSender);
        if (requests === undefined) {
            const requestMap = new SourceMap(pluginSender);
            this.Mappings.set(pluginSender, requestMap);
            return requestMap;
        }
        return requests;
    }
    requestFeatures(requestor, pluginSender, featureObject) {
        // Grab any existing map or build a new one
        //pluginSender.updateFeatures([featureObject]);
        const sourceMap = this.findOrCreateSourceRequestMap(pluginSender);
        sourceMap.requestFeatures(featureObject.outputIndex, featureObject.frameSize, featureObject.features, requestor);
    }
    ;
    deleteFeaturesFromSource(source) {
        // This will imediately kill the source
        // Used when deleting the plugin!
        const sourceMap = this.Mappings.get(source);
        if (sourceMap === undefined) {
            return;
        }
        sourceMap.revokeFeatures();
        this.Mappings.delete(source);
    }
    deleteFeatures(requestor, pluginSender, featureObject) {
        if (pluginSender === undefined && featureObject === undefined) {
            // Bork everything to this plugin!
            for (const sourceMap of this.Mappings.values()) {
                sourceMap.revokeFeatures(undefined, undefined, requestor, undefined); // Will bork any lists with that requestor
            }
        }
        else {
            const sourceMap = this.Mappings.get(pluginSender);
            if (sourceMap === undefined) {
                return;
            }
            // Depending on the level of info in featureObject...
            sourceMap.revokeFeatures(featureObject === null || featureObject === void 0 ? void 0 : featureObject.outputIndex, featureObject === null || featureObject === void 0 ? void 0 : featureObject.frameSize, requestor, featureObject === null || featureObject === void 0 ? void 0 : featureObject.features);
        }
    }
    ;
    getFeatureList(requestor, pluginSender) { }
    ;
    postFeatures(featureObject) {
        // Receive from the Sender objects
        // Trigger distributed search for results transmission
        // First get the instance mapping for output/frame
        const source = this.Mappings.get(featureObject.source);
        if (!source) {
            return;
        }
        const outputMap = source.getOutputMap(featureObject.outputIndex);
        if (outputMap === undefined) {
            return;
        }
        for (const [receiver, features] of outputMap.receiverMap.get(featureObject.frameSize)) {
            // Right now just send all features around
            receiver.postFeatures(featureObject);
        }
    }
    ;
}


/***/ }),

/***/ "./src/Factory/MidiSynthesisInstance.ts":
/*!**********************************************!*\
  !*** ./src/Factory/MidiSynthesisInstance.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MidiSynthesisInstance": () => (/* binding */ MidiSynthesisInstance),
/* harmony export */   "isMidiSynthesisInstance": () => (/* binding */ isMidiSynthesisInstance)
/* harmony export */ });
/* harmony import */ var _SynthesiserBasePlugin_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../SynthesiserBasePlugin/index */ "./src/SynthesiserBasePlugin/index.ts");
/* jshint esversion: 6 */

class MidiSynthesisInstance {
    constructor(node) {
        this.node = node;
        this.output = this.node.context.createGain();
        this.node.getOutputs()[0].connect(this.output);
    }
    destroy() {
        this.node.destroy();
    }
    ;
    get prototypeObject() { return this.node.prototypeObject; }
    get externalInterface() { return this.node.externalInterface; }
}
function isMidiSynthesisInstance(object) {
    return object.node instanceof _SynthesiserBasePlugin_index__WEBPACK_IMPORTED_MODULE_0__.SynthesiserBasePlugin;
}


/***/ }),

/***/ "./src/Factory/MidiSynthesiserHost.ts":
/*!********************************************!*\
  !*** ./src/Factory/MidiSynthesiserHost.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MidiSynthesiserHost": () => (/* binding */ MidiSynthesiserHost)
/* harmony export */ });
/* harmony import */ var _LinkedStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../LinkedStore */ "./src/LinkedStore.ts");
/* jshint esversion: 6 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

class MidiSynthesiserHost {
    constructor(factory) {
        this.factory = factory;
        this.ev = new EventTarget();
        this.connections = [];
        this.SessionData = this.factory.SessionData;
        this.UserData = this.factory.UserData;
        this.TrackData = new _LinkedStore__WEBPACK_IMPORTED_MODULE_0__.LinkedStore("Track");
    }
    unloadSynthesiserSlot() {
        if (this.midiSynthSlot) {
            this.midiSynthSlot.node.cancelAllEvents(this.factory.context.currentTime);
            this.midiSynthSlot.node.disconnect();
            this.midiSynthSlot = undefined;
        }
    }
    buildNewSynthesiserObject(prototypeObject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.unloadSynthesiserSlot();
            this.factory.deletePlugin(this.midiSynthSlot);
            if (prototypeObject.hasMidiInput == false || prototypeObject.hasMidiOutput == true) {
                throw new Error("Prototype is not a MidiSynthesis type. hasMidiInput must be true and hasMidiOutput must be false");
            }
            const node = yield prototypeObject.createPluginInstance(this);
            return node;
        });
    }
    addEventListener(type, listener, options) {
        return this.ev.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.ev.removeEventListener(type, listener, options);
    }
    connect(destinationNode, output, input) {
        if (destinationNode === undefined) {
            throw ("Must define an AudioNode object");
        }
        const exists = this.connections.find((conn) => {
            return conn.destinationNode == destinationNode && conn.output == output && conn.input == input;
        });
        if (exists) {
            return;
        }
        else {
            this.connections.push({
                destinationNode: destinationNode,
                output: output,
                input: input
            });
        }
        if (this.midiSynthSlot === undefined) {
            console.warn("MIDI Synthesiser is not loaded, connections will be validated on load");
        }
        else {
            this.midiSynthSlot.node.connect(destinationNode, output, input);
        }
    }
    disconnect(destinationNode, output, input) {
        if (destinationNode === undefined) {
            if (this.midiSynthSlot) {
                this.midiSynthSlot.node.disconnect();
            }
            this.connections = [];
        }
        else if (typeof destinationNode == "number" && typeof output == "undefined") {
            output = destinationNode;
            destinationNode = undefined;
            this.connections = this.connections.filter(function (conn) {
                if (conn.output == output) {
                    if (this.midiSynthSlot) {
                        this.midiSynthSlot.node.disconnect(conn.destinationNode, conn.output);
                    }
                    return false;
                }
                else {
                    return true;
                }
            });
        }
        else if (typeof destinationNode == "object" && typeof output == "undefined") {
            this.connections = this.connections.filter(function (conn) {
                if (conn.destinationNode == destinationNode) {
                    if (this.midiSynthSlot) {
                        this.midiSynthSlot.node.disconnect(conn.destinationNode);
                    }
                    return false;
                }
                else {
                    return true;
                }
            });
        }
        else if (typeof destinationNode == "object" && typeof output == "number") {
            this.connections = this.connections.filter(function (conn) {
                if (conn.destinationNode == destinationNode && conn.output == output) {
                    if (this.midiSynthSlot) {
                        this.midiSynthSlot.node.disconnect(conn.destinationNode, conn.output);
                    }
                    return false;
                }
                else {
                    return true;
                }
            });
        }
        else if (typeof destinationNode == "object" && typeof output == "number" && typeof input == "number") {
            this.connections = this.connections.filter(function (conn) {
                if (conn.destinationNode == destinationNode && conn.output == output && conn.input == input) {
                    if (this.midiSynthSlot) {
                        this.midiSynthSlot.node.disconnect(conn.destinationNode, conn.output, conn.input);
                    }
                    return false;
                }
                else {
                    return true;
                }
            });
        }
    }
    scheduleEvent(msg, t) {
        if (this.midiSynthSlot) {
            this.midiSynthSlot.node.scheduleEvent(msg, t);
        }
        else {
            throw ("MIDI Synthesiser not loaded");
        }
    }
    cancelAllEvents(t) {
        if (this.midiSynthSlot) {
            this.midiSynthSlot.node.cancelAllEvents(t);
        }
        else {
            throw ("MIDI Synthesiser not loaded");
        }
    }
    start() {
        if (this.midiSynthSlot) {
            this.midiSynthSlot.node.start();
        }
        else {
            throw ("MIDI Synthesiser not loaded");
        }
    }
    stop() {
        if (this.midiSynthSlot) {
            this.midiSynthSlot.node.stop();
        }
        else {
            throw ("MIDI Synthesiser not loaded");
        }
    }
    loadMidiSynthesiserModule(prototype) {
        return __awaiter(this, void 0, void 0, function* () {
            if (prototype.hasMidiInput == false || prototype.hasMidiOutput == true) {
                throw new Error("Prototype is not a MidiSynthesis type. hasMidiInput must be true and hasMidiOutput must be false");
            }
            let node;
            try {
                node = yield this.buildNewSynthesiserObject(prototype);
            }
            catch (e) {
                console.log(e);
                throw new Error("Plugin did not get created! Aborting");
            }
            ;
            node.node.onloaded.call(node.node);
            this.midiSynthSlot = node;
            this.connections.forEach(function (conn) {
                this.midiSynthSlot.node.connect(conn.destinationNode, conn.output, conn.input);
            });
            this.ev.dispatchEvent(new Event("loaded"));
            return this.midiSynthSlot;
        });
    }
    destroy() {
        this.unloadSynthesiserSlot();
        this.connections = undefined;
    }
    get midiSynthesiser() { return this.midiSynthSlot; }
}


/***/ }),

/***/ "./src/Factory/PluginAssets/PluginAsset.ts":
/*!*************************************************!*\
  !*** ./src/Factory/PluginAssets/PluginAsset.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginAsset": () => (/* binding */ PluginAsset)
/* harmony export */ });
/*eslint-env browser */
/* jshint esversion:6 */
class PluginAsset {
    constructor(pluginAssetManager, id, name, url, image_url, pack, _assetObject) {
        this.pluginAssetManager = pluginAssetManager;
        this.id = id;
        this.name = name;
        this.image_url = image_url;
        this.pack = pack;
        this._assetObject = _assetObject;
        this.usedBy = new Set();
        this.assetURL = new URL(url, window.location.origin);
    }
    abortScheduleForCleanup() {
        if (this.assetCleanupId !== undefined) {
            window.clearTimeout(this.assetCleanupId);
            this.assetCleanupId = undefined;
        }
    }
    scheduleForCleanup() {
        if (this.assetCleanupId !== undefined) {
            return;
        }
        this.assetCleanupId = window.setTimeout(() => {
            this._assetObject === undefined;
            this.assetCleanupId = undefined;
        }, 10000);
    }
    fetchAsset() {
        this.abortScheduleForCleanup();
        this.fetchPromise = this.pluginAssetManager.fetchAssetFunction(this)
            .then((ab) => {
            this._assetObject = ab;
            this.fetchPromise = undefined;
            return this._assetObject;
        });
    }
    fetch() {
        if (this._assetObject instanceof AudioBuffer) {
            return Promise.resolve(this._assetObject);
        }
        else if (this.fetchPromise === undefined) {
            this.fetchAsset();
        }
        return this.fetchPromise;
    }
    toJSON() {
        return { asset: this.assetURL.pathname };
    }
    toString() {
        return JSON.stringify(this.toJSON());
    }
    registerToPlugin(plugin) {
        this.abortScheduleForCleanup();
        this.usedBy.add(plugin);
    }
    deregisterFromPlugin(plugin) {
        this.usedBy.delete(plugin);
        if (this.usedBy.size === 0) {
            this.scheduleForCleanup();
        }
    }
    get url() { return this.assetURL.href; }
    get assetObject() { return this.assetObject; }
    get fetched() {
        return (this._assetObject instanceof AudioBuffer || this.fetchPromise !== undefined);
    }
}



/***/ }),

/***/ "./src/Factory/PluginAssets/PluginAssetManager.ts":
/*!********************************************************!*\
  !*** ./src/Factory/PluginAssets/PluginAssetManager.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginAssetManager": () => (/* binding */ PluginAssetManager)
/* harmony export */ });
/* harmony import */ var _PluginAssetsList__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginAssetsList */ "./src/Factory/PluginAssets/PluginAssetsList.ts");
/* harmony import */ var _defaultAssetFetch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./defaultAssetFetch */ "./src/Factory/PluginAssets/defaultAssetFetch.ts");
/*eslint-env browser */
/* jshint esversion:6 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function findPackByName(assetPackList, name) {
    return assetPackList.find(function (l) {
        return l.name == name;
    });
}
class PluginAssetManager {
    constructor(factoryContext) {
        this.factoryContext = factoryContext;
        this.assetFetchFunction = _defaultAssetFetch__WEBPACK_IMPORTED_MODULE_1__.fetchAssetAsArrayBuffer;
        this.assetPacks = [];
    }
    findPackByName(name) {
        return this.assetPacks.find(l => l.name == name);
    }
    addPackToList(id, name, image_url, resourceType) {
        if (typeof name != "string") {
            throw new Error("addAssetUrlToList Argument-1 must be a type of string");
        }
        if (this.findPackByName(name)) {
            throw new Error(`Pack with name ${name} already in this list`);
        }
        const assetPack = new _PluginAssetsList__WEBPACK_IMPORTED_MODULE_0__.PluginAssetsList(this, id, name, image_url, resourceType);
        this.assetPacks.push(assetPack);
        return assetPack;
    }
    removeAssetPackFromList(assetPack) {
        const index = this.assetPacks.indexOf(assetPack);
        if (index == -1) {
            return this.assetPacks;
        }
        this.assetPacks.splice(index, 1);
        return this.assetPacks;
    }
    removeAssetPackFromListByName(name) {
        if (typeof name != "string") {
            throw "removeAssetUrlFromList Argument-1 must be a type of string";
        }
        const asset = this.findPackByName(name);
        return this.removeAssetPackFromList(asset);
    }
    importFromAssetLists(oldContext) {
        oldContext.assetPacks.forEach((originalAssetPack) => {
            const newContextPack = this.addPackToList(originalAssetPack.id, originalAssetPack.name, originalAssetPack.image_url, originalAssetPack.resourceType);
            originalAssetPack.assetObjects.forEach((originalAsset) => {
                let assetObject;
                if (originalAsset.assetObject !== undefined) {
                    assetObject = this.factoryContext.context.createBuffer(originalAsset.assetObject.numberOfChannels, originalAsset.assetObject.length, originalAsset.assetObject.sampleRate);
                    for (var i = 0; i < assetObject.numberOfChannels; i++) {
                        assetObject.copyToChannel(originalAsset.assetObject.getChannelData(i), i, 0);
                    }
                }
                //id, name, url, image_url, assetObject
                newContextPack.addAssetUrlToList(originalAsset.id, originalAsset.name, originalAsset.url, originalAsset.image_url, assetObject);
            });
        });
    }
    setDefaultAssetFetchFunction(func) {
        if (typeof func === "function") {
            this.assetFetchFunction = func;
        }
    }
    fetchAssetFunction(assetObject) {
        return __awaiter(this, void 0, void 0, function* () {
            const ab = yield this.assetFetchFunction(assetObject);
            return yield this.factoryContext.context.decodeAudioData(ab);
        });
    }
    getAllAssets() {
        return this.assetPacks.map(l => l.assetObjects).flat();
    }
    getAllAssetsByResourceType(resourceType) {
        if (typeof resourceType == "string" && resourceType.length > 0) {
            return this.assetPacks.filter((list) => list.resourceType == resourceType).map(l => l.assetObjects).flat();
        }
        else {
            return this.getAllAssets();
        }
    }
    findAssetByUrl(url) {
        const fullUrl = new URL(url, window.location.origin);
        return this.getAllAssets().find((asset) => {
            const assetFullUrl = new URL(asset.url, window.location.origin);
            return (fullUrl.hostname === assetFullUrl.hostname && fullUrl.pathname === assetFullUrl.pathname);
        });
    }
    findAssetById(id) {
        return this.getAllAssets().find((asset) => asset.id === id);
    }
    destroy() {
        this.assetFetchFunction = undefined;
    }
}


/***/ }),

/***/ "./src/Factory/PluginAssets/PluginAssetsList.ts":
/*!******************************************************!*\
  !*** ./src/Factory/PluginAssets/PluginAssetsList.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginAssetsList": () => (/* binding */ PluginAssetsList)
/* harmony export */ });
/* harmony import */ var _PluginAsset__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginAsset */ "./src/Factory/PluginAssets/PluginAsset.ts");
/*eslint-env browser */
/* jshint esversion:6 */

class PluginAssetsList {
    constructor(pluginAssetManager, id, name, image_url, resourceType) {
        this.pluginAssetManager = pluginAssetManager;
        this.id = id;
        this.name = name;
        this.image_url = image_url;
        this.resourceType = resourceType;
        this.assetObjects = [];
    }
    findAssetByUrl(url) {
        return this.assetObjects.find((asset) => {
            return asset.url == url;
        });
    }
    addAssetUrlToList(id, name, url, image_url, assetObject) {
        if (typeof url != "string") {
            throw new Error("addAssetUrlToList Argument-2 must be a type of string");
        }
        if (this.findAssetByUrl(url)) {
            throw new Error(`URL ${url} already in this list`);
        }
        this.assetObjects.push(new _PluginAsset__WEBPACK_IMPORTED_MODULE_0__.PluginAsset(this.pluginAssetManager, id, name, url, image_url, this, assetObject));
        return this.assetObjects;
    }
    removeAssetFromList(asset) {
        const index = this.assetObjects.findIndex((listObjects) => asset.url == listObjects.url);
        if (index == -1) {
            throw new Error("Asset not in this list");
        }
        this.assetObjects.splice(index, 1);
        return this.assetObjects;
    }
    removeAssetUrlFromList(url) {
        if (typeof url != "string") {
            throw new Error("removeAssetUrlFromList Argument-1 must be a type of string");
        }
        const asset = this.findAssetByUrl(url);
        return this.removeAssetFromList(asset);
    }
    ;
}



/***/ }),

/***/ "./src/Factory/PluginAssets/defaultAssetFetch.ts":
/*!*******************************************************!*\
  !*** ./src/Factory/PluginAssets/defaultAssetFetch.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "fetchAssetAsArrayBuffer": () => (/* binding */ fetchAssetAsArrayBuffer)
/* harmony export */ });
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
function fetchAssetAsArrayBuffer(assetObject) {
    return __awaiter(this, void 0, void 0, function* () {
        const r = yield fetch(assetObject.url);
        return yield r.arrayBuffer();
    });
}


/***/ }),

/***/ "./src/Factory/PluginFactory.ts":
/*!**************************************!*\
  !*** ./src/Factory/PluginFactory.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginFactory": () => (/* binding */ PluginFactory)
/* harmony export */ });
/* harmony import */ var _LinkedStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../LinkedStore */ "./src/LinkedStore.ts");
/* harmony import */ var _PluginAssets_PluginAssetManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PluginAssets/PluginAssetManager */ "./src/Factory/PluginAssets/PluginAssetManager.ts");
/* harmony import */ var _PluginPrototype__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PluginPrototype */ "./src/Factory/PluginPrototype.ts");
/* harmony import */ var _FeatureMap_index__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FeatureMap/index */ "./src/Factory/FeatureMap/index.ts");
/* harmony import */ var _AudioPluginChainManager_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AudioPluginChainManager/index */ "./src/Factory/AudioPluginChainManager/index.ts");
/* harmony import */ var _MidiSynthesiserHost__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./MidiSynthesiserHost */ "./src/Factory/MidiSynthesiserHost.ts");
/* harmony import */ var _PluginUserInterfaceMessageHub__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PluginUserInterfaceMessageHub */ "./src/Factory/PluginUserInterfaceMessageHub.ts");
/* harmony import */ var _PluginInstance__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PluginInstance */ "./src/Factory/PluginInstance.ts");
/* harmony import */ var _MidiSynthesisInstance__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./MidiSynthesisInstance */ "./src/Factory/MidiSynthesisInstance.ts");
// This defines a master object for holding all the plugins and communicating
// This object will also handle creation and destruction of plugins
/*globals Promise, document, console, LinkedStore, Worker, window, XMLHttpRequest */
/*eslint-env browser */
/* jshint esversion:6 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









class PluginFactory {
    constructor(context, rootURL) {
        this.context = context;
        this.rootURL = rootURL;
        this.plugin_prototypes = [];
        this.audioPluginChainManagers = [];
        this.synthesiserHosts = [];
        this.pluginsList = [];
        this.audioStarted = false;
        this.PluginGUI = new _PluginUserInterfaceMessageHub__WEBPACK_IMPORTED_MODULE_6__.PluginUserInterfaceMessageHub(this);
        this.stores = [];
        this.SessionData = new _LinkedStore__WEBPACK_IMPORTED_MODULE_0__.LinkedStore("Session");
        this.UserData = new _LinkedStore__WEBPACK_IMPORTED_MODULE_0__.LinkedStore("User");
        this.FeatureMap = new _FeatureMap_index__WEBPACK_IMPORTED_MODULE_3__.FeatureMap(this);
        this.pluginAssets = new _PluginAssets_PluginAssetManager__WEBPACK_IMPORTED_MODULE_1__.PluginAssetManager(this);
        this.destroyAudioPluginChainManager = function (SubFactory) {
            var index = this.audioPluginChainManagers.findIndex(function (element) {
                if (element === this) {
                    return true;
                }
                return false;
            }, SubFactory);
            if (index >= 0) {
                this.audioPluginChainManagers.splice(index, 1);
                SubFactory.destroy();
            }
        };
    }
    copyFactory(factory, newcontext) {
        return __awaiter(this, void 0, void 0, function* () {
            const BFactory = new PluginFactory(newcontext, this.rootURL);
            for (const proto of this.plugin_prototypes) {
                yield BFactory.addPrototype(proto.proto);
            }
            BFactory.pluginAssets.importFromAssetLists(this.pluginAssets);
            return BFactory;
        });
    }
    pluginAudioStart(node, program_time, context_time) {
        node.start.call(node, program_time, context_time);
        node.parameters.getParameterNames().forEach(function (n) {
            var p = node.parameters.getParameterByName(n);
            if (p.enabled) {
                p.start(program_time, context_time);
            }
        });
    }
    pluginAudioStop(node) {
        const ct = this.context.currentTime;
        node.stop.call(node, ct);
        node.parameters.getParameterNames().forEach(function (n) {
            var p = node.parameters.getParameterByName(n);
            if (p.enabled) {
                p.stop(ct);
            }
        });
    }
    triggerAudioStart(program_time, context_time) {
        this.pluginsList.forEach(function (n) {
            this.pluginAudioStart(n.node, program_time, context_time);
        });
    }
    triggerAudioStop() {
        this.pluginsList.forEach(function (n) {
            this.pluginAudioStop(n.node);
        });
    }
    destroyFactory() {
        this.triggerAudioStop();
        for (const subFactory of Array.from(this.audioPluginChainManagers)) {
            this.destroyAudioPluginChainManager(subFactory);
        }
        for (const synthesiserHost of Array.from(this.synthesiserHosts)) {
            this.destroyMidiSynthesiserHost(synthesiserHost);
        }
        for (const plugin of Array.from(this.pluginsList)) {
            this.deletePlugin(plugin);
        }
        for (const prototype of Array.from(this.plugin_prototypes)) {
            this.deletePrototype(prototype);
        }
        this.pluginAssets.destroy();
    }
    ;
    loadPrototypeModule(resourceObject, mustModule = false) {
        return __awaiter(this, void 0, void 0, function* () {
            let module;
            try {
                if (typeof __webpack_require__.g.define === "function" && __webpack_require__.g.define.amd) {
                    module = __webpack_require__.g.require(resourceObject.url);
                }
                else if (typeof __webpack_require__.g.module == "object" && __webpack_require__.g.module.exports) {
                    module = (__webpack_require__.g.require(resourceObject.url));
                }
                else {
                    throw new Error("Cannot load using require");
                }
                if (typeof module === "function") {
                    return this.addPrototype(module);
                }
                else {
                    throw new Error("Is not a module plugin");
                }
            }
            catch (e) {
                if (mustModule === true) {
                    throw new Error("Cannot load using modular systems");
                }
                else {
                    console.warn("Could not load using modular systems");
                    return this.loadPluginScript(resourceObject);
                }
            }
            ;
        });
    }
    ;
    loadResource(resourceObject) {
        return __awaiter(this, void 0, void 0, function* () {
            if (typeof resourceObject !== "object") {
                throw new Error("Error");
            }
            else if (typeof resourceObject.url !== "string") {
                throw new Error("resourceObject.url must be a string");
            }
            else if (typeof resourceObject.test !== "function") {
                throw new Error("resourceObject.test must be a function");
            }
            const response = resourceObject.test();
            if (response !== false && response !== true) {
                throw new Error("resourceObject.test must return true or false");
            }
            if (!resourceObject.type) {
                resourceObject.type = "javascript";
            }
            resourceObject.type = resourceObject.type.toLowerCase();
            switch (resourceObject.type) {
                case "javascript":
                    if (!response) {
                        yield this.loadResource(resourceObject);
                    }
                    if (typeof resourceObject.returnObject === "string") {
                        if (window.hasOwnProperty(resourceObject.returnObject)) {
                            return (window[resourceObject.returnObject]);
                        }
                    }
                    break;
                default:
                    throw new Error("Invalid type " + String(resourceObject.type));
            }
        });
    }
    ;
    loadPluginScript(resourceObject) {
        return __awaiter(this, void 0, void 0, function* () {
            if (resourceObject) {
                if (typeof resourceObject.returnObject !== "string") {
                    throw new Error("resourceObject.returnObject must be the name of the prototype function");
                }
                const plugin = yield this.loadResource(resourceObject);
                return yield this.addPrototype(plugin);
            }
        });
    }
    ;
    injectPrototype(prototypeExecutable) {
        if (typeof prototypeExecutable != "function") {
            throw ("Invalid executable function");
        }
        return this.addPrototype(prototypeExecutable);
    }
    ;
    addPrototype(plugin_proto) {
        if (typeof plugin_proto !== "function") {
            throw new Error("The Prototype must be a function!");
        }
        else if (typeof plugin_proto.prototype.name !== "string" || plugin_proto.prototype.name.length === 0) {
            throw new Error("Malformed plugin. Name not defined");
        }
        else if (typeof plugin_proto.prototype.version !== "string" || plugin_proto.prototype.version.length === 0) {
            throw new Error("Malformed plugin. Version not defined");
        }
        else if (typeof plugin_proto.prototype.uniqueID !== "string" || plugin_proto.prototype.uniqueID.length === 0) {
            throw new Error("Malformed plugin. uniqueID not defined");
        }
        const testObj = {
            'proto': plugin_proto,
            'name': plugin_proto.prototype.name,
            'version': plugin_proto.prototype.version,
            'uniqueID': plugin_proto.prototype.uniqueID
        };
        const obj = this.plugin_prototypes.find((e) => {
            let match = 0;
            for (const param in testObj) {
                if (e[param] === this[param]) {
                    match++;
                }
                else {
                    return false;
                }
            }
            return match === 4;
        });
        if (obj) {
            throw new Error("The plugin must be unique!");
        }
        const newPluginPrototpye = new _PluginPrototype__WEBPACK_IMPORTED_MODULE_2__.PluginPrototype(plugin_proto, this);
        this.plugin_prototypes.push(newPluginPrototpye);
        return newPluginPrototpye;
    }
    ;
    deletePrototype(plugin_proto) {
        const index = this.plugin_prototypes.indexOf(plugin_proto);
        if (index === -1) {
            return;
        }
        this.plugin_prototypes.splice(index, 1);
    }
    ;
    getPrototypes() {
        return this.plugin_prototypes;
    }
    ;
    getAudioPluginPrototypes() {
        return this.plugin_prototypes.filter(function (proto) {
            return proto.hasMidiInput == false && proto.hasMidiOutput == false;
        });
    }
    ;
    getMidiSynthPrototypes() {
        return this.plugin_prototypes.filter(function (proto) {
            return proto.hasMidiInput == true && proto.hasMidiOutput == false;
        });
    }
    ;
    getMidiPluginPrototypes() {
        return this.plugin_prototypes.filter(function (proto) {
            return proto.hasMidiInput == true && proto.hasMidiOutput == true;
        });
    }
    ;
    getAllPlugins() {
        return this.pluginsList;
    }
    ;
    getAllPluginsObject() {
        const obj = {
            'factory': this,
            'audioPluginChainManagers': []
        };
        for (let i = 0; i < this.audioPluginChainManagers.length; i++) {
            obj.audioPluginChainManagers.push({
                'subFactory': this.audioPluginChainManagers[i],
                'plugins': this.audioPluginChainManagers[i].getPlugins()
            });
        }
        return obj;
    }
    ;
    createAudioPluginChainManager(chainStart, chainStop) {
        const node = new _AudioPluginChainManager_index__WEBPACK_IMPORTED_MODULE_4__.AudioPluginChainManager(this, chainStart, chainStop);
        this.audioPluginChainManagers.push(node);
        return node;
    }
    ;
    duplicateAudioPluginChainManager(sourceChainManager, chainStart, chainStop) {
        return __awaiter(this, void 0, void 0, function* () {
            const node = this.createAudioPluginChainManager(chainStart, chainStop);
            for (const plugin_object of sourceChainManager.getPlugins()) {
                const newPlugin = yield node.createPlugin(plugin_object.prototypeObject);
                newPlugin.node.parameters.setParametersByObject(plugin_object.node.parameters.getParameterObject);
            }
            return node;
        });
    }
    ;
    createMidiSynthesiserHost(factory) {
        if (factory === undefined) {
            factory = this;
        }
        const host = new _MidiSynthesiserHost__WEBPACK_IMPORTED_MODULE_5__.MidiSynthesiserHost(factory);
        this.synthesiserHosts.push(host);
        return host;
    }
    ;
    destroyMidiSynthesiserHost(host) {
        var index = this.synthesiserHosts.findIndex(function (element) {
            if (element === this) {
                return true;
            }
            return false;
        }, host);
        if (index >= 0) {
            this.synthesiserHosts.splice(index, 1);
            host.destroy();
        }
    }
    ;
    registerPluginInstance(instance) {
        if (this.pluginsList.find(p => p === instance)) {
            throw new Error("Plugin Instance not unique");
        }
        this.pluginsList.push(instance);
        if (this.audioStarted) {
            const context_time = this.context.currentTime;
            const program_time = this.getCurrentProgramTime();
            this.pluginAudioStart(instance.node, program_time, context_time);
        }
        return true;
    }
    ;
    deletePlugin(plugin) {
        const index = this.pluginsList.indexOf(plugin);
        if (index >= 0) {
            // Also check it isn't rogue attached to a plugin chain
            if ((0,_PluginInstance__WEBPACK_IMPORTED_MODULE_7__.isPluginInstance)(plugin)) {
                this.audioPluginChainManagers.forEach((subFactory) => {
                    if (subFactory.getPlugins().includes(plugin)) {
                        subFactory.removePlugin(plugin);
                    }
                });
            }
            else if ((0,_MidiSynthesisInstance__WEBPACK_IMPORTED_MODULE_8__.isMidiSynthesisInstance)(plugin)) {
                this.synthesiserHosts.forEach(host => {
                    if (host.midiSynthesiser === plugin) {
                        host.unloadSynthesiserSlot();
                    }
                });
            }
            this.pluginsList.splice(index, 1);
            plugin.node.delete();
            plugin.node.externalInterface.closeWindows();
        }
    }
    getCurrentProgramTime() {
        if (this.audioStarted) {
            return this.context.currentTime - this.audioStartContextTime + this.audioStartProgramTime;
        }
        else {
            return this.audioStartProgramTime;
        }
    }
    setCurrentProgramTime(time) {
        if (this.audioStarted) {
            throw new Error("Must stop playback to set the current program time");
        }
        if (typeof time == "number" && time >= 0) {
            this.audioStartProgramTime = time;
            this.PluginGUI.pollAllPlugins();
        }
    }
    audioStart(program_time, context_time) {
        if (context_time === undefined) {
            context_time = this.context.currentTime;
        }
        if (program_time === undefined) {
            program_time = 0;
            console.warn("Assuming start time at 0");
        }
        if (!this.audioStarted) {
            this.setCurrentProgramTime(program_time);
            this.audioStartContextTime = context_time;
            this.triggerAudioStart(program_time, context_time);
            this.audioStarted = true;
        }
    }
    audioStop() {
        if (this.audioStarted) {
            this.triggerAudioStop();
            this.audioStarted = false;
        }
    }
    createStore(storeName) {
        let node = this.findStore(storeName);
        if (node === undefined) {
            node = new _LinkedStore__WEBPACK_IMPORTED_MODULE_0__.LinkedStore(storeName);
            this.stores.push(node);
        }
        return node;
    }
    ;
    getStores() {
        return this.stores;
    }
    ;
    findStore(storeName) {
        return this.stores.find(a => a.name === storeName);
    }
    ;
    createFactoryCopy(context) {
        return this.copyFactory(this, context);
    }
    get hasAudioStarted() { return this.audioStarted; }
    get pluginRootURL() { return this.rootURL; }
    set pluginRootURL(t) { this.rootURL = t; }
    get subFactories() { return this.audioPluginChainManagers; }
}


/***/ }),

/***/ "./src/Factory/PluginInstance.ts":
/*!***************************************!*\
  !*** ./src/Factory/PluginInstance.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginInstance": () => (/* binding */ PluginInstance),
/* harmony export */   "isPluginInstance": () => (/* binding */ isPluginInstance)
/* harmony export */ });
/* harmony import */ var _BasePlugin_AudioPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../BasePlugin/AudioPlugin */ "./src/BasePlugin/AudioPlugin.ts");
/* jshint esversion: 6 */

/* jshint esversion: 6 */
class PluginInstance {
    constructor(node) {
        this.node = node;
        this._bypassed = false;
        this.ev = new EventTarget();
        this._in = this.node.context.createGain();
        this._out = this.node.context.createGain();
        this._in.connect(this.node.getInputs()[0]);
        this.node.getOutputs()[0].connect(this._out);
        this.node.addEventListener("parameterset", this);
        this.node.addEventListener("alterdelay", this);
    }
    bypassEnable() {
        this._in.disconnect();
        this._in.connect(this._out);
        this.node.getOutputs()[0].disconnect(this._out);
        this._bypassed = true;
        if (this.node.processingDelayAsSamples != 0) {
            this.ev.dispatchEvent(new Event("alterdelay"));
        }
        this.ev.dispatchEvent(new Event("bypassed"));
    }
    bypassDisable() {
        this._in.disconnect();
        this._in.connect(this.node.getInputs()[0]);
        this.node.getOutputs()[0].connect(this._out);
        this._bypassed = false;
        if (this.node.processingDelayAsSamples != 0) {
            this.ev.dispatchEvent(new Event("alterdelay"));
        }
        this.ev.dispatchEvent(new Event("bypassed"));
    }
    bypass(state) {
        state = (state === true);
        if (state === this._bypassed) {
            return this._bypassed;
        }
        if (state) {
            this.bypassEnable();
        }
        else {
            this.bypassDisable();
        }
        return this._bypassed;
    }
    isBypassed() {
        return this._bypassed;
    }
    reconnect(new_next) {
        this.connect(new_next);
    }
    connect(new_next) {
        if (this.next_node !== undefined) {
            this.disconnect();
        }
        if (new_next !== undefined && new_next.input !== undefined) {
            this.next_node = new_next;
            this._out.connect(this.next_node.input);
            return true;
        }
        return false;
    }
    disconnect() {
        if (this.next_node !== undefined) {
            this._out.disconnect(this.next_node.input);
            this.next_node = undefined;
        }
    }
    destroy() {
        this.node.destroy();
        this.node.removeEventListener("parameterset", this);
        this.node.removeEventListener("alterdelay", this);
    }
    handleEvent(e) {
        this.ev.dispatchEvent(new Event(e.type));
    }
    addEventListener(type, listener, options) {
        return this.ev.addEventListener(type, listener, options);
    }
    removeEventListener(type, listener, options) {
        return this.ev.removeEventListener(type, listener, options);
    }
    get input() { return this._in; }
    get output() { return this._out; }
    get bypassed() { return this._bypassed; }
    get prototypeObject() { return this.node.prototypeObject; }
    get externalInterface() { return this.node.externalInterface; }
}
function isPluginInstance(object) {
    return object.node instanceof _BasePlugin_AudioPlugin__WEBPACK_IMPORTED_MODULE_0__.AudioPlugin;
}


/***/ }),

/***/ "./src/Factory/PluginPrototype.ts":
/*!****************************************!*\
  !*** ./src/Factory/PluginPrototype.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginPrototype": () => (/* binding */ PluginPrototype),
/* harmony export */   "SynthesiserPrototype": () => (/* binding */ SynthesiserPrototype)
/* harmony export */ });
/* harmony import */ var _PluginInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PluginInstance */ "./src/Factory/PluginInstance.ts");
/* harmony import */ var _MidiSynthesisInstance__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MidiSynthesisInstance */ "./src/Factory/MidiSynthesisInstance.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* jshint esversion: 6 */


class BasePluginPrototype {
    constructor(proto, factory) {
        this.proto = proto;
        this.factory = factory;
    }
    get name() { return this.proto.prototype.name; }
    get version() { return this.proto.prototype.version; }
    get uniqueID() { return this.proto.prototype.uniqueID; }
    get hasMidiInput() { return (this.proto.prototype.hasMidiInput || false); }
    get hasMidiOutput() { return (this.proto.prototype.hasMidiOutput || false); }
}
class PluginPrototype extends BasePluginPrototype {
    constructor(proto, factory) {
        super(proto, factory);
        this.proto = proto;
        this.factory = factory;
    }
    createPluginInstance(owner) {
        return __awaiter(this, void 0, void 0, function* () {
            const plugin = new this.proto(this.factory, owner);
            if (plugin.initialise) {
                yield plugin.initialise();
            }
            const node = new _PluginInstance__WEBPACK_IMPORTED_MODULE_0__.PluginInstance(plugin);
            this.factory.registerPluginInstance(node);
            return node;
        });
    }
}
class SynthesiserPrototype extends BasePluginPrototype {
    constructor(proto, factory) {
        super(proto, factory);
        this.proto = proto;
        this.factory = factory;
    }
    createPluginInstance(owner) {
        return __awaiter(this, void 0, void 0, function* () {
            const plugin = new this.proto(this.factory, owner);
            if (plugin.initialise) {
                yield plugin.initialise();
            }
            const node = new _MidiSynthesisInstance__WEBPACK_IMPORTED_MODULE_1__.MidiSynthesisInstance(plugin);
            this.factory.registerPluginInstance(node);
            return node;
        });
    }
}


/***/ }),

/***/ "./src/Factory/PluginUserInterfaceMessageHub.ts":
/*!******************************************************!*\
  !*** ./src/Factory/PluginUserInterfaceMessageHub.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PluginUserInterfaceMessageHub": () => (/* binding */ PluginUserInterfaceMessageHub)
/* harmony export */ });
/* jshint esversion: 6 */
class PluginUserInterfaceMessageHub {
    constructor(factory) {
        this.factory = factory;
        this.default_interface = {
            src: "jsap_default.html",
            width: "500px",
            height: "500px"
        };
    }
    buildPluginInterface(plugin_object, interface_object) {
        const iframe = document.createElement("iframe");
        iframe.src = interface_object.src;
        if (interface_object.width) {
            iframe.width = interface_object.width;
        }
        if (interface_object.height) {
            iframe.height = interface_object.height;
        }
        iframe.style.border = "0";
        //iframe.contentWindow.pluginInstance = plugin_object;
        return iframe;
    }
    spawnPluginWindow(plugin_object, interface_object, opts) {
        const w = window.open(interface_object.src, plugin_object.name, opts);
        plugin_object.externalInterface.registerWindow(w);
        return w;
    }
    setDefaultInterface(src, width, height) {
        this.default_interface = {
            src: src,
            width: width,
            height: height
        };
        return this.default_interface;
    }
    pollAllPlugins() {
        this.factory.getAllPlugins().forEach(function (plugin) {
            plugin.node.externalInterface.updateInterfaces(true);
        });
    }
}


/***/ }),

/***/ "./src/LinkedStore.ts":
/*!****************************!*\
  !*** ./src/LinkedStore.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LinkedStore": () => (/* binding */ LinkedStore)
/* harmony export */ });
// Store for the semantic terms, each store holds its own data tree
// Terms are added as key/value paris to a root node
class LinkedStore {
    constructor(storeName) {
        this.storeName = storeName;
        this.et = new EventTarget();
    }
    objectToXML(obj, root, doc) {
        // Used if an object was passed as a term value
        for (const term of obj.keys()) {
            if (obj.hasOwnProperty(term)) {
                const entry = obj[term];
                if (typeof entry === "string") {
                    root.setAttribute(term, entry);
                }
                else if (typeof entry == "number") {
                    root.setAttribute(term, entry.toString());
                }
                else {
                    let docNode;
                    if (entry instanceof LinkedStore) {
                        docNode = entry.toXML(doc);
                    }
                    else {
                        docNode = doc.createElement(term);
                        root.appendChild(docNode);
                        if (entry instanceof Array) {
                            this.arrayToXML(entry, docNode, doc);
                        }
                        else {
                            this.objectToXML(entry, docNode, doc);
                        }
                    }
                    root.appendChild(docNode);
                }
            }
        }
    }
    arrayToXML(arr, root, doc) {
        // Used to convert an array to a list of XML entries
        var all_numbers = true, all_strings = true, i, l = arr.length;
        all_numbers = arr.every(function (a) {
            return typeof a === "number";
        });
        all_strings = arr.every(function (a) {
            return typeof a === "string";
        });
        if (all_numbers || all_strings) {
            // An array of numbers or strings
            arr.forEach(function (a, i) {
                root.setAttribute("index-" + i, a);
            });
        }
        else {
            // An array of objects
            arr.forEach(function (a, i) {
                var node = document.createElement("value");
                node.setAttribute("index", i);
                this.objectToXML(a, node, doc);
                root.appendChild(node);
            });
        }
    }
    addEventListener(type, listener, options) {
        return this.et.addEventListener(type, listener, options);
    }
    removeEventListener(type, callback, options) {
        return this.et.removeEventListener(type, callback, options);
    }
    setTerm(term, value) {
        if (typeof term !== "string" || term.length === 0) {
            throw ("term must be a string");
        }
        this.root.set(term, value);
        this.et.dispatchEvent(new CustomEvent("altered", { detail: { term: term, value: value } }));
    }
    setTerms(termsObject) {
        if (typeof termsObject !== "object") {
            throw ("setTerms takes an object of term/value pairs");
        }
        for (const term in termsObject) {
            if (termsObject.hasOwnProperty(term)) {
                this.setTerm(term, termsObject[term]);
            }
        }
    }
    deleteTerm(term) {
        this.setTerm(term, undefined);
    }
    getTerm(term) {
        if (typeof term !== "string" || term.length === 0) {
            throw ("term must be a string");
        }
        return this.root.get(term);
    }
    hasTerm(term) {
        if (typeof term !== "string" || term.length === 0) {
            throw ("term must be a string");
        }
        return this.root.has(term);
    }
    toJSON() {
        return JSON.parse(JSON.stringify(this.root));
    }
    toXML(doc) {
        let node;
        if (!doc) {
            doc = document.implementation.createDocument(null, this.storeName, null);
            node = doc.firstElementChild;
        }
        else {
            node = doc.createElement(this.storeName);
        }
        this.objectToXML(this.root, node, doc);
        return node;
    }
    get name() {
        return this.storeName;
    }
    set name(newName) {
        if (this.storeName !== undefined) {
            throw new Error("Name is already set");
        }
        this.storeName = newName;
    }
}


/***/ }),

/***/ "./src/SynthesiserBasePlugin/index.ts":
/*!********************************************!*\
  !*** ./src/SynthesiserBasePlugin/index.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesiserBasePlugin": () => (/* binding */ SynthesiserBasePlugin),
/* harmony export */   "isSynthesiserBasePlugin": () => (/* binding */ isSynthesiserBasePlugin)
/* harmony export */ });
/* harmony import */ var _BasePlugin_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../BasePlugin/index */ "./src/BasePlugin/index.ts");
/* jshint esversion: 6 */

class SynthesiserBasePlugin extends _BasePlugin_index__WEBPACK_IMPORTED_MODULE_0__.BasePlugin {
    constructor(factory, pluginOwner, prototypeObject) {
        super(factory, pluginOwner, prototypeObject);
        this.factory = factory;
        this.prototypeObject = prototypeObject;
        this.hasWarnedScheduleNotSet = false;
        this.hasWarnedCancelNotSet = false;
        this.editorType = "roll";
    }
    stop() {
        this.cancelAllEvents();
    }
    addInput() {
        throw new Error("Cannot add input to type \"SynthesiserBasePlugin\"");
    }
    deleteInput() {
        throw new Error("Cannot delete input to type \"SynthesiserBasePlugin\"");
    }
    scheduleEvent(msg, contextTime) {
        if (!this.hasWarnedScheduleNotSet) {
            console.warn("WARNING - .scheduleEvent is not overridden");
            this.hasWarnedScheduleNotSet = true;
        }
    }
    cancelAllEvents(contextTime) {
        if (!this.hasWarnedCancelNotSet) {
            console.warn("WARNING - .cancelAllEvents is not overridden");
            this.hasWarnedCancelNotSet = true;
        }
    }
    setEditorType(type) {
        if (type == "roll" || type == "line" || type == "sequencer") {
            this.editorType = type;
        }
        return this.editorType;
    }
    getEditorType() { return this.editorType; }
    isNoteActive(n) {
        if (typeof n == "number" && n >= 0 && n < 128) {
            return true;
        }
        else {
            return false;
        }
    }
    getActiveNoteProperties() {
        const obj = [];
        for (var n = 0; n < 128; n++) {
            obj.push({
                code: n,
                name: this.midiNoteToName(n)
            });
        }
        return obj;
    }
    midiNoteToFrequency(m) {
        return Math.pow(2.0, (m - 69) / 12) * 440;
    }
    frequencyToMidiNote(f) {
        return Math.round(12.0 * Math.log2(f / 440)) + 69;
    }
    midiNoteToName(m) {
        const notes = ["A", "A#", "B", "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#"];
        const root = m - 21;
        const octave = Math.floor(root / 12);
        const note = Math.floor((root + 36) % 12);
        return notes[note] + String(octave);
    }
    noteNameToMidi(n) {
        const notes = ["A", "A#", "B", "C", "C#", "D", "D#", "E", "F", "F#", "G", "G#"];
        const octave = Number(n.slice(n.length - 1));
        const note = notes.indexOf(n.slice(0, n.length - 1));
        return octave * 12 + note + 21;
    }
    noteNameToMIDI(n) {
        return this.noteNameToMidi;
    }
}
function isSynthesiserBasePlugin(object) {
    return object.inputs.length === 0 && object.outputs.length > 0 && `scheduleEvent` in object;
}


/***/ }),

/***/ "./src/utility/uniqueMergeArray.ts":
/*!*****************************************!*\
  !*** ./src/utility/uniqueMergeArray.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "uniqueMergeArray": () => (/* binding */ uniqueMergeArray)
/* harmony export */ });
function uniqueMergeArray(a, b) {
    const output = [];
    for (const entry of a) {
        if (output.includes(entry) === false) {
            output.push(entry);
        }
    }
    for (const entry of b) {
        if (output.includes(entry) === false) {
            output.push(entry);
        }
    }
    return output;
}


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioPlugin": () => (/* reexport safe */ _BasePlugin_AudioPlugin__WEBPACK_IMPORTED_MODULE_3__.AudioPlugin),
/* harmony export */   "BasePlugin": () => (/* reexport safe */ _BasePlugin_index__WEBPACK_IMPORTED_MODULE_0__.BasePlugin),
/* harmony export */   "SynthesiserBasePlugin": () => (/* reexport safe */ _SynthesiserBasePlugin_index__WEBPACK_IMPORTED_MODULE_1__.SynthesiserBasePlugin),
/* harmony export */   "PluginFactory": () => (/* reexport safe */ _Factory_PluginFactory__WEBPACK_IMPORTED_MODULE_2__.PluginFactory)
/* harmony export */ });
/* harmony import */ var _BasePlugin_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BasePlugin/index */ "./src/BasePlugin/index.ts");
/* harmony import */ var _SynthesiserBasePlugin_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SynthesiserBasePlugin/index */ "./src/SynthesiserBasePlugin/index.ts");
/* harmony import */ var _Factory_PluginFactory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Factory/PluginFactory */ "./src/Factory/PluginFactory.ts");
/* harmony import */ var _BasePlugin_AudioPlugin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BasePlugin/AudioPlugin */ "./src/BasePlugin/AudioPlugin.ts");
// This defines a master object for holding all the plugins and communicating
// This object will also handle creation and destruction of plugins
/*globals Promise, document, console, LinkedStore, Worker, window, XMLHttpRequest */
/*eslint-env browser */
/* jshint esversion:6 */






})();

JSAP = __webpack_exports__;
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mcmVlRkZULmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FtZGYuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfYXBwbHlfd2luZG93LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FycmF5X2JvdW5kLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FycmF5X2NvcHkuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfZGVpbnRlcmxhY2UuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfaW50ZXJsYWNlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FycmF5X21heC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9hcnJheV9taW4uanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfbm9ybWFsaXNlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FycmF5X3NjYWxlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FycmF5X3N1bS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9hcnJheV90b19KU09OLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2FzZGYuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfYXNzZXJ0X2FycmF5LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2F1dG9jb3JyZWxhdGlvbi5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9hdmVyYWdlX2RldmlhdGlvbi5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9iYXJrX2NvZWZmaWNpZW50cy5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9jaHJvbWEuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfY29tcGxleF9zcGVjdHJ1bS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9jcmVhdGVfd2luZG93LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2NyZXN0LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2RjdC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9kY3RfMi5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9lbmVyZ3kuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZjAuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZmFpbHNhZmVfZjAuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZmxhdG5lc3MuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZmxhdG5lc3NfZGIuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZnJhbWVfZnJvbV9hcnJheS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9nZXRfZGF0YV9mcmFtZXMuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfZ2V0X251bWJlcl9vZl9mcmFtZXMuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaGFybW9uaWNfc3BlY3RydW0uanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaGlnaGVzdF92YWx1ZS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9ocHMuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9iYXJrLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2luaXRfY2hyb21hLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2luaXRfZGN0LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2luaXRfZGZ0LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2luaXRfbWZjYy5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9pbml0X3BjcC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9pbml0X3dhdmVsZXQuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaXJyZWd1bGFyaXR5X2ouanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaXJyZWd1bGFyaXR5X2suanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfaXNfZGVub3JtYWwuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfa3VydG9zaXMuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfbG91ZG5lc3MuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfbG93ZXN0X3ZhbHVlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2xvd2hpZ2guanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfbHBjLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X2xwY2MuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3RfbWVhbi5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9tZmNjLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X21pZGljZW50LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X25vaXNpbmVzcy5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9ub256ZXJvX2NvdW50LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X29kZF9ldmVuX3JhdGlvLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X29uc2V0LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3BjcC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9wZWFrX3NwZWN0cnVtLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3Bvd2VyLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3Byb2Nlc3NfZnJhbWVfZGF0YS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9yZXNhbXBsZS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9ybXNfYW1wbGl0dWRlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3JvbGxvZmYuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc2hhcnBuZXNzLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3NrZXduZXNzLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3NrZXduZXNzX2t1cnRvc2lzLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3Ntb290aG5lc3MuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWQuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfZnVuZGFtZW50YWwuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9rdXJ0b3Npcy5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9tZWFuLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX3NrZXduZXNzLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX3Nsb3BlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX3NwcmVhZC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24uanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2UuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RydW0uanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2Z1bmN0aW9ucy94dHJhY3Rfc3RhbmRhcmRfZGV2aWF0aW9uLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3N1bS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF90ZW1wb3JhbF9jZW50cm9pZC5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF90b25hbGl0eS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF90cmlzdGltdWx1cy5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF92YXJpYW5jZS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF93YXZlbGV0X2YwLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9mdW5jdGlvbnMveHRyYWN0X3lpbi5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvZnVuY3Rpb25zL3h0cmFjdF96Y3IuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL2luZGV4LmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9vYmplY3RzL0NvbW1vbk1lbW9yeS5qcyIsIndlYnBhY2s6Ly9KU0FQL2pzWHRyYWN0L21vZHVsZXMvb2JqZWN0cy9EYXRhUHJvdG90eXBlLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9vYmplY3RzL0hhcm1vbmljU3BlY3RydW1EYXRhLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9vYmplY3RzL1BlYWtTcGVjdHJ1bURhdGEuanMiLCJ3ZWJwYWNrOi8vSlNBUC9qc1h0cmFjdC9tb2R1bGVzL29iamVjdHMvU3BlY3RydW1EYXRhLmpzIiwid2VicGFjazovL0pTQVAvanNYdHJhY3QvbW9kdWxlcy9vYmplY3RzL1RpbWVEYXRhLmpzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvTm90aWZpY2F0aW9uRmFjdG9yaWVzLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvT2JzZXJ2YWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL1N1YnNjcmliZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9TdWJzY3JpcHRpb24udHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9jb25maWcudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb20udHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb21BcnJheS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL29ic2VydmFibGUvb2YudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVBcnJheS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3NjaGVkdWxlZC9zY2hlZHVsZUFzeW5jSXRlcmFibGUudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVJdGVyYWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3NjaGVkdWxlZC9zY2hlZHVsZU9ic2VydmFibGUudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVQcm9taXNlLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvc2NoZWR1bGVkL3NjaGVkdWxlUmVhZGFibGVTdHJlYW1MaWtlLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvc2NoZWR1bGVkL3NjaGVkdWxlZC50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3NjaGVkdWxlci90aW1lb3V0UHJvdmlkZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zeW1ib2wvaXRlcmF0b3IudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9zeW1ib2wvb2JzZXJ2YWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvVW5zdWJzY3JpcHRpb25FcnJvci50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvYXJncy50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvYXJyUmVtb3ZlLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvdXRpbC9jYXVnaHRTY2hlZHVsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvY3JlYXRlRXJyb3JDbGFzcy50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvZXJyb3JDb250ZXh0LnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvdXRpbC9pZGVudGl0eS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNBcnJheUxpa2UudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC91dGlsL2lzQXN5bmNJdGVyYWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNGdW5jdGlvbi50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNJbnRlcm9wT2JzZXJ2YWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNJdGVyYWJsZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNQcm9taXNlLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvdXRpbC9pc1JlYWRhYmxlU3RyZWFtTGlrZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vbm9kZV9tb2R1bGVzL3J4anMvc3JjL2ludGVybmFsL3V0aWwvaXNTY2hlZHVsZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC91dGlsL25vb3AudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC91dGlsL3BpcGUudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL25vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC91dGlsL3JlcG9ydFVuaGFuZGxlZEVycm9yLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvcnhqcy9zcmMvaW50ZXJuYWwvdXRpbC90aHJvd1Vub2JzZXJ2YWJsZUVycm9yLnRzIiwid2VicGFjazovL0pTQVAvLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9BdWRpb1BsdWdpbi50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0Jhc2VQbHVnaW4vTGlua2VkU3RvcmVJbnRlcmZhY2UudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL1BhcmFtZXRlck1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2UvUGx1Z2luRmVhdHVyZUludGVyZmFjZVJlY2VpdmVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9QbHVnaW5GZWF0dXJlSW50ZXJmYWNlL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2VTZW5kZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2UvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL1BsdWdpbkludGVyZmFjZU1lc3NhZ2VIdWIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL2luZGV4LnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9wYXJhbWV0ZXJzL0Fzc2V0UGFyYW1ldGVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9wYXJhbWV0ZXJzL0J1dHRvblBhcmFtZXRlci50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0Jhc2VQbHVnaW4vcGFyYW1ldGVycy9JUGx1Z2luUGFyYW1ldGVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9wYXJhbWV0ZXJzL0xpc3RQYXJhbWV0ZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL3BhcmFtZXRlcnMvTnVtYmVyUGFyYW1ldGVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9wYXJhbWV0ZXJzL1BhcmFtZXRlckF1dG9tYXRpb24udHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL3BhcmFtZXRlcnMvUGx1Z2luUGFyYW1ldGVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvQmFzZVBsdWdpbi9wYXJhbWV0ZXJzL1N0cmluZ1BhcmFtZXRlci50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0Jhc2VQbHVnaW4vcGFyYW1ldGVycy9Td2l0Y2hQYXJhbWV0ZXIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9CYXNlUGx1Z2luL3BhcmFtZXRlcnMvVVJMUGFyYW1ldGVyLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvRmFjdG9yeS9BdWRpb1BsdWdpbkNoYWluTWFuYWdlci9TdWJGYWN0b3J5RmVhdHVyZVNlbmRlci9pbmRleC50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXIvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L0V4dHJhY3RvcnMvRXh0cmFjdG9yLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvRmFjdG9yeS9FeHRyYWN0b3JzL091dHB1dE5vZGUudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L0V4dHJhY3RvcnMvV29ya2VyRXh0cmFjdG9yLnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvRmFjdG9yeS9GZWF0dXJlTWFwL2luZGV4LnRzIiwid2VicGFjazovL0pTQVAvLi9zcmMvRmFjdG9yeS9NaWRpU3ludGhlc2lzSW5zdGFuY2UudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L01pZGlTeW50aGVzaXNlckhvc3QudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L1BsdWdpbkFzc2V0cy9QbHVnaW5Bc3NldC50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvUGx1Z2luQXNzZXRzL1BsdWdpbkFzc2V0TWFuYWdlci50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvUGx1Z2luQXNzZXRzL1BsdWdpbkFzc2V0c0xpc3QudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L1BsdWdpbkFzc2V0cy9kZWZhdWx0QXNzZXRGZXRjaC50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvUGx1Z2luRmFjdG9yeS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvUGx1Z2luSW5zdGFuY2UudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9GYWN0b3J5L1BsdWdpblByb3RvdHlwZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL0ZhY3RvcnkvUGx1Z2luVXNlckludGVyZmFjZU1lc3NhZ2VIdWIudHMiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9MaW5rZWRTdG9yZS50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL1N5bnRoZXNpc2VyQmFzZVBsdWdpbi9pbmRleC50cyIsIndlYnBhY2s6Ly9KU0FQLy4vc3JjL3V0aWxpdHkvdW5pcXVlTWVyZ2VBcnJheS50cyIsIndlYnBhY2s6Ly9KU0FQL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0pTQVAvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vSlNBUC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vSlNBUC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL0pTQVAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9KU0FQL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vSlNBUC8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQSxJQUFJLElBQXlEO0FBQzdEO0FBQ0EsTUFBTSxFQUt5QjtBQUMvQixDQUFDO0FBQ0QsTztRQ1ZBO1FBQ0E7O1FBRUE7UUFDQSxXQUFXLDhCQUFtQjs7UUFFOUI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7O1FBRUE7UUFDQSxrRUFBa0UsOEJBQW1COztRQUVyRjtRQUNBOztRQUVBO1FBQ0E7UUFDQTs7O1FBR0E7UUFDQSxFQUFFLDhCQUFtQjs7UUFFckI7UUFDQSxFQUFFLDhCQUFtQjs7UUFFckI7UUFDQSxFQUFFLDhCQUFtQjtRQUNyQixPQUFPLDhCQUFtQjtRQUMxQiwwQ0FBMEMsZ0NBQWdDO1FBQzFFO1FBQ0E7O1FBRUE7UUFDQSxFQUFFLDhCQUFtQjtRQUNyQjtRQUNBLHdEQUF3RCxrQkFBa0I7UUFDMUU7UUFDQSxpREFBaUQsY0FBYztRQUMvRDs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0EsRUFBRSw4QkFBbUI7UUFDckIsd0JBQXdCLDhCQUFtQjtRQUMzQztRQUNBO1FBQ0E7UUFDQSxHQUFHLDhCQUFtQjtRQUN0Qix5Q0FBeUMsaUNBQWlDO1FBQzFFLGtFQUFrRSw4QkFBbUIsMkJBQTJCLG1CQUFtQixFQUFFO1FBQ3JJO1FBQ0E7O1FBRUE7UUFDQSxFQUFFLDhCQUFtQjtRQUNyQjtRQUNBLDJCQUEyQiwwQkFBMEIsRUFBRTtRQUN2RCxpQ0FBaUMsZUFBZTtRQUNoRCxHQUFHLDhCQUFtQjtRQUN0QjtRQUNBOztRQUVBO1FBQ0EsRUFBRSw4QkFBbUIsaUNBQWlDLCtEQUErRDs7UUFFckg7UUFDQSxFQUFFLDhCQUFtQjs7O1FBR3JCO1FBQ0EsU0FBUyw4QkFBbUIsQ0FBQyw4QkFBbUI7Ozs7Ozs7Ozs7Ozs7QUNsRmhEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFB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QUNBOzs7Ozs7Ozs7Ozs7O0FDdEJBO0FBQUE7QUFBQTtBQUFBO0FBQzBEO0FBQ25EO0FBQ1AsU0FBUyxnRkFBbUI7QUFDNUI7QUFDQTtBQUNBLG1CQUFtQixzQkFBc0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDWkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFd0M7QUFHQztBQUdXO0FBR2Q7QUFHQztBQUdEO0FBR0E7QUFHRTtBQUdJO0FBR0o7QUFHSTtBQUdFO0FBR0c7QUFHTDtBQUdHO0FBR0w7QUFHRztBQUdaO0FBR2E7QUFHVDtBQUdVO0FBR0Q7QUFHQTtBQUdUO0FBR0E7QUFHUztBQUdKO0FBR0k7QUFHRjtBQUdZO0FBR1Y7QUFHQTtBQUdIO0FBR0E7QUFNSDtBQUdEO0FBR1A7QUFHSTtBQUdDO0FBR0E7QUFHRztBQUdIO0FBR0g7QUFHSTtBQUdJO0FBR1M7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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDMUJPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUkE7QUFDb0Q7QUFDWTtBQUN6RCw0QkFBNEIsNkRBQWU7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLFVBQVU7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MseUVBQXVCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoS0E7QUFDb0Q7QUFDYztBQUMzRCw4QkFBOEIsNkRBQWU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsMkVBQXlCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDRCQUE0QjtBQUN2RCx1QkFBdUIsc0NBQXNDO0FBQzdELDRCQUE0Qix3QkFBd0I7QUFDcEQsbUJBQW1CLFFBQVEsK0VBQStFO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLHFCQUFxQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FDOVBPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixPQUFPO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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OztBQ2xGTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O1VDYkE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7Ozs7V0N0QkE7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLGdDQUFnQyxZQUFZO1dBQzVDO1dBQ0EsRTs7Ozs7V0NQQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLHdDQUF3Qyx5Q0FBeUM7V0FDakY7V0FDQTtXQUNBLEU7Ozs7O1dDUEE7V0FDQTtXQUNBO1dBQ0E7V0FDQSxFQUFFO1dBQ0Y7V0FDQTtXQUNBLENBQUMsSTs7Ozs7V0NQRCx3Rjs7Ozs7V0NBQTtXQUNBO1dBQ0E7V0FDQSxzREFBc0Qsa0JBQWtCO1dBQ3hFO1dBQ0EsK0NBQStDLGNBQWM7V0FDN0QsRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDZ0Q7QUFDc0I7QUFDZDtBQUNEO0FBQ2tCIiwiZmlsZSI6Ii4vSlNBUC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImpzWHRyYWN0XCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImpzWHRyYWN0XCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi9tb2R1bGVzL2luZGV4LmpzXCIpO1xuIiwiLypcbiAqIEZyZWUgRkZUIGFuZCBjb252b2x1dGlvbiAoSmF2YVNjcmlwdClcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUHJvamVjdCBOYXl1a2lcbiAqIGh0dHBzOi8vd3d3Lm5heXVraS5pby9wYWdlL2ZyZWUtc21hbGwtZmZ0LWluLW11bHRpcGxlLWxhbmd1YWdlc1xuICpcbiAqIChNSVQgTGljZW5zZSlcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mXG4gKiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sXG4gKiBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqIC0gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqICAgYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiAtIFRoZSBTb2Z0d2FyZSBpcyBwcm92aWRlZCBcImFzIGlzXCIsIHdpdGhvdXQgd2FycmFudHkgb2YgYW55IGtpbmQsIGV4cHJlc3Mgb3JcbiAqICAgaW1wbGllZCwgaW5jbHVkaW5nIGJ1dCBub3QgbGltaXRlZCB0byB0aGUgd2FycmFudGllcyBvZiBtZXJjaGFudGFiaWxpdHksXG4gKiAgIGZpdG5lc3MgZm9yIGEgcGFydGljdWxhciBwdXJwb3NlIGFuZCBub25pbmZyaW5nZW1lbnQuIEluIG5vIGV2ZW50IHNoYWxsIHRoZVxuICogICBhdXRob3JzIG9yIGNvcHlyaWdodCBob2xkZXJzIGJlIGxpYWJsZSBmb3IgYW55IGNsYWltLCBkYW1hZ2VzIG9yIG90aGVyXG4gKiAgIGxpYWJpbGl0eSwgd2hldGhlciBpbiBhbiBhY3Rpb24gb2YgY29udHJhY3QsIHRvcnQgb3Igb3RoZXJ3aXNlLCBhcmlzaW5nIGZyb20sXG4gKiAgIG91dCBvZiBvciBpbiBjb25uZWN0aW9uIHdpdGggdGhlIFNvZnR3YXJlIG9yIHRoZSB1c2Ugb3Igb3RoZXIgZGVhbGluZ3MgaW4gdGhlXG4gKiAgIFNvZnR3YXJlLlxuICovXG5cblxuLypcbiAqIENvbXB1dGVzIHRoZSBkaXNjcmV0ZSBGb3VyaWVyIHRyYW5zZm9ybSAoREZUKSBvZiB0aGUgZ2l2ZW4gY29tcGxleCB2ZWN0b3IsIHN0b3JpbmcgdGhlIHJlc3VsdCBiYWNrIGludG8gdGhlIHZlY3Rvci5cbiAqIFRoZSB2ZWN0b3IgY2FuIGhhdmUgYW55IGxlbmd0aC4gVGhpcyBpcyBhIHdyYXBwZXIgZnVuY3Rpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2Zvcm0ocmVhbCwgaW1hZykge1xuICAgIGlmIChyZWFsLmxlbmd0aCAhPT0gaW1hZy5sZW5ndGgpXG4gICAgICAgIHRocm93IFwiTWlzbWF0Y2hlZCBsZW5ndGhzXCI7XG5cbiAgICB2YXIgbiA9IHJlYWwubGVuZ3RoO1xuICAgIGlmIChuID09PSAwKVxuICAgICAgICByZXR1cm47XG4gICAgZWxzZSBpZiAoKG4gJiAobiAtIDEpKSA9PT0gMCkgLy8gSXMgcG93ZXIgb2YgMlxuICAgICAgICB0cmFuc2Zvcm1SYWRpeDIocmVhbCwgaW1hZyk7XG4gICAgZWxzZSAvLyBNb3JlIGNvbXBsaWNhdGVkIGFsZ29yaXRobSBmb3IgYXJiaXRyYXJ5IHNpemVzXG4gICAgICAgIHRyYW5zZm9ybUJsdWVzdGVpbihyZWFsLCBpbWFnKTtcbn1cblxuXG4vKlxuICogQ29tcHV0ZXMgdGhlIGludmVyc2UgZGlzY3JldGUgRm91cmllciB0cmFuc2Zvcm0gKElERlQpIG9mIHRoZSBnaXZlbiBjb21wbGV4IHZlY3Rvciwgc3RvcmluZyB0aGUgcmVzdWx0IGJhY2sgaW50byB0aGUgdmVjdG9yLlxuICogVGhlIHZlY3RvciBjYW4gaGF2ZSBhbnkgbGVuZ3RoLiBUaGlzIGlzIGEgd3JhcHBlciBmdW5jdGlvbi4gVGhpcyB0cmFuc2Zvcm0gZG9lcyBub3QgcGVyZm9ybSBzY2FsaW5nLCBzbyB0aGUgaW52ZXJzZSBpcyBub3QgYSB0cnVlIGludmVyc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnZlcnNlVHJhbnNmb3JtKHJlYWwsIGltYWcpIHtcbiAgICB0cmFuc2Zvcm0oaW1hZywgcmVhbCk7XG59XG5cblxuLypcbiAqIENvbXB1dGVzIHRoZSBkaXNjcmV0ZSBGb3VyaWVyIHRyYW5zZm9ybSAoREZUKSBvZiB0aGUgZ2l2ZW4gY29tcGxleCB2ZWN0b3IsIHN0b3JpbmcgdGhlIHJlc3VsdCBiYWNrIGludG8gdGhlIHZlY3Rvci5cbiAqIFRoZSB2ZWN0b3IncyBsZW5ndGggbXVzdCBiZSBhIHBvd2VyIG9mIDIuIFVzZXMgdGhlIENvb2xleS1UdWtleSBkZWNpbWF0aW9uLWluLXRpbWUgcmFkaXgtMiBhbGdvcml0aG0uXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zZm9ybVJhZGl4MihyZWFsLCBpbWFnKSB7XG4gICAgLy8gSW5pdGlhbGl6YXRpb25cbiAgICBpZiAocmVhbC5sZW5ndGggIT09IGltYWcubGVuZ3RoKVxuICAgICAgICB0aHJvdyBcIk1pc21hdGNoZWQgbGVuZ3Roc1wiO1xuICAgIHZhciBuID0gcmVhbC5sZW5ndGg7XG4gICAgaWYgKG4gPT09IDEpIC8vIFRyaXZpYWwgdHJhbnNmb3JtXG4gICAgICAgIHJldHVybjtcbiAgICB2YXIgbGV2ZWxzID0gY2FsY3VsYXRlTnVtYmVyTGV2ZWxzKG4pO1xuICAgIGlmIChsZXZlbHMgPT09IC0xKVxuICAgICAgICB0aHJvdyBcIkxlbmd0aCBpcyBub3QgYSBwb3dlciBvZiAyXCI7XG4gICAgdmFyIGNvc1RhYmxlID0gbmV3IEZsb2F0NjRBcnJheShuIC8gMik7XG4gICAgdmFyIHNpblRhYmxlID0gbmV3IEZsb2F0NjRBcnJheShuIC8gMik7XG4gICAgY2FsY3VsYXRlQ29zU2luZVRhYmxlcyhjb3NUYWJsZSwgc2luVGFibGUpO1xuXG4gICAgLy8gQml0LXJldmVyc2VkIGFkZHJlc3NpbmcgcGVybXV0YXRpb25cbiAgICBiaXRSZXZlcnNlTWFwKHJlYWwsIGltYWcpO1xuXG4gICAgLy8gQ29vbGV5LVR1a2V5IGRlY2ltYXRpb24taW4tdGltZSByYWRpeC0yIEZGVFxuICAgIGZvciAodmFyIHNpemUgPSAyOyBzaXplIDw9IG47IHNpemUgKj0gMikge1xuICAgICAgICBjb29sZXlUdWtleShyZWFsLCBpbWFnLCBzaW5UYWJsZSwgY29zVGFibGUsIHNpemUpO1xuICAgIH1cblxuICAgIC8vIFJldHVybnMgdGhlIGludGVnZXIgd2hvc2UgdmFsdWUgaXMgdGhlIHJldmVyc2Ugb2YgdGhlIGxvd2VzdCAnYml0cycgYml0cyBvZiB0aGUgaW50ZWdlciAneCcuXG4gICAgZnVuY3Rpb24gcmV2ZXJzZUJpdHMoeCwgYml0cykge1xuICAgICAgICB2YXIgeSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYml0czsgaSsrKSB7XG4gICAgICAgICAgICB5ID0gKHkgPDwgMSkgfCAoeCAmIDEpO1xuICAgICAgICAgICAgeCA+Pj49IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29vbGV5VHVrZXkocmVhbCwgaW1hZywgc2luVGFibGUsIGNvc1RhYmxlLCBzaXplKSB7XG4gICAgICAgIHZhciBpLCBqLCBrO1xuICAgICAgICB2YXIgbiA9IHJlYWwubGVuZ3RoO1xuICAgICAgICB2YXIgaGFsZnNpemUgPSBzaXplIC8gMjtcbiAgICAgICAgdmFyIHRhYmxlc3RlcCA9IG4gLyBzaXplO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSArPSBzaXplKSB7XG4gICAgICAgICAgICBmb3IgKGogPSBpLCBrID0gMDsgaiA8IGkgKyBoYWxmc2l6ZTsgaisrLCBrICs9IHRhYmxlc3RlcCkge1xuICAgICAgICAgICAgICAgIHZhciB0cHJlID0gcmVhbFtqICsgaGFsZnNpemVdICogY29zVGFibGVba10gKyBpbWFnW2ogKyBoYWxmc2l6ZV0gKiBzaW5UYWJsZVtrXTtcbiAgICAgICAgICAgICAgICB2YXIgdHBpbSA9IC1yZWFsW2ogKyBoYWxmc2l6ZV0gKiBzaW5UYWJsZVtrXSArIGltYWdbaiArIGhhbGZzaXplXSAqIGNvc1RhYmxlW2tdO1xuICAgICAgICAgICAgICAgIHJlYWxbaiArIGhhbGZzaXplXSA9IHJlYWxbal0gLSB0cHJlO1xuICAgICAgICAgICAgICAgIGltYWdbaiArIGhhbGZzaXplXSA9IGltYWdbal0gLSB0cGltO1xuICAgICAgICAgICAgICAgIHJlYWxbal0gKz0gdHByZTtcbiAgICAgICAgICAgICAgICBpbWFnW2pdICs9IHRwaW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVOdW1iZXJMZXZlbHMoTikge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDMyOyBpKyspIHtcbiAgICAgICAgICAgIGlmICgxIDw8IGkgPT09IE4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYml0UmV2ZXJzZU1hcChyZWFsLCBpbWFnKSB7XG4gICAgICAgIHZhciBpLCBqLCB0ZW1wO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBqID0gcmV2ZXJzZUJpdHMoaSwgbGV2ZWxzKTtcbiAgICAgICAgICAgIGlmIChqID4gaSkge1xuICAgICAgICAgICAgICAgIHRlbXAgPSByZWFsW2ldO1xuICAgICAgICAgICAgICAgIHJlYWxbaV0gPSByZWFsW2pdO1xuICAgICAgICAgICAgICAgIHJlYWxbal0gPSB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBpbWFnW2ldO1xuICAgICAgICAgICAgICAgIGltYWdbaV0gPSBpbWFnW2pdO1xuICAgICAgICAgICAgICAgIGltYWdbal0gPSB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlQ29zU2luZVRhYmxlcyhjb3NUYWJsZSwgc2luVGFibGUpIHtcbiAgICAgICAgdmFyIG4gPSBjb3NUYWJsZS5sZW5ndGgsXG4gICAgICAgICAgICBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBjb3NUYWJsZVtpXSA9IE1hdGguY29zKE1hdGguUEkgKiBpIC8gbik7XG4gICAgICAgICAgICBzaW5UYWJsZVtpXSA9IE1hdGguc2luKE1hdGguUEkgKiBpIC8gbik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuLypcbiAqIENvbXB1dGVzIHRoZSBkaXNjcmV0ZSBGb3VyaWVyIHRyYW5zZm9ybSAoREZUKSBvZiB0aGUgZ2l2ZW4gY29tcGxleCB2ZWN0b3IsIHN0b3JpbmcgdGhlIHJlc3VsdCBiYWNrIGludG8gdGhlIHZlY3Rvci5cbiAqIFRoZSB2ZWN0b3IgY2FuIGhhdmUgYW55IGxlbmd0aC4gVGhpcyByZXF1aXJlcyB0aGUgY29udm9sdXRpb24gZnVuY3Rpb24sIHdoaWNoIGluIHR1cm4gcmVxdWlyZXMgdGhlIHJhZGl4LTIgRkZUIGZ1bmN0aW9uLlxuICogVXNlcyBCbHVlc3RlaW4ncyBjaGlycCB6LXRyYW5zZm9ybSBhbGdvcml0aG0uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2Zvcm1CbHVlc3RlaW4ocmVhbCwgaW1hZykge1xuICAgIC8vIEZpbmQgYSBwb3dlci1vZi0yIGNvbnZvbHV0aW9uIGxlbmd0aCBtIHN1Y2ggdGhhdCBtID49IG4gKiAyICsgMVxuICAgIGlmIChyZWFsLmxlbmd0aCAhPT0gaW1hZy5sZW5ndGgpXG4gICAgICAgIHRocm93IFwiTWlzbWF0Y2hlZCBsZW5ndGhzXCI7XG4gICAgdmFyIGksIGo7XG4gICAgdmFyIG4gPSByZWFsLmxlbmd0aDtcbiAgICB2YXIgbSA9IDE7XG4gICAgd2hpbGUgKG0gPCBuICogMiArIDEpXG4gICAgICAgIG0gKj0gMjtcblxuICAgIC8vIFRyaWdub21ldHJpYyB0YWJsZXNcbiAgICB2YXIgY29zVGFibGUgPSBuZXcgRmxvYXQ2NEFycmF5KG4pO1xuICAgIHZhciBzaW5UYWJsZSA9IG5ldyBGbG9hdDY0QXJyYXkobik7XG4gICAgKGZ1bmN0aW9uIChjb3NUYWJsZSwgc2luVGFibGUpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgaiA9IGkgKiBpICUgKG4gKiAyKTsgLy8gVGhpcyBpcyBtb3JlIGFjY3VyYXRlIHRoYW4gaiA9IGkgKiBpXG4gICAgICAgICAgICBjb3NUYWJsZVtpXSA9IE1hdGguY29zKE1hdGguUEkgKiBqIC8gbik7XG4gICAgICAgICAgICBzaW5UYWJsZVtpXSA9IE1hdGguc2luKE1hdGguUEkgKiBqIC8gbik7XG4gICAgICAgIH1cbiAgICB9KShjb3NUYWJsZSwgc2luVGFibGUpO1xuXG4gICAgLy8gVGVtcG9yYXJ5IHZlY3RvcnMgYW5kIHByZXByb2Nlc3NpbmdcbiAgICB2YXIgYXJlYWwgPSBuZXcgRmxvYXQ2NEFycmF5KG0pO1xuICAgIHZhciBhaW1hZyA9IG5ldyBGbG9hdDY0QXJyYXkobSk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIGFyZWFsW2ldID0gcmVhbFtpXSAqIGNvc1RhYmxlW2ldICsgaW1hZ1tpXSAqIHNpblRhYmxlW2ldO1xuICAgICAgICBhaW1hZ1tpXSA9IC1yZWFsW2ldICogc2luVGFibGVbaV0gKyBpbWFnW2ldICogY29zVGFibGVbaV07XG4gICAgfVxuICAgIHZhciBicmVhbCA9IG5ldyBGbG9hdDY0QXJyYXkobSk7XG4gICAgdmFyIGJpbWFnID0gbmV3IEZsb2F0NjRBcnJheShtKTtcbiAgICBicmVhbFswXSA9IGNvc1RhYmxlWzBdO1xuICAgIGJpbWFnWzBdID0gc2luVGFibGVbMF07XG4gICAgZm9yIChpID0gMTsgaSA8IG47IGkrKykge1xuICAgICAgICBicmVhbFtpXSA9IGJyZWFsW20gLSBpXSA9IGNvc1RhYmxlW2ldO1xuICAgICAgICBiaW1hZ1tpXSA9IGJpbWFnW20gLSBpXSA9IHNpblRhYmxlW2ldO1xuICAgIH1cblxuICAgIC8vIENvbnZvbHV0aW9uXG4gICAgdmFyIGNyZWFsID0gbmV3IEZsb2F0NjRBcnJheShtKTtcbiAgICB2YXIgY2ltYWcgPSBuZXcgRmxvYXQ2NEFycmF5KG0pO1xuICAgIGNvbnZvbHZlQ29tcGxleChhcmVhbCwgYWltYWcsIGJyZWFsLCBiaW1hZywgY3JlYWwsIGNpbWFnKTtcblxuICAgIC8vIFBvc3Rwcm9jZXNzaW5nXG4gICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICByZWFsW2ldID0gY3JlYWxbaV0gKiBjb3NUYWJsZVtpXSArIGNpbWFnW2ldICogc2luVGFibGVbaV07XG4gICAgICAgIGltYWdbaV0gPSAtY3JlYWxbaV0gKiBzaW5UYWJsZVtpXSArIGNpbWFnW2ldICogY29zVGFibGVbaV07XG4gICAgfVxufVxuXG5cbi8qXG4gKiBDb21wdXRlcyB0aGUgY2lyY3VsYXIgY29udm9sdXRpb24gb2YgdGhlIGdpdmVuIHJlYWwgdmVjdG9ycy4gRWFjaCB2ZWN0b3IncyBsZW5ndGggbXVzdCBiZSB0aGUgc2FtZS5cbiAqL1xuZnVuY3Rpb24gY29udm9sdmVSZWFsKHgsIHksIG91dCkge1xuICAgIGlmICh4Lmxlbmd0aCAhPT0geS5sZW5ndGggfHwgeC5sZW5ndGggIT09IG91dC5sZW5ndGgpXG4gICAgICAgIHRocm93IFwiTWlzbWF0Y2hlZCBsZW5ndGhzXCI7XG4gICAgdmFyIHplcm9zID0gbmV3IEFycmF5KHgubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHplcm9zLmxlbmd0aDsgaSsrKVxuICAgICAgICB6ZXJvc1tpXSA9IDA7XG4gICAgY29udm9sdmVDb21wbGV4KHgsIHplcm9zLCB5LCB6ZXJvcy5zbGljZSgpLCBvdXQsIHplcm9zLnNsaWNlKCkpO1xufVxuXG5cbi8qXG4gKiBDb21wdXRlcyB0aGUgY2lyY3VsYXIgY29udm9sdXRpb24gb2YgdGhlIGdpdmVuIGNvbXBsZXggdmVjdG9ycy4gRWFjaCB2ZWN0b3IncyBsZW5ndGggbXVzdCBiZSB0aGUgc2FtZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZvbHZlQ29tcGxleCh4cmVhbCwgeGltYWcsIHlyZWFsLCB5aW1hZywgb3V0cmVhbCwgb3V0aW1hZykge1xuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh4cmVhbC5sZW5ndGggIT09IHhpbWFnLmxlbmd0aCB8fCB4cmVhbC5sZW5ndGggIT09IHlyZWFsLmxlbmd0aCB8fCB5cmVhbC5sZW5ndGggIT09IHlpbWFnLmxlbmd0aCB8fCB4cmVhbC5sZW5ndGggIT09IG91dHJlYWwubGVuZ3RoIHx8IG91dHJlYWwubGVuZ3RoICE9PSBvdXRpbWFnLmxlbmd0aClcbiAgICAgICAgICAgIHRocm93IFwiTWlzbWF0Y2hlZCBsZW5ndGhzXCI7XG4gICAgfSkoKTtcbiAgICB2YXIgaTtcbiAgICB2YXIgbiA9IHhyZWFsLmxlbmd0aDtcbiAgICB4cmVhbCA9IHhyZWFsLnNsaWNlKCk7XG4gICAgeGltYWcgPSB4aW1hZy5zbGljZSgpO1xuICAgIHlyZWFsID0geXJlYWwuc2xpY2UoKTtcbiAgICB5aW1hZyA9IHlpbWFnLnNsaWNlKCk7XG5cbiAgICB0cmFuc2Zvcm0oeHJlYWwsIHhpbWFnKTtcbiAgICB0cmFuc2Zvcm0oeXJlYWwsIHlpbWFnKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIHZhciB0ZW1wID0geHJlYWxbaV0gKiB5cmVhbFtpXSAtIHhpbWFnW2ldICogeWltYWdbaV07XG4gICAgICAgIHhpbWFnW2ldID0geGltYWdbaV0gKiB5cmVhbFtpXSArIHhyZWFsW2ldICogeWltYWdbaV07XG4gICAgICAgIHhyZWFsW2ldID0gdGVtcDtcbiAgICB9XG4gICAgaW52ZXJzZVRyYW5zZm9ybSh4cmVhbCwgeGltYWcpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHsgLy8gU2NhbGluZyAoYmVjYXVzZSB0aGlzIEZGVCBpbXBsZW1lbnRhdGlvbiBvbWl0cyBpdClcbiAgICAgICAgb3V0cmVhbFtpXSA9IHhyZWFsW2ldIC8gbjtcbiAgICAgICAgb3V0aW1hZ1tpXSA9IHhpbWFnW2ldIC8gbjtcbiAgICB9XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9hbWRmKGFycmF5KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIG4gPSBhcnJheS5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkobik7XG4gICAgd2hpbGUgKG4tLSkge1xuICAgICAgICB2YXIgbWQgPSAwLjA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoIC0gbjsgaSsrKSB7XG4gICAgICAgICAgICBtZCArPSBNYXRoLmFicyhhcnJheVtpXSAtIGFycmF5W2kgKyBuXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0W25dID0gbWQgLyBhcnJheS5sZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXBwbHlfd2luZG93KFgsIFcpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoWCkgfHwgIXh0cmFjdF9hc3NlcnRfYXJyYXkoVykpIHtcbiAgICAgICAgdGhyb3cgKFwiQm90aCBYIGFuZCBXIG11c3QgYmUgZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgaWYgKFgubGVuZ3RoICE9PSBXLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyAoXCJCb3RoIFggYW5kIFcgbXVzdCBiZSB0aGUgc2FtZSBsZW5ndGhzXCIpO1xuICAgIH1cbiAgICB2YXIgTiA9IFgubGVuZ3RoO1xuICAgIHZhciBZID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICB2YXIgbjtcbiAgICBmb3IgKG4gPSAwOyBuIDwgTjsgbisrKSB7XG4gICAgICAgIFlbbl0gPSBYW25dICogV1tuXTtcbiAgICB9XG4gICAgcmV0dXJuIFk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X21pbn0gZnJvbSBcIi4veHRyYWN0X2FycmF5X21pblwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbWF4fSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfbWF4XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXJyYXlfYm91bmQoZGF0YSwgbWluLCBtYXgpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2YgbWluICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG1pbiA9IHh0cmFjdF9hcnJheV9taW4oZGF0YSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbWF4ICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG1heCA9IHh0cmFjdF9hcnJheV9tYXgoZGF0YSk7XG4gICAgfVxuICAgIGlmIChtaW4gPj0gbWF4KSB7XG4gICAgICAgIHRocm93IChcIkludmFsaWQgYm91bmRhcmllcyEgTWluaW11bSBjYW5ub3QgYmUgZ3JlYXRlciB0aGFuIG1heGltdW1cIik7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBuZXcgZGF0YS5jb25zdHJ1Y3RvcihkYXRhLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBkYXRhLmxlbmd0aDsgbisrKSB7XG4gICAgICAgIHJlc3VsdFtuXSA9IE1hdGgubWluKE1hdGgubWF4KGRhdGFbbl0sIG1pbiksIG1heCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X2NvcHkoc3JjKSB7XG4gICAgdmFyIE4gPSBzcmMubGVuZ3RoLFxuICAgICAgICBkc3QgPSBuZXcgc3JjLmNvbnN0cnVjdG9yKE4pO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgTjsgbisrKVxuICAgICAgICBkc3Rbbl0gPSBzcmNbbl07XG4gICAgcmV0dXJuIGRzdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X3Bvc2l0aXZlX2ludGVnZXJ9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlclwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X2RlaW50ZXJsYWNlKGRhdGEsIG51bV9hcnJheXMpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0LCBOO1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKG51bV9hcnJheXMpKSB7XG4gICAgICAgIHRocm93IChcIm51bV9hcnJheXMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgfVxuICAgIHJlc3VsdCA9IFtdO1xuICAgIE4gPSBkYXRhLmxlbmd0aCAvIG51bV9hcnJheXM7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBudW1fYXJyYXlzOyBuKyspIHtcbiAgICAgICAgcmVzdWx0W25dID0gbmV3IGRhdGEuY29uc3RydWN0b3IoTik7XG4gICAgfVxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgTjsgaysrKSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtX2FycmF5czsgaisrKSB7XG4gICAgICAgICAgICByZXN1bHRbal1ba10gPSBkYXRhW2sgKiBudW1fYXJyYXlzICsgal07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X2ludGVybGFjZShkYXRhKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgdmFyIG51bV9hcnJheXMgPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgbGVuZ3RoID0gZGF0YVswXS5sZW5ndGg7XG4gICAgaWYgKGRhdGEuZXZlcnkoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHJldHVybiBhLmxlbmd0aCA9PT0gbGVuZ3RoO1xuICAgICAgICB9KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgdGhyb3cgKFwiQWxsIGFyZ3VtZW50IGxlbmd0aHMgbXVzdCBiZSB0aGUgc2FtZVwiKTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBkYXRhWzBdLmNvbnN0cnVjdG9yKG51bV9hcnJheXMgKiBsZW5ndGgpO1xuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbGVuZ3RoOyBrKyspIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1fYXJyYXlzOyBqKyspIHtcbiAgICAgICAgICAgIHJlc3VsdFtrICogbnVtX2FycmF5cyArIGpdID0gZGF0YVtqXVtrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X21heChkYXRhKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKVxuICAgICAgICByZXR1cm4gLUluZmluaXR5O1xuICAgIGlmIChkYXRhLnJlZHVjZSkge1xuICAgICAgICByZXR1cm4gZGF0YS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIGlmIChiID4gYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIH0sIGRhdGFbMF0pO1xuICAgIH1cbiAgICB2YXIgbWF4ID0gZGF0YVswXSxcbiAgICAgICAgbCA9IGRhdGEubGVuZ3RoO1xuICAgIGZvciAodmFyIG4gPSAxOyBuIDwgbDsgbisrKSB7XG4gICAgICAgIGlmIChkYXRhW25dID4gbWF4KSB7XG4gICAgICAgICAgICBtYXggPSBkYXRhW25dO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXg7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXJyYXlfbWluKGRhdGEpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpXG4gICAgICAgIHJldHVybiBJbmZpbml0eTtcbiAgICBpZiAoZGF0YS5yZWR1Y2UpIHtcbiAgICAgICAgcmV0dXJuIGRhdGEucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYiA8IGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICB9LCBkYXRhWzBdKTtcbiAgICB9XG4gICAgdmFyIG1pbiA9IEluZmluaXR5LFxuICAgICAgICBsID0gZGF0YS5sZW5ndGg7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBsOyBuKyspIHtcbiAgICAgICAgaWYgKGRhdGFbbl0gPCBtaW4pIHtcbiAgICAgICAgICAgIG1pbiA9IGRhdGFbbl07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1pbjtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc2NhbGV9IGZyb20gXCIuL3h0cmFjdF9hcnJheV9zY2FsZVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbWF4fSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfbWF4XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXJyYXlfbm9ybWFsaXNlKGRhdGEpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHJldHVybiB4dHJhY3RfYXJyYXlfc2NhbGUoZGF0YSwgMS4wIC8geHRyYWN0X2FycmF5X21heChkYXRhKSk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X2NvcHl9IGZyb20gXCIuL3h0cmFjdF9hcnJheV9jb3B5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X3NjYWxlKGRhdGEsIGZhY3Rvcikge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShkYXRhKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBmYWN0b3IgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHZhciBpID0gMCxcbiAgICAgICAgbCA9IGRhdGEubGVuZ3RoLFxuICAgICAgICBhID0geHRyYWN0X2FycmF5X2NvcHkoZGF0YSk7XG4gICAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICBhW2ldICo9IGZhY3RvcjtcbiAgICB9XG4gICAgcmV0dXJuIGE7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXJyYXlfc3VtKGRhdGEpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChkYXRhLnJlZHVjZSkge1xuICAgICAgICByZXR1cm4gZGF0YS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhICsgYjtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxuICAgIHZhciBzdW0gPSAwLFxuICAgICAgICBsID0gZGF0YS5sZW5ndGg7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBsOyBuKyspIHtcbiAgICAgICAgc3VtICs9IGRhdGFbbl07XG4gICAgfVxuICAgIHJldHVybiBzdW07XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2FycmF5X3RvX0pTT04oYXJyYXkpIHtcbiAgICBpZiAoYXJyYXkuam9pbikge1xuICAgICAgICByZXR1cm4gJ1snICsgYXJyYXkuam9pbignLCAnKSArICddJztcbiAgICB9XG4gICAgdmFyIGpzb24gPSAnWyc7XG4gICAgdmFyIG4gPSAwO1xuICAgIHdoaWxlIChuIDwgdGhpcy5sZW5ndGgpIHtcbiAgICAgICAganNvbiA9IGpzb24gKyB0aGlzW25dO1xuICAgICAgICBpZiAodGhpc1tuICsgMV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAganNvbiA9IGpzb24gKyAnLCc7XG4gICAgICAgIH1cbiAgICAgICAgbisrO1xuICAgIH1cbiAgICByZXR1cm4ganNvbiArICddJztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9hc2RmKGFycmF5KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIG4gPSBhcnJheS5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkobik7XG4gICAgd2hpbGUgKG4tLSkge1xuICAgICAgICB2YXIgc2QgPSAwLjA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoIC0gbjsgaSsrKSB7XG4gICAgICAgICAgICBzZCArPSBNYXRoLnBvdyhhcnJheVtpXSAtIGFycmF5W2kgKyBuXSwgMik7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0W25dID0gc2QgLyBhcnJheS5sZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2Fzc2VydF9hcnJheShhcnJheSkge1xuICAgIHJldHVybiAodHlwZW9mIGFycmF5ID09PSBcIm9iamVjdFwiICYmIGFycmF5Lmxlbmd0aCAhPT0gdW5kZWZpbmVkICYmIGFycmF5Lmxlbmd0aCA+IDApO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihudW1iZXIpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBudW1iZXIgPT09IFwibnVtYmVyXCIgJiYgbnVtYmVyID49IDAgJiYgbnVtYmVyID09PSBNYXRoLnJvdW5kKG51bWJlcikpO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfYXV0b2NvcnJlbGF0aW9uKGFycmF5KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIG4gPSBhcnJheS5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkobik7XG4gICAgd2hpbGUgKG4tLSkge1xuICAgICAgICB2YXIgY29yciA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoIC0gbjsgaSsrKSB7XG4gICAgICAgICAgICBjb3JyICs9IGFycmF5W2ldICogYXJyYXlbaSArIG5dO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdFtuXSA9IGNvcnIgLyBhcnJheS5sZW5ndGg7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X21lYW59IGZyb20gXCIuL3h0cmFjdF9tZWFuXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2F2ZXJhZ2VfZGV2aWF0aW9uKGFycmF5LCBtZWFuKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBtZWFuICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG1lYW4gPSB4dHJhY3RfbWVhbihhcnJheSk7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSAwLjA7XG4gICAgaWYgKGFycmF5LnJlZHVjZSkge1xuICAgICAgICByZXN1bHQgPSBhcnJheS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhICsgTWF0aC5hYnMoYiAtIG1lYW4pO1xuICAgICAgICB9LCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGFycmF5Lmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gTWF0aC5hYnMoYXJyYXlbbl0gLSBtZWFuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0IC8gYXJyYXkubGVuZ3RoO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2JhcmtfY29lZmZpY2llbnRzKHNwZWN0cnVtLCBiYXJrX2xpbWl0cykge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChiYXJrX2xpbWl0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IChcInh0cmFjdF9iYXJrX2NvZWZmaWNpZW50cyByZXF1aXJlcyBjb21wdXRlIGxpbWl0cyBmcm9tIHh0cmFjdF9pbml0X2JhcmtcIik7XG4gICAgfVxuICAgIHZhciBOID0gc3BlY3RydW0ubGVuZ3RoID4+IDE7XG4gICAgdmFyIGJhbmRzID0gYmFya19saW1pdHMubGVuZ3RoO1xuICAgIHZhciByZXN1bHRzID0gbmV3IEZsb2F0NjRBcnJheShiYW5kcyk7XG4gICAgZm9yICh2YXIgYmFuZCA9IDA7IGJhbmQgPCBiYW5kcyAtIDE7IGJhbmQrKykge1xuICAgICAgICByZXN1bHRzW2JhbmRdID0gMC4wO1xuICAgICAgICBmb3IgKHZhciBuID0gYmFya19saW1pdHNbYmFuZF07IG4gPCBiYXJrX2xpbWl0c1tiYW5kICsgMV07IG4rKykge1xuICAgICAgICAgICAgcmVzdWx0c1tiYW5kXSArPSBzcGVjdHJ1bVtuXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9jaHJvbWEoc3BlY3RydW0sIGNocm9tYUZpbHRlcnMpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAoY2hyb21hRmlsdGVycy53dHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfY2hyb21hIHJlcXVpcmVzIGNocm9tYSBmaWx0ZXJzIGZyb20geHRyYWN0X2luaXRfY2hyb21hXCIpO1xuICAgIH1cbiAgICBpZiAoY2hyb21hRmlsdGVycy5uZmZ0ICE9PSBzcGVjdHJ1bS5sZW5ndGggLyAyKSB7XG4gICAgICAgIHRocm93IChcInRoZSBGRlQgbGVuZ3RocyBvZiB0aGUgc3BlY3RydW0gKFwiICsgc3BlY3RydW0ubGVuZ3RoIC8gMiArIFwiKSBhbmQgY2hyb21hIGZpbHRlcmJhbmsgKFwiICsgY2hyb21hRmlsdGVycy5uZmZ0ICsgXCIpIGRvIG5vdCBtYXRjaFwiKTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoY2hyb21hRmlsdGVycy5uYmlucyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaHJvbWFGaWx0ZXJzLm5iaW5zOyBpKyspIHtcbiAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hyb21hRmlsdGVycy5uZmZ0OyBqKyspIHtcbiAgICAgICAgICAgIHN1bSArPSBjaHJvbWFGaWx0ZXJzLnd0c1tpXVtqXSAqIHNwZWN0cnVtW2pdO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdFtpXSA9IHN1bTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt0cmFuc2Zvcm19IGZyb20gXCIuLi9mcmVlRkZUXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfY29tcGxleF9zcGVjdHJ1bShhcnJheSwgc2FtcGxlX3JhdGUsIHdpdGhEQykge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShhcnJheSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2Ygc2FtcGxlX3JhdGUgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlNhbXBsZSBSYXRlIG11c3QgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICh3aXRoREMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB3aXRoREMgPSBmYWxzZTtcbiAgICB9XG4gICAgdmFyIE4gPSBhcnJheS5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCwgYWxpZ24gPSAwLFxuICAgICAgICBhbXBzLCBmcmVxcztcbiAgICBpZiAod2l0aERDKSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoMyAqIChOIC8gMiArIDEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhbGlnbiA9IDE7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoMyAqIChOIC8gMikpO1xuICAgIH1cbiAgICBhbXBzID0gcmVzdWx0LnN1YmFycmF5KDAsIDIgKiAocmVzdWx0Lmxlbmd0aCAvIDMpKTtcbiAgICBmcmVxcyA9IHJlc3VsdC5zdWJhcnJheSgyICogKHJlc3VsdC5sZW5ndGggLyAzKSk7XG4gICAgdmFyIHJlYWxzID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICB2YXIgaW1hZ3MgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgIHJlYWxzW2ldID0gYXJyYXlbaV07XG4gICAgfVxuICAgIHRyYW5zZm9ybShyZWFscywgaW1hZ3MpO1xuICAgIGZvciAodmFyIGsgPSBhbGlnbjsgayA8PSByZWFscy5sZW5ndGggLyAyOyBrKyspIHtcbiAgICAgICAgYW1wc1soayAtIGFsaWduKSAqIDJdID0gcmVhbHNba107XG4gICAgICAgIGFtcHNbKGsgLSBhbGlnbikgKiAyICsgMV0gPSBpbWFnc1trXTtcbiAgICAgICAgZnJlcXNbayAtIGFsaWduXSA9ICgyICogayAvIE4pICogKHNhbXBsZV9yYXRlIC8gMik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcn0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyXCI7XG5cbmZ1bmN0aW9uIHdlbGNoKE4pIHtcbiAgICB2YXIgVyA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgdmFyIG47XG4gICAgdmFyIE4xMiA9IChOIC0gMSkgLyAyO1xuICAgIGZvciAobiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgV1tuXSA9IDEuMCAtIE1hdGgucG93KChuIC0gTjEyKSAvIE4xMiwgMik7XG4gICAgfVxuICAgIHJldHVybiBXO1xufVxuXG5mdW5jdGlvbiBzaW5lKE4pIHtcbiAgICB2YXIgdyA9IG5ldyBGbG9hdDY0QXJyYXkoTiksXG4gICAgICAgIG47XG4gICAgdmFyIGFyZ2EgPSAoTWF0aC5QSSAqIG4pIC8gKE4gLSAxKTtcbiAgICBmb3IgKG4gPSAwOyBuIDwgTjsgbisrKSB7XG4gICAgICAgIHdbbl0gPSBNYXRoLnNpbihhcmdhKTtcbiAgICB9XG4gICAgcmV0dXJuIHc7XG59XG5cbmZ1bmN0aW9uIGhhbm4oTikge1xuICAgIHZhciB3ID0gbmV3IEZsb2F0NjRBcnJheShOKSxcbiAgICAgICAgbjtcbiAgICBmb3IgKG4gPSAwOyBuIDwgTjsgbisrKSB7XG4gICAgICAgIHdbbl0gPSAwLjUgLSAoMSAtIE1hdGguY29zKChNYXRoLlBJICogMiAqIG4pIC8gKE4gLSAxKSkpO1xuICAgIH1cbiAgICByZXR1cm4gdztcbn1cblxuZnVuY3Rpb24gaGFtbWluZyhOKSB7XG4gICAgdmFyIHcgPSBuZXcgRmxvYXQ2NEFycmF5KE4pLFxuICAgICAgICBhbHBoYSA9IDI1IC8gNDYsXG4gICAgICAgIGJldGEgPSAyMSAvIDQ2LFxuICAgICAgICBuO1xuICAgIGZvciAobiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgd1tuXSA9IGFscGhhIC0gYmV0YSAqIE1hdGguY29zKChNYXRoLlBJICogMiAqIG4pIC8gKE4gLSAxKSk7XG4gICAgfVxuICAgIHJldHVybiB3O1xufVxuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2NyZWF0ZV93aW5kb3coTiwgdHlwZSkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKE4pKSB7XG4gICAgICAgIHRocm93IChcIk4gbXVzdCBiZSBhIGRlZmluZWQsIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdHlwZSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyAoXCJUeXBlIG11c3QgYmUgZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgdHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcImhhbW1pbmdcIjpcbiAgICAgICAgICAgIHJldHVybiBoYW1taW5nKE4pO1xuICAgICAgICBjYXNlIFwid2VsY2hcIjpcbiAgICAgICAgICAgIHJldHVybiB3ZWxjaChOKTtcbiAgICAgICAgY2FzZSBcInNpbmVcIjpcbiAgICAgICAgICAgIHJldHVybiBzaW5lKE4pO1xuICAgICAgICBjYXNlIFwiaGFublwiOlxuICAgICAgICAgICAgcmV0dXJuIGhhbm4oTik7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyAoXCJXaW5kb3cgZnVuY3Rpb25cXFwiXCIgKyB0eXBlICsgXCJcXFwiIG5vdCBkZWZpbmVkXCIpO1xuICAgIH1cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbWF4fSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfbWF4XCI7XG5pbXBvcnQge3h0cmFjdF9tZWFufSBmcm9tIFwiLi94dHJhY3RfbWVhblwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2NyZXN0KGRhdGEsIG1heCwgbWVhbikge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShkYXRhKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBtYXggIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgbWF4ID0geHRyYWN0X2FycmF5X21heChkYXRhKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBtZWFuICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG1lYW4gPSB4dHJhY3RfbWVhbihkYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIG1heCAvIG1lYW47XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9kY3QoYXJyYXkpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoYXJyYXkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgTiA9IGFycmF5Lmxlbmd0aDtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICBpZiAoYXJyYXkucmVkdWNlKSB7XG4gICAgICAgIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uIChlLCBpLCBhKSB7XG4gICAgICAgICAgICB2YXIgbk4gPSBpIC8gTjtcbiAgICAgICAgICAgIGFbaV0gPSBhcnJheS5yZWR1Y2UoZnVuY3Rpb24gKHIsIGQsIG0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gciArIGQgKiBNYXRoLmNvcyhNYXRoLlBJICogbk4gKiAobSArIDAuNSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgTjsgbisrKSB7XG4gICAgICAgICAgICB2YXIgbk4gPSBuIC8gTjtcbiAgICAgICAgICAgIGZvciAodmFyIG0gPSAwOyBtIDwgTjsgbSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W25dICs9IGFycmF5W21dICogTWF0aC5jb3MoTWF0aC5QSSAqIG5OICogKG0gKyAwLjUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9pbml0X2RjdH0gZnJvbSBcIi4veHRyYWN0X2luaXRfZGN0XCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9zdW19IGZyb20gXCIuL3h0cmFjdF9hcnJheV9zdW1cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9kY3RfMihhcnJheSwgZGN0KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIE4gPSBhcnJheS5sZW5ndGg7XG4gICAgaWYgKGRjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRjdCA9IHh0cmFjdF9pbml0X2RjdChOKTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgcmVzdWx0WzBdID0geHRyYWN0X2FycmF5X3N1bShhcnJheSk7XG4gICAgaWYgKHJlc3VsdC5mb3JFYWNoICYmIGFycmF5LnJlZHVjZSkge1xuICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoZSwgaywgYXIpIHtcbiAgICAgICAgICAgIGFyW2tdID0gYXJyYXkucmVkdWNlKGZ1bmN0aW9uIChhLCBiLCBuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiICogZGN0Lnd0W2tdW25dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGsgPSAxOyBrIDwgTjsgaysrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IE47IG4rKykge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtrXSArPSBhcnJheVtuXSAqIGRjdC53dFtrXVtuXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9ybXNfYW1wbGl0dWRlfSBmcm9tIFwiLi94dHJhY3Rfcm1zX2FtcGxpdHVkZVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2VuZXJneShhcnJheSwgc2FtcGxlX3JhdGUsIHdpbmRvd19tcykge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShhcnJheSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2Ygc2FtcGxlX3JhdGUgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcInh0cmFjdF9lbmVyZ3kgcmVxdWlyZXMgc2FtcGxlX3JhdGUgdG8gYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvd19tcyAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB3aW5kb3dfbXMgPSAxMDA7XG4gICAgfVxuICAgIGlmICh3aW5kb3dfbXMgPD0gMCkge1xuICAgICAgICB3aW5kb3dfbXMgPSAxMDA7XG4gICAgfVxuICAgIHZhciBOID0gYXJyYXkubGVuZ3RoO1xuICAgIHZhciBMID0gTWF0aC5mbG9vcihzYW1wbGVfcmF0ZSAqICh3aW5kb3dfbXMgLyAxMDAwLjApKTtcbiAgICB2YXIgSyA9IE1hdGguY2VpbChOIC8gTCk7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoSyk7XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCBLOyBrKyspIHtcbiAgICAgICAgdmFyIGZyYW1lID0gYXJyYXkuc3ViYXJyYXkoayAqIEwsIGsgKiBMICsgTCk7XG4gICAgICAgIHZhciBybXMgPSB4dHJhY3Rfcm1zX2FtcGxpdHVkZShmcmFtZSk7XG4gICAgICAgIHJlc3VsdFtrXSA9IHJtcztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfY29weX0gZnJvbSBcIi4veHRyYWN0X2FycmF5X2NvcHlcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X21heH0gZnJvbSBcIi4veHRyYWN0X2FycmF5X21heFwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfYm91bmR9IGZyb20gXCIuL3h0cmFjdF9hcnJheV9ib3VuZFwiO1xuXG5mdW5jdGlvbiBjYWxjX2Vycl90YXVfeChzdWJfYXJyLCBNLCB0YXUpIHtcbiAgICB2YXIgZXJyX3RhdSA9IDAuMCxcbiAgICAgICAgbjtcbiAgICBmb3IgKG4gPSAxOyBuIDwgTTsgbisrKSB7XG4gICAgICAgIGVycl90YXUgKz0gTWF0aC5hYnMoc3ViX2FycltuXSAtIHN1Yl9hcnJbbiArIHRhdV0pO1xuICAgIH1cbiAgICByZXR1cm4gZXJyX3RhdTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9mMCh0aW1lQXJyYXksIHNhbXBsZVJhdGUpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkodGltZUFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBzYW1wbGVSYXRlICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHNhbXBsZVJhdGUgPSA0NDEwMC4wO1xuICAgIH1cbiAgICB2YXIgc3ViX2FyciA9IHh0cmFjdF9hcnJheV9jb3B5KHRpbWVBcnJheSk7XG4gICAgdmFyIE4gPSBzdWJfYXJyLmxlbmd0aDtcbiAgICB2YXIgTSA9IE4gLyAyO1xuICAgIHZhciBuO1xuXG4gICAgdmFyIHRocmVzaG9sZF9wZWFrID0gMC44LFxuICAgICAgICB0aHJlc2hvbGRfY2VudHJlID0gMC4zLFxuICAgICAgICBhcnJheV9tYXggPSAwO1xuXG4gICAgYXJyYXlfbWF4ID0geHRyYWN0X2FycmF5X21heChzdWJfYXJyKTtcbiAgICB0aHJlc2hvbGRfcGVhayAqPSBhcnJheV9tYXg7XG4gICAgdGhyZXNob2xkX2NlbnRyZSAqPSBhcnJheV9tYXg7XG5cbiAgICBzdWJfYXJyID0geHRyYWN0X2FycmF5X2JvdW5kKHN1Yl9hcnIsIC10aHJlc2hvbGRfcGVhaywgdGhyZXNob2xkX3BlYWspO1xuXG4gICAgc3ViX2Fyci5mb3JFYWNoKGZ1bmN0aW9uICh2LCBpLCBhKSB7XG4gICAgICAgIGFbaV0gPSBNYXRoLm1heCgwLCB2IC0gdGhyZXNob2xkX2NlbnRyZSk7XG4gICAgfSk7XG5cbiAgICB2YXIgZXJyX3RhdV8xID0gY2FsY19lcnJfdGF1X3goc3ViX2FyciwgTSwgMSk7XG4gICAgZm9yICh2YXIgdGF1ID0gMjsgdGF1IDwgTTsgdGF1KyspIHtcbiAgICAgICAgdmFyIGVycl90YXVfeCA9IGNhbGNfZXJyX3RhdV94KHN1Yl9hcnIsIE0sIHRhdSk7XG4gICAgICAgIGlmIChlcnJfdGF1X3ggPCBlcnJfdGF1XzEpIHtcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVSYXRlIC8gKHRhdSArIChlcnJfdGF1X3ggLyBlcnJfdGF1XzEpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTA7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9mMH0gZnJvbSBcIi4veHRyYWN0X2YwXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfZmFpbHNhZmVfZjAodGltZUFycmF5LCBzYW1wbGVSYXRlKSB7XG4gICAgcmV0dXJuIHh0cmFjdF9mMCh0aW1lQXJyYXksIHNhbXBsZVJhdGUpO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfZmxhdG5lc3Moc3BlY3RydW0pIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgY291bnQgPSAwLFxuICAgICAgICBkZW5vcm1hbF9mb3VuZCA9IGZhbHNlLFxuICAgICAgICBudW0gPSAxLjAsXG4gICAgICAgIGRlbiA9IDAuMCxcbiAgICAgICAgdGVtcCA9IDAuMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgSyA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHNwZWN0cnVtLnN1YmFycmF5KDAsIEspO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgSzsgbisrKSB7XG4gICAgICAgIHRlbXAgPSBNYXRoLm1heCgxZS0zMiwgYW1wc1tuXSk7XG4gICAgICAgIG51bSAqPSB0ZW1wO1xuICAgICAgICBkZW4gKz0gdGVtcDtcbiAgICAgICAgY291bnQrKztcbiAgICB9XG4gICAgaWYgKGNvdW50ID09PSAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBudW0gPSBNYXRoLnBvdyhudW0sIDEuMCAvIGNvdW50KTtcbiAgICBkZW4gLz0gY291bnQ7XG5cbiAgICByZXR1cm4gbnVtIC8gZGVuO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9mbGF0bmVzc30gZnJvbSBcIi4veHRyYWN0X2ZsYXRuZXNzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfZmxhdG5lc3NfZGIoc3BlY3RydW0sIGZsYXRuZXNzKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBmbGF0bmVzcyAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBmbGF0bmVzcyA9IHh0cmFjdF9mbGF0bmVzcyhzcGVjdHJ1bSk7XG4gICAgfVxuICAgIHJldHVybiAxMC4wICogTWF0aC5sb2cxMChmbGF0bmVzcyk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcn0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyXCI7XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2dldF9udW1iZXJfb2ZfZnJhbWVzfSBmcm9tIFwiLi94dHJhY3RfZ2V0X251bWJlcl9vZl9mcmFtZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9mcmFtZV9mcm9tX2FycmF5KHNyYywgZHN0LCBpbmRleCwgZnJhbWVfc2l6ZSwgaG9wX3NpemUpIHtcbiAgICBpZiAoaG9wX3NpemUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBob3Bfc2l6ZSA9IGZyYW1lX3NpemU7XG4gICAgfVxuICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKGluZGV4KSkge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2ZyYW1lIHJlcXVpcmVzIHRoZSBpbmRleCB0byBiZSBhbiBpbnRlZ2VyIHZhbHVlXCIpO1xuICAgIH1cbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihmcmFtZV9zaXplKSkge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2ZyYW1lIHJlcXVpcmVzIHRoZSBmcmFtZV9zaXplIHRvIGJlIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICB9XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNyYykpIHtcbiAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBkYXRhIHBhcmFtZXRlci4gTXVzdCBiZSBpdGVtIHdpdGggaXRlcmFibGUgbGlzdFwiKTtcbiAgICB9XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRzdCkpIHtcbiAgICAgICAgdGhyb3cgKFwiZHN0IG11c3QgYmUgYW4gQXJyYXktbGlrZSBvYmplY3QgZXF1YWwgaW4gbGVuZ3RoIHRvIGZyYW1lX3NpemVcIik7XG4gICAgfVxuICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKGhvcF9zaXplKSkge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2ZyYW1lIHJlcXVpcmVzIHRoZSBob3Bfc2l6ZSB0byBiZSBhIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgfVxuICAgIHZhciBLID0geHRyYWN0X2dldF9udW1iZXJfb2ZfZnJhbWVzKHNyYywgaG9wX3NpemUpO1xuICAgIGlmIChpbmRleCA+PSBLKSB7XG4gICAgICAgIHRocm93IChcImluZGV4IG51bWJlciBcIiArIGluZGV4ICsgXCIgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICB9XG4gICAgdmFyIG4gPSAwO1xuICAgIHZhciBvZmZzZXQgPSBpbmRleCAqIGhvcF9zaXplO1xuICAgIHdoaWxlIChuIDwgZHN0Lmxlbmd0aCAmJiBuIDwgc3JjLmxlbmd0aCAmJiBuIDwgZnJhbWVfc2l6ZSkge1xuICAgICAgICBkc3Rbbl0gPSBzcmNbbiArIG9mZnNldF07XG4gICAgICAgIG4rKztcbiAgICB9XG4gICAgd2hpbGUgKG4gPCBkc3QubGVuZ3RoKSB7XG4gICAgICAgIGRzdFtuXSA9IDAuMDtcbiAgICB9XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyfSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X3Bvc2l0aXZlX2ludGVnZXJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9nZXRfZGF0YV9mcmFtZXMoZGF0YSwgZnJhbWVfc2l6ZSwgaG9wX3NpemUsIGNvcHkpIHtcbiAgICBpZiAoaG9wX3NpemUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBob3Bfc2l6ZSA9IGZyYW1lX3NpemU7XG4gICAgfVxuICAgIChmdW5jdGlvbiAoZGF0YSwgZnJhbWVfc2l6ZSwgaG9wX3NpemUpIHtcbiAgICAgICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJJbnZhbGlkIGRhdGEgcGFyYW1ldGVyLiBNdXN0IGJlIGl0ZW0gd2l0aCBpdGVyYWJsZSBsaXN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKGZyYW1lX3NpemUpKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzIHJlcXVpcmVzIHRoZSBmcmFtZV9zaXplIHRvIGJlIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihob3Bfc2l6ZSkpIHtcbiAgICAgICAgICAgIHRocm93IChcInh0cmFjdF9nZXRfZGF0YV9mcmFtZXMgcmVxdWlyZXMgdGhlIGhvcF9zaXplIHRvIGJlIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KShkYXRhLCBmcmFtZV9zaXplLCBob3Bfc2l6ZSk7XG5cbiAgICB2YXIgZnJhbWVzID0gW107XG4gICAgdmFyIE4gPSBkYXRhLmxlbmd0aDtcbiAgICB2YXIgSyA9IE1hdGguY2VpbChOIC8gaG9wX3NpemUpO1xuICAgIHZhciBzdWJfZnJhbWU7XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCBLOyBrKyspIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IGsgKiBob3Bfc2l6ZTtcbiAgICAgICAgaWYgKGNvcHkpIHtcbiAgICAgICAgICAgIHN1Yl9mcmFtZSA9IG5ldyBGbG9hdDY0QXJyYXkoZnJhbWVfc2l6ZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGZyYW1lX3NpemUgJiYgbiArIG9mZnNldCA8IGRhdGEubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgICAgICBzdWJfZnJhbWVbbl0gPSBkYXRhW24gKyBvZmZzZXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3ViX2ZyYW1lID0gZGF0YS5zdWJhcnJheShvZmZzZXQsIG9mZnNldCArIGZyYW1lX3NpemUpO1xuICAgICAgICAgICAgaWYgKHN1Yl9mcmFtZS5sZW5ndGggPCBmcmFtZV9zaXplKSB7XG4gICAgICAgICAgICAgICAgLy8gTXVzdCB6ZXJvLXBhZCB1cCB0byB0aGUgbGVuZ3RoXG4gICAgICAgICAgICAgICAgdmFyIGNfZnJhbWUgPSBuZXcgRmxvYXQ2NEFycmF5KGZyYW1lX3NpemUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViX2ZyYW1lLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNfZnJhbWVbaV0gPSBzdWJfZnJhbWVbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1Yl9mcmFtZSA9IGNfZnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnJhbWVzLnB1c2goc3ViX2ZyYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyYW1lcztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9nZXRfbnVtYmVyX29mX2ZyYW1lcyhkYXRhLCBob3Bfc2l6ZSkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShkYXRhKSkge1xuICAgICAgICB0aHJvdyAoXCJJbnZhbGlkIGRhdGEgcGFyYW1ldGVyLiBNdXN0IGJlIGl0ZW0gd2l0aCBpdGVyYWJsZSBsaXN0XCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGhvcF9zaXplICE9PSBcIm51bWJlclwiICYmIGhvcF9zaXplIDw9IDApIHtcbiAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBob3Bfc2l6ZS4gTXVzdCBiZSBwb3NpdGl2ZSBpbnRlZ2VyXCIpO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5mbG9vcihkYXRhLmxlbmd0aCAvIGhvcF9zaXplKTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2hhcm1vbmljX3NwZWN0cnVtKHBlYWtTcGVjdHJ1bSwgZjAsIHRocmVzaG9sZCkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShwZWFrU3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgTiA9IHBlYWtTcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIEsgPSBOID4+IDE7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgdmFyIGFtcHNJbiA9IHBlYWtTcGVjdHJ1bS5zdWJhcnJheSgwLCBLKTtcbiAgICB2YXIgZnJlcXNJbiA9IHBlYWtTcGVjdHJ1bS5zdWJhcnJheShLKTtcbiAgICB2YXIgYW1wc091dCA9IHJlc3VsdC5zdWJhcnJheSgwLCBLKTtcbiAgICB2YXIgZnJlcXNPdXQgPSByZXN1bHQuc3ViYXJyYXkoSyk7XG4gICAgdmFyIG4gPSBLO1xuICAgIGlmIChmMCA9PT0gdW5kZWZpbmVkIHx8IHRocmVzaG9sZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IChcImhhcm1vbmljX3NwZWN0cnVtIHJlcXVpcmVzIGYwIGFuZCB0aHJlc2hvbGQgdG8gYmUgbnVtYmVycyBhbmQgZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgaWYgKHRocmVzaG9sZCA+IDEpIHtcbiAgICAgICAgdGhyZXNob2xkIC89IDEwMC4wO1xuICAgIH1cbiAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgIGlmIChmcmVxc0luW25dICE9PSAwLjApIHtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IGZyZXFzSW5bbl0gLyBmMDtcbiAgICAgICAgICAgIHZhciBuZWFyZXN0ID0gTWF0aC5yb3VuZChyYXRpbyk7XG4gICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBNYXRoLmFicyhuZWFyZXN0IC0gcmF0aW8pO1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlID4gdGhyZXNob2xkKSB7XG4gICAgICAgICAgICAgICAgYW1wc091dFtuXSA9IDAuMDtcbiAgICAgICAgICAgICAgICBmcmVxc091dFtuXSA9IDAuMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYW1wc091dFtuXSA9IGFtcHNJbltuXTtcbiAgICAgICAgICAgICAgICBmcmVxc091dFtuXSA9IGZyZXFzSW5bbl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHRbbl0gPSAwLjA7XG4gICAgICAgICAgICBmcmVxc091dFtuXSA9IDAuMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9sb3doaWdofSBmcm9tIFwiLi94dHJhY3RfbG93aGlnaFwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2hpZ2hlc3RfdmFsdWUoZGF0YSwgdGhyZXNob2xkKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIHRocmVzaG9sZCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB0aHJlc2hvbGQgPSArSW5maW5pdHk7XG4gICAgfVxuICAgIHJldHVybiB4dHJhY3RfbG93aGlnaChkYXRhLCB0aHJlc2hvbGQpLm1heDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuXG5mdW5jdGlvbiBnZXRfcGVha19pbmRleChNLCBhbXBzKSB7XG4gICAgdmFyIHBlYWtfaW5kZXggPSAwLFxuICAgICAgICBwZWFrID0gMCxcbiAgICAgICAgaTtcbiAgICB2YXIgdGVtcFByb2R1Y3QgPSBuZXcgRmxvYXQ2NEFycmF5KE0pO1xuICAgIHRlbXBQcm9kdWN0LmZvckVhY2goZnVuY3Rpb24gKGUsIGksIGEpIHtcbiAgICAgICAgYVtpXSA9IGFtcHNbaV0gKiBhbXBzW2kgKiAyXSAqIGFtcHNbaSAqIDNdO1xuICAgIH0pO1xuICAgIHRlbXBQcm9kdWN0LmZvckVhY2goZnVuY3Rpb24gKHYsIGkpIHtcbiAgICAgICAgaWYgKHYgPiBwZWFrKSB7XG4gICAgICAgICAgICBwZWFrID0gdjtcbiAgICAgICAgICAgIHBlYWtfaW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHBlYWtfaW5kZXg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfaHBzKHNwZWN0cnVtKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIHBlYWtfaW5kZXggPSAwLFxuICAgICAgICBwb3NpdGlvbjFfbHdyID0gMCxcbiAgICAgICAgbGFyZ2VzdDFfbHdyID0gMCxcbiAgICAgICAgcmF0aW8xID0gMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgSyA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHNwZWN0cnVtLnN1YmFycmF5KDAsIEspO1xuICAgIHZhciBmcmVxcyA9IHNwZWN0cnVtLnN1YmFycmF5KEspO1xuICAgIHZhciBNID0gTWF0aC5jZWlsKEsgLyAzLjApO1xuICAgIHZhciBpO1xuICAgIGlmIChNIDw9IDEpIHtcbiAgICAgICAgdGhyb3cgKFwiSW5wdXQgRGF0YSBpcyB0b28gc2hvcnQgZm9yIEhQU1wiKTtcbiAgICB9XG5cbiAgICBwZWFrX2luZGV4ID0gZ2V0X3BlYWtfaW5kZXgoTSwgYW1wcyk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgSzsgaSsrKSB7XG4gICAgICAgIGlmIChhbXBzW2ldID4gbGFyZ2VzdDFfbHdyICYmIGkgIT09IHBlYWtfaW5kZXgpIHtcbiAgICAgICAgICAgIGxhcmdlc3QxX2x3ciA9IGFtcHNbaV07XG4gICAgICAgICAgICBwb3NpdGlvbjFfbHdyID0gaTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJhdGlvMSA9IGFtcHNbcG9zaXRpb24xX2x3cl0gLyBhbXBzW3BlYWtfaW5kZXhdO1xuXG4gICAgaWYgKHBvc2l0aW9uMV9sd3IgPiBwZWFrX2luZGV4ICogMC40ICYmIHBvc2l0aW9uMV9sd3IgPCBwZWFrX2luZGV4ICogMC42ICYmIHJhdGlvMSA+IDAuMSlcbiAgICAgICAgcGVha19pbmRleCA9IHBvc2l0aW9uMV9sd3I7XG5cbiAgICByZXR1cm4gZnJlcXNbcGVha19pbmRleF07XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2luaXRfYmFyayhOLCBzYW1wbGVSYXRlLCBiYW5kcykge1xuICAgIGlmICh0eXBlb2YgYmFuZHMgIT09IFwibnVtYmVyXCIgfHwgYmFuZHMgPCAwIHx8IGJhbmRzID4gMjYpIHtcbiAgICAgICAgYmFuZHMgPSAyNjtcbiAgICB9XG4gICAgdmFyIGVkZ2VzID0gWzAsIDEwMCwgMjAwLCAzMDAsIDQwMCwgNTEwLCA2MzAsIDc3MCwgOTIwLCAxMDgwLCAxMjcwLCAxNDgwLCAxNzIwLCAyMDAwLCAyMzIwLCAyNzAwLCAzMTUwLCAzNzAwLCA0NDAwLCA1MzAwLCA2NDAwLCA3NzAwLCA5NTAwLCAxMjAwMCwgMTU1MDAsIDIwNTAwLCAyNzAwMF07XG4gICAgdmFyIGJhbmRfbGltaXRzID0gbmV3IEludDMyQXJyYXkoYmFuZHMpO1xuICAgIHdoaWxlIChiYW5kcy0tKSB7XG4gICAgICAgIGJhbmRfbGltaXRzW2JhbmRzXSA9IChlZGdlc1tiYW5kc10gLyBzYW1wbGVSYXRlKSAqIE47XG4gICAgfVxuICAgIHJldHVybiBiYW5kX2xpbWl0cztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2FycmF5X3N1bX0gZnJvbSBcIi4veHRyYWN0X2FycmF5X3N1bVwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9pbml0X2Nocm9tYShOLCBzYW1wbGVSYXRlLCBuYmlucywgQTQ0MCwgZl9jdHIsIG9jdHdpZHRoKSB7XG4gICAgLypydW4gYXJnIGNoZWNrcyBoZXJlLi4uIChpZihuYmlucz09J3VuZGVmaW5lZCcpKi9cblxuICAgIGlmICh0eXBlb2YgbmJpbnMgIT09IFwibnVtYmVyXCIgfHwgbmJpbnMgPD0gMSkge1xuICAgICAgICBuYmlucyA9IDEyO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIEE0NDAgIT09IFwibnVtYmVyXCIgfHwgQTQ0MCA8PSAyNy41KSB7XG4gICAgICAgIEE0NDAgPSA0NDA7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZl9jdHIgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgZl9jdHIgPSAxMDAwO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9jdHdpZHRoICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG9jdHdpZHRoID0gMTtcbiAgICB9XG4gICAgdmFyIEEwID0gMjcuNTsgLy8gQTAgaW4gSHpcbiAgICB2YXIgTjIgPSBOOyAvLyBpZ25vcmUgZnJlcSB2YWx1ZXMgcmV0dXJuZWQgYnkgeHRyYWN0X3NwZWN0cnVtIC0gdGhpcyByZWxpZXMgb24gZGMtb2Zmc2V0IGJlaW5nIGtlcHRcbiAgICB2YXIgY3Ryb2N0ID0gTWF0aC5sb2coZl9jdHIgLyBBMCkgLyBNYXRoLkxOMjsgLy8gZl9jdHIgaW4gb2N0YXZlc1xuICAgIHZhciBjaHJvbWFGaWx0ZXJzID0ge1xuICAgICAgICB3dHM6IFtdLFxuICAgICAgICBuZmZ0OiBOMixcbiAgICAgICAgbmJpbnM6IG5iaW5zLFxuICAgIH07XG4gICAgdmFyIGZmdGZycWJpbnMgPSBuZXcgRmxvYXQ2NEFycmF5KE4yKTtcbiAgICB2YXIgYmlud2lkdGhiaW5zID0gbmV3IEZsb2F0NjRBcnJheShOMik7XG4gICAgLy8gQ29udmVydCBhIGZyZXF1ZW5jeSBpbiBIeiBpbnRvIGEgcmVhbCBudW1iZXIgY291bnRpbmcgdGhlIG9jdGF2ZXMgYWJvdmUgQTAuIFNvIGh6Mm9jdHMoNDQwKSA9IDQuMFxuICAgIHZhciBoejJvY3RzID0gZnVuY3Rpb24gKGZyZXEpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubG9nKGZyZXEgLyAoQTQ0MCAvIDE2KSkgLyBNYXRoLkxOMjtcbiAgICB9O1xuICAgIHZhciBpLCBqO1xuICAgIGZvciAoaSA9IDE7IGkgPCBOMjsgaSsrKSB7XG4gICAgICAgIGZmdGZycWJpbnNbaV0gPSBuYmlucyAqIGh6Mm9jdHMoaSAvIE4gKiBzYW1wbGVSYXRlKTtcbiAgICB9XG4gICAgZmZ0ZnJxYmluc1swXSA9IGZmdGZycWJpbnNbMV0gLSAxLjUgKiBuYmluczsgLy9EQyBvZmZzZXQgYmluXG4gICAgZm9yIChpID0gMDsgaSA8IE4yIC0gMTsgaSsrKSB7XG4gICAgICAgIHZhciBkaWZmVmFsID0gZmZ0ZnJxYmluc1tpICsgMV0gLSBmZnRmcnFiaW5zW2ldO1xuICAgICAgICBpZiAoZGlmZlZhbCA+PSAxKSB7XG4gICAgICAgICAgICBiaW53aWR0aGJpbnNbaV0gPSBkaWZmVmFsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmlud2lkdGhiaW5zW2ldID0gMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBiaW53aWR0aGJpbnNbTjIgLSAxXSA9IDE7XG4gICAgdmFyIG5iaW5zMiA9IE1hdGgucm91bmQobmJpbnMgLyAyLjApO1xuICAgIHZhciB3dHMgPSBbXTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbmJpbnM7IGkrKykge1xuICAgICAgICB3dHNbaV0gPSBbXTtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IE4yOyBqKyspIHtcbiAgICAgICAgICAgIHZhciB0bXBGID0gZmZ0ZnJxYmluc1tqXSAtIGk7XG4gICAgICAgICAgICB2YXIgdG1wQiA9IGJpbndpZHRoYmluc1tqXTtcbiAgICAgICAgICAgIHZhciByZW1GID0gKCh0bXBGICsgbmJpbnMyICsgMTAgKiBuYmlucykgJSBuYmlucykgLSBuYmluczI7XG4gICAgICAgICAgICB3dHNbaV1bal0gPSBNYXRoLmV4cCgtMC41ICogTWF0aC5wb3coKDIgKiByZW1GIC8gdG1wQiksIDIpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhlYWQoYSkge1xuICAgICAgICByZXR1cm4gYVswXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0YWlsKGEpIHtcbiAgICAgICAgcmV0dXJuIGEuc2xpY2UoMSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdHJhbnNwb3NlKGEpIHtcbiAgICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciB4ID0gYS5sZW5ndGgsXG4gICAgICAgICAgICB5ID0gYVswXS5sZW5ndGgsXG4gICAgICAgICAgICBtdHggPSBbXSxcbiAgICAgICAgICAgIGksIGo7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB5OyBpKyspIHtcbiAgICAgICAgICAgIG10eFtpXSA9IG5ldyBGbG9hdDY0QXJyYXkoeCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHg7IGkrKykge1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHk7IGorKykge1xuICAgICAgICAgICAgICAgIG10eFtqXVtpXSA9IGFbaV1bal07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG10eDtcbiAgICB9XG4gICAgdmFyIHd0c0NvbHVtblN1bXMgPSB0cmFuc3Bvc2Uod3RzKS5tYXAoeHRyYWN0X2FycmF5X3N1bSk7XG4gICAgZm9yIChpID0gMDsgaSA8IG5iaW5zOyBpKyspIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IE4yOyBqKyspIHtcbiAgICAgICAgICAgIHd0c1tpXVtqXSAqPSAxIC8gd3RzQ29sdW1uU3Vtc1tqXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAob2N0d2lkdGggPiAwKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuYmluczsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgTjI7IGorKykge1xuICAgICAgICAgICAgICAgIHd0c1tpXVtqXSAqPSBNYXRoLmV4cCgtMC41ICogKE1hdGgucG93KCgoZmZ0ZnJxYmluc1tqXSAvIG5iaW5zIC0gY3Ryb2N0KSAvIG9jdHdpZHRoKSwgMikpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjaHJvbWFGaWx0ZXJzLnd0cyA9IHd0cztcbiAgICByZXR1cm4gY2hyb21hRmlsdGVycztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfaW5pdF9kY3QoTikge1xuICAgIHZhciBkY3QgPSB7XG4gICAgICAgIE46IE4sXG4gICAgICAgIHd0OiBbXVxuICAgIH07XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCBOOyBrKyspIHtcbiAgICAgICAgZGN0Lnd0W2tdID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgICAgIGRjdC53dFtrXVtuXSA9IE1hdGguY29zKE1hdGguUEkgKiBrICogKG4gKyAwLjUpIC8gTik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRjdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfaW5pdF9kZnQoTikge1xuICAgIHZhciBkZnQgPSB7XG4gICAgICAgIE46IE4gLyAyICsgMSxcbiAgICAgICAgcmVhbDogW10sXG4gICAgICAgIGltYWc6IFtdXG4gICAgfTtcbiAgICB2YXIgcG93ZXJfY29uc3QgPSAtMi4wICogTWF0aC5QSSAvIE47XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCBkZnQuTjsgaysrKSB7XG4gICAgICAgIHZhciBwb3dlcl9rID0gcG93ZXJfY29uc3QgKiBrO1xuICAgICAgICBkZnQucmVhbFtrXSA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgICAgIGRmdC5pbWFnW2tdID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgICAgIHZhciBwb3dlciA9IHBvd2VyX2sgKiBuO1xuICAgICAgICAgICAgZGZ0LnJlYWxba11bbl0gPSBNYXRoLmNvcyhwb3dlcik7XG4gICAgICAgICAgICBkZnQuaW1hZ1trXVtuXSA9IE1hdGguc2luKHBvd2VyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGZ0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuXG5mdW5jdGlvbiBnZXRfZmZ0X3BlYWsoTiwgZnJlcV9tYXgsIGZyZXFfbWluLCBmcmVxX2JhbmRzLCBueXF1aXN0LCBzdHlsZSkge1xuICAgIHZhciBub3JtID0gMSxcbiAgICAgICAgTSA9IE4gLyAyLFxuICAgICAgICBoZWlnaHQsIG5vcm1fZmFjdCwgbjtcbiAgICB2YXIgbWVsX2ZyZXFfbWF4ID0gMTEyNyAqIE1hdGgubG9nKDEgKyBmcmVxX21heCAvIDcwMCk7XG4gICAgdmFyIG1lbF9mcmVxX21pbiA9IDExMjcgKiBNYXRoLmxvZygxICsgZnJlcV9taW4gLyA3MDApO1xuICAgIHZhciBmcmVxX2J3X21lbCA9IChtZWxfZnJlcV9tYXggLSBtZWxfZnJlcV9taW4pIC8gZnJlcV9iYW5kcztcblxuICAgIHZhciBtZWxfcGVhayA9IG5ldyBGbG9hdDY0QXJyYXkoZnJlcV9iYW5kcyArIDIpO1xuICAgIHZhciBsaW5fcGVhayA9IG5ldyBGbG9hdDY0QXJyYXkoZnJlcV9iYW5kcyArIDIpO1xuICAgIHZhciBmZnRfcGVhayA9IG5ldyBGbG9hdDY0QXJyYXkoZnJlcV9iYW5kcyArIDIpO1xuICAgIHZhciBoZWlnaHRfbm9ybSA9IG5ldyBGbG9hdDY0QXJyYXkoZnJlcV9iYW5kcyk7XG4gICAgbWVsX3BlYWtbMF0gPSBtZWxfZnJlcV9taW47XG4gICAgbGluX3BlYWtbMF0gPSBmcmVxX21pbjtcbiAgICBmZnRfcGVha1swXSA9IE1hdGguZmxvb3IobGluX3BlYWtbMF0gLyBueXF1aXN0ICogTSk7XG5cbiAgICBmb3IgKG4gPSAxOyBuIDwgKGZyZXFfYmFuZHMgKyAyKTsgKytuKSB7XG4gICAgICAgIC8vcm9sbCBvdXQgcGVhayBsb2NhdGlvbnMgLSBtZWwsIGxpbmVhciBhbmQgbGluZWFyIG9uIGZmdCB3aW5kb3cgc2NhbGVcbiAgICAgICAgbWVsX3BlYWtbbl0gPSBtZWxfcGVha1tuIC0gMV0gKyBmcmVxX2J3X21lbDtcbiAgICAgICAgbGluX3BlYWtbbl0gPSA3MDAgKiAoTWF0aC5leHAobWVsX3BlYWtbbl0gLyAxMTI3KSAtIDEpO1xuICAgICAgICBmZnRfcGVha1tuXSA9IE1hdGguZmxvb3IobGluX3BlYWtbbl0gLyBueXF1aXN0ICogTSk7XG4gICAgfVxuXG4gICAgZm9yIChuID0gMDsgbiA8IGZyZXFfYmFuZHM7IG4rKykge1xuICAgICAgICAvL3JvbGwgb3V0IG5vcm1hbGlzZWQgZ2FpbiBvZiBlYWNoIHBlYWtcbiAgICAgICAgaWYgKHN0eWxlID09PSBcIlhUUkFDVF9FUVVBTF9HQUlOXCIpIHtcbiAgICAgICAgICAgIGhlaWdodCA9IDE7XG4gICAgICAgICAgICBub3JtX2ZhY3QgPSBub3JtO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGVpZ2h0ID0gMiAvIChsaW5fcGVha1tuICsgMl0gLSBsaW5fcGVha1tuXSk7XG4gICAgICAgICAgICBub3JtX2ZhY3QgPSBub3JtIC8gKDIgLyAobGluX3BlYWtbMl0gLSBsaW5fcGVha1swXSkpO1xuICAgICAgICB9XG4gICAgICAgIGhlaWdodF9ub3JtW25dID0gaGVpZ2h0ICogbm9ybV9mYWN0O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBmOiBmZnRfcGVhayxcbiAgICAgICAgaDogaGVpZ2h0X25vcm1cbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2luaXRfbWZjYyhOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKSB7XG4gICAgdmFyIG1mY2MgPSB7XG4gICAgICAgIG5fZmlsdGVyczogZnJlcV9iYW5kcyxcbiAgICAgICAgZmlsdGVyczogW11cbiAgICB9O1xuICAgIHZhciBub3JtID0gMSxcbiAgICAgICAgTSA9IE4gLyAyLFxuICAgICAgICBoZWlnaHQsIG5vcm1fZmFjdCwgbjtcblxuICAgIGlmIChmcmVxX2JhbmRzIDw9IDEpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdmFyIGkgPSAwLFxuICAgICAgICBmaCA9IGdldF9mZnRfcGVhayhOLCBmcmVxX21heCwgZnJlcV9taW4sIGZyZXFfYmFuZHMsIG55cXVpc3QsIHN0eWxlKSxcbiAgICAgICAgaW5jO1xuICAgIHZhciBmZnRfcGVhayA9IGZoLmYsXG4gICAgICAgIGhlaWdodF9ub3JtID0gZmguaDtcbiAgICB2YXIgbmV4dF9wZWFrO1xuICAgIGZvciAobiA9IDA7IG4gPCBmcmVxX2JhbmRzOyBuKyspIHtcbiAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSByaXNlIGluY3JlbWVudFxuICAgICAgICBpZiAobiA9PT0gMCkge1xuICAgICAgICAgICAgaW5jID0gaGVpZ2h0X25vcm1bbl0gLyBmZnRfcGVha1tuXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGluYyA9IGhlaWdodF9ub3JtW25dIC8gKGZmdF9wZWFrW25dIC0gZmZ0X3BlYWtbbiAtIDFdKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmFsID0gMDtcbiAgICAgICAgLy8gQ3JlYXRlIGFycmF5XG4gICAgICAgIG1mY2MuZmlsdGVyc1tuXSA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgICAgIC8vIGZpbGwgaW4gdGhlIHJpc2VcbiAgICAgICAgZm9yICg7IGkgPD0gZmZ0X3BlYWtbbl07IGkrKykge1xuICAgICAgICAgICAgbWZjYy5maWx0ZXJzW25dW2ldID0gdmFsO1xuICAgICAgICAgICAgdmFsICs9IGluYztcbiAgICAgICAgfVxuICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGZhbGwgaW5jcmVtZW50XG4gICAgICAgIGluYyA9IGhlaWdodF9ub3JtW25dIC8gKGZmdF9wZWFrW24gKyAxXSAtIGZmdF9wZWFrW25dKTtcblxuICAgICAgICB2YWwgPSAwO1xuICAgICAgICBuZXh0X3BlYWsgPSBmZnRfcGVha1tuICsgMV07XG5cbiAgICAgICAgLy8gcmV2ZXJzZSBmaWxsIHRoZSAnZmFsbCdcbiAgICAgICAgZm9yIChpID0gTWF0aC5mbG9vcihuZXh0X3BlYWspOyBpID4gZmZ0X3BlYWtbbl07IGktLSkge1xuICAgICAgICAgICAgbWZjYy5maWx0ZXJzW25dW2ldID0gdmFsO1xuICAgICAgICAgICAgdmFsICs9IGluYztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWZjYztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfaW5pdF9wY3AoTiwgZnMsIGZfcmVmKSB7XG4gICAgaWYgKHR5cGVvZiBmcyAhPT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgTiAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB0aHJvdyAoJ1RoZSBTYW1wbGUgUmF0ZSBhbmQgc2FtcGxlIGNvdW50IGhhdmUgdG8gYmUgZGVmaW5lZDogeHRyYWN0X2luaXRfcGNwKE4sIGZzLCBmX3JlZiknKTtcbiAgICB9XG4gICAgaWYgKE4gPD0gMCB8fCBOICE9PSBNYXRoLmZsb29yKE4pKSB7XG4gICAgICAgIHRocm93IChcIlRoZSBzYW1wbGUgY291bnQsIE4sIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyOiB4dHJhY3RfaW5pdF9wY3AoTiwgZnMsIGZfcmVmKVwiKTtcbiAgICB9XG4gICAgaWYgKGZzIDw9IDAuMCkge1xuICAgICAgICB0aHJvdyAoJ1RoZSBTYW1wbGUgUmF0ZSBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyOiB4dHJhY3RfaW5pdF9wY3AoTiwgZnMsIGZfcmVmKScpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGZfcmVmICE9PSBcIm51bWJlclwiIHx8IGZfcmVmIDw9IDAuMCB8fCBmX3JlZiA+PSBmcyAvIDIpIHtcbiAgICAgICAgZl9yZWYgPSA0OC45OTk0Mjk0OTc3O1xuICAgIH1cblxuICAgIHZhciBNID0gbmV3IEZsb2F0NjRBcnJheShOIC0gMSk7XG4gICAgdmFyIGZzMiA9IGZzIC8gMjtcbiAgICBmb3IgKHZhciBsID0gMTsgbCA8IE47IGwrKykge1xuICAgICAgICB2YXIgZiA9ICgyICogbCAvIE4pICogZnMyO1xuICAgICAgICBNW2wgLSAxXSA9IE1hdGgucm91bmQoMTIgKiBNYXRoLmxvZzIoKGYgLyBOKSAqIGZfcmVmKSkgJSAxMjtcbiAgICB9XG4gICAgcmV0dXJuIE07XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2luaXRfd2F2ZWxldCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBfcHJldlBpdGNoOiAtMSxcbiAgICAgICAgX3BpdGNoQ29uZmlkZW5jZTogLTFcbiAgICB9O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2lycmVndWxhcml0eV9qKHNwZWN0cnVtKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIG51bSA9IDAsXG4gICAgICAgIGRlbiA9IDA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIEsgPSBOID4+IDE7XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBLKTtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IEsgLSAxOyBuKyspIHtcbiAgICAgICAgbnVtICs9IE1hdGgucG93KGFtcHNbbl0gLSBhbXBzW24gKyAxXSwgMik7XG4gICAgICAgIGRlbiArPSBNYXRoLnBvdyhhbXBzW25dLCAyKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bSAvIGRlbjtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2lycmVndWxhcml0eV9rKHNwZWN0cnVtKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIEsgPSBOID4+IDE7XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBLKTtcbiAgICBmb3IgKHZhciBuID0gMTsgbiA8IEsgLSAxOyBuKyspIHtcbiAgICAgICAgcmVzdWx0ICs9IE1hdGguYWJzKE1hdGgubG9nMTAoYW1wc1tuXSkgLSBNYXRoLmxvZzEwKGFtcHNbbiAtIDFdICsgYW1wc1tuXSArIGFtcHNbbiArIDFdKSAvIDMpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9pc19kZW5vcm1hbChudW0pIHtcbiAgICBpZiAoTWF0aC5hYnMobnVtKSA8PSAyLjIyNTA3Mzg1ODUwNzIwMTRlLTMwOCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3Rfc2tld25lc3Nfa3VydG9zaXN9IGZyb20gXCIuL3h0cmFjdF9za2V3bmVzc19rdXJ0b3Npc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2t1cnRvc2lzKGFycmF5LCBtZWFuLCBzdGFuZGFyZF9kZXZpYXRpb24pIHtcbiAgICByZXR1cm4geHRyYWN0X3NrZXduZXNzX2t1cnRvc2lzKGFycmF5LCBtZWFuLCBzdGFuZGFyZF9kZXZpYXRpb24pWzFdO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2xvdWRuZXNzKGJhcmtCYW5kc0FycmF5KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGJhcmtCYW5kc0FycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgaWYgKGJhcmtCYW5kc0FycmF5LnJlZHVjZSkge1xuICAgICAgICByZXN1bHQgPSBiYXJrQmFuZHNBcnJheS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhICsgTWF0aC5wb3coYiwgMC4yMyk7XG4gICAgICAgIH0sIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgYmFya0JhbmRzQXJyYXkubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBNYXRoLnBvdyhiYXJrQmFuZHNBcnJheVtuXSwgMC4yMyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfbG93aGlnaH0gZnJvbSBcIi4veHRyYWN0X2xvd2hpZ2hcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9sb3dlc3RfdmFsdWUoZGF0YSwgdGhyZXNob2xkKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIHRocmVzaG9sZCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB0aHJlc2hvbGQgPSAtSW5maW5pdHk7XG4gICAgfVxuICAgIHJldHVybiB4dHJhY3RfbG93aGlnaChkYXRhLCB0aHJlc2hvbGQpLm1pbjtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfbG93aGlnaChkYXRhLCB0aHJlc2hvbGQpIHtcbiAgICB2YXIgciA9IHtcbiAgICAgICAgbWluOiBudWxsLFxuICAgICAgICBtYXg6IG51bGxcbiAgICB9O1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZGF0YS5sZW5ndGg7IG4rKykge1xuICAgICAgICBpZiAoZGF0YVtuXSA+IHRocmVzaG9sZCkge1xuICAgICAgICAgICAgci5taW4gPSBNYXRoLm1pbihyLm1pbiwgZGF0YVtuXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGFbbl0gPCB0aHJlc2hvbGQpIHtcbiAgICAgICAgICAgIHIubWF4ID0gTWF0aC5tYXgoci5tYXgsIGRhdGFbbl0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfbHBjKGF1dG9jb3JyKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGF1dG9jb3JyKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIGksIGosIHIsIGVycm9yID0gYXV0b2NvcnJbMF07XG4gICAgdmFyIE4gPSBhdXRvY29yci5sZW5ndGg7XG4gICAgdmFyIEwgPSBOIC0gMTtcbiAgICB2YXIgbHBjID0gbmV3IEZsb2F0NjRBcnJheShMKTtcbiAgICB2YXIgcmVmID0gbmV3IEZsb2F0NjRBcnJheShMKTtcbiAgICBpZiAoZXJyb3IgPT09IDAuMCkge1xuICAgICAgICByZXR1cm4gbHBjO1xuICAgIH1cblxuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBMOyBpKyspIHtcbiAgICAgICAgICAgIHIgPSAtYXV0b2NvcnJbaSArIDFdO1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGk7IGorKykge1xuICAgICAgICAgICAgICAgIHIgLT0gbHBjW2pdICogYXV0b2NvcnJbaSAtIGpdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgciAvPSBlcnJvcjtcbiAgICAgICAgICAgIHJlZltpXSA9IHI7XG5cbiAgICAgICAgICAgIGxwY1tpXSA9IHI7XG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgKGkgPj4gMSk7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciB0bXAgPSBscGNbal07XG4gICAgICAgICAgICAgICAgbHBjW2pdICs9IHIgKiBscGNbaSAtIDEgLSBqXTtcbiAgICAgICAgICAgICAgICBscGNbaSAtIDEgLSBqXSArPSByICogdG1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgJSAyKSB7XG4gICAgICAgICAgICAgICAgbHBjW2pdICs9IGxwY1tqXSAqIHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlcnJvciAqPSAxLjAgLSByICogcjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG4gICAgcmV0dXJuIGxwYztcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X2xwY2MobHBjLCBRKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGxwYykpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciBOID0gbHBjLmxlbmd0aDtcbiAgICB2YXIgbiwgaywgc3VtLCBvcmRlciA9IE4gLSAxLFxuICAgICAgICBjZXBfbGVuZ3RoO1xuICAgIGlmICh0eXBlb2YgUSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBRID0gTiAtIDE7XG4gICAgfVxuICAgIGNlcF9sZW5ndGggPSBRO1xuXG4gICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoY2VwX2xlbmd0aCk7XG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yIChuID0gMTsgbiA8IFEgJiYgbiA8IGNlcF9sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgc3VtID0gMDtcbiAgICAgICAgICAgIGZvciAoayA9IDE7IGsgPCBuOyBrKyspIHtcbiAgICAgICAgICAgICAgICBzdW0gKz0gayAqIHJlc3VsdFtrIC0gMV0gKiBscGNbbiAtIGtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzdWx0W24gLSAxXSA9IGxwY1tuXSArIHN1bSAvIG47XG4gICAgICAgIH1cbiAgICB9KSgpO1xuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAobiA9IG9yZGVyICsgMTsgbiA8PSBjZXBfbGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIHN1bSA9IDAuMDtcbiAgICAgICAgICAgIGZvciAoayA9IG4gLSAob3JkZXIgLSAxKTsgayA8IG47IGsrKykge1xuICAgICAgICAgICAgICAgIHN1bSArPSBrICogcmVzdWx0W2sgLSAxXSAqIGxwY1tuIC0ga107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHRbbiAtIDFdID0gc3VtIC8gbjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfc3VtXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X21lYW4oYXJyYXkpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoYXJyYXkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICByZXR1cm4geHRyYWN0X2FycmF5X3N1bShhcnJheSkgLyBhcnJheS5sZW5ndGg7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2RjdH0gZnJvbSBcIi4veHRyYWN0X2RjdFwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9tZmNjKHNwZWN0cnVtLCBtZmNjKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIEsgPSBzcGVjdHJ1bS5sZW5ndGggPj4gMTtcbiAgICBpZiAodHlwZW9mIG1mY2MgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBNRkNDLCBtdXN0IGJlIE1GQ0Mgb2JqZWN0IGJ1aWx0IHVzaW5nIHh0cmFjdF9pbml0X21mY2NcIik7XG4gICAgfVxuICAgIGlmIChtZmNjLm5fZmlsdGVycyA9PT0gMCkge1xuICAgICAgICB0aHJvdyAoXCJJbnZhbGlkIE1GQ0MsIG9iamVjdCBtdXN0IGJlIGJ1aWx0IHVzaW5nIHh0cmFjdF9pbml0X21mY2NcIik7XG4gICAgfVxuICAgIGlmIChtZmNjLmZpbHRlcnNbMF0ubGVuZ3RoICE9PSBLKSB7XG4gICAgICAgIHRocm93IChcIkxlbmd0aHMgZG8gbm90IG1hdGNoXCIpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gbmV3IEZsb2F0NjRBcnJheShtZmNjLm5fZmlsdGVycyk7XG4gICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKHYsIGYsIHIpIHtcbiAgICAgICAgcltmXSA9IDAuMDtcbiAgICAgICAgdmFyIGZpbHRlciA9IG1mY2MuZmlsdGVyc1tmXTtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBmaWx0ZXIubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIHJbZl0gKz0gc3BlY3RydW1bbl0gKiBmaWx0ZXJbbl07XG4gICAgICAgIH1cbiAgICAgICAgcltmXSA9IE1hdGgubG9nKE1hdGgubWF4KHJbZl0sIDJlLTQyKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHh0cmFjdF9kY3QocmVzdWx0KTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfbWlkaWNlbnQoZjApIHtcbiAgICBpZiAodHlwZW9mIGYwICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgdmFyIG5vdGUgPSAwLjA7XG4gICAgbm90ZSA9IDY5ICsgTWF0aC5sb2coZjAgLyA0NDAuMCkgKiAxNy4zMTIzNDtcbiAgICBub3RlICo9IDEwMDtcbiAgICBub3RlID0gTWF0aC5yb3VuZCgwLjUgKyBub3RlKTtcbiAgICByZXR1cm4gbm90ZTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfbm9pc2luZXNzKGgsIHApIHtcbiAgICB2YXIgaSA9IDAuMDtcbiAgICBpZiAodHlwZW9mIGggIT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIHAgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGkgPSBwIC0gaDtcbiAgICByZXR1cm4gaSAvIHA7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfbm9uemVyb19jb3VudChkYXRhKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgY291bnQgPSAwO1xuICAgIGlmIChkYXRhLnJlZHVjZSkge1xuICAgICAgICByZXR1cm4gZGF0YS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIGlmIChiICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgYSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGRhdGEubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgaWYgKGRhdGFbbl0gIT09IDApIHtcbiAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvdW50O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfb2RkX2V2ZW5fcmF0aW8oaGFybW9uaWNTcGVjdHJ1bSwgZjApIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoaGFybW9uaWNTcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIChmdW5jdGlvbiAoZjApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmMCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhyb3cgKFwic3BlY3RyYWxfaW5oYXJtb25pY2l0eSByZXF1aXJlcyBmMCB0byBiZSBkZWZpbmVkLlwiKTtcbiAgICAgICAgfVxuICAgIH0pKGYwKTtcbiAgICB2YXIgaCA9IDAsXG4gICAgICAgIG9kZCA9IDAuMCxcbiAgICAgICAgZXZlbiA9IDAuMCxcbiAgICAgICAgdGVtcDtcbiAgICB2YXIgTiA9IGhhcm1vbmljU3BlY3RydW0ubGVuZ3RoO1xuICAgIHZhciBLID0gTiA+PiAxO1xuICAgIHZhciBhbXBzID0gaGFybW9uaWNTcGVjdHJ1bS5zdWJhcnJheSgwLCBuKTtcbiAgICB2YXIgZnJlcXMgPSBoYXJtb25pY1NwZWN0cnVtLnN1YmFycmF5KG4pO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgSzsgbisrKSB7XG4gICAgICAgIHRlbXAgPSBhbXBzW25dO1xuICAgICAgICBpZiAodGVtcCAhPT0gMC4wKSB7XG4gICAgICAgICAgICBoID0gTWF0aC5mbG9vcihmcmVxc1tuXSAvIGYwICsgMC41KTtcbiAgICAgICAgICAgIGlmIChoICUgMiAhPT0gMCkge1xuICAgICAgICAgICAgICAgIG9kZCArPSB0ZW1wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBldmVuICs9IHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2RkID09PSAwLjAgfHwgZXZlbiA9PT0gMC4wKSB7XG4gICAgICAgIHJldHVybiAwLjA7XG4gICAgfVxuICAgIHJldHVybiBvZGQgLyBldmVuO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt0cmFuc2Zvcm19IGZyb20gXCIuLi9mcmVlRkZUXCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9pbnRlcmxhY2V9IGZyb20gXCIuL3h0cmFjdF9hcnJheV9pbnRlcmxhY2VcIjtcbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzfSBmcm9tIFwiLi94dHJhY3RfZ2V0X2RhdGFfZnJhbWVzXCI7XG5cbmZ1bmN0aW9uIGFuZ2xlKHJlYWwsIGltYWcpIHtcbiAgICBpZiAoaW1hZyA9PT0gdW5kZWZpbmVkICYmIHJlYWwubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiBNYXRoLmF0YW4yKHJlYWxbMV0sIHJlYWxbMF0pO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5hdGFuMihpbWFnLCByZWFsKTtcbn1cblxuZnVuY3Rpb24gYWJzKHJlYWwsIGltYWcpIHtcbiAgICBpZiAoaW1hZyA9PT0gdW5kZWZpbmVkICYmIHJlYWwubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3cocmVhbFswXSwgMikgKyBNYXRoLnBvdyhyZWFsWzFdLCAyKSk7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3cocmVhbCwgMikgKyBNYXRoLnBvdyhpbWFnLCAyKSk7XG59XG5cbmZ1bmN0aW9uIHByaW5jYXJnKHBoYXNlSW4pIHtcbiAgICAvL3BoYXNlPW1vZChwaGFzZWluK3BpLC0yKnBpKStwaTtcbiAgICByZXR1cm4gKHBoYXNlSW4gKyBNYXRoLlBJKSAlICgtMiAqIE1hdGguUEkpICsgTWF0aC5QSTtcbn1cblxuZnVuY3Rpb24gY29tcGxleF9tdWwoY3BseF9wYWlyX0EsIGNwbHhfcGFpcl9CKSB7XG4gICAgaWYgKGNwbHhfcGFpcl9BLmxlbmd0aCAhPT0gMiB8fCBjcGx4X3BhaXJfQi5sZW5ndGggIT09IDIpIHtcbiAgICAgICAgdGhyb3cgKFwiQm90aCBhcmd1bWVudHMgbXVzdCBiZSBudW1lcmFsIGFycmF5cyBvZiBsZW5ndGggMlwiKTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBjcGx4X3BhaXJfQS5jb25zdHJ1Y3RvcigyKTtcbiAgICByZXN1bHRbMF0gPSBjcGx4X3BhaXJfQVswXSAqIGNwbHhfcGFpcl9CWzBdIC0gY3BseF9wYWlyX0FbMV0gKiBjcGx4X3BhaXJfQlsxXTtcbiAgICByZXN1bHRbMV0gPSBjcGx4X3BhaXJfQVswXSAqIGNwbHhfcGFpcl9CWzFdICsgY3BseF9wYWlyX0FbMV0gKiBjcGx4X3BhaXJfQlswXTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBnZXRfWChmcmFtZXMsIGZyYW1lU2l6ZSkge1xuICAgIHZhciBOID0gZnJhbWVzLmxlbmd0aDtcbiAgICB2YXIgWCA9IFtdO1xuICAgIHZhciByZWFsID0gbmV3IEZsb2F0NjRBcnJheShmcmFtZVNpemUpO1xuICAgIHZhciBpbWFnID0gbmV3IEZsb2F0NjRBcnJheShmcmFtZVNpemUpO1xuICAgIHZhciBLID0gZnJhbWVTaXplIC8gMiArIDE7XG4gICAgdmFyIG47XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBOOyBpKyspIHtcbiAgICAgICAgZm9yIChuID0gMDsgbiA8IGZyYW1lU2l6ZTsgbisrKSB7XG4gICAgICAgICAgICByZWFsW25dID0gZnJhbWVzW2ldW25dO1xuICAgICAgICAgICAgaW1hZ1tuXSA9IDAuMDtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2Zvcm0ocmVhbCwgaW1hZyk7XG4gICAgICAgIFhbaV0gPSB4dHJhY3RfYXJyYXlfaW50ZXJsYWNlKFtyZWFsLnN1YmFycmF5KDAsIEspLCBpbWFnLnN1YmFycmF5KDAsIEspXSk7XG4gICAgfVxuICAgIHJldHVybiBYO1xufVxuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X29uc2V0KHRpbWVEYXRhLCBmcmFtZVNpemUpIHtcblxuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheSh0aW1lRGF0YSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChmcmFtZVNpemUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyAoXCJBbGwgYXJndW1lbnRzIGZvciB4dHJhY3Rfb25zZXQgbXVzdCBiZSBkZWZpbmVkOiB4dHJhY3Rfb25zZXQodGltZURhdGEsIGZyYW1lU2l6ZSlcIik7XG4gICAgfVxuICAgIHZhciBmcmFtZXMgPSB4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzKHRpbWVEYXRhLCBmcmFtZVNpemUsIGZyYW1lU2l6ZSwgZmFsc2UpO1xuICAgIHZhciBOID0gZnJhbWVzLmxlbmd0aDtcbiAgICB2YXIgSyA9IGZyYW1lU2l6ZSAvIDIgKyAxO1xuICAgIHZhciBYID0gZ2V0X1goZnJhbWVzLCBmcmFtZVNpemUpO1xuXG4gICAgdmFyIEUgPSBuZXcgdGltZURhdGEuY29uc3RydWN0b3IoTik7XG4gICAgdmFyIG47XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCBLOyBrKyspIHtcbiAgICAgICAgdmFyIHBoYXNlX3ByZXYgPSBhbmdsZShYWzBdLnN1YmFycmF5KDIgKiBrLCAyICogayArIDIpKTtcbiAgICAgICAgdmFyIHBoYXNlX2RlbHRhID0gYW5nbGUoWFswXS5zdWJhcnJheSgyICogaywgMiAqIGsgKyAyKSk7XG4gICAgICAgIGZvciAobiA9IDE7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgICAgIHZhciBwaGkgPSBwcmluY2FyZyhwaGFzZV9wcmV2ICsgcGhhc2VfZGVsdGEpO1xuICAgICAgICAgICAgdmFyIGV4cCA9IFtNYXRoLmNvcyhwaGkpLCBNYXRoLnNpbihwaGkpXTtcbiAgICAgICAgICAgIHZhciBYVCA9IGNvbXBsZXhfbXVsKFhbbl0uc3ViYXJyYXkoMiAqIGssIDIgKiBrICsgMiksIGV4cCk7XG4gICAgICAgICAgICBYVFswXSA9IFhbbl1bMiAqIGtdIC0gWFRbMF07XG4gICAgICAgICAgICBYVFsxXSA9IFhbbl1bMiAqIGsgKyAxXSAtIFhUWzFdO1xuICAgICAgICAgICAgRVtuXSArPSBhYnMoWFQpO1xuICAgICAgICAgICAgdmFyIHBoYXNlX25vdyA9IGFuZ2xlKFhbbl0uc3ViYXJyYXkoMiAqIGssIDIgKiBrICsgMikpO1xuICAgICAgICAgICAgcGhhc2VfZGVsdGEgPSBwaGFzZV9ub3cgLSBwaGFzZV9wcmV2O1xuICAgICAgICAgICAgcGhhc2VfcHJldiA9IHBoYXNlX25vdztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAobiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgRVtuXSAvPSBmcmFtZVNpemU7XG4gICAgfVxuICAgIHJldHVybiBFO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9pbml0X3BjcH0gZnJvbSBcIi4veHRyYWN0X2luaXRfcGNwXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3BjcChzcGVjdHJ1bSwgTSwgZnMpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aCA+PiAxO1xuICAgIGlmICh0eXBlb2YgTSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAodHlwZW9mIGZzICE9PSBcIm51bWJlclwiIHx8IGZzIDw9IDAuMCkge1xuICAgICAgICAgICAgdGhyb3cgKFwiQ2Fubm90IGR5bmFtaWNhbGx5IGNvbXB1dGUgTSBpZiBmcyBpcyB1bmRlZmluZWQgLyBub3QgYSB2YWxpZCBzYW1wbGUgcmF0ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBNID0geHRyYWN0X2luaXRfcGNwKE4sIGZzKTtcbiAgICB9XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgxLCBOKTtcbiAgICB2YXIgUENQID0gbmV3IEZsb2F0NjRBcnJheSgxMik7XG4gICAgZm9yICh2YXIgbCA9IDA7IGwgPCBhbXBzLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgIHZhciBwID0gTVtsXTtcbiAgICAgICAgUENQW2xdICs9IE1hdGgucG93KE1hdGguYWJzKGFtcHNbbF0pLCAyKTtcbiAgICB9XG4gICAgcmV0dXJuIFBDUDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbWF4fSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfbWF4XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3RfcGVha19zcGVjdHJ1bShzcGVjdHJ1bSwgcSwgdGhyZXNob2xkKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIEsgPSBOID4+IDE7XG4gICAgdmFyIG1heCA9IDAuMCxcbiAgICAgICAgeSA9IDAuMCxcbiAgICAgICAgeTIgPSAwLjAsXG4gICAgICAgIHkzID0gMC4wLFxuICAgICAgICBwID0gMC4wO1xuICAgIGlmICh0eXBlb2YgcSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfcGVha19zcGVjdHJ1bSByZXF1aXJlcyBzZWNvbmQgYXJndW1lbnQgdG8gYmUgc2FtcGxlX3JhdGUvTlwiKTtcbiAgICB9XG4gICAgaWYgKHRocmVzaG9sZCA8IDAgfHwgdGhyZXNob2xkID4gMTAwKSB7XG4gICAgICAgIHRocmVzaG9sZCA9IDA7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIHZhciBhbXBzSW4gPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBLKTtcbiAgICB2YXIgZnJlcXNJbiA9IHNwZWN0cnVtLnN1YmFycmF5KEspO1xuICAgIHZhciBhbXBzT3V0ID0gcmVzdWx0LnN1YmFycmF5KDAsIEspO1xuICAgIHZhciBmcmVxc091dCA9IHJlc3VsdC5zdWJhcnJheShLKTtcbiAgICBtYXggPSB4dHJhY3RfYXJyYXlfbWF4KGFtcHNJbik7XG4gICAgdGhyZXNob2xkICo9IDAuMDEgKiBtYXg7XG4gICAgZm9yICh2YXIgbiA9IDE7IG4gPCBOIC0gMTsgbisrKSB7XG4gICAgICAgIGlmIChhbXBzSW5bbl0gPj0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgICBpZiAoYW1wc0luW25dID4gYW1wc0luW24gLSAxXSAmJiBhbXBzSW5bbl0gPiBhbXBzSW5bbiArIDFdKSB7XG4gICAgICAgICAgICAgICAgeSA9IGFtcHNJbltuIC0gMV07XG4gICAgICAgICAgICAgICAgeTIgPSBhbXBzSW5bbl07XG4gICAgICAgICAgICAgICAgeTMgPSBhbXBzSW5bbiArIDFdO1xuICAgICAgICAgICAgICAgIHAgPSAwLjUgKiAoeSAtIHkzKSAvIChhbXBzSW5bbiAtIDFdIC0gMiAqICh5MiArIGFtcHNJbltuICsgMV0pKTtcbiAgICAgICAgICAgICAgICBmcmVxc091dFtuXSA9IHEgKiAobiArIDEgKyBwKTtcbiAgICAgICAgICAgICAgICBhbXBzT3V0W25dID0geTIgLSAwLjI1ICogKHkgLSB5MykgKiBwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbXBzT3V0W25dID0gMDtcbiAgICAgICAgICAgICAgICBmcmVxc091dFtuXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhbXBzT3V0W25dID0gMDtcbiAgICAgICAgICAgIGZyZXFzT3V0W25dID0gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9wb3dlcihtYWduaXR1ZGVBcnJheSkge1xuICAgIHJldHVybiBudWxsO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzfSBmcm9tIFwiLi94dHJhY3RfZ2V0X2RhdGFfZnJhbWVzXCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJ1bX0gZnJvbSBcIi4veHRyYWN0X3NwZWN0cnVtXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3Byb2Nlc3NfZnJhbWVfZGF0YShhcnJheSwgZnVuYywgc2FtcGxlX3JhdGUsIGZyYW1lX3NpemUsIGhvcF9zaXplLCBhcmdfdGhpcykge1xuICAgIHZhciBmcmFtZXMgPSB4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzKGFycmF5LCBmcmFtZV9zaXplLCBob3Bfc2l6ZSk7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgbnVtX2ZyYW1lczogZnJhbWVzLmxlbmd0aCxcbiAgICAgICAgcmVzdWx0czogW11cbiAgICB9O1xuICAgIHZhciBmcmFtZV90aW1lID0gMDtcbiAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgZnJhbWVfc2l6ZTogZnJhbWVfc2l6ZSxcbiAgICAgICAgaG9wX3NpemU6IGhvcF9zaXplLFxuICAgICAgICBzYW1wbGVfcmF0ZTogc2FtcGxlX3JhdGUsXG4gICAgICAgIFRpbWVEYXRhOiB1bmRlZmluZWQsXG4gICAgICAgIFNwZWN0cnVtRGF0YTogdW5kZWZpbmVkXG4gICAgfTtcbiAgICB2YXIgcHJldl9kYXRhO1xuICAgIHZhciBwcmV2X3Jlc3VsdDtcbiAgICBmb3IgKHZhciBmbiA9IDA7IGZuIDwgZnJhbWVzLmxlbmd0aDsgZm4rKykge1xuICAgICAgICB2YXIgZnJhbWUgPSBmcmFtZXNbZm5dO1xuICAgICAgICBkYXRhLlRpbWVEYXRhID0gZnJhbWU7XG4gICAgICAgIGRhdGEuU3BlY3RydW1EYXRhID0geHRyYWN0X3NwZWN0cnVtKGZyYW1lLCBzYW1wbGVfcmF0ZSwgdHJ1ZSwgZmFsc2UpO1xuICAgICAgICBwcmV2X3Jlc3VsdCA9IGZ1bmMuY2FsbChhcmdfdGhpcyB8fCB0aGlzLCBkYXRhLCBwcmV2X2RhdGEsIHByZXZfcmVzdWx0KTtcbiAgICAgICAgdmFyIGZyYW1lX3Jlc3VsdCA9IHtcbiAgICAgICAgICAgIHRpbWVfc3RhcnQ6IGZyYW1lX3RpbWUsXG4gICAgICAgICAgICByZXN1bHQ6IHByZXZfcmVzdWx0XG4gICAgICAgIH07XG4gICAgICAgIGZyYW1lX3RpbWUgKz0gZnJhbWVfc2l6ZSAvIHNhbXBsZV9yYXRlO1xuICAgICAgICBwcmV2X2RhdGEgPSBkYXRhO1xuICAgICAgICBkYXRhID0ge1xuICAgICAgICAgICAgZnJhbWVfc2l6ZTogZnJhbWVfc2l6ZSxcbiAgICAgICAgICAgIGhvcF9zaXplOiBob3Bfc2l6ZSxcbiAgICAgICAgICAgIHNhbXBsZV9yYXRlOiBzYW1wbGVfcmF0ZSxcbiAgICAgICAgICAgIFRpbWVEYXRhOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBTcGVjdHJ1bURhdGE6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICByZXN1bHQucmVzdWx0cy5wdXNoKGZyYW1lX3Jlc3VsdCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3RyYW5zZm9ybSwgaW52ZXJzZVRyYW5zZm9ybX0gZnJvbSBcIi4uL2ZyZWVGRlRcIjtcbmltcG9ydCB7eHRyYWN0X2dldF9kYXRhX2ZyYW1lc30gZnJvbSBcIi4veHRyYWN0X2dldF9kYXRhX2ZyYW1lc1wiO1xuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmZ1bmN0aW9uIGZpbHRlcihOLCBjKSB7XG4gICAgdmFyIGNfYiwgUmUsIEltLCBiO1xuICAgIGNfYiA9IE1hdGguZmxvb3IoYyAqIE4pO1xuICAgIFJlID0gbmV3IEZsb2F0NjRBcnJheShOKTtcbiAgICBJbSA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgdmFyIGksIGo7XG4gICAgZm9yIChpID0gMDsgaSA8IGNfYjsgaSsrKSB7XG4gICAgICAgIFJlW2ldID0gMTtcbiAgICB9XG4gICAgZm9yIChpID0gTiAtIGNfYiArIDE7IGkgPCBOOyBpKyspIHtcbiAgICAgICAgUmVbaV0gPSAxO1xuICAgIH1cbiAgICBpbnZlcnNlVHJhbnNmb3JtKFJlLCBJbSk7XG4gICAgLy8gU2NhbGUgYW5kIHNoaWZ0IGludG8gSW1cbiAgICBmb3IgKGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgIGogPSAoaSArIChOID4+IDEpKSAlIE47XG4gICAgICAgIEltW2ldID0gUmVbal0gLyBOO1xuICAgICAgICAvLyBBcHBseSBjb21wdXRlIGJsYWNrbWFuLWhhcnJpcyB0byBJbVxuICAgICAgICB2YXIgcmFkID0gKE1hdGguUEkgKiBpKSAvIChOKTtcbiAgICAgICAgSW1baV0gKj0gMC4zNTg3NSAtIDAuNDg4MjkgKiBNYXRoLmNvcygyICogcmFkKSArIDAuMTQxMjggKiBNYXRoLmNvcyg0ICogcmFkKSAtIDAuMDExNjggKiBNYXRoLmNvcyg2ICogcmFkKTtcbiAgICB9XG4gICAgcmV0dXJuIEltO1xufVxuXG5mdW5jdGlvbiBwb2x5bihkYXRhLCBLKSB7XG4gICAgdmFyIE4gPSBkYXRhLmxlbmd0aDtcbiAgICB2YXIgeCA9IFswLCBkYXRhWzBdLCBkYXRhWzFdXTtcbiAgICB2YXIgZHN0ID0gbmV3IEZsb2F0NjRBcnJheShLKTtcbiAgICB2YXIgcmF0aW8gPSBLIC8gTjtcbiAgICB2YXIgdGluYyA9IDEgLyByYXRpbztcbiAgICB2YXIgbiA9IDAsXG4gICAgICAgIHQgPSAwLFxuICAgICAgICBrO1xuICAgIGZvciAoayA9IDA7IGsgPCBLOyBrKyspIHtcbiAgICAgICAgaWYgKHQgPT09IG4pIHtcbiAgICAgICAgICAgIC8vIFBvaW50cyBsaWUgb24gc2FtZSB0aW1lXG4gICAgICAgICAgICBkc3Rba10gPSBkYXRhW25dO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHkgPSAodCAtIG4gLSAxKSAqICh0IC0gbikgKiB4WzBdIC0gMiAqICh0IC0gbiAtIDEpICogKHQgLSBuICsgMSkgKiB4WzFdICsgKHQgLSBuKSAqICh0IC0gbiArIDEpICogeFsyXTtcbiAgICAgICAgICAgIGRzdFtrXSA9IHkgLyAyO1xuICAgICAgICB9XG4gICAgICAgIHQgKz0gdGluYztcbiAgICAgICAgaWYgKHQgPj0gbiArIDEpIHtcbiAgICAgICAgICAgIG4gPSBNYXRoLmZsb29yKHQpO1xuICAgICAgICAgICAgeFswXSA9IGRhdGFbbiAtIDFdO1xuICAgICAgICAgICAgeFsxXSA9IGRhdGFbbl07XG4gICAgICAgICAgICBpZiAobiArIDEgPCBOKSB7XG4gICAgICAgICAgICAgICAgeFsyXSA9IGRhdGFbbiArIDFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4WzJdID0gMC4wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkc3Q7XG59XG5cbmZ1bmN0aW9uIHpwKGEpIHtcbiAgICB2YXIgYiA9IG5ldyBGbG9hdDY0QXJyYXkoYS5sZW5ndGggKiAyKTtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGEubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgYltuXSA9IGFbbl07XG4gICAgfVxuICAgIHJldHVybiBiO1xufVxuXG5mdW5jdGlvbiByMmMoeCkge1xuICAgIHZhciByZWFsID0genAoeCk7XG4gICAgdmFyIGltYWcgPSBuZXcgRmxvYXQ2NEFycmF5KHJlYWwubGVuZ3RoKTtcbiAgICB0cmFuc2Zvcm0ocmVhbCwgaW1hZyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVhbDogcmVhbCxcbiAgICAgICAgaW1hZzogaW1hZ1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIFcoTikge1xuICAgIHZhciB3ID0gbmV3IEZsb2F0NjRBcnJheShOKSxcbiAgICAgICAgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgIHZhciByYWQgPSAoTWF0aC5QSSAqIGkpIC8gKE4pO1xuICAgICAgICB3W2ldID0gMC4zNTg3NSAtIDAuNDg4MjkgKiBNYXRoLmNvcygyICogcmFkKSArIDAuMTQxMjggKiBNYXRoLmNvcyg0ICogcmFkKSAtIDAuMDExNjggKiBNYXRoLmNvcyg2ICogcmFkKTtcbiAgICB9XG4gICAgcmV0dXJuIHc7XG59XG5cbmZ1bmN0aW9uIG92ZXJsYXAoWCwgYikgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG1heC1zdGF0ZW1lbnRzXG4gICAgdmFyIGksIGY7XG4gICAgdmFyIFkgPSBuZXcgRmxvYXQ2NEFycmF5KFgubGVuZ3RoKTtcbiAgICB2YXIgTiA9IGIubGVuZ3RoO1xuICAgIHZhciBOMiA9IDIgKiBOO1xuICAgIHZhciBCID0gcjJjKGIpO1xuICAgIHZhciBYaSA9IHh0cmFjdF9nZXRfZGF0YV9mcmFtZXMoWCwgTiwgTiwgZmFsc2UpO1xuICAgIHZhciBZaSA9IHh0cmFjdF9nZXRfZGF0YV9mcmFtZXMoWSwgTiwgTiwgZmFsc2UpO1xuICAgIHZhciB4X2xhc3QgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIHZhciB5X2xhc3QgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIHZhciB3ID0gVyhOMik7XG4gICAgdmFyIHhGID0ge1xuICAgICAgICByZWFsOiBuZXcgRmxvYXQ2NEFycmF5KE4yKSxcbiAgICAgICAgaW1hZzogbmV3IEZsb2F0NjRBcnJheShOMilcbiAgICB9O1xuICAgIHZhciB5RiA9IHtcbiAgICAgICAgcmVhbDogbmV3IEZsb2F0NjRBcnJheShOMiksXG4gICAgICAgIGltYWc6IG5ldyBGbG9hdDY0QXJyYXkoTjIpXG4gICAgfTtcbiAgICBmb3IgKGYgPSAwOyBmIDwgWGkubGVuZ3RoOyBmKyspIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IE47IGkrKykge1xuICAgICAgICAgICAgeEYucmVhbFtpXSA9IHhfbGFzdFtpXSAqIHdbaV07XG4gICAgICAgICAgICB4Ri5yZWFsW2kgKyBOXSA9IFhpW2ZdW2ldICogd1tpICsgTl07XG4gICAgICAgICAgICB4X2xhc3RbaV0gPSBYaVtmXVtpXTtcbiAgICAgICAgICAgIHhGLmltYWdbaV0gPSAwO1xuICAgICAgICAgICAgeEYuaW1hZ1tpICsgTl0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zZm9ybSh4Ri5yZWFsLCB4Ri5pbWFnKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IE4yOyBpKyspIHtcbiAgICAgICAgICAgIHlGLnJlYWxbaV0gPSB4Ri5yZWFsW2ldICogQi5yZWFsW2ldIC0geEYuaW1hZ1tpXSAqIEIuaW1hZ1tpXTtcbiAgICAgICAgICAgIHlGLmltYWdbaV0gPSB4Ri5pbWFnW2ldICogQi5yZWFsW2ldICsgeEYucmVhbFtpXSAqIEIuaW1hZ1tpXTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2Zvcm0oeUYuaW1hZywgeUYucmVhbCk7XG4gICAgICAgIC8vIFBlcmZvcm0gZmZ0X3NoaWZ0IGFuZCBzY2FsZVxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaCA9IHlGLnJlYWxbaSArIE5dIC8gTjtcbiAgICAgICAgICAgIHlGLnJlYWxbaSArIE5dID0geUYucmVhbFtpXSAvIE47XG4gICAgICAgICAgICB5Ri5yZWFsW2ldID0gaDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgICAgICBZaVtmXVtpXSA9ICh5Ri5yZWFsW2ldICsgeV9sYXN0W2ldKTtcbiAgICAgICAgICAgIHlfbGFzdFtpXSA9IHlGLnJlYWxbaSArIE5dO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBZO1xufVxuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3Jlc2FtcGxlKGRhdGEsIHAsIHEsIG4pIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoZGF0YSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIC8vIFNhbWUgZnVuY3Rpb24gY2FsbCBhcyBtYXRsYWI6XG4gICAgLy8gZGF0YSBpcyB0aGUgYXJyYXlcbiAgICAvLyBwIGlzIHRoZSB0YXJnZXQgc2FtcGxlIHJhdGVcbiAgICAvLyBxIGlzIHRoZSBzb3VyY2Ugc2FtcGxlIHJhdGVcbiAgICAvLyBuIGlzIHRoZSBkZXNpcmVkIGZpbHRlciBvcmRlciwgbj09MTAyNCBpZiB1bmRlZmluZWRcblxuICAgIC8vIERldGVybWluZSB3aGljaCB3YXkgdG8gZ29cbiAgICB2YXIgYiwgTiA9IGRhdGEubGVuZ3RoO1xuICAgIGlmICh0eXBlb2YgbiAhPT0gXCJudW1iZXJcIiB8fCBuIDw9IDApIHtcbiAgICAgICAgbiA9IDUxMjtcbiAgICB9XG4gICAgaWYgKHAgPT09IHEpIHtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIHZhciByYXRpbyA9IChwIC8gcSk7XG4gICAgdmFyIEsgPSBNYXRoLmZsb29yKE4gKiByYXRpbyk7XG4gICAgdmFyIGRzdDtcbiAgICBpZiAocCA+IHEpIHtcbiAgICAgICAgLy8gVXBzYW1wbGluZ1xuICAgICAgICAvLyAxLiBFeHBhbmQgRGF0YSByYW5nZVxuICAgICAgICBkc3QgPSBwb2x5bihkYXRhLCBLKTtcbiAgICAgICAgLy8gMi4gRmlsdGVyIG91dCBzcHVyaW91cyBlbmVyZ3kgYWJvdmUgcVxuICAgICAgICBiID0gZmlsdGVyKG4sIDEgLyByYXRpbyk7XG4gICAgICAgIG92ZXJsYXAoZGF0YSwgYik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRG93bnNhbXBsaW5nXG4gICAgICAgIC8vIDEuIEZpbHRlciBvdXQgZW5lcmd5IGFib3ZlIHBcbiAgICAgICAgYiA9IGZpbHRlcihuLCByYXRpbyAvIDIpO1xuICAgICAgICB2YXIgZHMxID0gb3ZlcmxhcChkYXRhLCBiKTtcbiAgICAgICAgLy8gMi4gRGVjcmVhc2UgZGF0YSByYW5nZVxuICAgICAgICBkc3QgPSBwb2x5bihkczEsIEspO1xuICAgIH1cbiAgICByZXR1cm4gZHN0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfcm1zX2FtcGxpdHVkZSh0aW1lQXJyYXkpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkodGltZUFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgaWYgKHRpbWVBcnJheS5yZWR1Y2UpIHtcbiAgICAgICAgcmVzdWx0ID0gdGltZUFycmF5LnJlZHVjZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIGEgKyBiICogYjtcbiAgICAgICAgfSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCB0aW1lQXJyYXkubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0aW1lQXJyYXlbbl0gKiB0aW1lQXJyYXlbbl07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE1hdGguc3FydChyZXN1bHQgLyB0aW1lQXJyYXkubGVuZ3RoKTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfc3VtXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfcm9sbG9mZihzcGVjdHJ1bSwgc2FtcGxlUmF0ZSwgdGhyZXNob2xkKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKHR5cGVvZiBzYW1wbGVSYXRlICE9PSBcIm51bWJlclwiIHx8IHR5cGVvZiB0aHJlc2hvbGQgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ4dHJhY3Rfcm9sbG9mZiByZXF1aXJlcyBzYW1wbGVSYXRlIGFuZCB0aHJlc2hvbGQgdG8gYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBOID0gc3BlY3RydW0ubGVuZ3RoO1xuICAgIHZhciBLID0gTiA+PiAxO1xuICAgIHZhciBhbXBzID0gc3BlY3RydW0uc3ViYXJyYXkoMCwgSyk7XG5cbiAgICB2YXIgcGl2b3QgPSAwLFxuICAgICAgICB0ZW1wID0gMDtcblxuICAgIHBpdm90ID0geHRyYWN0X2FycmF5X3N1bShhbXBzKTtcblxuICAgIHBpdm90ICo9IHRocmVzaG9sZCAvIDEwMC4wO1xuICAgIHZhciBuID0gMDtcbiAgICB3aGlsZSAodGVtcCA8IHBpdm90KSB7XG4gICAgICAgIHRlbXAgKz0gYW1wc1tuXTtcbiAgICAgICAgbisrO1xuICAgIH1cbiAgICByZXR1cm4gbiAqIChzYW1wbGVSYXRlIC8gKHNwZWN0cnVtLmxlbmd0aCkpO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc2hhcnBuZXNzKGJhcmtCYW5kc0FycmF5KSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGJhcmtCYW5kc0FycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIE4gPSBiYXJrQmFuZHNBcnJheS5sZW5ndGg7XG5cbiAgICB2YXIgcnYsIHNsID0gMC4wLFxuICAgICAgICBnID0gMC4wLFxuICAgICAgICB0ZW1wID0gMC4wO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgTjsgbisrKSB7XG4gICAgICAgIHNsID0gTWF0aC5wb3coYmFya0JhbmRzQXJyYXlbbl0sIDAuMjMpO1xuICAgICAgICBnID0gKG4gPCAxNSA/IDEuMCA6IDAuMDY2ICogTWF0aC5leHAoMC4xNzEgKiBuKSk7XG4gICAgICAgIHRlbXAgKz0gbiAqIGcgKiBzbDtcbiAgICB9XG4gICAgdGVtcCA9IDAuMTEgKiB0ZW1wIC8gTjtcbiAgICByZXR1cm4gdGVtcDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X3NrZXduZXNzX2t1cnRvc2lzfSBmcm9tIFwiLi94dHJhY3Rfc2tld25lc3Nfa3VydG9zaXNcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc2tld25lc3MoYXJyYXksIG1lYW4sIHN0YW5kYXJkX2RldmlhdGlvbikge1xuICAgIHJldHVybiB4dHJhY3Rfc2tld25lc3Nfa3VydG9zaXMoYXJyYXksIG1lYW4sIHN0YW5kYXJkX2RldmlhdGlvbilbMF07XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X21lYW59IGZyb20gXCIuL3h0cmFjdF9tZWFuXCI7XG5pbXBvcnQge3h0cmFjdF9zdGFuZGFyZF9kZXZpYXRpb259IGZyb20gXCIuL3h0cmFjdF9zdGFuZGFyZF9kZXZpYXRpb25cIjtcbmltcG9ydCB7eHRyYWN0X3ZhcmlhbmNlfSBmcm9tIFwiLi94dHJhY3RfdmFyaWFuY2VcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9za2V3bmVzc19rdXJ0b3NpcyhhcnJheSwgbWVhbiwgc3RhbmRhcmRfZGV2aWF0aW9uKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGFycmF5KSlcbiAgICAgICAgcmV0dXJuIFswLjAsIDAuMF07XG4gICAgaWYgKHR5cGVvZiBtZWFuICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIG1lYW4gPSB4dHJhY3RfbWVhbihhcnJheSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc3RhbmRhcmRfZGV2aWF0aW9uICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHN0YW5kYXJkX2RldmlhdGlvbiA9IHh0cmFjdF9zdGFuZGFyZF9kZXZpYXRpb24oYXJyYXksIHh0cmFjdF92YXJpYW5jZShhcnJheSwgbWVhbikpO1xuICAgIH1cbiAgICBpZiAoc3RhbmRhcmRfZGV2aWF0aW9uID09PSAwKSB7XG4gICAgICAgIHJldHVybiBbMC4wLCAwLjBdO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gWzAuMCwgMC4wXTtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGFycmF5Lmxlbmd0aDsgbisrKSB7XG4gICAgICAgIHJlc3VsdFswXSArPSBNYXRoLnBvdygoYXJyYXlbbl0gLSBtZWFuKSAvIHN0YW5kYXJkX2RldmlhdGlvbiwgMyk7XG4gICAgICAgIHJlc3VsdFsxXSArPSBNYXRoLnBvdygoYXJyYXlbbl0gLSBtZWFuKSAvIHN0YW5kYXJkX2RldmlhdGlvbiwgNCk7XG4gICAgfVxuICAgIHJlc3VsdFswXSAvPSBhcnJheS5sZW5ndGg7XG4gICAgcmVzdWx0WzFdIC89IGFycmF5Lmxlbmd0aDtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc21vb3RobmVzcyhzcGVjdHJ1bSkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciBwcmV2ID0gMCxcbiAgICAgICAgY3VycmVudCA9IDAsXG4gICAgICAgIG5leHQgPSAwLFxuICAgICAgICB0ZW1wID0gMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgSyA9IE4gPj4gMTtcbiAgICBwcmV2ID0gTWF0aC5tYXgoMWUtNSwgc3BlY3RydW1bMF0pO1xuICAgIGN1cnJlbnQgPSBNYXRoLm1heCgxZS01LCBzcGVjdHJ1bVsxXSk7XG4gICAgZm9yICh2YXIgbiA9IDE7IG4gPCBLIC0gMTsgbisrKSB7XG4gICAgICAgIG5leHQgPSBNYXRoLm1heCgxZS01LCBzcGVjdHJ1bVtuICsgMV0pO1xuICAgICAgICB0ZW1wICs9IE1hdGguYWJzKDIwLjAgKiBNYXRoLmxvZyhjdXJyZW50KSAtICgyMC4wICogTWF0aC5sb2cocHJldikgKyAyMC4wICogTWF0aC5sb2coY3VycmVudCkgKyAyMC4wICogTWF0aC5sb2cobmV4dCkpIC8gMy4wKTtcbiAgICAgICAgcHJldiA9IGN1cnJlbnQ7XG4gICAgICAgIGN1cnJlbnQgPSBuZXh0O1xuICAgIH1cbiAgICByZXR1cm4gdGVtcDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfc3VtXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3NwZWN0cmFsX2NlbnRyb2lkKHNwZWN0cnVtKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIG4gPSBOID4+IDE7XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBuKTtcbiAgICB2YXIgZnJlcXMgPSBzcGVjdHJ1bS5zdWJhcnJheShuKTtcbiAgICB2YXIgQV9kID0geHRyYWN0X2FycmF5X3N1bShhbXBzKTtcbiAgICBpZiAoQV9kID09PSAwLjApIHtcbiAgICAgICAgcmV0dXJuIDAuMDtcbiAgICB9XG4gICAgdmFyIHN1bSA9IDAuMDtcbiAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgIHN1bSArPSBmcmVxc1tuXSAqIChhbXBzW25dIC8gQV9kKTtcbiAgICB9XG4gICAgcmV0dXJuIHN1bTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHtpbnZlcnNlVHJhbnNmb3JtfSBmcm9tIFwiLi4vZnJlZUZGVC5qc1wiO1xuZnVuY3Rpb24gcGVha19waWNraW5nKEUsIHdpbmRvdykge1xuICAgIHZhciBvID0gW10sXG4gICAgICAgIE4gPSBFLmxlbmd0aCxcbiAgICAgICAgbjtcbiAgICBpZiAod2luZG93ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgd2luZG93ID0gNTtcbiAgICB9XG4gICAgZm9yIChuID0gd2luZG93OyBuIDwgTiAtIHdpbmRvdyAtIDE7IG4rKykge1xuICAgICAgICB2YXIgbWF4ID0gMSxcbiAgICAgICAgICAgIG07XG4gICAgICAgIGZvciAobSA9IC13aW5kb3c7IG0gPCB3aW5kb3cgLSAxOyBtKyspIHtcbiAgICAgICAgICAgIGlmIChFW24gKyBtXSA+IEVbbl0pIHtcbiAgICAgICAgICAgICAgICBtYXggPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtYXggPT09IDEpIHtcbiAgICAgICAgICAgIG8ucHVzaChuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9zcGVjdHJhbF9mdW5kYW1lbnRhbChzcGVjdHJ1bSwgc2FtcGxlX3JhdGUpIHtcbiAgICAvLyBCYXNlZCBvbiB3b3JrIGJ5IE1vdGVnaSBhbmQgU2hpbWFtdXJhXG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHNwZWN0cnVtKSlcbiAgICAgICAgcmV0dXJuIDA7XG5cbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aCA+PiAxO1xuICAgIHZhciBhbXBzID0gc3BlY3RydW0uc3ViYXJyYXkoMCwgTik7XG4gICAgdmFyIGZyZXFzID0gc3BlY3RydW0uc3ViYXJyYXkoTik7XG4gICAgdmFyIEsgPSBOICogMjtcblxuICAgIC8vIENyZWF0ZSB0aGUgcG93ZXIgc3BlY3RydW1cbiAgICB2YXIgcG93ZXIgPSBuZXcgRmxvYXQ2NEFycmF5KEspO1xuICAgIHZhciBuO1xuICAgIGZvciAobiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgcG93ZXJbbl0gPSBNYXRoLnBvdyhhbXBzW25dLCAyKTtcbiAgICAgICAgcG93ZXJbSyAtIDEgLSBuXSA9IHBvd2VyW25dO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm0gYXV0b2NvcnJlbGF0aW9uIHVzaW5nIElGRlRcbiAgICB2YXIgUiA9IG5ldyBGbG9hdDY0QXJyYXkoSyk7XG4gICAgaW52ZXJzZVRyYW5zZm9ybShwb3dlciwgUik7XG4gICAgUiA9IHVuZGVmaW5lZDtcbiAgICBSID0gcG93ZXI7XG4gICAgcG93ZXIgPSB1bmRlZmluZWQ7XG5cbiAgICAvLyBHZXQgdGhlIHBlYWtzXG4gICAgdmFyIHAgPSBwZWFrX3BpY2tpbmcoUiwgNSk7XG4gICAgaWYgKHAubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBwID0gcFswXTtcblxuICAgIHAgPSBwIC8gc2FtcGxlX3JhdGU7XG4gICAgcCA9IDEgLyBwO1xuICAgIHJldHVybiBwO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eShwZWFrU3BlY3RydW0sIGYwKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHBlYWtTcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2YgZjAgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcInNwZWN0cmFsX2luaGFybW9uaWNpdHkgcmVxdWlyZXMgZjAgdG8gYmUgZGVmaW5lZC5cIik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgaCA9IDAsXG4gICAgICAgIG51bSA9IDAuMCxcbiAgICAgICAgZGVuID0gMC4wO1xuICAgIHZhciBOID0gcGVha1NwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgSyA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHBlYWtTcGVjdHJ1bS5zdWJhcnJheSgwLCBuKTtcbiAgICB2YXIgZnJlcXMgPSBwZWFrU3BlY3RydW0uc3ViYXJyYXkobik7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBLOyBuKyspIHtcbiAgICAgICAgaWYgKGFtcHNbbl0gIT09IDAuMCkge1xuICAgICAgICAgICAgaCA9IE1hdGguZmxvb3IoZnJlcXNbbl0gLyBmMCArIDAuNSk7XG4gICAgICAgICAgICB2YXIgbWFnX3NxID0gTWF0aC5wb3coYW1wc1tuXSwgMik7XG4gICAgICAgICAgICBudW0gKz0gTWF0aC5hYnMoZnJlcXNbbl0gLSBoICogZjApICogbWFnX3NxO1xuICAgICAgICAgICAgZGVuICs9IG1hZ19zcTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKDIgKiBudW0pIC8gKGYwICogZGVuKTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWR9IGZyb20gXCIuL3h0cmFjdF9zcGVjdHJhbF9jZW50cm9pZFwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9ufSBmcm9tIFwiLi94dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uXCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJhbF92YXJpYW5jZX0gZnJvbSBcIi4veHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlXCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9zdW19IGZyb20gXCIuL3h0cmFjdF9hcnJheV9zdW1cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9zcGVjdHJhbF9rdXJ0b3NpcyhzcGVjdHJ1bSwgc3BlY3RyYWxfY2VudHJvaWQsIHNwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbikge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2Ygc3BlY3RyYWxfY2VudHJvaWQgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc3BlY3RyYWxfY2VudHJvaWQgPSB4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWQoc3BlY3RydW0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbiAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24gPSB4dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uKHNwZWN0cnVtLCB4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2Uoc3BlY3RydW0sIHNwZWN0cmFsX2NlbnRyb2lkKSk7XG4gICAgfVxuICAgIGlmIChzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIEluZmluaXR5O1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgSyA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHNwZWN0cnVtLnN1YmFycmF5KDAsIEspO1xuICAgIHZhciBmcmVxcyA9IHNwZWN0cnVtLnN1YmFycmF5KEspO1xuICAgIHZhciBBX2QgPSB4dHJhY3RfYXJyYXlfc3VtKGFtcHMpO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgSzsgbisrKSB7XG4gICAgICAgIHJlc3VsdCArPSBNYXRoLnBvdyhmcmVxc1tuXSAtIHNwZWN0cmFsX2NlbnRyb2lkLCA0KSAqIChhbXBzW25dIC8gQV9kKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdCAvIE1hdGgucG93KHNwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbiwgNCk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X3N1bX0gZnJvbSBcIi4veHRyYWN0X2FycmF5X3N1bVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3NwZWN0cmFsX21lYW4oc3BlY3RydW0pIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgbiA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHNwZWN0cnVtLnN1YmFycmF5KDAsIG4pO1xuICAgIHZhciBzdW0gPSB4dHJhY3RfYXJyYXlfc3VtKGFtcHMpO1xuICAgIHZhciByZXN1bHQgPSBzdW0gLyBuO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX2NlbnRyb2lkfSBmcm9tIFwiLi94dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWRcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbn0gZnJvbSBcIi4veHRyYWN0X3NwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvblwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2V9IGZyb20gXCIuL3h0cmFjdF9zcGVjdHJhbF92YXJpYW5jZVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfc3VtXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc3BlY3RyYWxfc2tld25lc3Moc3BlY3RydW0sIHNwZWN0cmFsX2NlbnRyb2lkLCBzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24pIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIHNwZWN0cmFsX21lYW4gIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc3BlY3RyYWxfY2VudHJvaWQgPSB4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWQoc3BlY3RydW0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbiAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24gPSB4dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uKHNwZWN0cnVtLCB4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2Uoc3BlY3RydW0sIHNwZWN0cmFsX2NlbnRyb2lkKSk7XG4gICAgfVxuICAgIGlmIChzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSAwO1xuICAgIHZhciBOID0gc3BlY3RydW0ubGVuZ3RoO1xuICAgIHZhciBLID0gTiA+PiAxO1xuICAgIHZhciBhbXBzID0gc3BlY3RydW0uc3ViYXJyYXkoMCwgSyk7XG4gICAgdmFyIGZyZXFzID0gc3BlY3RydW0uc3ViYXJyYXkoSyk7XG4gICAgdmFyIEFfZCA9IHh0cmFjdF9hcnJheV9zdW0oYW1wcyk7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCBLOyBuKyspIHtcbiAgICAgICAgcmVzdWx0ICs9IE1hdGgucG93KGZyZXFzW25dIC0gc3BlY3RyYWxfY2VudHJvaWQsIDMpICogKGFtcHNbbl0gLyBBX2QpO1xuICAgIH1cbiAgICByZXN1bHQgLz0gTWF0aC5wb3coc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uLCAzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9zdW19IGZyb20gXCIuL3h0cmFjdF9hcnJheV9zdW1cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9zcGVjdHJhbF9zbG9wZShzcGVjdHJ1bSkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciBGID0gMC4wLFxuICAgICAgICBGQSA9IDAuMCxcbiAgICAgICAgQSA9IDAuMCxcbiAgICAgICAgRlhUUkFDVF9TUSA9IDAuMDtcbiAgICB2YXIgTiA9IHNwZWN0cnVtLmxlbmd0aDtcbiAgICB2YXIgTSA9IE4gPj4gMTtcbiAgICB2YXIgYW1wcyA9IHNwZWN0cnVtLnN1YmFycmF5KDAsIE0pO1xuICAgIHZhciBmcmVxcyA9IHNwZWN0cnVtLnN1YmFycmF5KE0pO1xuICAgIEYgPSB4dHJhY3RfYXJyYXlfc3VtKGZyZXFzKTtcbiAgICBBID0geHRyYWN0X2FycmF5X3N1bShhbXBzKTtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IE07IG4rKykge1xuICAgICAgICBGQSArPSBmcmVxc1tuXSAqIGFtcHNbbl07XG4gICAgICAgIEZYVFJBQ1RfU1EgKz0gZnJlcXNbbl0gKiBmcmVxc1tuXTtcbiAgICB9XG4gICAgcmV0dXJuICgxLjAgLyBBKSAqIChNICogRkEgLSBGICogQSkgLyAoTSAqIEZYVFJBQ1RfU1EgLSBGICogRik7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJhbF92YXJpYW5jZX0gZnJvbSBcIi4veHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3NwZWN0cmFsX3NwcmVhZChzcGVjdHJ1bSwgc3BlY3RyYWxfY2VudHJvaWQpIHtcbiAgICByZXR1cm4geHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlKHNwZWN0cnVtLCBzcGVjdHJhbF9jZW50cm9pZCk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlfSBmcm9tIFwiLi94dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2VcIjtcbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uKHNwZWN0cnVtLCBzcGVjdHJhbF92YXJpYW5jZSkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2Ygc3BlY3RyYWxfdmFyaWFuY2UgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc3BlY3RyYWxfdmFyaWFuY2UgPSB4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2Uoc3BlY3RydW0pO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5zcXJ0KHNwZWN0cmFsX3ZhcmlhbmNlKTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWR9IGZyb20gXCIuL3h0cmFjdF9zcGVjdHJhbF9jZW50cm9pZFwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfc3VtXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlKHNwZWN0cnVtLCBzcGVjdHJhbF9jZW50cm9pZCkge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShzcGVjdHJ1bSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2Ygc3BlY3RyYWxfY2VudHJvaWQgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc3BlY3RyYWxfY2VudHJvaWQgPSB4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWQoc3BlY3RydW0pO1xuICAgIH1cbiAgICB2YXIgQSA9IDAsXG4gICAgICAgIHJlc3VsdCA9IDA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIG4gPSBOID4+IDE7XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBuKTtcbiAgICB2YXIgZnJlcXMgPSBzcGVjdHJ1bS5zdWJhcnJheShuLCBOKTtcbiAgICB2YXIgQV9kID0geHRyYWN0X2FycmF5X3N1bShhbXBzKTtcbiAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgIHJlc3VsdCArPSBNYXRoLnBvdyhmcmVxc1tuXSAtIHNwZWN0cmFsX2NlbnRyb2lkLCAyKSAqIChhbXBzW25dIC8gQV9kKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbm9ybWFsaXNlfSBmcm9tIFwiLi94dHJhY3RfYXJyYXlfbm9ybWFsaXNlXCI7XG5pbXBvcnQge3RyYW5zZm9ybX0gZnJvbSBcIi4uL2ZyZWVGRlRcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF9zcGVjdHJ1bShhcnJheSwgc2FtcGxlX3JhdGUsIHdpdGhEQywgbm9ybWFsaXNlKSB7XG4gICAgKGZ1bmN0aW9uIChhcnJheSwgc2FtcGxlX3JhdGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzYW1wbGVfcmF0ZSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhyb3cgKFwiU2FtcGxlIFJhdGUgbXVzdCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICB9XG4gICAgfSkoYXJyYXksIHNhbXBsZV9yYXRlKTtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoYXJyYXkpKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICB3aXRoREMgPSAod2l0aERDID09PSB0cnVlKTtcbiAgICBub3JtYWxpc2UgPSAobm9ybWFsaXNlID09PSB0cnVlKTtcblxuICAgIHZhciBOID0gYXJyYXkubGVuZ3RoO1xuICAgIHZhciByZXN1bHQsIGFsaWduID0gMDtcbiAgICB2YXIgYW1wcztcbiAgICB2YXIgZnJlcXM7XG4gICAgaWYgKHdpdGhEQykge1xuICAgICAgICByZXN1bHQgPSBuZXcgRmxvYXQ2NEFycmF5KE4gKyAyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhbGlnbiA9IDE7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgfVxuICAgIGFtcHMgPSByZXN1bHQuc3ViYXJyYXkoMCwgcmVzdWx0Lmxlbmd0aCAvIDIpO1xuICAgIGZyZXFzID0gcmVzdWx0LnN1YmFycmF5KHJlc3VsdC5sZW5ndGggLyAyKTtcbiAgICB2YXIgcmVhbHMgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIHZhciBpbWFncyA9IG5ldyBGbG9hdDY0QXJyYXkoTik7XG4gICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAodiwgaSkge1xuICAgICAgICByZWFsc1tpXSA9IHY7XG4gICAgfSk7XG4gICAgdHJhbnNmb3JtKHJlYWxzLCBpbWFncyk7XG4gICAgZm9yICh2YXIgayA9IGFsaWduOyBrIDw9IHJlc3VsdC5sZW5ndGggLyAyOyBrKyspIHtcbiAgICAgICAgYW1wc1trIC0gYWxpZ25dID0gTWF0aC5zcXJ0KChyZWFsc1trXSAqIHJlYWxzW2tdKSArIChpbWFnc1trXSAqIGltYWdzW2tdKSkgLyBhcnJheS5sZW5ndGg7XG4gICAgICAgIGZyZXFzW2sgLSBhbGlnbl0gPSAoMiAqIGsgLyBOKSAqIChzYW1wbGVfcmF0ZSAvIDIpO1xuICAgIH1cbiAgICBpZiAobm9ybWFsaXNlKSB7XG4gICAgICAgIGFtcHMgPSB4dHJhY3RfYXJyYXlfbm9ybWFsaXNlKGFtcHMpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF92YXJpYW5jZX0gZnJvbSBcIi4veHRyYWN0X3ZhcmlhbmNlXCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3N0YW5kYXJkX2RldmlhdGlvbihhcnJheSwgdmFyaWFuY2UpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoYXJyYXkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIHZhcmlhbmNlICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHZhcmlhbmNlID0geHRyYWN0X3ZhcmlhbmNlKGFycmF5KTtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGguc3FydCh2YXJpYW5jZSk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X3N1bX0gZnJvbSBcIi4veHRyYWN0X2FycmF5X3N1bVwiO1xuXG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3N1bShkYXRhKSB7XG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KGRhdGEpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICByZXR1cm4geHRyYWN0X2FycmF5X3N1bShkYXRhKTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2FycmF5X3N1bX0gZnJvbSBcIi4veHRyYWN0X2FycmF5X3N1bVwiO1xuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF90ZW1wb3JhbF9jZW50cm9pZChlbmVyZ3lBcnJheSwgc2FtcGxlX3JhdGUsIHdpbmRvd19tcykge1xuICAgIGlmICh0eXBlb2Ygc2FtcGxlX3JhdGUgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcInh0cmFjdF90ZW1wb3JhbF9jZW50cm9pZCByZXF1aXJlcyBzYW1wbGVfcmF0ZSB0byBiZSBhIG51bWJlclwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvd19tcyAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBjb25zb2xlLmxvZyhcInh0cmFjdF90ZW1wb3JhbF9jZW50cm9pZCBhc3N1bWluZyB3aW5kb3dfbXMgPSAxMDBtc1wiKTtcbiAgICAgICAgd2luZG93X21zID0gMTAwLjA7XG4gICAgfVxuICAgIGlmICh3aW5kb3dfbXMgPD0gMCkge1xuICAgICAgICB3aW5kb3dfbXMgPSAxMDAuMDtcbiAgICB9XG4gICAgdmFyIHRzID0gMS4wIC8gc2FtcGxlX3JhdGU7XG4gICAgdmFyIEwgPSBzYW1wbGVfcmF0ZSAqICh3aW5kb3dfbXMgLyAxMDAwLjApO1xuICAgIHZhciBkZW4gPSB4dHJhY3RfYXJyYXlfc3VtKGVuZXJneUFycmF5KTtcbiAgICB2YXIgbnVtID0gMC4wO1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZW5lcmd5QXJyYXkubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgbnVtICs9IGVuZXJneUFycmF5W25dICogKG4gKiBMICogdHMpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gbnVtIC8gZGVuO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcbmltcG9ydCB7eHRyYWN0X2ZsYXRuZXNzX2RifSBmcm9tIFwiLi94dHJhY3RfZmxhdG5lc3NfZGJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF90b25hbGl0eShzcGVjdHJ1bSwgZmxhdG5lc3NfZGIpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIGZsYXRuZXNzX2RiICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGZsYXRuZXNzX2RiID0geHRyYWN0X2ZsYXRuZXNzX2RiKHNwZWN0cnVtKTtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKGZsYXRuZXNzX2RiIC8gLTYwLjAsIDEpO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3RyaXN0aW11bHVzKHNwZWN0cnVtLCBmMCkge1xuICAgIHZhciB0cmlzdCA9IFswLjAsIDAuMCwgMC4wXTtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoc3BlY3RydW0pKVxuICAgICAgICByZXR1cm4gdHJpc3Q7XG4gICAgaWYgKHR5cGVvZiBmMCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfdHJpc3RpbXVsdXMgcmVxdWlyZXMgZjAgdG8gYmUgZGVmaW5lZCBhbmQgYSBudW1iZXJcIik7XG4gICAgfVxuICAgIHZhciBoID0gMCxcbiAgICAgICAgZGVuID0gMC4wLFxuICAgICAgICBwID0gWzAsIDAsIDAsIDAsIDBdLFxuICAgICAgICB0ZW1wID0gMC4wLFxuICAgICAgICBudW0gPSAwLjA7XG4gICAgdmFyIE4gPSBzcGVjdHJ1bS5sZW5ndGg7XG4gICAgdmFyIEsgPSBOID4+IDE7XG4gICAgdmFyIGFtcHMgPSBzcGVjdHJ1bS5zdWJhcnJheSgwLCBLKTtcbiAgICB2YXIgZnJlcXMgPSBzcGVjdHJ1bS5zdWJhcnJheShLKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgSzsgaSsrKSB7XG4gICAgICAgIHRlbXAgPSBhbXBzW2ldO1xuICAgICAgICBpZiAodGVtcCAhPT0gMCkge1xuICAgICAgICAgICAgZGVuICs9IHRlbXA7XG4gICAgICAgICAgICBoID0gTWF0aC5mbG9vcihmcmVxc1tpXSAvIGYwICsgMC41KTtcbiAgICAgICAgICAgIHBbaCAtIDFdICs9IHRlbXA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGVuICE9PSAwLjApIHtcbiAgICAgICAgdHJpc3RbMF0gPSBwWzBdIC8gZGVuO1xuICAgICAgICB0cmlzdFsxXSA9IChwWzFdICsgcFsyXSArIHBbM10pIC8gZGVuO1xuICAgICAgICB0cmlzdFsyXSA9IHBbNF0gLyBkZW47XG4gICAgfVxuICAgIHJldHVybiB0cmlzdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF90cmlzdGltdWx1c18xKHNwZWN0cnVtLCBmMCkge1xuICAgIHJldHVybiB4dHJhY3RfdHJpc3RpbXVsdXMoc3BlY3RydW0sIGYwKVswXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF90cmlzdGltdWx1c18yKHNwZWN0cnVtLCBmMCkge1xuICAgIHJldHVybiB4dHJhY3RfdHJpc3RpbXVsdXMoc3BlY3RydW0sIGYwKVsxXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF90cmlzdGltdWx1c18zKHNwZWN0cnVtLCBmMCkge1xuICAgIHJldHVybiB4dHJhY3RfdHJpc3RpbXVsdXMoc3BlY3RydW0sIGYwKVsyXTtcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2Z1bmN0aW9ucy5kLnRzXCIgLz5cbmltcG9ydCB7eHRyYWN0X2Fzc2VydF9hcnJheX0gZnJvbSBcIi4veHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHt4dHJhY3RfbWVhbn0gZnJvbSBcIi4veHRyYWN0X21lYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF92YXJpYW5jZShhcnJheSwgbWVhbikge1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShhcnJheSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICh0eXBlb2YgbWVhbiAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICBtZWFuID0geHRyYWN0X21lYW4oYXJyYXkpO1xuICAgIH1cbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkoYXJyYXkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAodHlwZW9mIG1lYW4gIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgbWVhbiA9IHh0cmFjdF9tZWFuKGFycmF5KTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IDAuMDtcbiAgICBpZiAoYXJyYXkucmVkdWNlKSB7XG4gICAgICAgIHJlc3VsdCA9IGFycmF5LnJlZHVjZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgYSArPSBNYXRoLnBvdyhiIC0gbWVhbiwgMik7XG4gICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgfSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBhcnJheS5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IE1hdGgucG93KGFycmF5W25dIC0gbWVhbiwgMik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0IC89IChhcnJheS5sZW5ndGggLSAxKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9zdW19IGZyb20gXCIuL3h0cmFjdF9hcnJheV9zdW1cIjtcbmltcG9ydCB7eHRyYWN0X21lYW59IGZyb20gXCIuL3h0cmFjdF9tZWFuXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB4dHJhY3Rfd2F2ZWxldF9mMCh0aW1lQXJyYXksIHNhbXBsZVJhdGUsIHBpdGNodHJhY2tlcikgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG1heC1zdGF0ZW1lbnRzXG4gICAgaWYgKCF4dHJhY3RfYXNzZXJ0X2FycmF5KHRpbWVBcnJheSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChwaXRjaHRyYWNrZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyAoXCJ4dHJhY3Rfd2F2ZWxldF9mMCByZXF1aXJlcyBwaXRjaHRyYWNrZXIgdG8gYmUgZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgaWYgKHh0cmFjdF9hcnJheV9zdW0odGltZUFycmF5KSA9PT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3Bvd2VyMnAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSAmIDB4MSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChfcG93ZXIycCh2YWx1ZSA+PiAxKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2JpdGNvdW50KHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfYml0Y291bnQodmFsdWUgPj4gMSkgKyAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9jZWlsX3Bvd2VyMih2YWx1ZSkge1xuICAgICAgICBpZiAoX3Bvd2VyMnAodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9XG4gICAgICAgIHZhciBqLCBpID0gX2JpdGNvdW50KHZhbHVlKTtcbiAgICAgICAgdmFyIHJlcyA9IDE7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBpOyBqKyspIHtcbiAgICAgICAgICAgIHJlcyA8PD0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9mbG9vcl9wb3dlcjIodmFsdWUpIHtcbiAgICAgICAgaWYgKF9wb3dlcjJwKHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfY2VpbF9wb3dlcjIodmFsdWUpIC8gMjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfaWFicyh4KSB7XG4gICAgICAgIGlmICh4ID49IDApIHJldHVybiB4O1xuICAgICAgICByZXR1cm4gLXg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gXzJwb3dlcihpKSB7XG4gICAgICAgIHZhciByZXMgPSAxLFxuICAgICAgICAgICAgajtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGk7IGorKykge1xuICAgICAgICAgICAgcmVzIDw8PSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHl3YXBpdGNoX25lZWRlZHNhbXBsZWNvdW50KG1pbkZyZXEpIHtcbiAgICAgICAgdmFyIG5iU2FtID0gMyAqIDQ0MTAwIC8gbWluRnJlcTsgLy8gMTAxNy4gZm9yIDEzMCBIelxuICAgICAgICBuYlNhbSA9IF9jZWlsX3Bvd2VyMihuYlNhbSk7IC8vIDEwMjRcbiAgICAgICAgcmV0dXJuIG5iU2FtO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJvZHlMb29wKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG1heC1zdGF0ZW1lbnRzXG4gICAgICAgIGRlbHRhID0gTWF0aC5mbG9vcig0NDEwMCAvIChfMnBvd2VyKGN1ckxldmVsKSAqIDMwMDApKTtcbiAgICAgICAgaWYgKGN1clNhbU5iIDwgMikge1xuICAgICAgICAgICAgY29udCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkdiwgcHJldmlvdXNEViA9IC0xMDAwO1xuICAgICAgICB2YXIgbmJNaW5zID0gMCxcbiAgICAgICAgICAgIG5iTWF4cyA9IDA7XG4gICAgICAgIHZhciBsYXN0TWluSW5kZXggPSAtMTAwMDAwMDtcbiAgICAgICAgdmFyIGxhc3RtYXhJbmRleCA9IC0xMDAwMDAwO1xuICAgICAgICB2YXIgZmluZE1heCA9IDA7XG4gICAgICAgIHZhciBmaW5kTWluID0gMDtcbiAgICAgICAgKGZ1bmN0aW9uICgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjb21wbGV4aXR5XG4gICAgICAgICAgICBmb3IgKGkgPSAyOyBpIDwgY3VyU2FtTmI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNpID0gc2FtW2ldIC0gdGhlREM7XG4gICAgICAgICAgICAgICAgc2kxID0gc2FtW2kgLSAxXSAtIHRoZURDO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNpMSA8PSAwICYmIHNpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmaW5kTWF4ID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNpMSA+PSAwICYmIHNpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBmaW5kTWluID0gMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBtaW4gb3IgbWF4ID9cbiAgICAgICAgICAgICAgICBkdiA9IHNpIC0gc2kxO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzRFYgPiAtMTAwMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaW5kTWluICYmIHByZXZpb3VzRFYgPCAwICYmIGR2ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1pbmltdW1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhzaSkgPj0gYW1wbHRpdHVkZVRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID4gbGFzdE1pbkluZGV4ICsgZGVsdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluc1tuYk1pbnMrK10gPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0TWluSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kTWluID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZmluZE1heCAmJiBwcmV2aW91c0RWID4gMCAmJiBkdiA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXhpbXVtXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoc2kpID49IGFtcGx0aXR1ZGVUaHJlc2hvbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IGxhc3RtYXhJbmRleCArIGRlbHRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heHNbbmJNYXhzKytdID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdG1heEluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZE1heCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcHJldmlvdXNEViA9IGR2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpO1xuXG4gICAgICAgIGlmIChuYk1pbnMgPT09IDAgJiYgbmJNYXhzID09PSAwKSB7XG4gICAgICAgICAgICBjb250ID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZDtcbiAgICAgICAgLy9tZW1zZXQoZGlzdGFuY2VzLCAwLCBzYW1wbGVjb3VudCpzaXplb2YoaW50KSk7XG4gICAgICAgIHZhciBkaXN0YW5jZXMgPSBuZXcgSW50MzJBcnJheShzYW1wbGVjb3VudCk7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbmJNaW5zOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGogPSAxOyBqIDwgMzsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICsgaiA8IG5iTWlucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IF9pYWJzKG1pbnNbaV0gLSBtaW5zW2kgKyBqXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZXNbZF0gPSBkaXN0YW5jZXNbZF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5iTWF4czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMTsgaiA8IDM7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSArIGogPCBuYk1heHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBfaWFicyhtYXhzW2ldIC0gbWF4c1tpICsgal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9hc0xvZyhcImR5d2FwaXRjaCBpPSVsZCBqPSVsZCBkPSVsZFxcblwiLCBpLCBqLCBkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlc1tkXSA9IGRpc3RhbmNlc1tkXSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG5cbiAgICAgICAgdmFyIGJlc3REaXN0YW5jZSA9IC0xO1xuICAgICAgICB2YXIgYmVzdFZhbHVlID0gLTE7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY3VyU2FtTmI7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdW1tZWQgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IC1kZWx0YTsgaiA8PSBkZWx0YTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICsgaiA+PSAwICYmIGkgKyBqIDwgY3VyU2FtTmIpXG4gICAgICAgICAgICAgICAgICAgICAgICBzdW1tZWQgKz0gZGlzdGFuY2VzW2kgKyBqXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9hc0xvZyhcImR5d2FwaXRjaCBpPSVsZCBzdW1tZWQ9JWxkIGJlc3REaXN0YW5jZT0lbGRcXG5cIiwgaSwgc3VtbWVkLCBiZXN0RGlzdGFuY2UpO1xuICAgICAgICAgICAgICAgIGlmIChzdW1tZWQgPT09IGJlc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMiAqIGJlc3REaXN0YW5jZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlc3REaXN0YW5jZSA9IGk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN1bW1lZCA+IGJlc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0VmFsdWUgPSBzdW1tZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJlc3REaXN0YW5jZSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpO1xuICAgICAgICB2YXIgZGlzdEF2ZyA9IDAuMDtcbiAgICAgICAgdmFyIG5iRGlzdHMgPSAwO1xuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9yIChqID0gLWRlbHRhOyBqIDw9IGRlbHRhOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYmVzdERpc3RhbmNlICsgaiA+PSAwICYmIGJlc3REaXN0YW5jZSArIGogPCBzYW1wbGVjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmJEaXN0ID0gZGlzdGFuY2VzW2Jlc3REaXN0YW5jZSArIGpdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmJEaXN0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmJEaXN0cyArPSBuYkRpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0QXZnICs9IChiZXN0RGlzdGFuY2UgKyBqKSAqIG5iRGlzdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICAgICAgLy8gdGhpcyBpcyBvdXIgbW9kZSBkaXN0YW5jZSAhXG4gICAgICAgIGRpc3RBdmcgLz0gbmJEaXN0cztcblxuICAgICAgICAvLyBjb250aW51ZSB0aGUgbGV2ZWxzID9cbiAgICAgICAgaWYgKGN1ck1vZGVEaXN0YW5jZSA+IC0xLjApIHtcbiAgICAgICAgICAgIHZhciBzaW1pbGFyaXR5ID0gTWF0aC5hYnMoZGlzdEF2ZyAqIDIgLSBjdXJNb2RlRGlzdGFuY2UpO1xuICAgICAgICAgICAgaWYgKHNpbWlsYXJpdHkgPD0gMiAqIGRlbHRhKSB7XG4gICAgICAgICAgICAgICAgLy9pZiBERUJVR0cgdGhlbiBwdXQgXCJzaW1pbGFyaXR5PVwiJnNpbWlsYXJpdHkmJlwiZGVsdGE9XCImZGVsdGEmJlwib2tcIlxuICAgICAgICAgICAgICAgIC8vYXNMb2coXCJkeXdhcGl0Y2ggc2ltaWxhcml0eT0lZiBPSyAhXFxuXCIsIHNpbWlsYXJpdHkpO1xuICAgICAgICAgICAgICAgIC8vIHR3byBjb25zZWN1dGl2ZSBzaW1pbGFyIG1vZGUgZGlzdGFuY2VzIDogb2sgIVxuICAgICAgICAgICAgICAgIHBpdGNoRiA9IDQ0MTAwIC8gKF8ycG93ZXIoY3VyTGV2ZWwgLSAxKSAqIGN1ck1vZGVEaXN0YW5jZSk7XG4gICAgICAgICAgICAgICAgY29udCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vaWYgREVCVUdHIHRoZW4gcHV0IFwic2ltaWxhcml0eT1cIiZzaW1pbGFyaXR5JiZcImRlbHRhPVwiJmRlbHRhJiZcIm5vdFwiXG4gICAgICAgIH1cblxuICAgICAgICAvLyBub3Qgc2ltaWxhciwgY29udGludWUgbmV4dCBsZXZlbFxuICAgICAgICBjdXJNb2RlRGlzdGFuY2UgPSBkaXN0QXZnO1xuXG4gICAgICAgIGN1ckxldmVsID0gY3VyTGV2ZWwgKyAxO1xuICAgICAgICBpZiAoY3VyTGV2ZWwgPj0gNikge1xuICAgICAgICAgICAgLy8gcHV0IFwibWF4IGxldmVscyByZWFjaGVkLCBleGl0aW5nXCJcbiAgICAgICAgICAgIC8vYXNMb2coXCJkeXdhcGl0Y2ggbWF4IGxldmVscyByZWFjaGVkLCBleGl0aW5nXFxuXCIpO1xuICAgICAgICAgICAgY29udCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZG93bnNhbXBsZVxuICAgICAgICBpZiAoY3VyU2FtTmIgPCAyKSB7XG4gICAgICAgICAgICAvL2FzTG9nKFwiZHl3YXBpdGNoIG5vdCBlbm91Z2ggc2FtcGxlcywgZXhpdGluZ1xcblwiKTtcbiAgICAgICAgICAgIGNvbnQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGN1clNhbU5iIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2FtW2ldID0gKHNhbVsyICogaV0gKyBzYW1bMiAqIGkgKyAxXSkgLyAyLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICAgIGN1clNhbU5iIC89IDI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2R5d2FwaXRjaF9keW5hbWljcHJvY2VzcyhwaXRjaHRyYWNrZXIsIHBpdGNoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY29tcGxleGl0eVxuICAgICAgICBpZiAocGl0Y2ggPT09IDAuMCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xLjA7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZXN0aW1hdGVkUGl0Y2ggPSAtMSxcbiAgICAgICAgICAgIGFjY2VwdGVkRXJyb3IgPSAwLjIsXG4gICAgICAgICAgICBtYXhDb25maWRlbmNlID0gNTtcbiAgICAgICAgaWYgKHBpdGNoICE9PSAtMSkge1xuICAgICAgICAgICAgLy8gSSBoYXZlIGEgcGl0Y2ggaGVyZVxuXG4gICAgICAgICAgICBpZiAocGl0Y2h0cmFja2VyLl9wcmV2UGl0Y2ggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gbm8gUHJldmlvdXNcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRQaXRjaCA9IHBpdGNoO1xuICAgICAgICAgICAgICAgIHBpdGNodHJhY2tlci5fcHJldlBpdGNoID0gcGl0Y2g7XG4gICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChNYXRoLmFicyhwaXRjaHRyYWNrZXIuX3ByZXZQaXRjaCAtIHBpdGNoKSAvIHBpdGNoIDwgYWNjZXB0ZWRFcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIHNpbWlsYXI6IHJlbWVtYmVyIGFuZCBpbmNyZW1lbnRcbiAgICAgICAgICAgICAgICBwaXRjaHRyYWNrZXIuX3ByZXZQaXRjaCA9IHBpdGNoO1xuICAgICAgICAgICAgICAgIGVzdGltYXRlZFBpdGNoID0gcGl0Y2g7XG4gICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPSBNYXRoLm1pbihtYXhDb25maWRlbmNlLCBwaXRjaHRyYWNrZXIuX3BpdGNoQ29uZmlkZW5jZSArIDEpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgocGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPj0gbWF4Q29uZmlkZW5jZSAtIDIpICYmIE1hdGguYWJzKHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlIC0gMiAqIHBpdGNoKSAvICgyICogcGl0Y2gpIDwgYWNjZXB0ZWRFcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIGNsb3NlIHRvIGhhbGYgdGhlIGxhc3QgcGl0Y2gsIHdoaWNoIGlzIHRydXN0ZWRcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRQaXRjaCA9IDIgKiBwaXRjaDtcbiAgICAgICAgICAgICAgICBwaXRjaHRyYWNrZXIuX3ByZXZQaXRjaCA9IGVzdGltYXRlZFBpdGNoO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgocGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPj0gbWF4Q29uZmlkZW5jZSAtIDIpICYmIE1hdGguYWJzKHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlIC0gMC41ICogcGl0Y2gpIC8gKDAuNSAqIHBpdGNoKSA8IGFjY2VwdGVkRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRQaXRjaCA9IDAuNSAqIHBpdGNoO1xuICAgICAgICAgICAgICAgIHBpdGNodHJhY2tlci5fcHJldlBpdGNoID0gZXN0aW1hdGVkUGl0Y2g7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFZlcnkgZGlmZmVyZW50IHZhbHVlXG4gICAgICAgICAgICAgICAgaWYgKHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgdHJ1c3RlZFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRQaXRjaCA9IHBpdGNodHJhY2tlci5fcHJldlBpdGNoO1xuICAgICAgICAgICAgICAgICAgICBwaXRjaHRyYWNrZXIuX3BpdGNoQ29uZmlkZW5jZSA9IE1hdGgubWF4KDAsIHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlIC0gMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkUGl0Y2ggPSBwaXRjaDtcbiAgICAgICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9wcmV2UGl0Y2ggPSBwaXRjaDtcbiAgICAgICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE5vIHBpdGNoXG4gICAgICAgICAgICBpZiAocGl0Y2h0cmFja2VyLl9wcmV2UGl0Y2ggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gd2FzIGEgcGl0Y2ggYmVmb3JlXG4gICAgICAgICAgICAgICAgaWYgKHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgdHJ1c3RlZFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRQaXRjaCA9IHBpdGNodHJhY2tlci5fcHJldlBpdGNoO1xuICAgICAgICAgICAgICAgICAgICBwaXRjaHRyYWNrZXIuX3BpdGNoQ29uZmlkZW5jZSA9IE1hdGgubWF4KDAsIHBpdGNodHJhY2tlci5fcGl0Y2hDb25maWRlbmNlIC0gMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9wcmV2UGl0Y2ggPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkUGl0Y2ggPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgcGl0Y2h0cmFja2VyLl9waXRjaENvbmZpZGVuY2UgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwaXRjaHRyYWNrZXIuX3BpdGNoQ29uZmlkZW5jZSA+PSAxKSB7XG4gICAgICAgICAgICBwaXRjaCA9IGVzdGltYXRlZFBpdGNoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGl0Y2ggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGl0Y2ggPT09IC0xKSB7XG4gICAgICAgICAgICBwaXRjaCA9IDAuMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGl0Y2g7XG4gICAgfVxuXG4gICAgdmFyIF9taW5tYXggPSB7XG4gICAgICAgIGluZGV4OiB1bmRlZmluZWQsXG4gICAgICAgIG5leHQ6IHVuZGVmaW5lZFxuICAgIH07XG4gICAgLy9fZHl3YXBpdGNoX2NvbXB1dGVXYXZlbGV0UGl0Y2goc2FtcGxlcywgc3RhcnRzYW1wbGUsIHNhbXBsZWNvdW50KVxuICAgIHZhciBzYW1wbGVzID0gdGltZUFycmF5LFxuICAgICAgICBzdGFydHNhbXBsZSA9IDAsXG4gICAgICAgIHNhbXBsZWNvdW50ID0gdGltZUFycmF5Lmxlbmd0aDtcbiAgICB2YXIgcGl0Y2hGID0gMC4wO1xuICAgIHZhciBpLCBqLCBzaSwgc2kxO1xuXG4gICAgc2FtcGxlY291bnQgPSBfZmxvb3JfcG93ZXIyKHNhbXBsZWNvdW50KTtcbiAgICB2YXIgc2FtID0gbmV3IEZsb2F0NjRBcnJheShzYW1wbGVjb3VudCk7XG4gICAgZm9yIChpID0gMDsgaSA8IHNhbXBsZWNvdW50OyBpKyspIHtcbiAgICAgICAgc2FtW2ldID0gc2FtcGxlc1tpXTtcbiAgICB9XG5cbiAgICB2YXIgY3VyU2FtTmIgPSBzYW1wbGVjb3VudDtcblxuICAgIHZhciBtaW5zID0gbmV3IEludDMyQXJyYXkoc2FtcGxlY291bnQpO1xuICAgIHZhciBtYXhzID0gbmV3IEludDMyQXJyYXkoc2FtcGxlY291bnQpO1xuXG4gICAgLy92YXIgbWF4RkxXVGxldmVscyA9IDY7XG4gICAgLy92YXIgbWF4RiA9IDMwMDA7XG4gICAgLy92YXIgZGlmZmVyZW5jZUxldmVsc04gPSAzO1xuICAgIC8vdmFyIG1heGltYVRocmVzaG9sZFJhdGlvID0gMC43NTtcbiAgICB2YXIgdGhlREMgPSBnZXRUaGVEQyhzYW0sIHNhbXBsZWNvdW50KTtcblxuICAgIGZ1bmN0aW9uIGdldFRoZURDKHNhbSwgc2FtcGxlY291bnQpIHtcbiAgICAgICAgcmV0dXJuIHh0cmFjdF9tZWFuKHNhbS5zdWJhcnJheShzYW1wbGVjb3VudCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldGFtcGxpdHVkZU1heChzYW0sIHNhbXBsZWNvdW50KSB7XG4gICAgICAgIHZhciBzaSwgaTtcbiAgICAgICAgdmFyIG1pblZhbHVlID0gMC4wLFxuICAgICAgICAgICAgbWF4VmFsdWUgPSAwLjA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBzYW1wbGVjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICBzaSA9IHNhbVtpXTtcbiAgICAgICAgICAgIGlmIChzaSA+IG1heFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbWF4VmFsdWUgPSBzaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaSA8IG1pblZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbWluVmFsdWUgPSBzaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXhWYWx1ZSA9IG1heFZhbHVlIC0gdGhlREM7XG4gICAgICAgIG1pblZhbHVlID0gbWluVmFsdWUgLSB0aGVEQztcbiAgICAgICAgcmV0dXJuIChtYXhWYWx1ZSA+IC1taW5WYWx1ZSA/IG1heFZhbHVlIDogLW1pblZhbHVlKTtcbiAgICB9XG4gICAgdmFyIGFtcGx0aXR1ZGVUaHJlc2hvbGQgPSBnZXRhbXBsaXR1ZGVNYXgoc2FtLCBzYW1wbGVjb3VudCkgKiAwLjc1O1xuXG4gICAgdmFyIGN1ckxldmVsID0gMDtcbiAgICB2YXIgY3VyTW9kZURpc3RhbmNlID0gLTE7XG4gICAgdmFyIGRlbHRhO1xuXG4gICAgdmFyIGNvbnQgPSB0cnVlO1xuXG4gICAgd2hpbGUgKGNvbnQpIHtcbiAgICAgICAgYm9keUxvb3AoKTtcbiAgICB9XG5cbiAgICAvL19keXdhcGl0Y2hfZHluYW1pY3Byb2Nlc3MocGl0Y2h0cmFja2VyLCBwaXRjaClcbiAgICByZXR1cm4gX2R5d2FwaXRjaF9keW5hbWljcHJvY2VzcyhwaXRjaHRyYWNrZXIsIHBpdGNoRik7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9mdW5jdGlvbnMuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hc3NlcnRfYXJyYXl9IGZyb20gXCIuL3h0cmFjdF9hc3NlcnRfYXJyYXlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHh0cmFjdF95aW4oYXJyYXkpIHtcbiAgICAvLyBVc2VzIHRoZSBZSU4gcHJvY2Vzc1xuICAgIGlmICgheHRyYWN0X2Fzc2VydF9hcnJheShhcnJheSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHZhciBUID0gYXJyYXkubGVuZ3RoO1xuICAgIHZhciBkID0gbmV3IEZsb2F0NjRBcnJheShhcnJheS5sZW5ndGgpO1xuICAgIHZhciByID0gbmV3IGFycmF5LmNvbnN0cnVjdG9yKGFycmF5Lmxlbmd0aCk7XG5cbiAgICB2YXIgZF9zaWdtYSA9IDA7XG4gICAgZm9yICh2YXIgdGF1ID0gMTsgdGF1IDwgVDsgdGF1KyspIHtcbiAgICAgICAgdmFyIHNpZ21hID0gMDtcbiAgICAgICAgZm9yICh2YXIgdCA9IDE7IHQgPCBUIC0gdGF1OyB0KyspIHtcbiAgICAgICAgICAgIHNpZ21hICs9IE1hdGgucG93KGFycmF5W3RdIC0gYXJyYXlbdCArIHRhdV0sIDIpO1xuICAgICAgICB9XG4gICAgICAgIGRbdGF1XSA9IHNpZ21hO1xuICAgICAgICBkX3NpZ21hICs9IHNpZ21hO1xuICAgICAgICByW3RhdV0gPSBkW3RhdV0gLyAoKDEgLyB0YXUpICogZF9zaWdtYSk7XG4gICAgfVxuICAgIHJldHVybiByO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvZnVuY3Rpb25zLmQudHNcIiAvPlxuaW1wb3J0IHt4dHJhY3RfYXNzZXJ0X2FycmF5fSBmcm9tIFwiLi94dHJhY3RfYXNzZXJ0X2FycmF5XCI7XG5leHBvcnQgZnVuY3Rpb24geHRyYWN0X3pjcih0aW1lQXJyYXkpIHtcbiAgICBpZiAoIXh0cmFjdF9hc3NlcnRfYXJyYXkodGltZUFycmF5KSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgZm9yICh2YXIgbiA9IDE7IG4gPCB0aW1lQXJyYXkubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgaWYgKHRpbWVBcnJheVtuXSAqIHRpbWVBcnJheVtuIC0gMV0gPCAwKSB7XG4gICAgICAgICAgICByZXN1bHQrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0IC8gdGltZUFycmF5Lmxlbmd0aDtcbn1cbiIsImltcG9ydCB7XG4gICAgeHRyYWN0X2lzX2Rlbm9ybWFsXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaXNfZGVub3JtYWxcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2Fzc2VydF9hcnJheVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2Fzc2VydF9hcnJheVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXNzZXJ0X3Bvc2l0aXZlX2ludGVnZXJcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlclwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXJyYXlfc3VtXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfc3VtXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9hcnJheV9jb3B5XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfY29weVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXJyYXlfbWluXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfbWluXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9hcnJheV9tYXhcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9hcnJheV9tYXhcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2FycmF5X3NjYWxlXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfc2NhbGVcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2FycmF5X25vcm1hbGlzZVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2FycmF5X25vcm1hbGlzZVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXJyYXlfYm91bmRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9hcnJheV9ib3VuZFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXJyYXlfaW50ZXJsYWNlXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfaW50ZXJsYWNlXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9hcnJheV9kZWludGVybGFjZVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2FycmF5X2RlaW50ZXJsYWNlXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9nZXRfbnVtYmVyX29mX2ZyYW1lc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2dldF9udW1iZXJfb2ZfZnJhbWVzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9nZXRfZGF0YV9mcmFtZXNcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9nZXRfZGF0YV9mcmFtZXNcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3Byb2Nlc3NfZnJhbWVfZGF0YVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3Byb2Nlc3NfZnJhbWVfZGF0YVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXJyYXlfdG9fSlNPTlxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2FycmF5X3RvX0pTT05cIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2ZyYW1lX2Zyb21fYXJyYXlcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9mcmFtZV9mcm9tX2FycmF5XCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9tZWFuXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfbWVhblwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfdGVtcG9yYWxfY2VudHJvaWRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF90ZW1wb3JhbF9jZW50cm9pZFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfdmFyaWFuY2Vcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF92YXJpYW5jZVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc3RhbmRhcmRfZGV2aWF0aW9uXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3RhbmRhcmRfZGV2aWF0aW9uXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9hdmVyYWdlX2RldmlhdGlvblxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2F2ZXJhZ2VfZGV2aWF0aW9uXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9za2V3bmVzc19rdXJ0b3Npc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3NrZXduZXNzX2t1cnRvc2lzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9za2V3bmVzc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3NrZXduZXNzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9rdXJ0b3Npc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2t1cnRvc2lzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJhbF9jZW50cm9pZFxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX2NlbnRyb2lkXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJhbF9tZWFuXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfbWVhblwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2Vcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF92YXJpYW5jZVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc3BlY3RyYWxfc3ByZWFkXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfc3ByZWFkXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb25cbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb25cIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3NwZWN0cmFsX3NrZXduZXNzXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfc2tld25lc3NcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3NwZWN0cmFsX2t1cnRvc2lzXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfa3VydG9zaXNcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2lycmVndWxhcml0eV9rXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaXJyZWd1bGFyaXR5X2tcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2lycmVndWxhcml0eV9qXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaXJyZWd1bGFyaXR5X2pcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3RyaXN0aW11bHVzLFxuICAgIHh0cmFjdF90cmlzdGltdWx1c18xLFxuICAgIHh0cmFjdF90cmlzdGltdWx1c18yLFxuICAgIHh0cmFjdF90cmlzdGltdWx1c18zXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfdHJpc3RpbXVsdXNcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3Ntb290aG5lc3Ncbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9zbW9vdGhuZXNzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF96Y3Jcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF96Y3JcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3JvbGxvZmZcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9yb2xsb2ZmXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9sb3VkbmVzc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2xvdWRuZXNzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9mbGF0bmVzc1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2ZsYXRuZXNzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9mbGF0bmVzc19kYlxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2ZsYXRuZXNzX2RiXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF90b25hbGl0eVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3RvbmFsaXR5XCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9jcmVzdFxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2NyZXN0XCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9ub2lzaW5lc3Ncbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9ub2lzaW5lc3NcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3Jtc19hbXBsaXR1ZGVcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9ybXNfYW1wbGl0dWRlXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJhbF9pbmhhcm1vbmljaXR5XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfcG93ZXJcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9wb3dlclwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfb2RkX2V2ZW5fcmF0aW9cbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9vZGRfZXZlbl9yYXRpb1wiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc2hhcnBuZXNzXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc2hhcnBuZXNzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJhbF9zbG9wZVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX3Nsb3BlXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9sb3doaWdoXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfbG93aGlnaFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfbG93ZXN0X3ZhbHVlXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfbG93ZXN0X3ZhbHVlXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9oaWdoZXN0X3ZhbHVlXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaGlnaGVzdF92YWx1ZVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc3VtXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfc3VtXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9ub256ZXJvX2NvdW50XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfbm9uemVyb19jb3VudFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfaHBzXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaHBzXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9mMFxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2YwXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9mYWlsc2FmZV9mMFxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2ZhaWxzYWZlX2YwXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF93YXZlbGV0X2YwXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3Rfd2F2ZWxldF9mMFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfbWlkaWNlbnRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9taWRpY2VudFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfc3BlY3RyYWxfZnVuZGFtZW50YWxcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9mdW5kYW1lbnRhbFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfZW5lcmd5XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfZW5lcmd5XCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9zcGVjdHJ1bVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cnVtXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9jb21wbGV4X3NwZWN0cnVtXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfY29tcGxleF9zcGVjdHJ1bVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfbWZjY1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X21mY2NcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2RjdFxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2RjdFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfZGN0XzJcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9kY3RfMlwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXV0b2NvcnJlbGF0aW9uXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXV0b2NvcnJlbGF0aW9uXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9hbWRmXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYW1kZlwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXNkZlxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2FzZGZcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2JhcmtfY29lZmZpY2llbnRzXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYmFya19jb2VmZmljaWVudHNcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3BlYWtfc3BlY3RydW1cbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9wZWFrX3NwZWN0cnVtXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9oYXJtb25pY19zcGVjdHJ1bVxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2hhcm1vbmljX3NwZWN0cnVtXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9scGNcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9scGNcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2xwY2Ncbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9scGNjXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9wY3Bcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9wY3BcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X3lpblxufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X3lpblwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3Rfb25zZXRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9vbnNldFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfcmVzYW1wbGVcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9yZXNhbXBsZVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfaW5pdF9kZnRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9pbml0X2RmdFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfaW5pdF9kY3Rcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9pbml0X2RjdFwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfaW5pdF9tZmNjXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9tZmNjXCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9pbml0X3dhdmVsZXRcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9pbml0X3dhdmVsZXRcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2luaXRfcGNwXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9wY3BcIjtcbmltcG9ydCB7XG4gICAgeHRyYWN0X2luaXRfYmFya1xufSBmcm9tIFwiLi9mdW5jdGlvbnMveHRyYWN0X2luaXRfYmFya1wiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfaW5pdF9jaHJvbWFcbn0gZnJvbSBcIi4vZnVuY3Rpb25zL3h0cmFjdF9pbml0X2Nocm9tYVwiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfYXBwbHlfd2luZG93XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfYXBwbHlfd2luZG93XCI7XG5pbXBvcnQge1xuICAgIHh0cmFjdF9jcmVhdGVfd2luZG93XG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfY3JlYXRlX3dpbmRvd1wiO1xuaW1wb3J0IHtcbiAgICB4dHJhY3RfY2hyb21hXG59IGZyb20gXCIuL2Z1bmN0aW9ucy94dHJhY3RfY2hyb21hXCI7XG5cbmltcG9ydCB7XG4gICAgSGFybW9uaWNTcGVjdHJ1bURhdGFcbn0gZnJvbSBcIi4vb2JqZWN0cy9IYXJtb25pY1NwZWN0cnVtRGF0YVwiO1xuaW1wb3J0IHtcbiAgICBQZWFrU3BlY3RydW1EYXRhXG59IGZyb20gXCIuL29iamVjdHMvUGVha1NwZWN0cnVtRGF0YVwiO1xuaW1wb3J0IHtcbiAgICBTcGVjdHJ1bURhdGFcbn0gZnJvbSBcIi4vb2JqZWN0cy9TcGVjdHJ1bURhdGFcIjtcbmltcG9ydCB7XG4gICAgVGltZURhdGFcbn0gZnJvbSBcIi4vb2JqZWN0cy9UaW1lRGF0YVwiO1xuXG5cbmlmICh0eXBlb2YgQW5hbHlzZXJOb2RlICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cbiAgICBBbmFseXNlck5vZGUucHJvdG90eXBlLnRpbWVEYXRhID0gdW5kZWZpbmVkO1xuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuc3BlY3RydW1EYXRhID0gdW5kZWZpbmVkO1xuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuY2FsbGJhY2tPYmplY3QgPSB1bmRlZmluZWQ7XG4gICAgQW5hbHlzZXJOb2RlLnByb3RvdHlwZS5mb29HYWluID0gdW5kZWZpbmVkO1xuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuZ2V0WHRyYWN0RGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGltZURhdGEgPT09IHVuZGVmaW5lZCB8fCB0aGlzLnNjcGVjdHJ1bURhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy50aW1lRGF0YSA9IG5ldyBUaW1lRGF0YSh0aGlzLmZmdFNpemUsIHRoaXMuY29udGV4dC5zYW1wbGVSYXRlKTtcbiAgICAgICAgICAgIHRoaXMuc3BlY3RydW1EYXRhID0gbmV3IFNwZWN0cnVtRGF0YSh0aGlzLmZyZXF1ZW5jeUJpbkNvdW50LCB0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRzdCA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5mZnRTaXplKTtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGlmICh0aGlzLmdldEZsb2F0VGltZURvbWFpbkRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YShkc3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLmZmdFNpemUpO1xuICAgICAgICAgICAgdGhpcy5nZXRCeXRlVGltZURvbWFpbkRhdGEodmlldyk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5mZnRTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICBkc3RbaV0gPSB2aWV3W2ldO1xuICAgICAgICAgICAgICAgIGRzdFtpXSA9IChkc3RbaV0gLyAxMjcuNSkgLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudGltZURhdGEuY29weURhdGFGcm9tKGRzdCk7XG4gICAgICAgIHRoaXMudGltZURhdGEucmVzdWx0LnNwZWN0cnVtID0gdGhpcy5zcGVjdHJ1bURhdGE7XG4gICAgICAgIHZhciBMb2dTdG9yZSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5mcmVxdWVuY3lCaW5Db3VudCk7XG4gICAgICAgIHRoaXMuZ2V0RmxvYXRGcmVxdWVuY3lEYXRhKExvZ1N0b3JlKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJlcXVlbmN5QmluQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgTG9nU3RvcmVbaV0gPSBNYXRoLnBvdygxMC4wLCBMb2dTdG9yZVtpXSAvIDIwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNwZWN0cnVtRGF0YS5jb3B5RGF0YUZyb20oTG9nU3RvcmUpO1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lRGF0YTtcbiAgICB9O1xuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUucHJldmlvdXNGcmFtZSA9IHVuZGVmaW5lZDtcbiAgICBBbmFseXNlck5vZGUucHJvdG90eXBlLnByZXZpb3VzUmVzdWx0ID0gdW5kZWZpbmVkO1xuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuZnJhbWVDYWxsYmFjayA9IGZ1bmN0aW9uIChmdW5jLCBhcmdfdGhpcykge1xuICAgICAgICAvLyBQZXJmb3JtIGEgY2FsbGJhY2sgb24gZWFjaCBmcmFtZVxuICAgICAgICAvLyBUaGUgZnVuY3Rpb24gY2FsbGJhY2sgaGFzIHRoZSBhcmd1bWVudHMgKGN1cnJlbnRfZnJhbWUsIHByZXZpb3VzX2ZyYW1lLCBwcmV2aW91c19yZXN1bHQpXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrT2JqZWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tPYmplY3QgPSB0aGlzLmNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKHRoaXMuZmZ0U2l6ZSwgMSwgMSk7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3QodGhpcy5jYWxsYmFja09iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9mdW5jID0gZnVuYztcbiAgICAgICAgdmFyIF9hcmdfdGhpcyA9IGFyZ190aGlzO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tPYmplY3Qub25hdWRpb3Byb2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRfZnJhbWUgPSBzZWxmLmdldFh0cmFjdERhdGEoKTtcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNSZXN1bHQgPSBfZnVuYy5jYWxsKF9hcmdfdGhpcywgY3VycmVudF9mcmFtZSwgdGhpcy5wcmV2aW91c0ZyYW1lLCB0aGlzLnByZXZpb3VzUmVzdWx0KTtcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNGcmFtZSA9IGN1cnJlbnRfZnJhbWU7XG4gICAgICAgICAgICB2YXIgTiA9IGUub3V0cHV0QnVmZmVyLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBuZXcgRmxvYXQzMkFycmF5KE4pO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMucHJldmlvdXNSZXN1bHQ7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMucHJldmlvdXNSZXN1bHQgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE47IGkrKykge1xuICAgICAgICAgICAgICAgIG91dHB1dFtpXSA9IHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUub3V0cHV0QnVmZmVyLmNvcHlUb0NoYW5uZWwob3V0cHV0LCAwLCAwKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBGb3IgY2hyb21lIGFuZCBvdGhlciBlZmZpY2llbmN5IGJyb3dzZXJzXG4gICAgICAgIGlmICghdGhpcy5mb29HYWluKSB7XG4gICAgICAgICAgICB0aGlzLmZvb0dhaW4gPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgICAgICAgICAgdGhpcy5mb29HYWluLmdhaW4udmFsdWUgPSAwO1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFja09iamVjdC5jb25uZWN0KHRoaXMuZm9vR2Fpbik7XG4gICAgICAgICAgICB0aGlzLmZvb0dhaW4uY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuY2xlYXJDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0KHRoaXMuY2FsbGJhY2tPYmplY3QpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrT2JqZWN0Lm9uYXVkaW9wcm9jZXNzID0gdW5kZWZpbmVkO1xuICAgIH07XG5cbiAgICBBbmFseXNlck5vZGUucHJvdG90eXBlLnh0cmFjdEZyYW1lID0gZnVuY3Rpb24gKGZ1bmMsIGFyZ190aGlzKSB7XG4gICAgICAgIC8vIENvbGxlY3QgdGhlIGN1cnJlbnQgZnJhbWUgb2YgZGF0YSBhbmQgcGVyZm9ybSB0aGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgICAgZnVuYy5jYWxsKGFyZ190aGlzLCB0aGlzLmdldFh0cmFjdERhdGEoKSk7XG4gICAgfTtcbn1cblxuaWYgKHR5cGVvZiBBdWRpb0J1ZmZlciAhPT0gXCJ1bmRlZmluZWRcIikge1xuXG4gICAgQXVkaW9CdWZmZXIucHJvdG90eXBlLnh0cmFjdF9nZXRfZGF0YV9mcmFtZXMgPSBmdW5jdGlvbiAoZnJhbWVfc2l6ZSwgaG9wX3NpemUpIHtcbiAgICAgICAgaWYgKGhvcF9zaXplID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhvcF9zaXplID0gZnJhbWVfc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF4dHJhY3RfYXNzZXJ0X3Bvc2l0aXZlX2ludGVnZXIoZnJhbWVfc2l6ZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzIHJlcXVpcmVzIHRoZSBmcmFtZV9zaXplIHRvIGJlIGRlZmluZWQsIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihob3Bfc2l6ZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoXCJ4dHJhY3RfZ2V0X2RhdGFfZnJhbWVzIHJlcXVpcmVzIHRoZSBob3Bfc2l6ZSB0byBiZSBhIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICAgIHRoaXMuZnJhbWVzID0gW107XG4gICAgICAgIHZhciBOID0gdGhpcy5sZW5ndGg7XG4gICAgICAgIHZhciBLID0gdGhpcy54dHJhY3RfZ2V0X251bWJlcl9vZl9mcmFtZXMoaG9wX3NpemUpO1xuICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMubnVtYmVyT2ZDaGFubmVsczsgYysrKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZ2V0Q2hhbm5lbERhdGEoYyk7XG4gICAgICAgICAgICB0aGlzLmZyYW1lc1tjXSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBLOyBrKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgVGltZURhdGEoZnJhbWVfc2l6ZSwgdGhpcy5zYW1wbGVSYXRlKTtcbiAgICAgICAgICAgICAgICBmcmFtZS5jb3B5RGF0YUZyb20oZGF0YS5zdWJhcnJheShob3Bfc2l6ZSAqIGssIGhvcF9zaXplICogayArIGZyYW1lX3NpemUpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZyYW1lc1tjXS5wdXNoKGZyYW1lKTtcbiAgICAgICAgICAgICAgICBmcmFtZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZnJhbWVzO1xuICAgIH07XG5cbiAgICBBdWRpb0J1ZmZlci5wcm90b3R5cGUueHRyYWN0X2dldF9udW1iZXJfb2ZfZnJhbWVzID0gZnVuY3Rpb24gKGhvcF9zaXplKSB7XG4gICAgICAgIHJldHVybiB4dHJhY3RfZ2V0X251bWJlcl9vZl9mcmFtZXModGhpcywgaG9wX3NpemUpO1xuICAgIH07XG5cbiAgICBBdWRpb0J1ZmZlci5wcm90b3R5cGUueHRyYWN0X2dldF9mcmFtZSA9IGZ1bmN0aW9uIChkc3QsIGNoYW5uZWwsIGluZGV4LCBmcmFtZV9zaXplKSB7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRzdCAhPT0gXCJvYmplY3RcIiB8fCBkc3QuY29uc3RydWN0b3IgIT09IEZsb2F0MzJBcnJheSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcImRzdCBtdXN0IGJlIGEgRmxvYXQzMkFycmF5IG9iamVjdCBlcXVhbCBpbiBsZW5ndGggdG8gaG9wX3NpemVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihjaGFubmVsKSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcInh0cmFjdF9nZXRfZnJhbWUgcmVxdWlyZXMgdGhlIGNoYW5uZWwgdG8gYmUgYW4gaW50ZWdlciB2YWx1ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgheHRyYWN0X2Fzc2VydF9wb3NpdGl2ZV9pbnRlZ2VyKGluZGV4KSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcInh0cmFjdF9nZXRfZnJhbWUgcmVxdWlyZXMgdGhlIGluZGV4IHRvIGJlIGFuIGludGVnZXIgdmFsdWVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcihmcmFtZV9zaXplKSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcInh0cmFjdF9nZXRfZnJhbWUgcmVxdWlyZXMgdGhlIGZyYW1lX3NpemUgdG8gYmUgZGVmaW5lZCwgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICAgICAgaWYgKGNoYW5uZWwgPCAwIHx8IGNoYW5uZWwgPiB0aGlzLm51bWJlck9mQ2hhbm5lbHMpIHtcbiAgICAgICAgICAgIHRocm93IChcImNoYW5uZWwgbnVtYmVyIFwiICsgY2hhbm5lbCArIFwiIG91dCBvZiBib3VuZHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIEsgPSB0aGlzLnh0cmFjdF9nZXRfbnVtYmVyX29mX2ZyYW1lcyhmcmFtZV9zaXplKTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBLKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJpbmRleCBudW1iZXIgXCIgKyBpbmRleCArIFwiIG91dCBvZiBib3VuZHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY29weUZyb21DaGFubmVsKGRzdCwgY2hhbm5lbCwgZnJhbWVfc2l6ZSAqIGluZGV4KTtcbiAgICB9O1xuXG4gICAgQXVkaW9CdWZmZXIucHJvdG90eXBlLnh0cmFjdF9wcm9jZXNzX2ZyYW1lX2RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IChcIkF1ZGlvQnVmZmVyOjp4dHJhY3RfcHJvY2Vzc19mcmFtZV9kYXRhIGhhcyBiZWVuIGRlcHJlY2F0ZWRcIik7XG4gICAgfTtcbn1cblxuXG5leHBvcnQge1xuICAgIHh0cmFjdF9pc19kZW5vcm1hbCxcbiAgICB4dHJhY3RfYXNzZXJ0X2FycmF5LFxuICAgIHh0cmFjdF9hc3NlcnRfcG9zaXRpdmVfaW50ZWdlcixcbiAgICB4dHJhY3RfYXJyYXlfc3VtLFxuICAgIHh0cmFjdF9hcnJheV9jb3B5LFxuICAgIHh0cmFjdF9hcnJheV9taW4sXG4gICAgeHRyYWN0X2FycmF5X21heCxcbiAgICB4dHJhY3RfYXJyYXlfc2NhbGUsXG4gICAgeHRyYWN0X2FycmF5X25vcm1hbGlzZSxcbiAgICB4dHJhY3RfYXJyYXlfYm91bmQsXG4gICAgeHRyYWN0X2FycmF5X2ludGVybGFjZSxcbiAgICB4dHJhY3RfYXJyYXlfZGVpbnRlcmxhY2UsXG4gICAgeHRyYWN0X2dldF9udW1iZXJfb2ZfZnJhbWVzLFxuICAgIHh0cmFjdF9nZXRfZGF0YV9mcmFtZXMsXG4gICAgeHRyYWN0X3Byb2Nlc3NfZnJhbWVfZGF0YSxcbiAgICB4dHJhY3RfYXJyYXlfdG9fSlNPTixcbiAgICB4dHJhY3RfZnJhbWVfZnJvbV9hcnJheSxcbiAgICB4dHJhY3RfbWVhbixcbiAgICB4dHJhY3RfdGVtcG9yYWxfY2VudHJvaWQsXG4gICAgeHRyYWN0X3ZhcmlhbmNlLFxuICAgIHh0cmFjdF9zdGFuZGFyZF9kZXZpYXRpb24sXG4gICAgeHRyYWN0X2F2ZXJhZ2VfZGV2aWF0aW9uLFxuICAgIHh0cmFjdF9za2V3bmVzc19rdXJ0b3NpcyxcbiAgICB4dHJhY3Rfc2tld25lc3MsXG4gICAgeHRyYWN0X2t1cnRvc2lzLFxuICAgIHh0cmFjdF9zcGVjdHJhbF9jZW50cm9pZCxcbiAgICB4dHJhY3Rfc3BlY3RyYWxfbWVhbixcbiAgICB4dHJhY3Rfc3BlY3RyYWxfdmFyaWFuY2UsXG4gICAgeHRyYWN0X3NwZWN0cmFsX3NwcmVhZCxcbiAgICB4dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uLFxuICAgIHh0cmFjdF9zcGVjdHJhbF9za2V3bmVzcyxcbiAgICB4dHJhY3Rfc3BlY3RyYWxfa3VydG9zaXMsXG4gICAgeHRyYWN0X2lycmVndWxhcml0eV9rLFxuICAgIHh0cmFjdF9pcnJlZ3VsYXJpdHlfaixcbiAgICB4dHJhY3RfdHJpc3RpbXVsdXMsXG4gICAgeHRyYWN0X3RyaXN0aW11bHVzXzEsXG4gICAgeHRyYWN0X3RyaXN0aW11bHVzXzIsXG4gICAgeHRyYWN0X3RyaXN0aW11bHVzXzMsXG4gICAgeHRyYWN0X3Ntb290aG5lc3MsXG4gICAgeHRyYWN0X3pjcixcbiAgICB4dHJhY3Rfcm9sbG9mZixcbiAgICB4dHJhY3RfbG91ZG5lc3MsXG4gICAgeHRyYWN0X2ZsYXRuZXNzLFxuICAgIHh0cmFjdF9mbGF0bmVzc19kYixcbiAgICB4dHJhY3RfdG9uYWxpdHksXG4gICAgeHRyYWN0X2NyZXN0LFxuICAgIHh0cmFjdF9ub2lzaW5lc3MsXG4gICAgeHRyYWN0X3Jtc19hbXBsaXR1ZGUsXG4gICAgeHRyYWN0X3NwZWN0cmFsX2luaGFybW9uaWNpdHksXG4gICAgeHRyYWN0X3Bvd2VyLFxuICAgIHh0cmFjdF9vZGRfZXZlbl9yYXRpbyxcbiAgICB4dHJhY3Rfc2hhcnBuZXNzLFxuICAgIHh0cmFjdF9zcGVjdHJhbF9zbG9wZSxcbiAgICB4dHJhY3RfbG93aGlnaCxcbiAgICB4dHJhY3RfbG93ZXN0X3ZhbHVlLFxuICAgIHh0cmFjdF9oaWdoZXN0X3ZhbHVlLFxuICAgIHh0cmFjdF9zdW0sXG4gICAgeHRyYWN0X25vbnplcm9fY291bnQsXG4gICAgeHRyYWN0X2hwcyxcbiAgICB4dHJhY3RfZjAsXG4gICAgeHRyYWN0X2ZhaWxzYWZlX2YwLFxuICAgIHh0cmFjdF93YXZlbGV0X2YwLFxuICAgIHh0cmFjdF9taWRpY2VudCxcbiAgICB4dHJhY3Rfc3BlY3RyYWxfZnVuZGFtZW50YWwsXG4gICAgeHRyYWN0X2VuZXJneSxcbiAgICB4dHJhY3Rfc3BlY3RydW0sXG4gICAgeHRyYWN0X2NvbXBsZXhfc3BlY3RydW0sXG4gICAgeHRyYWN0X21mY2MsXG4gICAgeHRyYWN0X2RjdCxcbiAgICB4dHJhY3RfZGN0XzIsXG4gICAgeHRyYWN0X2F1dG9jb3JyZWxhdGlvbixcbiAgICB4dHJhY3RfYW1kZixcbiAgICB4dHJhY3RfYXNkZixcbiAgICB4dHJhY3RfYmFya19jb2VmZmljaWVudHMsXG4gICAgeHRyYWN0X3BlYWtfc3BlY3RydW0sXG4gICAgeHRyYWN0X2hhcm1vbmljX3NwZWN0cnVtLFxuICAgIHh0cmFjdF9scGMsXG4gICAgeHRyYWN0X2xwY2MsXG4gICAgeHRyYWN0X3BjcCxcbiAgICB4dHJhY3RfeWluLFxuICAgIHh0cmFjdF9vbnNldCxcbiAgICB4dHJhY3RfcmVzYW1wbGUsXG4gICAgeHRyYWN0X2luaXRfZGZ0LFxuICAgIHh0cmFjdF9pbml0X2RjdCxcbiAgICB4dHJhY3RfaW5pdF9tZmNjLFxuICAgIHh0cmFjdF9pbml0X3dhdmVsZXQsXG4gICAgeHRyYWN0X2luaXRfcGNwLFxuICAgIHh0cmFjdF9pbml0X2JhcmssXG4gICAgeHRyYWN0X2luaXRfY2hyb21hLFxuICAgIHh0cmFjdF9hcHBseV93aW5kb3csXG4gICAgeHRyYWN0X2NyZWF0ZV93aW5kb3csXG4gICAgeHRyYWN0X2Nocm9tYSxcbiAgICBIYXJtb25pY1NwZWN0cnVtRGF0YSxcbiAgICBQZWFrU3BlY3RydW1EYXRhLFxuICAgIFNwZWN0cnVtRGF0YSxcbiAgICBUaW1lRGF0YVxufTtcbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL29iamVjdHMvQ29tbW9uTWVtb3J5LmQudHNcIiAvPlxuXG5pbXBvcnQge3h0cmFjdF9pbml0X2RjdH0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9kY3RcIjtcbmltcG9ydCB7eHRyYWN0X2luaXRfbWZjY30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9tZmNjXCI7XG5pbXBvcnQge3h0cmFjdF9pbml0X2Jhcmt9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2luaXRfYmFya1wiO1xuaW1wb3J0IHt4dHJhY3RfaW5pdF9jaHJvbWF9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2luaXRfY2hyb21hXCI7XG5cbmZ1bmN0aW9uIHNlYXJjaE1hcFByb3BlcnRpZXMobWFwLCBwcm9wZXJ0aWVzKSB7XG4gICAgdmFyIG1hdGNoID0gbWFwLmZpbmQoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBpZiAoZVtwcm9wXSAhPT0gcHJvcGVydGllc1twcm9wXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWF0Y2g7XG59XG5cbnZhciBkY3RfbWFwID0ge1xuICAgIHBhcmVudDogdGhpcyxcbiAgICBzdG9yZTogW10sXG4gICAgY3JlYXRlQ29lZmZpY2llbnRzOiBmdW5jdGlvbiAoTikge1xuICAgICAgICB2YXIgbWF0Y2ggPSBzZWFyY2hNYXBQcm9wZXJ0aWVzKHRoaXMuc3RvcmUsIHtcbiAgICAgICAgICAgIE46IE5cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIG1hdGNoID0ge1xuICAgICAgICAgICAgICAgIE46IE4sXG4gICAgICAgICAgICAgICAgZGF0YTogeHRyYWN0X2luaXRfZGN0KE4pXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5zdG9yZS5wdXNoKG1hdGNoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0Y2guZGF0YTtcbiAgICB9XG59O1xuXG52YXIgbWZjY19tYXAgPSB7XG4gICAgcGFyZW50OiB0aGlzLFxuICAgIHN0b3JlOiBbXSxcbiAgICBjcmVhdGVDb2VmZmljaWVudHM6IGZ1bmN0aW9uIChOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKSB7XG4gICAgICAgIHZhciBzZWFyY2ggPSB7XG4gICAgICAgICAgICBOOiBOLFxuICAgICAgICAgICAgbnlxdWlzdDogbnlxdWlzdCxcbiAgICAgICAgICAgIHN0eWxlOiBzdHlsZSxcbiAgICAgICAgICAgIGZyZXFfbWluOiBmcmVxX21pbixcbiAgICAgICAgICAgIGZyZXFfbWF4OiBmcmVxX21heCxcbiAgICAgICAgICAgIGZyZXFfYmFuZHM6IGZyZXFfYmFuZHNcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1hdGNoID0gc2VhcmNoTWFwUHJvcGVydGllcyh0aGlzLnN0b3JlLCBzZWFyY2gpO1xuICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBtYXRjaCA9IHNlYXJjaDtcbiAgICAgICAgICAgIG1hdGNoLmRhdGEgPSB4dHJhY3RfaW5pdF9tZmNjKE4sIG55cXVpc3QsIHN0eWxlLCBmcmVxX21pbiwgZnJlcV9tYXgsIGZyZXFfYmFuZHMpO1xuICAgICAgICAgICAgdGhpcy5zdG9yZS5wdXNoKG1hdGNoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0Y2guZGF0YTtcbiAgICB9XG59O1xuXG52YXIgYmFya19tYXAgPSB7XG4gICAgcGFyZW50OiB0aGlzLFxuICAgIHN0b3JlOiBbXSxcbiAgICBjcmVhdGVDb2VmZmljaWVudHM6IGZ1bmN0aW9uIChOLCBzYW1wbGVSYXRlLCBudW1CYW5kcykge1xuICAgICAgICB2YXIgc2VhcmNoID0ge1xuICAgICAgICAgICAgTjogTixcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6IHNhbXBsZVJhdGUsXG4gICAgICAgICAgICBudW1CYW5kczogbnVtQmFuZHNcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1hdGNoID0gc2VhcmNoTWFwUHJvcGVydGllcyh0aGlzLnN0b3JlLCBzZWFyY2gpO1xuICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBtYXRjaCA9IHNlYXJjaDtcbiAgICAgICAgICAgIG1hdGNoLmRhdGEgPSB4dHJhY3RfaW5pdF9iYXJrKE4sIHNhbXBsZVJhdGUsIG51bUJhbmRzKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmUucHVzaChtYXRjaCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hdGNoLmRhdGE7XG4gICAgfVxufTtcblxuXG52YXIgY2hyb21hX21hcCA9IHtcbiAgICBwYXJlbnQ6IHRoaXMsXG4gICAgc3RvcmU6IFtdLFxuICAgIGNyZWF0ZUNvZWZmaWNpZW50czogZnVuY3Rpb24gKE4sIHNhbXBsZVJhdGUsIG5iaW5zLCBBNDQwLCBmX2N0ciwgb2N0d2lkdGgpIHtcbiAgICAgICAgdmFyIHNlYXJjaCA9IHtcbiAgICAgICAgICAgIE46IE4sXG4gICAgICAgICAgICBzYW1wbGVSYXRlOiBzYW1wbGVSYXRlLFxuICAgICAgICAgICAgbmJpbnM6IG5iaW5zLFxuICAgICAgICAgICAgQTQ0MDogQTQ0MCxcbiAgICAgICAgICAgIGZfY3RyOiBmX2N0cixcbiAgICAgICAgICAgIG9jdHdpZHRoOiBvY3R3aWR0aFxuICAgICAgICB9O1xuICAgICAgICB2YXIgbWF0Y2ggPSBzZWFyY2hNYXBQcm9wZXJ0aWVzKHRoaXMuc3RvcmUsIHNlYXJjaCk7XG4gICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIG1hdGNoID0gc2VhcmNoO1xuICAgICAgICAgICAgbWF0Y2guZGF0YSA9IHh0cmFjdF9pbml0X2Nocm9tYShOLCBzYW1wbGVSYXRlLCBuYmlucywgQTQ0MCwgZl9jdHIsIG9jdHdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmUucHVzaChtYXRjaCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hdGNoLmRhdGE7XG4gICAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURjdENvZWZmaWNpZW50cyhOKSB7XG4gICAgcmV0dXJuIGRjdF9tYXAuY3JlYXRlQ29lZmZpY2llbnRzKE4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTWZjY0NvZWZmaWNpZW50cyhOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKSB7XG4gICAgcmV0dXJuIG1mY2NfbWFwLmNyZWF0ZUNvZWZmaWNpZW50cyhOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJhcmtDb2VmZmljaWVudHMoTiwgc2FtcGxlUmF0ZSwgbnVtQmFuZHMpIHtcbiAgICBpZiAodHlwZW9mIG51bUJhbmRzICE9PSBcIm51bWJlclwiIHx8IG51bUJhbmRzIDwgMCB8fCBudW1CYW5kcyA+IDI2KSB7XG4gICAgICAgIG51bUJhbmRzID0gMjY7XG4gICAgfVxuICAgIHJldHVybiBiYXJrX21hcC5jcmVhdGVDb2VmZmljaWVudHMoTiwgc2FtcGxlUmF0ZSwgbnVtQmFuZHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2hyb21hQ29lZmZpY2llbnRzKE4sIHNhbXBsZVJhdGUsIG5iaW5zLCBBNDQwLCBmX2N0ciwgb2N0d2lkdGgpIHtcbiAgICByZXR1cm4gY2hyb21hX21hcC5jcmVhdGVDb2VmZmljaWVudHMoTiwgc2FtcGxlUmF0ZSwgbmJpbnMsIEE0NDAsIGZfY3RyLCBvY3R3aWR0aCk7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9vYmplY3RzL0RhdGFQcm90b3R5cGUuZC50c1wiIC8+XG5pbXBvcnQge3h0cmFjdF9hcnJheV90b19KU09OfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9hcnJheV90b19KU09OXCI7XG5pbXBvcnQge2NyZWF0ZURjdENvZWZmaWNpZW50cywgY3JlYXRlTWZjY0NvZWZmaWNpZW50cywgY3JlYXRlQmFya0NvZWZmaWNpZW50cywgY3JlYXRlQ2hyb21hQ29lZmZpY2llbnRzfSBmcm9tIFwiLi9Db21tb25NZW1vcnlcIjtcblxuZnVuY3Rpb24gcmVjdXJzaXZlRGVsdGEoYSwgYikge1xuICAgIC8vYSBhbmQgYiBhcmUgb2JqZWN0cyBvZiBUaW1lL1NwZWN0cnVtL1BlYWtTL0hhcm1vbmljUyBEYXRhXG4gICAgLy9hIGFuZCBiIGFyZSB0aGUgLnJlc3VsdCBvYmplY3RcbiAgICB2YXIgcGFyYW0sIGRlbHRhID0ge307XG4gICAgZm9yIChwYXJhbSBpbiBhKSB7XG4gICAgICAgIGlmIChiW3BhcmFtXSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhW3BhcmFtXSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIGRlbHRhW3BhcmFtXSA9IGFbcGFyYW1dIC0gYltwYXJhbV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbHRhW3BhcmFtXSA9IGRlbHRhT2JqZWN0KGEsIGIsIHBhcmFtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGVsdGE7XG59XG5cbmZ1bmN0aW9uIGRlbHRhT2JqZWN0KGEsIGIsIHBhcmFtKSB7XG4gICAgaWYgKGEucmVzdWx0ICYmIGIucmVzdWx0KSB7XG4gICAgICAgIHJldHVybiByZWN1cnNpdmVEZWx0YShhW3BhcmFtXS5yZXN1bHQsIGJbcGFyYW1dLnJlc3VsdCk7XG4gICAgfSBlbHNlIGlmIChhLmxlbmd0aCAmJiBiLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZGVsdGFBcnJheShhW3BhcmFtXSwgYltwYXJhbV0pO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBkZWx0YUFycmF5KGEsIGIpIHtcbiAgICB2YXIgZDtcbiAgICBpZiAoYS5sZW5ndGggPT09IGIubGVuZ3RoKSB7XG4gICAgICAgIGQgPSBuZXcgRmxvYXQ2NEFycmF5KGEubGVuZ3RoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBkID0gW107XG4gICAgfVxuICAgIHZhciBuID0gMDtcbiAgICB3aGlsZSAobiA8IGEubGVuZ3RoICYmIG4gPCBiLmxlbmd0aCkge1xuICAgICAgICBkW25dID0gYVtuXSAtIGJbbl07XG4gICAgICAgIG4rKztcbiAgICB9XG4gICAgcmV0dXJuIGQ7XG59XG5cbmV4cG9ydCBjbGFzcyBEYXRhUHJvdG90eXBlIHtcbiAgICBjb25zdHJ1Y3RvcihOLCBzYW1wbGVSYXRlKSB7XG4gICAgICAgIHRoaXMucmVzdWx0ID0ge307XG4gICAgICAgIHRoaXMuX3NhbXBsZVJhdGUgPSBzYW1wbGVSYXRlO1xuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgRmxvYXQ2NEFycmF5KE4pO1xuICAgIH1cbiAgICBnZXQgc2FtcGxlUmF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NhbXBsZVJhdGU7XG4gICAgfVxuICAgIHNldCBzYW1wbGVSYXRlKGZzKSB7XG4gICAgICAgIHRoaXMuX3NhbXBsZVJhdGUgPSBmcztcbiAgICB9XG4gICAgY2xlYXJSZXN1bHQoKSB7XG4gICAgICAgIHRoaXMucmVzdWx0ID0ge307XG4gICAgfVxuICAgIGdldERhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGE7XG4gICAgfVxuICAgIHplcm9EYXRhUmFuZ2Uoc3RhcnQsIGVuZCkge1xuICAgICAgICBpZiAodGhpcy5kYXRhLmZpbGwpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5maWxsKDAsIHN0YXJ0LCBlbmQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgbiA9IHN0YXJ0OyBuIDwgZW5kOyBuKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFbbl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXJSZXN1bHQoKTtcbiAgICB9XG4gICAgemVyb0RhdGEgKCkge1xuICAgICAgICB0aGlzLnplcm9EYXRhUmFuZ2UoMCwgdGhpcy5kYXRhLmxlbmd0aCk7XG4gICAgfVxuICAgIGNvcHlEYXRhRnJvbShzcmMsIE4sIG9mZnNldCkge1xuICAgICAgICBpZiAodHlwZW9mIHNyYyAhPT0gXCJvYmplY3RcIiB8fCBzcmMubGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IChcImNvcHlEYXRhRnJvbSByZXF1aXJlcyBzcmMgdG8gYmUgYW4gQXJyYXkgb3IgVHlwZWRBcnJheVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgTiA9IE1hdGgubWluKHNyYy5sZW5ndGgsIHRoaXMuZGF0YS5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIE4gPSBNYXRoLm1pbihOICsgb2Zmc2V0LCB0aGlzLmRhdGEubGVuZ3RoKTtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBOOyBuKyspIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YVtuICsgb2Zmc2V0XSA9IHNyY1tuXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyUmVzdWx0KCk7XG4gICAgfVxuXG4gICAgZHVwbGljYXRlKCkge1xuICAgICAgICB2YXIgY29weSA9IHRoaXMucHJvdG90eXBlLmNvbnN0cnVjdG9yKHRoaXMuZGF0YS5sZW5ndGgsIHRoaXMuc2FtcGxlUmF0ZSk7XG4gICAgICAgIGNvcHkuY29weURhdGFGcm9tKHRoaXMuZGF0YSk7XG4gICAgfVxuXG4gICAgdG9KU09OKCkge1xuICAgICAgICBmdW5jdGlvbiBsY2hhcihzdHIpIHtcbiAgICAgICAgICAgIHZhciBsYXN0Y2hhciA9IHN0cltzdHIubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAobGFzdGNoYXIgIT09ICd7JyAmJiBsYXN0Y2hhciAhPT0gJywnKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gc3RyICsgJywgJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdHI7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRKU09OU3RyaW5nKHNlbGYsIHAsIG4pIHtcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwID09PSBcIm51bWJlclwiICYmIGlzRmluaXRlKHApKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gJ1wiJyArIG4gKyAnXCI6ICcgKyBwO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIGlmIChwLnRvSlNPTikge1xuICAgICAgICAgICAgICAgICAgICBzdHIgPSAnXCInICsgbiArICdcIjogJyArIHAudG9KU09OKHApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gJ1wiJyArIG4gKyAnXCI6ICcgKyB4dHJhY3RfYXJyYXlfdG9fSlNPTihwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdHIgPSAnXCInICsgbiArICdcIjogJyArIHNlbGYudG9KU09OKHApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gJ1wiJyArIG4gKyAnXCI6IFwiJyArIHAudG9TdHJpbmcoKSArICdcIic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgICB9XG4gICAgICAgIHZhciBqc29uID0gJ3snO1xuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiB0aGlzLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0Lmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIGpzb24gPSBsY2hhcihqc29uKTtcbiAgICAgICAgICAgICAgICBqc29uID0ganNvbiArIGdldEpTT05TdHJpbmcodGhpcywgdGhpcy5yZXN1bHRbcHJvcGVydHldLCBwcm9wZXJ0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGpzb24gKyAnfSc7XG4gICAgfVxuXG4gICAgY29tcHV0ZURlbHRhKGNvbXBhcmUpIHtcbiAgICAgICAgdGhpcy5yZXN1bHQuZGVsdGEgPSByZWN1cnNpdmVEZWx0YSh0aGlzLnJlc3VsdCwgY29tcGFyZS5yZXN1bHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuZGVsdGE7XG4gICAgfVxuXG4gICAgY29tcHV0ZURlbHRhRGVsdGEoY29tcGFyZSkge1xuICAgICAgICBpZiAoIWNvbXBhcmUucmVzdWx0LmRlbHRhIHx8ICF0aGlzLnJlc3VsdC5kZWx0YSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiQ2Fubm90IGNvbXB1dGUgZGVsdGEtZGVsdGEgd2l0aG91dCBib3RoIG9iamVjdHMgaGF2aW5nIGRlbHRhc1wiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc3VsdC5kZWx0YS5kZWx0YSA9IHJlY3Vyc2l2ZURlbHRhKHRoaXMucmVzdWx0LmRlbHRhLCBjb21wYXJlLnJlc3VsdC5kZWx0YSk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5kZWx0YS5kZWx0YTtcbiAgICB9XG5cbiAgICBjcmVhdGVEY3RDb2VmZmljaWVudHMoTikge1xuICAgICAgICByZXR1cm4gY3JlYXRlRGN0Q29lZmZpY2llbnRzKE51bWJlcihOKSk7XG4gICAgfVxuXG4gICAgY3JlYXRlTWZjY0NvZWZmaWNpZW50cyhOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKSB7XG4gICAgICAgIE4gPSBOdW1iZXIoTik7XG4gICAgICAgIG55cXVpc3QgPSBOdW1iZXIobnlxdWlzdCk7XG4gICAgICAgIGZyZXFfbWluID0gTnVtYmVyKGZyZXFfbWluKTtcbiAgICAgICAgZnJlcV9tYXggPSBOdW1iZXIoZnJlcV9tYXgpO1xuICAgICAgICBmcmVxX2JhbmRzID0gTnVtYmVyKGZyZXFfYmFuZHMpO1xuICAgICAgICByZXR1cm4gY3JlYXRlTWZjY0NvZWZmaWNpZW50cyhOLCBueXF1aXN0LCBzdHlsZSwgZnJlcV9taW4sIGZyZXFfbWF4LCBmcmVxX2JhbmRzKTtcbiAgICB9XG5cbiAgICBjcmVhdGVCYXJrQ29lZmZpY2llbnRzKE4sIHNhbXBsZVJhdGUsIG51bUJhbmRzKSB7XG4gICAgICAgIE4gPSBOdW1iZXIoTik7XG4gICAgICAgIHNhbXBsZVJhdGUgPSBOdW1iZXIoc2FtcGxlUmF0ZSk7XG4gICAgICAgIG51bUJhbmRzID0gTnVtYmVyKG51bUJhbmRzKTtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUJhcmtDb2VmZmljaWVudHMoTiwgc2FtcGxlUmF0ZSwgbnVtQmFuZHMpO1xuICAgIH1cblxuICAgIGNyZWF0ZUNocm9tYUNvZWZmaWNpZW50cyhOLCBzYW1wbGVSYXRlLCBuYmlucywgQTQ0MCwgZl9jdHIsIG9jdHdpZHRoKSB7XG4gICAgICAgIE4gPSBOdW1iZXIoTik7XG4gICAgICAgIHNhbXBsZVJhdGUgPSBOdW1iZXIoc2FtcGxlUmF0ZSk7XG4gICAgICAgIG5iaW5zID0gTnVtYmVyKG5iaW5zKTtcbiAgICAgICAgQTQ0MCA9IE51bWJlcihBNDQwKTtcbiAgICAgICAgZl9jdHIgPSBOdW1iZXIoZl9jdHIpO1xuICAgICAgICBvY3R3aWR0aCA9IE51bWJlcihvY3R3aWR0aCk7XG4gICAgICAgIHJldHVybiBjcmVhdGVDaHJvbWFDb2VmZmljaWVudHMoTiwgc2FtcGxlUmF0ZSwgbmJpbnMsIEE0NDAsIGZfY3RyLCBvY3R3aWR0aCk7XG4gICAgfVxufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3Mvb2JqZWN0cy9QZWFrU3BlY3RydW1EYXRhLmQudHNcIiAvPlxuaW1wb3J0IHtQZWFrU3BlY3RydW1EYXRhfSBmcm9tIFwiLi9QZWFrU3BlY3RydW1EYXRhXCI7XG5pbXBvcnQge3h0cmFjdF9vZGRfZXZlbl9yYXRpb30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfb2RkX2V2ZW5fcmF0aW9cIjtcbmltcG9ydCB7eHRyYWN0X25vaXNpbmVzc30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfbm9pc2luZXNzXCI7XG5cbmV4cG9ydCBjbGFzcyBIYXJtb25pY1NwZWN0cnVtRGF0YSBleHRlbmRzIFBlYWtTcGVjdHJ1bURhdGEge1xuICAgIG9kZF9ldmVuX3JhdGlvICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0Lm9kZF9ldmVuX3JhdGlvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmYwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwZWN0cmFsX2Z1bmRhbWVudGFsKHRoaXMuZGF0YSwgdGhpcy5zYW1wbGVSYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lm9kZF9ldmVuX3JhdGlvID0geHRyYWN0X29kZF9ldmVuX3JhdGlvKHRoaXMuZGF0YSwgdGhpcy5mMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0Lm9kZF9ldmVuX3JhdGlvO1xuICAgIH1cblxuICAgIG5vaXNpbmVzcygpIHtcbiAgICAgICAgaWYgKHBhcmVudC5jb25zdHJ1Y3RvciAhPT0gUGVha1NwZWN0cnVtRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQubm9pc2luZXNzID0gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lm5vaXNpbmVzcyA9IHh0cmFjdF9ub2lzaW5lc3ModGhpcy5ub256ZXJvX2NvdW50KCksIHBhcmVudC5ub256ZXJvX2NvdW50KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5ub2lzaW5lc3M7XG4gICAgfVxufVxuXG5IYXJtb25pY1NwZWN0cnVtRGF0YS5wcm90b3R5cGUuZmVhdHVyZXMgPSBQZWFrU3BlY3RydW1EYXRhLnByb3RvdHlwZS5mZWF0dXJlcy5jb25jYXQoW1xuICAgIHtcbiAgICAgICAgbmFtZTogXCJPZGQgRXZlbiBSYXRpb25cIixcbiAgICAgICAgZnVuY3Rpb246IFwib2RkX2V2ZW5fcmF0aW9cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJOb2lzaW5lc3NcIixcbiAgICAgICAgZnVuY3Rpb246IFwibm9pc2luZXNzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG4gICAgfVxuXSk7XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy9vYmplY3RzL1BlYWtTcGVjdHJ1bURhdGEuZC50c1wiIC8+XG5pbXBvcnQge1NwZWN0cnVtRGF0YX0gZnJvbSBcIi4vU3BlY3RydW1EYXRhXCI7XG5pbXBvcnQge0hhcm1vbmljU3BlY3RydW1EYXRhfSBmcm9tIFwiLi9IYXJtb25pY1NwZWN0cnVtRGF0YVwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eVwiO1xuaW1wb3J0IHt4dHJhY3RfaGFybW9uaWNfc3BlY3RydW19IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2hhcm1vbmljX3NwZWN0cnVtXCI7XG5cblxuZXhwb3J0IGNsYXNzIFBlYWtTcGVjdHJ1bURhdGEgZXh0ZW5kcyBTcGVjdHJ1bURhdGEge1xuICAgIHNwZWN0cmFsX2luaGFybW9uaWNpdHkoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zcGVjdHJhbF9pbmhhcm1vbmljaXR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNwZWN0cmFsX2luaGFybW9uaWNpdHkgPSB4dHJhY3Rfc3BlY3RyYWxfaW5oYXJtb25pY2l0eSh0aGlzLmRhdGEsIHRoaXMuc2FtcGxlUmF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnNwZWN0cmFsX2luaGFybW9uaWNpdHk7XG4gICAgfVxuXG4gICAgaGFybW9uaWNfc3BlY3RydW0odGhyZXNob2xkKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5oYXJtb25pY19zcGVjdHJ1bSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5mMCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGVjdHJhbF9mdW5kYW1lbnRhbCh0aGlzLmRhdGEsIHRoaXMuc2FtcGxlUmF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5oYXJtb25pY19zcGVjdHJ1bSA9IG5ldyBIYXJtb25pY1NwZWN0cnVtRGF0YSh0aGlzLmxlbmd0aCwgdGhpcy5zYW1wbGVSYXRlLCB0aGlzKTtcbiAgICAgICAgICAgIHZhciBocyA9IHh0cmFjdF9oYXJtb25pY19zcGVjdHJ1bSh0aGlzLmRhdGEsIHRoaXMuZjAsIHRocmVzaG9sZCk7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5oYXJtb25pY19zcGVjdHJ1bS5jb3B5RGF0YUZyb20oaHMuc3ViYXJyYXkoMCwgdGhpcy5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuaGFybW9uaWNfc3BlY3RydW07XG4gICAgfVxufVxuXG5QZWFrU3BlY3RydW1EYXRhLnByb3RvdHlwZS5mZWF0dXJlcyA9IFNwZWN0cnVtRGF0YS5wcm90b3R5cGUuZmVhdHVyZXMuY29uY2F0KFtcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiU3BlY3RyYWwgSW5oYXJtb25pY2l0eVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9pbmhhcm1vbmljaXR5XCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW1wiZjBcIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiSGFybW9uaWMgU3BlY3RydW1cIixcbiAgICAgICAgZnVuY3Rpb246IFwiaGFybW9uaWNfc3BlY3RydW1cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW3tcbiAgICAgICAgICAgIG5hbWU6IFwiVGhyZXNob2xkXCIsXG4gICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgIG1pbmltdW06IDAsXG4gICAgICAgICAgICBtYXhpbXVtOiAxMDAsXG4gICAgICAgICAgICBkZWZhdWx0OiAzMFxuICAgIH1dLFxuICAgICAgICByZXR1cm5zOiBcIkhhcm1vbmljU3BlY3RydW1EYXRhXCJcbn1dKTtcbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL29iamVjdHMvU3BlY3RydW1EYXRhLmQudHNcIiAvPlxuaW1wb3J0IHtEYXRhUHJvdG90eXBlfSBmcm9tIFwiLi9EYXRhUHJvdG90eXBlXCI7XG5pbXBvcnQge1BlYWtTcGVjdHJ1bURhdGF9IGZyb20gXCIuL1BlYWtTcGVjdHJ1bURhdGFcIjtcbmltcG9ydCB7eHRyYWN0X2luaXRfYmFya30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfaW5pdF9iYXJrXCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9taW59IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2FycmF5X21pblwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfbWF4fSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9hcnJheV9tYXhcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X3N1bX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfc3VtXCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJhbF9jZW50cm9pZH0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWRcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX21lYW59IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX21lYW5cIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF92YXJpYW5jZVwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfc3ByZWFkfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9zcHJlYWRcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbn0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uXCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJhbF9za2V3bmVzc30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfc2tld25lc3NcIjtcbmltcG9ydCB7eHRyYWN0X3NwZWN0cmFsX2t1cnRvc2lzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9zcGVjdHJhbF9rdXJ0b3Npc1wiO1xuaW1wb3J0IHt4dHJhY3RfaXJyZWd1bGFyaXR5X2t9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2lycmVndWxhcml0eV9rXCI7XG5pbXBvcnQge3h0cmFjdF9pcnJlZ3VsYXJpdHlfan0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfaXJyZWd1bGFyaXR5X2pcIjtcbmltcG9ydCB7eHRyYWN0X3RyaXN0aW11bHVzXzEsIHh0cmFjdF90cmlzdGltdWx1c18yLCB4dHJhY3RfdHJpc3RpbXVsdXNfM30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfdHJpc3RpbXVsdXNcIjtcbmltcG9ydCB7eHRyYWN0X3Ntb290aG5lc3N9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3Ntb290aG5lc3NcIjtcbmltcG9ydCB7eHRyYWN0X3JvbGxvZmZ9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3JvbGxvZmZcIjtcbmltcG9ydCB7eHRyYWN0X2xvdWRuZXNzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9sb3VkbmVzc1wiO1xuaW1wb3J0IHt4dHJhY3Rfc2hhcnBuZXNzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9zaGFycG5lc3NcIjtcbmltcG9ydCB7eHRyYWN0X2ZsYXRuZXNzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9mbGF0bmVzc1wiO1xuaW1wb3J0IHt4dHJhY3RfZmxhdG5lc3NfZGJ9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2ZsYXRuZXNzX2RiXCI7XG5pbXBvcnQge3h0cmFjdF90b25hbGl0eX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfdG9uYWxpdHlcIjtcbmltcG9ydCB7eHRyYWN0X2NyZXN0fSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9jcmVzdFwiO1xuaW1wb3J0IHt4dHJhY3Rfc3BlY3RyYWxfc2xvcGV9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3NwZWN0cmFsX3Nsb3BlXCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJhbF9mdW5kYW1lbnRhbH0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RyYWxfZnVuZGFtZW50YWxcIjtcbmltcG9ydCB7eHRyYWN0X25vbnplcm9fY291bnR9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X25vbnplcm9fY291bnRcIjtcbmltcG9ydCB7eHRyYWN0X2hwc30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfaHBzXCI7XG5pbXBvcnQge3h0cmFjdF9tZmNjfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9tZmNjXCI7XG5pbXBvcnQge3h0cmFjdF9kY3RfMn0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfZGN0XzJcIjtcbmltcG9ydCB7eHRyYWN0X2JhcmtfY29lZmZpY2llbnRzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9iYXJrX2NvZWZmaWNpZW50c1wiO1xuaW1wb3J0IHt4dHJhY3RfY2hyb21hfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9jaHJvbWFcIjtcbmltcG9ydCB7eHRyYWN0X3BlYWtfc3BlY3RydW19IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3BlYWtfc3BlY3RydW1cIjtcblxuZXhwb3J0IGNsYXNzIFNwZWN0cnVtRGF0YSBleHRlbmRzIERhdGFQcm90b3R5cGUge1xuICAgIGNvbnN0cnVjdG9yKE4sIHNhbXBsZVJhdGUsIHBhcmVudCkge1xuICAgICAgICBpZiAoTiA9PT0gdW5kZWZpbmVkIHx8IE4gPD0gMCkge1xuICAgICAgICAgICAgdGhyb3cgKFwiU3BlY3RydW1EYXRhIGNvbnN0cnVjdG9yIHJlcXVpcmVzIE4gdG8gYmUgYSBkZWZpbmVkLCB3aG9sZSBudW1iZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNhbXBsZVJhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2FtcGxlUmF0ZSA9IE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIoMipOLCBzYW1wbGVSYXRlKTtcbiAgICAgICAgdGhpcy5fYW1wcyA9IHRoaXMuZGF0YS5zdWJhcnJheSgwLCBOKTtcbiAgICAgICAgdGhpcy5fZnJlcXMgPSB0aGlzLmRhdGEuc3ViYXJyYXkoTiwgMiAqIE4pO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSBOO1xuICAgICAgICB0aGlzLl9mMCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fbWZjYyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fYmFyayA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fZGN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9jaHJvbWEgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgdGhpcy5jb21wdXRlRnJlcXVlbmNpZXMoKTtcbiAgICB9XG4gICAgY29tcHV0ZUZyZXF1ZW5jaWVzICgpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5fZnJlcXNbaV0gPSAoaSAvIHRoaXMuX2xlbmd0aCkgKiAodGhpcy5zYW1wbGVSYXRlIC8gMik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHNhbXBsZVJhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zYW1wbGVSYXRlO1xuICAgIH1cbiAgICBzZXQgc2FtcGxlUmF0ZShmcykge1xuICAgICAgICBpZiAodGhpcy5fc2FtcGxlUmF0ZSA9PT0gTWF0aC5QSSkge1xuICAgICAgICAgICAgdGhpcy5fc2FtcGxlUmF0ZSA9IGZzO1xuICAgICAgICAgICAgdGhpcy5jb21wdXRlRnJlcXVlbmNpZXMoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9iYXJrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXJrID0geHRyYWN0X2luaXRfYmFyayh0aGlzLl9sZW5ndGgsIHRoaXMuX3NhbXBsZVJhdGUgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgKFwiQ2Fubm90IHNldCBvbmUtdGltZSB2YXJpYWJsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBmMCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2YwO1xuICAgIH1cblxuICAgIHNldCBmMChmMCkge1xuICAgICAgICBpZiAodHlwZW9mIGYwID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aGlzLl9mMCA9IGYwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9XG5cbiAgICBpbml0X21mY2MobnVtX2JhbmRzLCBmcmVxX21pbiwgZnJlcV9tYXgsIHN0eWxlKSB7XG4gICAgICAgIHRoaXMuX21mY2MgPSB0aGlzLmNyZWF0ZU1mY2NDb2VmZmljaWVudHModGhpcy5fbGVuZ3RoLCB0aGlzLnNhbXBsZVJhdGUgKiAwLjUsIHN0eWxlLCBmcmVxX21pbiwgZnJlcV9tYXgsIG51bV9iYW5kcyk7XG4gICAgICAgIHRoaXMucmVzdWx0Lm1mY2MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiB0aGlzLl9tZmNjO1xuICAgIH1cblxuICAgIGluaXRfYmFyayhudW1CYW5kcykge1xuICAgICAgICBpZiAodHlwZW9mIG51bUJhbmRzICE9PSBcIm51bWJlclwiIHx8IG51bUJhbmRzIDwgMCB8fCBudW1CYW5kcyA+IDI2KSB7XG4gICAgICAgICAgICBudW1CYW5kcyA9IDI2O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2JhcmsgPSB0aGlzLmNyZWF0ZUJhcmtDb2VmZmljaWVudHModGhpcy5fbGVuZ3RoLCB0aGlzLl9GcywgbnVtQmFuZHMpO1xuICAgICAgICByZXR1cm4gdGhpcy5fYmFyaztcbiAgICB9XG5cbiAgICBpbml0X2Nocm9tYShuYmlucywgQTQ0MCwgZl9jdHIsIG9jdHdpZHRoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmJpbnMgIT09IFwibnVtYmVyXCIgfHwgbmJpbnMgPD0gMSkge1xuICAgICAgICAgICAgbmJpbnMgPSAxMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIEE0NDAgIT09IFwibnVtYmVyXCIgfHwgQTQ0MCA8PSAyNy41KSB7XG4gICAgICAgICAgICAgICBBNDQwID0gNDQwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZl9jdHIgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgIGZfY3RyID0gMTAwMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9jdHdpZHRoICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICBvY3R3aWR0aCA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2hyb21hID0gdGhpcy5jcmVhdGVDaHJvbWFDb2VmZmljaWVudHModGhpcy5fbGVuZ3RoLCB0aGlzLl9GcywgbmJpbnMsIEE0NDAsIGZfY3RyLCBvY3R3aWR0aCk7XG4gICAgICAgIHRoaXMucmVzdWx0LmNocm9tYSA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nocm9tYTtcbiAgICB9XG5cbiAgICBtaW5pbXVtKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQubWluaW11bSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5taW5pbXVtID0geHRyYWN0X2FycmF5X21pbih0aGlzLl9hbXBzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQubWluaW11bTtcbiAgICB9XG5cbiAgICBtYXhpbXVtKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQubWF4aW11bSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5tYXhpbXVtID0geHRyYWN0X2FycmF5X21heCh0aGlzLl9hbXBzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQubWF4aW11bTtcbiAgICB9XG5cbiAgICBzdW0oKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zdW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc3VtID0geHRyYWN0X2FycmF5X3N1bSh0aGlzLl9hbXBzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3VtO1xuICAgIH1cblxuICAgIHNwZWN0cmFsX2NlbnRyb2lkKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3BlY3RyYWxfY2VudHJvaWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc3BlY3RyYWxfY2VudHJvaWQgPSB4dHJhY3Rfc3BlY3RyYWxfY2VudHJvaWQodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3BlY3RyYWxfY2VudHJvaWQ7XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfbWVhbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zcGVjdHJhbF9tZWFuID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNwZWN0cmFsX21lYW4gPSB4dHJhY3Rfc3BlY3RyYWxfbWVhbih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zcGVjdHJhbF9tZWFuO1xuICAgIH1cblxuICAgIHNwZWN0cmFsX3ZhcmlhbmNlICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNwZWN0cmFsX3ZhcmlhbmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNwZWN0cmFsX3ZhcmlhbmNlID0geHRyYWN0X3NwZWN0cmFsX3ZhcmlhbmNlKHRoaXMuZGF0YSwgdGhpcy5zcGVjdHJhbF9jZW50cm9pZCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3BlY3RyYWxfdmFyaWFuY2U7XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfc3ByZWFkKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3BlY3RyYWxfc3ByZWFkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNwZWN0cmFsX3NwcmVhZCA9IHh0cmFjdF9zcGVjdHJhbF9zcHJlYWQodGhpcy5kYXRhLCB0aGlzLnNwZWN0cmFsX2NlbnRyb2lkKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zcGVjdHJhbF9zcHJlYWQ7XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNwZWN0cmFsX3N0YW5kYXJkX2RldmlhdGlvbiA9IHh0cmFjdF9zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24odGhpcy5kYXRhLCB0aGlzLnNwZWN0cmFsX3ZhcmlhbmNlKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb247XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfc2tld25lc3MoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zcGVjdHJhbF9za2V3bmVzcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5zcGVjdHJhbF9za2V3bmVzcyA9IHh0cmFjdF9zcGVjdHJhbF9za2V3bmVzcyh0aGlzLmRhdGEsIHRoaXMuc3BlY3RyYWxfY2VudHJvaWQoKSwgdGhpcy5zcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb24oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnNwZWN0cmFsX3NrZXduZXNzO1xuICAgIH1cblxuICAgIHNwZWN0cmFsX2t1cnRvc2lzKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3BlY3RyYWxfa3VydG9zaXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc3BlY3RyYWxfa3VydG9zaXMgPSB4dHJhY3Rfc3BlY3RyYWxfa3VydG9zaXModGhpcy5kYXRhLCB0aGlzLnNwZWN0cmFsX2NlbnRyb2lkKCksIHRoaXMuc3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zcGVjdHJhbF9rdXJ0b3NpcztcbiAgICB9XG5cbiAgICBpcnJlZ3VsYXJpdHlfayAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfayA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfayA9IHh0cmFjdF9pcnJlZ3VsYXJpdHlfayh0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfaztcbiAgICB9XG5cbiAgICBpcnJlZ3VsYXJpdHlfaiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfaiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfaiA9IHh0cmFjdF9pcnJlZ3VsYXJpdHlfaih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5pcnJlZ3VsYXJpdHlfajtcbiAgICB9XG5cbiAgICB0cmlzdGltdWx1c18xICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2YwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3BlY3RyYWxfZnVuZGFtZW50YWwoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXN1bHQudHJpc3RpbXVsdXNfMSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC50cmlzdGltdWx1c18xID0geHRyYWN0X3RyaXN0aW11bHVzXzEodGhpcy5kYXRhLCB0aGlzLl9mMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnRyaXN0aW11bHVzXzE7XG4gICAgfVxuICAgIHRyaXN0aW11bHVzXzIgKCkge1xuICAgICAgICBpZiAodGhpcy5fZjAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5zcGVjdHJhbF9mdW5kYW1lbnRhbCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC50cmlzdGltdWx1c18yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnRyaXN0aW11bHVzXzIgPSB4dHJhY3RfdHJpc3RpbXVsdXNfMih0aGlzLmRhdGEsIHRoaXMuX2YwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQudHJpc3RpbXVsdXNfMjtcbiAgICB9XG4gICAgdHJpc3RpbXVsdXNfMyAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9mMCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnNwZWN0cmFsX2Z1bmRhbWVudGFsKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnRyaXN0aW11bHVzXzMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQudHJpc3RpbXVsdXNfMyA9IHh0cmFjdF90cmlzdGltdWx1c18zKHRoaXMuZGF0YSwgdGhpcy5fZjApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC50cmlzdGltdWx1c18zO1xuICAgIH1cblxuICAgIHNtb290aG5lc3MoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zbW9vdGhuZXNzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnNtb290aG5lc3MgPSB4dHJhY3Rfc21vb3RobmVzcyh0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zbW9vdGhuZXNzO1xuICAgIH1cblxuICAgIHJvbGxvZmYodGhyZXNob2xkKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5yb2xsb2ZmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnJvbGxvZmYgPSB4dHJhY3Rfcm9sbG9mZih0aGlzLmRhdGEsIHRoaXMuc2FtcGxlUmF0ZSwgdGhyZXNob2xkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQucm9sbG9mZjtcbiAgICB9XG5cbiAgICBsb3VkbmVzcygpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LmxvdWRuZXNzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LmxvdWRuZXNzID0geHRyYWN0X2xvdWRuZXNzKHRoaXMuYmFya19jb2VmZmljaWVudHMoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LmxvdWRuZXNzO1xuICAgIH1cblxuICAgIHNoYXJwbmVzcyAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaGFycG5lc3MgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc2hhcnBuZXNzID0geHRyYWN0X3NoYXJwbmVzcyh0aGlzLmJhcmtfY29lZmZpY2llbnRzKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5zaGFycG5lc3M7XG4gICAgfVxuXG4gICAgZmxhdG5lc3MgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuZmxhdG5lc3MgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuZmxhdG5lc3MgPSB4dHJhY3RfZmxhdG5lc3ModGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuZmxhdG5lc3M7XG4gICAgfVxuXG4gICAgZmxhdG5lc3NfZGIgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuZmxhdG5lc3NfZGIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuZmxhdG5lc3NfZGIgPSB4dHJhY3RfZmxhdG5lc3NfZGIodGhpcy5kYXRhLCB0aGlzLmZsYXRuZXNzKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5mbGF0bmVzc19kYjtcbiAgICB9XG5cbiAgICB0b25hbGl0eSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnRvbmFsaXR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnRvbmFsaXR5ID0geHRyYWN0X3RvbmFsaXR5KHRoaXMuZGF0YSwgdGhpcy5mbGF0bmVzc19kYigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQudG9uYWxpdHk7XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfY3Jlc3RfZmFjdG9yICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNwZWN0cmFsX2NyZXN0X2ZhY3RvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5zcGVjdHJhbF9jcmVzdF9mYWN0b3IgPSB4dHJhY3RfY3Jlc3QodGhpcy5fYW1wcywgdGhpcy5tYXhpbXVtKCksIHRoaXMuc3BlY3RyYWxfbWVhbigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3BlY3RyYWxfY3Jlc3RfZmFjdG9yO1xuICAgIH1cblxuICAgIHNwZWN0cmFsX3Nsb3BlKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3BlY3RyYWxfc2xvcGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc3BlY3RyYWxfc2xvcGUgPSB4dHJhY3Rfc3BlY3RyYWxfc2xvcGUodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3BlY3RyYWxfc2xvcGU7XG4gICAgfVxuXG4gICAgc3BlY3RyYWxfZnVuZGFtZW50YWwoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5zcGVjdHJhbF9mdW5kYW1lbnRhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5zcGVjdHJhbF9mdW5kYW1lbnRhbCA9IHh0cmFjdF9zcGVjdHJhbF9mdW5kYW1lbnRhbCh0aGlzLmRhdGEsIF9Gcyk7XG4gICAgICAgICAgICB0aGlzLmYwID0gdGhpcy5yZXN1bHQuc3BlY3RyYWxfZnVuZGFtZW50YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnNwZWN0cmFsX2Z1bmRhbWVudGFsO1xuICAgIH1cblxuICAgIG5vbnplcm9fY291bnQgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQubm9uemVyb19jb3VudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5ub256ZXJvX2NvdW50ID0geHRyYWN0X25vbnplcm9fY291bnQoX2FtcHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5ub256ZXJvX2NvdW50O1xuICAgIH1cblxuICAgIGhwcyAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5ocHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuaHBzID0geHRyYWN0X2hwcyh0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5ocHM7XG4gICAgfVxuXG4gICAgbWZjYyhudW1fYmFuZHMsIGZyZXFfbWluLCBmcmVxX21heCkge1xuICAgICAgICBpZiAodGhpcy5fbWZjYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoZnJlcV9taW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRocm93IChcIlJ1biBpbml0X21mY2MobnVtX2JhbmRzLCBmcmVxX21pbiwgZnJlcV9tYXgsIHN0eWxlKSBmaXJzdFwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWZjYyA9IHRoaXMuaW5pdF9tZmNjKG51bV9iYW5kcywgZnJlcV9taW4sIGZyZXFfbWF4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXN1bHQubWZjYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5tZmNjID0geHRyYWN0X21mY2ModGhpcy5kYXRhLCB0aGlzLl9tZmNjKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQubWZjYztcbiAgICB9XG5cbiAgICBkY3QgKCkge1xuICAgICAgICBpZiAodGhpcy5fZGN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2RjdCA9IHRoaXMuY3JlYXRlRGN0Q29lZmZpY2llbnRzKHRoaXMuX2xlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LmRjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5kY3QgPSB4dHJhY3RfZGN0XzIodGhpcy5fYW1wcyx0aGlzLl9kY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5kY3Q7XG4gICAgfVxuXG4gICAgYmFya19jb2VmZmljaWVudHMobnVtX2JhbmRzKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5iYXJrX2NvZWZmaWNpZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYmFyayA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFyayA9IHRoaXMuaW5pdF9iYXJrKG51bV9iYW5kcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5iYXJrX2NvZWZmaWNpZW50cyA9IHh0cmFjdF9iYXJrX2NvZWZmaWNpZW50cyh0aGlzLmRhdGEsIHRoaXMuX2JhcmspO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5iYXJrX2NvZWZmaWNpZW50cztcbiAgICB9XG5cbiAgICBjaHJvbWEobmJpbnMsIEE0NDAsIGZfY3RyLCBvY3R3aWR0aCkge1xuICAgICAgICBpZih0aGlzLnJlc3VsdC5jaHJvbWEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2Nocm9tYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hyb21hID0gdGhpcy5pbml0X2Nocm9tYShuYmlucywgQTQ0MCwgZl9jdHIsIG9jdHdpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVzdWx0LmNocm9tYSA9IHh0cmFjdF9jaHJvbWEodGhpcy5kYXRhLCB0aGlzLl9jaHJvbWEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5jaHJvbWE7XG4gICAgfVxuXG4gICAgcGVha19zcGVjdHJ1bSh0aHJlc2hvbGQpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnBlYWtfc3BlY3RydW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQucGVha19zcGVjdHJ1bSA9IG5ldyBQZWFrU3BlY3RydW1EYXRhKHRoaXMuX2xlbmd0aCwgdGhpcy5zYW1wbGVSYXRlLCB0aGlzKTtcbiAgICAgICAgICAgIHZhciBwcyA9IHh0cmFjdF9wZWFrX3NwZWN0cnVtKHRoaXMuZGF0YSwgdGhpcy5zYW1wbGVSYXRlIC8gdGhpcy5fbGVuZ3RoLCB0aHJlc2hvbGQpO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQucGVha19zcGVjdHJ1bS5jb3B5RGF0YUZyb20ocHMuc3ViYXJyYXkoMCwgdGhpcy5fbGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnBlYWtfc3BlY3RydW07XG4gICAgfVxufVxuXG5TcGVjdHJ1bURhdGEucHJvdG90eXBlLmZlYXR1cmVzID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogXCJNaW5pbXVtXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcIm1pbmltdW1cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJNYXhpbXVtXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcIm1heGltdW1cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTdW1cIixcbiAgICAgICAgZnVuY3Rpb246IFwic3VtXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiU3BlY3RyYWwgQ2VudHJvaWRcIixcbiAgICAgICAgZnVuY3Rpb246IFwic3BlY3RyYWxfY2VudHJvaWRcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTcGVjdHJhbCBNZWFuXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInNwZWN0cmFsX21lYW5cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTcGVjdHJhbCBWYXJpYW5jZVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF92YXJpYW5jZVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcInNwZWN0cmFsX21lYW5cIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiU3BlY3RyYWwgU3ByZWFkXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInNwZWN0cmFsX3NwcmVhZFwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcInNwZWN0cmFsX2NlbnRyb2lkXCJdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIlNwZWN0cmFsIFN0YW5kYXJkIERldmlhdGlvblwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb25cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJzcGVjdHJhbF92YXJpYW5jZVwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTcGVjdHJhbCBTa2V3bmVzc1wiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9za2V3bmVzc1wiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcInNwZWN0cmFsX21lYW5cIiwgXCJzcGVjdHJhbF9zdGFuZGFyZF9kZXZpYXRpb25cIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiU3BlY3RyYWwgS3VydG9zaXNcIixcbiAgICAgICAgZnVuY3Rpb246IFwic3BlY3RyYWxfa3VydG9zaXNcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJzcGVjdHJhbF9tZWFuXCIsIFwic3BlY3RyYWxfc3RhbmRhcmRfZGV2aWF0aW9uXCJdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIklycmVndWxhcml0eSBLXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImlycmVndWxhcml0eV9rXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiSXJyZWd1bGFyaXR5IEpcIixcbiAgICAgICAgZnVuY3Rpb246IFwiaXJyZWd1bGFyaXR5X2pcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJUcmlzdGltdWx1cyAxXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInRyaXN0aW11bHVzXzFcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJzcGVjdHJhbF9mdW5kYW1lbnRhbFwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJUcmlzdGltdWx1cyAyXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInRyaXN0aW11bHVzXzJcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJzcGVjdHJhbF9mdW5kYW1lbnRhbFwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJUcmlzdGltdWx1cyAzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInRyaXN0aW11bHVzXzNcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJzcGVjdHJhbF9mdW5kYW1lbnRhbFwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTbW9vdGhuZXNzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInNtb290aG5lc3NcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJSb2xsb2ZmXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInJvbGxvZmZcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW3tcbiAgICAgICAgICAgIG5hbWU6IFwiVGhyZXNob2xkXCIsXG4gICAgICAgICAgICB1bml0OiBcIiVcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAwLFxuICAgICAgICAgICAgbWF4aW11bTogMTAwLFxuICAgICAgICAgICAgZGVmYXVsdDogOTBcbiAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIkxvdWRuZXNzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImxvdWRuZXNzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW1wiYmFya19jb2VmZmljaWVudHNcIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiU2hhcnBuZXNzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInNoYXJwbmVzc1wiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcImJhcmtfY29lZmZpY2llbnRzXCJdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIkZsYXRuZXNzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImZsYXRuZXNzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiRmxhdG5lc3MgREJcIixcbiAgICAgICAgZnVuY3Rpb246IFwiZmxhdG5lc3NfZGJcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJmbGF0bmVzc1wiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJUb25hbGl0eVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJ0b25hbGl0eVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcImZsYXRuZXNzX2RiXCJdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIlNwZWN0cmFsIENyZXN0IEZhY3RvclwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9jcmVzdF9mYWN0b3JcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJtYXhpbXVtXCIsIFwic3BlY3RyYWxfbWVhblwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJTcGVjdHJhbCBTbG9wZVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9zbG9wZVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIkZ1bmRhbWVudGFsIEZyZXF1ZW5jeVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzcGVjdHJhbF9mdW5kYW1lbnRhbFwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxufSwge1xuICAgICAgICBuYW1lOiBcIk5vbi1aZXJvIGNvdW50XCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcIm5vbnplcm9fY291bnRcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbn0sIHtcbiAgICAgICAgbmFtZTogXCJIUFNcIixcbiAgICAgICAgZnVuY3Rpb246IFwiaHBzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiTUZDQ1wiLFxuICAgICAgICBmdW5jdGlvbjogXCJtZmNjXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIkJhbmQgQ291bnRcIixcbiAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgbWluaW11bTogMCxcbiAgICAgICAgICAgIG1heGltdW06IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGRlZmF1bHQ6IDI2XG4gICAgfSwge1xuICAgICAgICAgICAgbmFtZTogXCJNaW5pbXVtIEZyZXF1ZW5jeVwiLFxuICAgICAgICAgICAgdW5pdDogXCJIelwiLFxuICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgIG1pbmltdW06IDAsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiA0MDBcbiAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiBcIk1heGltdW0gRnJlcXVlbmN5XCIsXG4gICAgICAgICAgICB1bml0OiBcIkh6XCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAwLFxuICAgICAgICAgICAgbWF4aW11bTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGVmYXVsdDogMjAwMDBcbiAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJhcnJheVwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiQ2hyb21hXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImNocm9tYVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbe1xuICAgICAgICAgICAgbmFtZTogXCJuYmluc1wiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAyLFxuICAgICAgICAgICAgbWF4aW11bTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGVmYXVsdDogMTJcbiAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiBcIkE0NDBcIixcbiAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgbWluaW11bTogMjIwLFxuICAgICAgICAgICAgbWF4aW11bTogODgwLFxuICAgICAgICAgICAgZGVmYXVsdDogNDQwXG4gICAgfSwge1xuICAgICAgICAgICAgbmFtZTogXCJmX2N0clwiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiAxMDAwXG4gICAgfSwge1xuICAgICAgICAgICAgbmFtZTogXCJvY3R3aWR0aFwiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiAxXG4gICAgfV0sXG4gICAgICAgIHJldHVybnM6IFwiYXJyYXlcIlxufSwge1xuICAgICAgICBuYW1lOiBcIkRDVFwiLFxuICAgICAgICBmdW5jdGlvbjogXCJkY3RcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwiYXJyYXlcIlxufSwge1xuICAgICAgICBuYW1lOiBcIkJhcmsgQ29lZmZpY2llbnRzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImJhcmtfY29lZmZpY2llbnRzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIkJhbmQgQ291bnRcIixcbiAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgbWluaW11bTogMCxcbiAgICAgICAgICAgIG1heGltdW06IDI2LFxuICAgICAgICAgICAgZGVmYXVsdDogMjZcbiAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJhcnJheVwiXG59LCB7XG4gICAgICAgIG5hbWU6IFwiUGVhayBTcGVjdHJ1bVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJwZWFrX3NwZWN0cnVtXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIlRocmVzaG9sZFwiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAwLFxuICAgICAgICAgICAgbWF4aW11bTogMTAwLFxuICAgICAgICAgICAgZGVmYXVsdDogMzBcbiAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJQZWFrU3BlY3RydW1EYXRhXCJcbn1dO1xuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3Mvb2JqZWN0cy9UaW1lRGF0YS5kLnRzXCIgLz5cbmltcG9ydCB7RGF0YVByb3RvdHlwZX0gZnJvbSBcIi4vRGF0YVByb3RvdHlwZVwiO1xuaW1wb3J0IHtTcGVjdHJ1bURhdGF9IGZyb20gXCIuL1NwZWN0cnVtRGF0YVwiO1xuaW1wb3J0IHt4dHJhY3RfaW5pdF93YXZlbGV0fSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9pbml0X3dhdmVsZXRcIjtcbmltcG9ydCB7eHRyYWN0X2FycmF5X21pbn0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfYXJyYXlfbWluXCI7XG5pbXBvcnQge3h0cmFjdF9hcnJheV9tYXh9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2FycmF5X21heFwiO1xuaW1wb3J0IHt4dHJhY3RfYXJyYXlfc3VtfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9hcnJheV9zdW1cIjtcbmltcG9ydCB7eHRyYWN0X21lYW59IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X21lYW5cIjtcbmltcG9ydCB7eHRyYWN0X3RlbXBvcmFsX2NlbnRyb2lkfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF90ZW1wb3JhbF9jZW50cm9pZFwiO1xuaW1wb3J0IHt4dHJhY3RfdmFyaWFuY2V9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3ZhcmlhbmNlXCI7XG5pbXBvcnQge3h0cmFjdF9zdGFuZGFyZF9kZXZpYXRpb259IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3N0YW5kYXJkX2RldmlhdGlvblwiO1xuaW1wb3J0IHt4dHJhY3RfYXZlcmFnZV9kZXZpYXRpb259IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2F2ZXJhZ2VfZGV2aWF0aW9uXCI7XG5pbXBvcnQge3h0cmFjdF9za2V3bmVzc30gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc2tld25lc3NcIjtcbmltcG9ydCB7eHRyYWN0X2t1cnRvc2lzfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9rdXJ0b3Npc1wiO1xuaW1wb3J0IHt4dHJhY3RfemNyfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF96Y3JcIjtcbmltcG9ydCB7eHRyYWN0X2NyZXN0fSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9jcmVzdFwiO1xuaW1wb3J0IHt4dHJhY3Rfcm1zX2FtcGxpdHVkZX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfcm1zX2FtcGxpdHVkZVwiO1xuaW1wb3J0IHt4dHJhY3RfbG93ZXN0X3ZhbHVlfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9sb3dlc3RfdmFsdWVcIjtcbmltcG9ydCB7eHRyYWN0X25vbnplcm9fY291bnR9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X25vbnplcm9fY291bnRcIjtcbmltcG9ydCB7eHRyYWN0X3dhdmVsZXRfZjB9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X3dhdmVsZXRfZjBcIjtcbmltcG9ydCB7eHRyYWN0X2VuZXJneX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfZW5lcmd5XCI7XG5pbXBvcnQge3h0cmFjdF9zcGVjdHJ1bX0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfc3BlY3RydW1cIjtcbmltcG9ydCB7eHRyYWN0X2RjdF8yfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9kY3RfMlwiO1xuaW1wb3J0IHt4dHJhY3RfYXV0b2NvcnJlbGF0aW9ufSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9hdXRvY29ycmVsYXRpb25cIjtcbmltcG9ydCB7eHRyYWN0X2FtZGZ9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2FtZGZcIjtcbmltcG9ydCB7eHRyYWN0X2FzZGZ9IGZyb20gXCIuLi9mdW5jdGlvbnMveHRyYWN0X2FzZGZcIjtcbmltcG9ydCB7eHRyYWN0X3lpbn0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3RfeWluXCI7XG5pbXBvcnQge3h0cmFjdF9vbnNldH0gZnJvbSBcIi4uL2Z1bmN0aW9ucy94dHJhY3Rfb25zZXRcIjtcbmltcG9ydCB7eHRyYWN0X3Jlc2FtcGxlfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3h0cmFjdF9yZXNhbXBsZVwiO1xuXG5leHBvcnQgY2xhc3MgVGltZURhdGEgZXh0ZW5kcyBEYXRhUHJvdG90eXBlIHtcbiAgICBjb25zdHJ1Y3RvcihpbnB1dCwgc2FtcGxlUmF0ZSkge1xuICAgICAgICBpZiAoc2FtcGxlUmF0ZSA8PSAwKSB7XG4gICAgICAgICAgICBzYW1wbGVSYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbnZhbGlkIHBhcmFtZXRlciBmb3IgJ3NhbXBsZVJhdGUnIGZvciBUaW1lRGF0YVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIHZhciBzcmMsIHNyY19kYXRhO1xuICAgICAgICAgICAgaWYgKGlucHV0IGluc3RhbmNlb2YgVGltZURhdGEpIHtcbiAgICAgICAgICAgICAgICBzcmMgPSBzcmMuZ2V0RGF0YSgpO1xuICAgICAgICAgICAgICAgIHN1cGVyKHNyYy5sZW5ndGgsIHNhbXBsZVJhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29weURhdGFGcm9tKHNyYywgc3JjLmxlbmd0aCwgMCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5IHx8IGlucHV0IGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSB7XG4gICAgICAgICAgICAgICAgc3JjID0gaW5wdXQ7XG4gICAgICAgICAgICAgICAgc3VwZXIoc3JjLmxlbmd0aCwgc2FtcGxlUmF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb3B5RGF0YUZyb20oc3JjLCBzcmMubGVuZ3RoLCAwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKFwiVGltZURhdGE6IEludmFsaWQgb2JqZWN0IHBhc3NlZCBhcyBmaXJzdCBhcmd1bWVudC5cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dCA8PSAwIHx8IGlucHV0ICE9PSBNYXRoLmZsb29yKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcIlRpbWVEYXRhOiBJbnZhbGlkIG51bWJlciBwYXNzZWQgYXMgZmlyc3QgYXJndW1lbnQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3VwZXIoaW5wdXQsIHNhbXBsZVJhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgKFwiVGltZURhdGE6IENvbnN0cnVjdG9yIGhhcyBpbnZhbGlkIG9wZXJhdG9ycyFcIik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9kY3QgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX3dhdmVsZXQgPSB4dHJhY3RfaW5pdF93YXZlbGV0KCk7XG4gICAgfVxuICAgIGdldEZyYW1lcyhmcmFtZVNpemUsIGhvcFNpemUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmcmFtZVNpemUgIT09IFwibnVtYmVyXCIgfHwgZnJhbWVTaXplIDw9IDAgfHwgZnJhbWVTaXplICE9PSBNYXRoLmZsb29yKGZyYW1lU2l6ZSkpIHtcbiAgICAgICAgICAgIHRocm93IChcImZyYW1lU2l6ZSBtdXN0IGJlIGEgZGVmaW5lZCwgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGhvcFNpemUgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIGhvcFNpemUgPSBmcmFtZVNpemU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG51bV9mcmFtZXMgPSBNYXRoLmNlaWwodGhpcy5kYXRhLmxlbmd0aCAvIGZyYW1lU2l6ZSk7XG4gICAgICAgIHZhciByZXN1bHRfZnJhbWVzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtX2ZyYW1lczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgVGltZURhdGEoaG9wU2l6ZSwgdGhpcy5zYW1wbGVSYXRlKTtcbiAgICAgICAgICAgIGZyYW1lLmNvcHlEYXRhRnJvbSh0aGlzLmRhdGEuc3ViYXJyYXkoZnJhbWVTaXplICogaSwgZnJhbWVTaXplICogaSArIGhvcFNpemUpKTtcbiAgICAgICAgICAgIHJlc3VsdF9mcmFtZXMucHVzaChmcmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdF9mcmFtZXM7XG4gICAgfVxuXG4gICAgLy8gRmVhdHVyZXNcbiAgICBtaW5pbXVtKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQubWluaW11bSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5taW5pbXVtID0geHRyYWN0X2FycmF5X21pbih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5taW5pbXVtO1xuICAgIH1cblxuICAgIG1heGltdW0oKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5tYXhpbXVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lm1heGltdW0gPSB4dHJhY3RfYXJyYXlfbWF4KHRoaXMuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0Lm1heGltdW07XG4gICAgfVxuXG4gICAgc3VtKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuc3VtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnN1bSA9IHh0cmFjdF9hcnJheV9zdW0odGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3VtO1xuICAgIH1cblxuICAgIG1lYW4oKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5tZWFuID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lm1lYW4gPSB4dHJhY3RfbWVhbih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5tZWFuO1xuICAgIH1cblxuICAgIHRlbXBvcmFsX2NlbnRyb2lkKHdpbmRvd19tcykge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQudGVtcG9yYWxfY2VudHJvaWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5lbmVyZ3kod2luZG93X21zKTtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnRlbXBvcmFsX2NlbnRyb2lkID0geHRyYWN0X3RlbXBvcmFsX2NlbnRyb2lkKHRoaXMucmVzdWx0LmVuZXJneS5kYXRhLCB0aGlzLnNhbXBsZVJhdGUsIHdpbmRvd19tcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnRlbXBvcmFsX2NlbnRyb2lkO1xuICAgIH1cblxuICAgIHZhcmlhbmNlKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQudmFyaWFuY2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQudmFyaWFuY2UgPSB4dHJhY3RfdmFyaWFuY2UodGhpcy5kYXRhLCB0aGlzLm1lYW4oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnZhcmlhbmNlO1xuICAgIH1cblxuICAgIHN0YW5kYXJkX2RldmlhdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnN0YW5kYXJkX2RldmlhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5zdGFuZGFyZF9kZXZpYXRpb24gPSB4dHJhY3Rfc3RhbmRhcmRfZGV2aWF0aW9uKHRoaXMuZGF0YSwgdGhpcy52YXJpYW5jZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc3RhbmRhcmRfZGV2aWF0aW9uO1xuICAgIH1cblxuICAgIGF2ZXJhZ2VfZGV2aWF0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LmF2ZXJhZ2VfZGV2aWF0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LmF2ZXJhZ2VfZGV2aWF0aW9uID0geHRyYWN0X2F2ZXJhZ2VfZGV2aWF0aW9uKHRoaXMuZGF0YSwgdGhpcy5tZWFuKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5hdmVyYWdlX2RldmlhdGlvbjtcbiAgICB9XG5cbiAgICBza2V3bmVzcyAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5za2V3bmVzcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5za2V3bmVzcyA9IHh0cmFjdF9za2V3bmVzcyh0aGlzLmRhdGEsIHRoaXMubWVhbigpLCB0aGlzLnN0YW5kYXJkX2RldmlhdGlvbigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuc2tld25lc3M7XG4gICAgfVxuXG4gICAga3VydG9zaXMgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQua3VydG9zaXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQua3VydG9zaXMgPSB4dHJhY3Rfa3VydG9zaXModGhpcy5kYXRhLCB0aGlzLm1lYW4oKSwgdGhpcy5zdGFuZGFyZF9kZXZpYXRpb24oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0Lmt1cnRvc2lzO1xuICAgIH1cblxuICAgIHpjciAgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuemNyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LnpjciA9IHh0cmFjdF96Y3IodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuemNyO1xuICAgIH1cblxuICAgIGNyZXN0X2ZhY3RvciAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5jcmVzdF9mYWN0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuY3Jlc3RfZmFjdG9yID0geHRyYWN0X2NyZXN0KHRoaXMuZGF0YSwgdGhpcy5tYXhpbXVtKCksIHRoaXMubWVhbigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuY3Jlc3RfZmFjdG9yO1xuICAgIH1cblxuICAgIHJtc19hbXBsaXR1ZGUgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQucm1zX2FtcGxpdHVkZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5ybXNfYW1wbGl0dWRlID0geHRyYWN0X3Jtc19hbXBsaXR1ZGUodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQucm1zX2FtcGxpdHVkZTtcbiAgICB9XG5cbiAgICBsb3dlc3RfdmFsdWUgKHRocmVzaG9sZCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQubG93ZXN0X3ZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lmxvd2VzdF92YWx1ZSA9IHh0cmFjdF9sb3dlc3RfdmFsdWUodGhpcy5kYXRhLCB0aHJlc2hvbGQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5sb3dlc3RfdmFsdWU7XG4gICAgfVxuXG4gICAgaGlnaGVzdF92YWx1ZSAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5ub256ZXJvX2NvdW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Lm5vbnplcm9fY291bnQgPSB4dHJhY3Rfbm9uemVyb19jb3VudCh0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5ub256ZXJvX2NvdW50O1xuICAgIH1cblxuICAgIGYwICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3dhdmVsZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fd2F2ZWxldCA9IHRoaXMuaW5pdF93YXZlbGV0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LmYwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LmYwID0geHRyYWN0X3dhdmVsZXRfZjAodGhpcy5kYXRhLCB0aGlzLnNhbXBsZVJhdGUsIHRoaXMuX3dhdmVsZXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5mMDtcbiAgICB9XG5cbiAgICBlbmVyZ3kgKHdpbmRvd19tcykge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuZW5lcmd5ID09PSB1bmRlZmluZWQgfHwgdGhpcy5yZXN1bHQuZW5lcmd5LndpbmRvd19tcyAhPT0gd2luZG93X21zKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5lbmVyZ3kgPSB7XG4gICAgICAgICAgICAgICAgJ2RhdGEnOiB4dHJhY3RfZW5lcmd5KHRoaXMuZGF0YSwgdGhpcy5zYW1wbGVSYXRlLCB3aW5kb3dfbXMpLFxuICAgICAgICAgICAgICAgICd3aW5kb3dfbXMnOiB3aW5kb3dfbXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LmVuZXJneTtcbiAgICB9XG5cbiAgICBzcGVjdHJ1bSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNwZWN0cnVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBfc3BlYyA9IHh0cmFjdF9zcGVjdHJ1bSh0aGlzLmRhdGEsIHRoaXMuc2FtcGxlUmF0ZSwgdHJ1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuc3BlY3RydW0gPSBuZXcgU3BlY3RydW1EYXRhKF9zcGVjLmxlbmd0aCAvIDIsIHRoaXMuc2FtcGxlUmF0ZSk7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5zcGVjdHJ1bS5jb3B5RGF0YUZyb20oX3NwZWMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0LnNwZWN0cnVtO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGN0KCkge1xuICAgICAgICBpZiAodGhpcy5fZGN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2RjdCA9IHRoaXMuY3JlYXRlRGN0Q29lZmZpY2llbnRzKHRoaXMuZGF0YS5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5kY3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuZGN0ID0geHRyYWN0X2RjdF8yKHRoaXMuZGF0YSwgdGhpcy5fZGN0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuZGN0O1xuICAgIH1cblxuICAgIGF1dG9jb3JyZWxhdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5hdXRvY29ycmVsYXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQuYXV0b2NvcnJlbGF0aW9uID0geHRyYWN0X2F1dG9jb3JyZWxhdGlvbih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5hdXRvY29ycmVsYXRpb247XG4gICAgfVxuXG4gICAgYW1kZiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5hbWRmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0LmFtZGYgPSB4dHJhY3RfYW1kZih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC5hbWRmO1xuICAgIH1cblxuICAgIGFzZGYgKCkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHQuYXNkZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5hc2RmID0geHRyYWN0X2FzZGYodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQuYXNkZjtcbiAgICB9XG5cbiAgICB5aW4oKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC55aW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQueWluID0geHRyYWN0X3lpbih0aGlzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdC55aW47XG4gICAgfVxuXG4gICAgb25zZXQoZnJhbWVTaXplKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdC5vbnNldCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMucmVzdWx0Lm9uc2V0LmZyYW1lU2l6ZSAhPT0gZnJhbWVTaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdC5vbnNldCA9IHtcbiAgICAgICAgICAgICAgICAnZGF0YSc6IHh0cmFjdF9vbnNldCh0aGlzLmRhdGEsIGZyYW1lU2l6ZSksXG4gICAgICAgICAgICAgICAgJ2ZyYW1lU2l6ZSc6IGZyYW1lU2l6ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQub25zZXQ7XG4gICAgfVxuXG4gICAgcmVzYW1wbGUodGFyZ2V0U2FtcGxlUmF0ZSkge1xuICAgICAgICBpZiAodGhpcy5zYW1wbGVSYXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IChcIlNvdXJjZSBzYW1wbGVSYXRlIG11c3QgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHRhcmdldFNhbXBsZVJhdGUgIT09IFwibnVtYmVyXCIgfHwgdGFyZ2V0U2FtcGxlUmF0ZSA8PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJUYXJnZXQgc2FtcGxlUmF0ZSBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXNhbXBsZWQgPSB4dHJhY3RfcmVzYW1wbGUodGhpcy5kYXRhLCB0YXJnZXRTYW1wbGVSYXRlLCB0aGlzLnNhbXBsZVJhdGUpO1xuICAgICAgICB2YXIgcmVwbHkgPSBuZXcgVGltZURhdGEocmVzYW1wbGVkLmxlbmd0aCwgdGFyZ2V0U2FtcGxlUmF0ZSk7XG4gICAgICAgIHJlcGx5LmNvcHlEYXRhRnJvbShyZXNhbXBsZWQpO1xuICAgICAgICB0aGlzLnJlc3VsdC5yZXNhbXBsZSA9IHJlcGx5O1xuICAgICAgICByZXR1cm4gcmVwbHk7XG4gICAgfVxufVxuXG5UaW1lRGF0YS5wcm90b3R5cGUuZmVhdHVyZXMgPSBbXG4gICAge1xuICAgICAgICBuYW1lOiBcIk1pbmltdW1cIixcbiAgICAgICAgZnVuY3Rpb246IFwibWluaW11bVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJNYXhpbXVtXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcIm1heGltdW1cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiU3VtXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInN1bVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJNZWFuXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcIm1lYW5cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiVGVtcG9yYWwgQ2VudHJvaWRcIixcbiAgICAgICAgZnVuY3Rpb246IFwidGVtcG9yYWxfY2VudHJvaWRcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJlbmVyZ3lcIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIldpbmRvdyBUaW1lXCIsXG4gICAgICAgICAgICB1bml0OiBcIm1zXCIsXG4gICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgbWluaW11bTogMSxcbiAgICAgICAgICAgIG1heGltdW06IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGRlZmF1bHQ6IDEwMFxuICAgICAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJWYXJpYW5jZVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJ2YXJpYW5jZVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcIm1lYW5cIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIlN0YW5kYXJkIERldmlhdGlvblwiLFxuICAgICAgICBmdW5jdGlvbjogXCJzdGFuZGFyZF9kZXZpYXRpb25cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJ2YXJpYW5jZVwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiQXZlcmFnZSBEZXZpYXRpb25cIixcbiAgICAgICAgZnVuY3Rpb246IFwiYXZlcmFnZV9kZXZpYXRpb25cIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXCJtZWFuXCJdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJTa2V3bmVzc1wiLFxuICAgICAgICBmdW5jdGlvbjogXCJza2V3bmVzc1wiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtcIm1lYW5cIiwgXCJzdGFuZGFyZF9kZXZpYXRpb25cIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIkt1cnRvc2lzXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImt1cnRvc2lzXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW1wibWVhblwiLCBcInN0YW5kYXJkX2RldmlhdGlvblwiXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiWmVybyBDcm9zc2luZyBSYXRlXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInpjclwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJDcmVzdCBGYWN0b3JcIixcbiAgICAgICAgZnVuY3Rpb246IFwiY3Jlc3RfZmFjdG9yXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW1wibWF4aW11bVwiLCBcIm1lYW5cIl0sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIm51bWJlclwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIlJNUyBBbXBsaXR1ZGVcIixcbiAgICAgICAgZnVuY3Rpb246IFwicm1zX2FtcGxpdHVkZVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJMb3dlc3QgVmFsdWVcIixcbiAgICAgICAgZnVuY3Rpb246IFwibG93ZXN0X3ZhbHVlXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIlRocmVzaG9sZFwiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiB1bmRlZmluZWRcbiAgICAgICAgfV0sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiSGlnaGVzdCBWYWx1ZVwiLFxuICAgICAgICBmdW5jdGlvbjogXCJoaWdoZXN0X3ZhbHVlXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIlRocmVzaG9sZFwiLFxuICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiB1bmRlZmluZWRcbiAgICAgICAgfV0sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiTm9uLVplcm8gQ291bnRcIixcbiAgICAgICAgZnVuY3Rpb246IFwibm9uemVyb19jb3VudFwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJudW1iZXJcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJGdW5kYW1lbnRhbCBGcmVxdWVuY3lcIixcbiAgICAgICAgZnVuY3Rpb246IFwiZjBcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwibnVtYmVyXCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiRW5lcmd5XCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcImVuZXJneVwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbe1xuICAgICAgICAgICAgbmFtZTogXCJXaW5kb3dcIixcbiAgICAgICAgICAgIHVuaXQ6IFwibXNcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAxLFxuICAgICAgICAgICAgbWF4aW11bTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGVmYXVsdDogMTAwXG4gICAgICAgIH1dLFxuICAgICAgICByZXR1cm5zOiBcIm9iamVjdFwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIlNwZWN0cnVtXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInNwZWN0cnVtXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcIlNwZWN0cnVtRGF0YVwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIkRDVFwiLFxuICAgICAgICBmdW5jdGlvbjogXCJkY3RcIixcbiAgICAgICAgc3ViX2ZlYXR1cmVzOiBbXSxcbiAgICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICAgIHJldHVybnM6IFwiYXJyYXlcIlxuICAgIH0sIHtcbiAgICAgICAgbmFtZTogXCJBdXRvY29ycmVsYXRpb25cIixcbiAgICAgICAgZnVuY3Rpb246IFwiYXV0b2NvcnJlbGF0aW9uXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcImFycmF5XCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiQU1ERlwiLFxuICAgICAgICBmdW5jdGlvbjogXCJhbWRmXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcImFycmF5XCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiQVNERlwiLFxuICAgICAgICBmdW5jdGlvbjogXCJhc2RmXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFtdLFxuICAgICAgICByZXR1cm5zOiBcImFycmF5XCJcbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiWUlOIFBpdGNoXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInlpblwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXSxcbiAgICAgICAgcmV0dXJuczogXCJhcnJheVwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIk9uc2V0IERldGVjdGlvblwiLFxuICAgICAgICBmdW5jdGlvbjogXCJvbnNldFwiLFxuICAgICAgICBzdWJfZmVhdHVyZXM6IFtdLFxuICAgICAgICBwYXJhbWV0ZXJzOiBbe1xuICAgICAgICAgICAgbmFtZTogXCJGcmFtZSBTaXplXCIsXG4gICAgICAgICAgICB1bml0OiBcInNhbXBsZXNcIixcbiAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICBtaW5pbXVtOiAxLFxuICAgICAgICAgICAgbWF4aW11bTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGVmYXVsdDogMTAyNFxuICAgICAgICB9XSxcbiAgICAgICAgcmV0dXJuczogXCJhcnJheVwiXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcIlJlc2FtcGxlXCIsXG4gICAgICAgIGZ1bmN0aW9uOiBcInJlc2FtcGxlXCIsXG4gICAgICAgIHN1Yl9mZWF0dXJlczogW10sXG4gICAgICAgIHBhcmFtZXRlcnM6IFt7XG4gICAgICAgICAgICBuYW1lOiBcIlRhcmdldCBTYW1wbGUgUmF0ZVwiLFxuICAgICAgICAgICAgdW5pdDogXCJIelwiLFxuICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgIG1pbmltdW06IDAsXG4gICAgICAgICAgICBtYXhpbXVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWZhdWx0OiA4MDAwXG4gICAgICAgIH1dLFxuICAgICAgICByZXR1cm5zOiBcIlRpbWVEYXRhXCJcbiAgICB9XTtcbiIsImltcG9ydCB7IENvbXBsZXRlTm90aWZpY2F0aW9uLCBOZXh0Tm90aWZpY2F0aW9uLCBFcnJvck5vdGlmaWNhdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIEEgY29tcGxldGlvbiBvYmplY3Qgb3B0aW1pemVkIGZvciBtZW1vcnkgdXNlIGFuZCBjcmVhdGVkIHRvIGJlIHRoZVxuICogc2FtZSBcInNoYXBlXCIgYXMgb3RoZXIgbm90aWZpY2F0aW9ucyBpbiB2OC5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgQ09NUExFVEVfTk9USUZJQ0FUSU9OID0gKCgpID0+IGNyZWF0ZU5vdGlmaWNhdGlvbignQycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKSBhcyBDb21wbGV0ZU5vdGlmaWNhdGlvbikoKTtcblxuLyoqXG4gKiBJbnRlcm5hbCB1c2Ugb25seS4gQ3JlYXRlcyBhbiBvcHRpbWl6ZWQgZXJyb3Igbm90aWZpY2F0aW9uIHRoYXQgaXMgdGhlIHNhbWUgXCJzaGFwZVwiXG4gKiBhcyBvdGhlciBub3RpZmljYXRpb25zLlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlcnJvck5vdGlmaWNhdGlvbihlcnJvcjogYW55KTogRXJyb3JOb3RpZmljYXRpb24ge1xuICByZXR1cm4gY3JlYXRlTm90aWZpY2F0aW9uKCdFJywgdW5kZWZpbmVkLCBlcnJvcikgYXMgYW55O1xufVxuXG4vKipcbiAqIEludGVybmFsIHVzZSBvbmx5LiBDcmVhdGVzIGFuIG9wdGltaXplZCBuZXh0IG5vdGlmaWNhdGlvbiB0aGF0IGlzIHRoZSBzYW1lIFwic2hhcGVcIlxuICogYXMgb3RoZXIgbm90aWZpY2F0aW9ucy5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gbmV4dE5vdGlmaWNhdGlvbjxUPih2YWx1ZTogVCkge1xuICByZXR1cm4gY3JlYXRlTm90aWZpY2F0aW9uKCdOJywgdmFsdWUsIHVuZGVmaW5lZCkgYXMgTmV4dE5vdGlmaWNhdGlvbjxUPjtcbn1cblxuLyoqXG4gKiBFbnN1cmVzIHRoYXQgYWxsIG5vdGlmaWNhdGlvbnMgY3JlYXRlZCBpbnRlcm5hbGx5IGhhdmUgdGhlIHNhbWUgXCJzaGFwZVwiIGluIHY4LlxuICpcbiAqIFRPRE86IFRoaXMgaXMgb25seSBleHBvcnRlZCB0byBzdXBwb3J0IGEgY3JhenkgbGVnYWN5IHRlc3QgaW4gYGdyb3VwQnlgLlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOb3RpZmljYXRpb24oa2luZDogJ04nIHwgJ0UnIHwgJ0MnLCB2YWx1ZTogYW55LCBlcnJvcjogYW55KSB7XG4gIHJldHVybiB7XG4gICAga2luZCxcbiAgICB2YWx1ZSxcbiAgICBlcnJvcixcbiAgfTtcbn1cbiIsIi8qKlxuICogQHByZXR0aWVyXG4gKi9cbmltcG9ydCB7IE9wZXJhdG9yIH0gZnJvbSAnLi9PcGVyYXRvcic7XG5pbXBvcnQgeyBTYWZlU3Vic2NyaWJlciwgU3Vic2NyaWJlciB9IGZyb20gJy4vU3Vic2NyaWJlcic7XG5pbXBvcnQgeyBpc1N1YnNjcmlwdGlvbiwgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgVGVhcmRvd25Mb2dpYywgT3BlcmF0b3JGdW5jdGlvbiwgU3Vic2NyaWJhYmxlLCBPYnNlcnZlciB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgb2JzZXJ2YWJsZSBhcyBTeW1ib2xfb2JzZXJ2YWJsZSB9IGZyb20gJy4vc3ltYm9sL29ic2VydmFibGUnO1xuaW1wb3J0IHsgcGlwZUZyb21BcnJheSB9IGZyb20gJy4vdXRpbC9waXBlJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7IGlzRnVuY3Rpb24gfSBmcm9tICcuL3V0aWwvaXNGdW5jdGlvbic7XG5pbXBvcnQgeyBlcnJvckNvbnRleHQgfSBmcm9tICcuL3V0aWwvZXJyb3JDb250ZXh0JztcblxuLyoqXG4gKiBBIHJlcHJlc2VudGF0aW9uIG9mIGFueSBzZXQgb2YgdmFsdWVzIG92ZXIgYW55IGFtb3VudCBvZiB0aW1lLiBUaGlzIGlzIHRoZSBtb3N0IGJhc2ljIGJ1aWxkaW5nIGJsb2NrXG4gKiBvZiBSeEpTLlxuICpcbiAqIEBjbGFzcyBPYnNlcnZhYmxlPFQ+XG4gKi9cbmV4cG9ydCBjbGFzcyBPYnNlcnZhYmxlPFQ+IGltcGxlbWVudHMgU3Vic2NyaWJhYmxlPFQ+IHtcbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIEludGVybmFsIGltcGxlbWVudGF0aW9uIGRldGFpbCwgZG8gbm90IHVzZSBkaXJlY3RseS4gV2lsbCBiZSBtYWRlIGludGVybmFsIGluIHY4LlxuICAgKi9cbiAgc291cmNlOiBPYnNlcnZhYmxlPGFueT4gfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIEludGVybmFsIGltcGxlbWVudGF0aW9uIGRldGFpbCwgZG8gbm90IHVzZSBkaXJlY3RseS4gV2lsbCBiZSBtYWRlIGludGVybmFsIGluIHY4LlxuICAgKi9cbiAgb3BlcmF0b3I6IE9wZXJhdG9yPGFueSwgVD4gfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWJzY3JpYmUgdGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlIE9ic2VydmFibGUgaXNcbiAgICogaW5pdGlhbGx5IHN1YnNjcmliZWQgdG8uIFRoaXMgZnVuY3Rpb24gaXMgZ2l2ZW4gYSBTdWJzY3JpYmVyLCB0byB3aGljaCBuZXcgdmFsdWVzXG4gICAqIGNhbiBiZSBgbmV4dGBlZCwgb3IgYW4gYGVycm9yYCBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByYWlzZSBhbiBlcnJvciwgb3JcbiAgICogYGNvbXBsZXRlYCBjYW4gYmUgY2FsbGVkIHRvIG5vdGlmeSBvZiBhIHN1Y2Nlc3NmdWwgY29tcGxldGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHN1YnNjcmliZT86ICh0aGlzOiBPYnNlcnZhYmxlPFQ+LCBzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSA9PiBUZWFyZG93bkxvZ2ljKSB7XG4gICAgaWYgKHN1YnNjcmliZSkge1xuICAgICAgdGhpcy5fc3Vic2NyaWJlID0gc3Vic2NyaWJlO1xuICAgIH1cbiAgfVxuXG4gIC8vIEhBQ0s6IFNpbmNlIFR5cGVTY3JpcHQgaW5oZXJpdHMgc3RhdGljIHByb3BlcnRpZXMgdG9vLCB3ZSBoYXZlIHRvXG4gIC8vIGZpZ2h0IGFnYWluc3QgVHlwZVNjcmlwdCBoZXJlIHNvIFN1YmplY3QgY2FuIGhhdmUgYSBkaWZmZXJlbnQgc3RhdGljIGNyZWF0ZSBzaWduYXR1cmVcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBieSBjYWxsaW5nIHRoZSBPYnNlcnZhYmxlIGNvbnN0cnVjdG9yXG4gICAqIEBvd25lciBPYnNlcnZhYmxlXG4gICAqIEBtZXRob2QgY3JlYXRlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHN1YnNjcmliZT8gdGhlIHN1YnNjcmliZXIgZnVuY3Rpb24gdG8gYmUgcGFzc2VkIHRvIHRoZSBPYnNlcnZhYmxlIGNvbnN0cnVjdG9yXG4gICAqIEByZXR1cm4ge09ic2VydmFibGV9IGEgbmV3IG9ic2VydmFibGVcbiAgICogQG5vY29sbGFwc2VcbiAgICogQGRlcHJlY2F0ZWQgVXNlIGBuZXcgT2JzZXJ2YWJsZSgpYCBpbnN0ZWFkLiBXaWxsIGJlIHJlbW92ZWQgaW4gdjguXG4gICAqL1xuICBzdGF0aWMgY3JlYXRlOiAoLi4uYXJnczogYW55W10pID0+IGFueSA9IDxUPihzdWJzY3JpYmU/OiAoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikgPT4gVGVhcmRvd25Mb2dpYykgPT4ge1xuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxUPihzdWJzY3JpYmUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IE9ic2VydmFibGUsIHdpdGggdGhpcyBPYnNlcnZhYmxlIGluc3RhbmNlIGFzIHRoZSBzb3VyY2UsIGFuZCB0aGUgcGFzc2VkXG4gICAqIG9wZXJhdG9yIGRlZmluZWQgYXMgdGhlIG5ldyBvYnNlcnZhYmxlJ3Mgb3BlcmF0b3IuXG4gICAqIEBtZXRob2QgbGlmdFxuICAgKiBAcGFyYW0gb3BlcmF0b3IgdGhlIG9wZXJhdG9yIGRlZmluaW5nIHRoZSBvcGVyYXRpb24gdG8gdGFrZSBvbiB0aGUgb2JzZXJ2YWJsZVxuICAgKiBAcmV0dXJuIGEgbmV3IG9ic2VydmFibGUgd2l0aCB0aGUgT3BlcmF0b3IgYXBwbGllZFxuICAgKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC5cbiAgICogSWYgeW91IGhhdmUgaW1wbGVtZW50ZWQgYW4gb3BlcmF0b3IgdXNpbmcgYGxpZnRgLCBpdCBpcyByZWNvbW1lbmRlZCB0aGF0IHlvdSBjcmVhdGUgYW5cbiAgICogb3BlcmF0b3IgYnkgc2ltcGx5IHJldHVybmluZyBgbmV3IE9ic2VydmFibGUoKWAgZGlyZWN0bHkuIFNlZSBcIkNyZWF0aW5nIG5ldyBvcGVyYXRvcnMgZnJvbVxuICAgKiBzY3JhdGNoXCIgc2VjdGlvbiBoZXJlOiBodHRwczovL3J4anMuZGV2L2d1aWRlL29wZXJhdG9yc1xuICAgKi9cbiAgbGlmdDxSPihvcGVyYXRvcj86IE9wZXJhdG9yPFQsIFI+KTogT2JzZXJ2YWJsZTxSPiB7XG4gICAgY29uc3Qgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlPFI+KCk7XG4gICAgb2JzZXJ2YWJsZS5zb3VyY2UgPSB0aGlzO1xuICAgIG9ic2VydmFibGUub3BlcmF0b3IgPSBvcGVyYXRvcjtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbiAgfVxuXG4gIHN1YnNjcmliZShvYnNlcnZlcj86IFBhcnRpYWw8T2JzZXJ2ZXI8VD4+KTogU3Vic2NyaXB0aW9uO1xuICBzdWJzY3JpYmUobmV4dDogKHZhbHVlOiBUKSA9PiB2b2lkKTogU3Vic2NyaXB0aW9uO1xuICAvKiogQGRlcHJlY2F0ZWQgSW5zdGVhZCBvZiBwYXNzaW5nIHNlcGFyYXRlIGNhbGxiYWNrIGFyZ3VtZW50cywgdXNlIGFuIG9ic2VydmVyIGFyZ3VtZW50LiBTaWduYXR1cmVzIHRha2luZyBzZXBhcmF0ZSBjYWxsYmFjayBhcmd1bWVudHMgd2lsbCBiZSByZW1vdmVkIGluIHY4LiBEZXRhaWxzOiBodHRwczovL3J4anMuZGV2L2RlcHJlY2F0aW9ucy9zdWJzY3JpYmUtYXJndW1lbnRzICovXG4gIHN1YnNjcmliZShuZXh0PzogKCh2YWx1ZTogVCkgPT4gdm9pZCkgfCBudWxsLCBlcnJvcj86ICgoZXJyb3I6IGFueSkgPT4gdm9pZCkgfCBudWxsLCBjb21wbGV0ZT86ICgoKSA9PiB2b2lkKSB8IG51bGwpOiBTdWJzY3JpcHRpb247XG4gIC8qKlxuICAgKiBJbnZva2VzIGFuIGV4ZWN1dGlvbiBvZiBhbiBPYnNlcnZhYmxlIGFuZCByZWdpc3RlcnMgT2JzZXJ2ZXIgaGFuZGxlcnMgZm9yIG5vdGlmaWNhdGlvbnMgaXQgd2lsbCBlbWl0LlxuICAgKlxuICAgKiA8c3BhbiBjbGFzcz1cImluZm9ybWFsXCI+VXNlIGl0IHdoZW4geW91IGhhdmUgYWxsIHRoZXNlIE9ic2VydmFibGVzLCBidXQgc3RpbGwgbm90aGluZyBpcyBoYXBwZW5pbmcuPC9zcGFuPlxuICAgKlxuICAgKiBgc3Vic2NyaWJlYCBpcyBub3QgYSByZWd1bGFyIG9wZXJhdG9yLCBidXQgYSBtZXRob2QgdGhhdCBjYWxscyBPYnNlcnZhYmxlJ3MgaW50ZXJuYWwgYHN1YnNjcmliZWAgZnVuY3Rpb24uIEl0XG4gICAqIG1pZ2h0IGJlIGZvciBleGFtcGxlIGEgZnVuY3Rpb24gdGhhdCB5b3UgcGFzc2VkIHRvIE9ic2VydmFibGUncyBjb25zdHJ1Y3RvciwgYnV0IG1vc3Qgb2YgdGhlIHRpbWUgaXQgaXNcbiAgICogYSBsaWJyYXJ5IGltcGxlbWVudGF0aW9uLCB3aGljaCBkZWZpbmVzIHdoYXQgd2lsbCBiZSBlbWl0dGVkIGJ5IGFuIE9ic2VydmFibGUsIGFuZCB3aGVuIGl0IGJlIHdpbGwgZW1pdHRlZC4gVGhpcyBtZWFuc1xuICAgKiB0aGF0IGNhbGxpbmcgYHN1YnNjcmliZWAgaXMgYWN0dWFsbHkgdGhlIG1vbWVudCB3aGVuIE9ic2VydmFibGUgc3RhcnRzIGl0cyB3b3JrLCBub3Qgd2hlbiBpdCBpcyBjcmVhdGVkLCBhcyBpdCBpcyBvZnRlblxuICAgKiB0aGUgdGhvdWdodC5cbiAgICpcbiAgICogQXBhcnQgZnJvbSBzdGFydGluZyB0aGUgZXhlY3V0aW9uIG9mIGFuIE9ic2VydmFibGUsIHRoaXMgbWV0aG9kIGFsbG93cyB5b3UgdG8gbGlzdGVuIGZvciB2YWx1ZXNcbiAgICogdGhhdCBhbiBPYnNlcnZhYmxlIGVtaXRzLCBhcyB3ZWxsIGFzIGZvciB3aGVuIGl0IGNvbXBsZXRlcyBvciBlcnJvcnMuIFlvdSBjYW4gYWNoaWV2ZSB0aGlzIGluIHR3b1xuICAgKiBvZiB0aGUgZm9sbG93aW5nIHdheXMuXG4gICAqXG4gICAqIFRoZSBmaXJzdCB3YXkgaXMgY3JlYXRpbmcgYW4gb2JqZWN0IHRoYXQgaW1wbGVtZW50cyB7QGxpbmsgT2JzZXJ2ZXJ9IGludGVyZmFjZS4gSXQgc2hvdWxkIGhhdmUgbWV0aG9kc1xuICAgKiBkZWZpbmVkIGJ5IHRoYXQgaW50ZXJmYWNlLCBidXQgbm90ZSB0aGF0IGl0IHNob3VsZCBiZSBqdXN0IGEgcmVndWxhciBKYXZhU2NyaXB0IG9iamVjdCwgd2hpY2ggeW91IGNhbiBjcmVhdGVcbiAgICogeW91cnNlbGYgaW4gYW55IHdheSB5b3Ugd2FudCAoRVM2IGNsYXNzLCBjbGFzc2ljIGZ1bmN0aW9uIGNvbnN0cnVjdG9yLCBvYmplY3QgbGl0ZXJhbCBldGMuKS4gSW4gcGFydGljdWxhciwgZG9cbiAgICogbm90IGF0dGVtcHQgdG8gdXNlIGFueSBSeEpTIGltcGxlbWVudGF0aW9uIGRldGFpbHMgdG8gY3JlYXRlIE9ic2VydmVycyAtIHlvdSBkb24ndCBuZWVkIHRoZW0uIFJlbWVtYmVyIGFsc29cbiAgICogdGhhdCB5b3VyIG9iamVjdCBkb2VzIG5vdCBoYXZlIHRvIGltcGxlbWVudCBhbGwgbWV0aG9kcy4gSWYgeW91IGZpbmQgeW91cnNlbGYgY3JlYXRpbmcgYSBtZXRob2QgdGhhdCBkb2Vzbid0XG4gICAqIGRvIGFueXRoaW5nLCB5b3UgY2FuIHNpbXBseSBvbWl0IGl0LiBOb3RlIGhvd2V2ZXIsIGlmIHRoZSBgZXJyb3JgIG1ldGhvZCBpcyBub3QgcHJvdmlkZWQgYW5kIGFuIGVycm9yIGhhcHBlbnMsXG4gICAqIGl0IHdpbGwgYmUgdGhyb3duIGFzeW5jaHJvbm91c2x5LiBFcnJvcnMgdGhyb3duIGFzeW5jaHJvbm91c2x5IGNhbm5vdCBiZSBjYXVnaHQgdXNpbmcgYHRyeWAvYGNhdGNoYC4gSW5zdGVhZCxcbiAgICogdXNlIHRoZSB7QGxpbmsgb25VbmhhbmRsZWRFcnJvcn0gY29uZmlndXJhdGlvbiBvcHRpb24gb3IgdXNlIGEgcnVudGltZSBoYW5kbGVyIChsaWtlIGB3aW5kb3cub25lcnJvcmAgb3JcbiAgICogYHByb2Nlc3Mub24oJ2Vycm9yKWApIHRvIGJlIG5vdGlmaWVkIG9mIHVuaGFuZGxlZCBlcnJvcnMuIEJlY2F1c2Ugb2YgdGhpcywgaXQncyByZWNvbW1lbmRlZCB0aGF0IHlvdSBwcm92aWRlXG4gICAqIGFuIGBlcnJvcmAgbWV0aG9kIHRvIGF2b2lkIG1pc3NpbmcgdGhyb3duIGVycm9ycy5cbiAgICpcbiAgICogVGhlIHNlY29uZCB3YXkgaXMgdG8gZ2l2ZSB1cCBvbiBPYnNlcnZlciBvYmplY3QgYWx0b2dldGhlciBhbmQgc2ltcGx5IHByb3ZpZGUgY2FsbGJhY2sgZnVuY3Rpb25zIGluIHBsYWNlIG9mIGl0cyBtZXRob2RzLlxuICAgKiBUaGlzIG1lYW5zIHlvdSBjYW4gcHJvdmlkZSB0aHJlZSBmdW5jdGlvbnMgYXMgYXJndW1lbnRzIHRvIGBzdWJzY3JpYmVgLCB3aGVyZSB0aGUgZmlyc3QgZnVuY3Rpb24gaXMgZXF1aXZhbGVudFxuICAgKiBvZiBhIGBuZXh0YCBtZXRob2QsIHRoZSBzZWNvbmQgb2YgYW4gYGVycm9yYCBtZXRob2QgYW5kIHRoZSB0aGlyZCBvZiBhIGBjb21wbGV0ZWAgbWV0aG9kLiBKdXN0IGFzIGluIGNhc2Ugb2YgYW4gT2JzZXJ2ZXIsXG4gICAqIGlmIHlvdSBkbyBub3QgbmVlZCB0byBsaXN0ZW4gZm9yIHNvbWV0aGluZywgeW91IGNhbiBvbWl0IGEgZnVuY3Rpb24gYnkgcGFzc2luZyBgdW5kZWZpbmVkYCBvciBgbnVsbGAsXG4gICAqIHNpbmNlIGBzdWJzY3JpYmVgIHJlY29nbml6ZXMgdGhlc2UgZnVuY3Rpb25zIGJ5IHdoZXJlIHRoZXkgd2VyZSBwbGFjZWQgaW4gZnVuY3Rpb24gY2FsbC4gV2hlbiBpdCBjb21lc1xuICAgKiB0byB0aGUgYGVycm9yYCBmdW5jdGlvbiwgYXMgd2l0aCBhbiBPYnNlcnZlciwgaWYgbm90IHByb3ZpZGVkLCBlcnJvcnMgZW1pdHRlZCBieSBhbiBPYnNlcnZhYmxlIHdpbGwgYmUgdGhyb3duIGFzeW5jaHJvbm91c2x5LlxuICAgKlxuICAgKiBZb3UgY2FuLCBob3dldmVyLCBzdWJzY3JpYmUgd2l0aCBubyBwYXJhbWV0ZXJzIGF0IGFsbC4gVGhpcyBtYXkgYmUgdGhlIGNhc2Ugd2hlcmUgeW91J3JlIG5vdCBpbnRlcmVzdGVkIGluIHRlcm1pbmFsIGV2ZW50c1xuICAgKiBhbmQgeW91IGFsc28gaGFuZGxlZCBlbWlzc2lvbnMgaW50ZXJuYWxseSBieSB1c2luZyBvcGVyYXRvcnMgKGUuZy4gdXNpbmcgYHRhcGApLlxuICAgKlxuICAgKiBXaGljaGV2ZXIgc3R5bGUgb2YgY2FsbGluZyBgc3Vic2NyaWJlYCB5b3UgdXNlLCBpbiBib3RoIGNhc2VzIGl0IHJldHVybnMgYSBTdWJzY3JpcHRpb24gb2JqZWN0LlxuICAgKiBUaGlzIG9iamVjdCBhbGxvd3MgeW91IHRvIGNhbGwgYHVuc3Vic2NyaWJlYCBvbiBpdCwgd2hpY2ggaW4gdHVybiB3aWxsIHN0b3AgdGhlIHdvcmsgdGhhdCBhbiBPYnNlcnZhYmxlIGRvZXMgYW5kIHdpbGwgY2xlYW5cbiAgICogdXAgYWxsIHJlc291cmNlcyB0aGF0IGFuIE9ic2VydmFibGUgdXNlZC4gTm90ZSB0aGF0IGNhbmNlbGxpbmcgYSBzdWJzY3JpcHRpb24gd2lsbCBub3QgY2FsbCBgY29tcGxldGVgIGNhbGxiYWNrXG4gICAqIHByb3ZpZGVkIHRvIGBzdWJzY3JpYmVgIGZ1bmN0aW9uLCB3aGljaCBpcyByZXNlcnZlZCBmb3IgYSByZWd1bGFyIGNvbXBsZXRpb24gc2lnbmFsIHRoYXQgY29tZXMgZnJvbSBhbiBPYnNlcnZhYmxlLlxuICAgKlxuICAgKiBSZW1lbWJlciB0aGF0IGNhbGxiYWNrcyBwcm92aWRlZCB0byBgc3Vic2NyaWJlYCBhcmUgbm90IGd1YXJhbnRlZWQgdG8gYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5LlxuICAgKiBJdCBpcyBhbiBPYnNlcnZhYmxlIGl0c2VsZiB0aGF0IGRlY2lkZXMgd2hlbiB0aGVzZSBmdW5jdGlvbnMgd2lsbCBiZSBjYWxsZWQuIEZvciBleGFtcGxlIHtAbGluayBvZn1cbiAgICogYnkgZGVmYXVsdCBlbWl0cyBhbGwgaXRzIHZhbHVlcyBzeW5jaHJvbm91c2x5LiBBbHdheXMgY2hlY2sgZG9jdW1lbnRhdGlvbiBmb3IgaG93IGdpdmVuIE9ic2VydmFibGVcbiAgICogd2lsbCBiZWhhdmUgd2hlbiBzdWJzY3JpYmVkIGFuZCBpZiBpdHMgZGVmYXVsdCBiZWhhdmlvciBjYW4gYmUgbW9kaWZpZWQgd2l0aCBhIGBzY2hlZHVsZXJgLlxuICAgKlxuICAgKiAjIyBFeGFtcGxlXG4gICAqICMjIyBTdWJzY3JpYmUgd2l0aCBhbiBPYnNlcnZlclxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnO1xuICAgKlxuICAgKiBjb25zdCBzdW1PYnNlcnZlciA9IHtcbiAgICogICBzdW06IDAsXG4gICAqICAgbmV4dCh2YWx1ZSkge1xuICAgKiAgICAgY29uc29sZS5sb2coJ0FkZGluZzogJyArIHZhbHVlKTtcbiAgICogICAgIHRoaXMuc3VtID0gdGhpcy5zdW0gKyB2YWx1ZTtcbiAgICogICB9LFxuICAgKiAgIGVycm9yKCkge1xuICAgKiAgICAgLy8gV2UgYWN0dWFsbHkgY291bGQganVzdCByZW1vdmUgdGhpcyBtZXRob2QsXG4gICAqICAgICAvLyBzaW5jZSB3ZSBkbyBub3QgcmVhbGx5IGNhcmUgYWJvdXQgZXJyb3JzIHJpZ2h0IG5vdy5cbiAgICogICB9LFxuICAgKiAgIGNvbXBsZXRlKCkge1xuICAgKiAgICAgY29uc29sZS5sb2coJ1N1bSBlcXVhbHM6ICcgKyB0aGlzLnN1bSk7XG4gICAqICAgfVxuICAgKiB9O1xuICAgKlxuICAgKiBvZigxLCAyLCAzKSAvLyBTeW5jaHJvbm91c2x5IGVtaXRzIDEsIDIsIDMgYW5kIHRoZW4gY29tcGxldGVzLlxuICAgKiAgIC5zdWJzY3JpYmUoc3VtT2JzZXJ2ZXIpO1xuICAgKlxuICAgKiAvLyBMb2dzOlxuICAgKiAvLyBcIkFkZGluZzogMVwiXG4gICAqIC8vIFwiQWRkaW5nOiAyXCJcbiAgICogLy8gXCJBZGRpbmc6IDNcIlxuICAgKiAvLyBcIlN1bSBlcXVhbHM6IDZcIlxuICAgKiBgYGBcbiAgICpcbiAgICogIyMjIFN1YnNjcmliZSB3aXRoIGZ1bmN0aW9uc1xuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnXG4gICAqXG4gICAqIGxldCBzdW0gPSAwO1xuICAgKlxuICAgKiBvZigxLCAyLCAzKS5zdWJzY3JpYmUoXG4gICAqICAgdmFsdWUgPT4ge1xuICAgKiAgICAgY29uc29sZS5sb2coJ0FkZGluZzogJyArIHZhbHVlKTtcbiAgICogICAgIHN1bSA9IHN1bSArIHZhbHVlO1xuICAgKiAgIH0sXG4gICAqICAgdW5kZWZpbmVkLFxuICAgKiAgICgpID0+IGNvbnNvbGUubG9nKCdTdW0gZXF1YWxzOiAnICsgc3VtKVxuICAgKiApO1xuICAgKlxuICAgKiAvLyBMb2dzOlxuICAgKiAvLyBcIkFkZGluZzogMVwiXG4gICAqIC8vIFwiQWRkaW5nOiAyXCJcbiAgICogLy8gXCJBZGRpbmc6IDNcIlxuICAgKiAvLyBcIlN1bSBlcXVhbHM6IDZcIlxuICAgKiBgYGBcbiAgICpcbiAgICogIyMjIENhbmNlbCBhIHN1YnNjcmlwdGlvblxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBpbnRlcnZhbCB9IGZyb20gJ3J4anMnO1xuICAgKlxuICAgKiBjb25zdCBzdWJzY3JpcHRpb24gPSBpbnRlcnZhbCgxMDAwKS5zdWJzY3JpYmUoe1xuICAgKiAgIG5leHQobnVtKSB7XG4gICAqICAgICBjb25zb2xlLmxvZyhudW0pXG4gICAqICAgfSxcbiAgICogICBjb21wbGV0ZSgpIHtcbiAgICogICAgIC8vIFdpbGwgbm90IGJlIGNhbGxlZCwgZXZlbiB3aGVuIGNhbmNlbGxpbmcgc3Vic2NyaXB0aW9uLlxuICAgKiAgICAgY29uc29sZS5sb2coJ2NvbXBsZXRlZCEnKTtcbiAgICogICB9XG4gICAqIH0pO1xuICAgKlxuICAgKiBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICogICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICogICBjb25zb2xlLmxvZygndW5zdWJzY3JpYmVkIScpO1xuICAgKiB9LCAyNTAwKTtcbiAgICpcbiAgICogLy8gTG9nczpcbiAgICogLy8gMCBhZnRlciAxc1xuICAgKiAvLyAxIGFmdGVyIDJzXG4gICAqIC8vIFwidW5zdWJzY3JpYmVkIVwiIGFmdGVyIDIuNXNcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSB7T2JzZXJ2ZXJ8RnVuY3Rpb259IG9ic2VydmVyT3JOZXh0IChvcHRpb25hbCkgRWl0aGVyIGFuIG9ic2VydmVyIHdpdGggbWV0aG9kcyB0byBiZSBjYWxsZWQsXG4gICAqICBvciB0aGUgZmlyc3Qgb2YgdGhyZWUgcG9zc2libGUgaGFuZGxlcnMsIHdoaWNoIGlzIHRoZSBoYW5kbGVyIGZvciBlYWNoIHZhbHVlIGVtaXR0ZWQgZnJvbSB0aGUgc3Vic2NyaWJlZFxuICAgKiAgT2JzZXJ2YWJsZS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3IgKG9wdGlvbmFsKSBBIGhhbmRsZXIgZm9yIGEgdGVybWluYWwgZXZlbnQgcmVzdWx0aW5nIGZyb20gYW4gZXJyb3IuIElmIG5vIGVycm9yIGhhbmRsZXIgaXMgcHJvdmlkZWQsXG4gICAqICB0aGUgZXJyb3Igd2lsbCBiZSB0aHJvd24gYXN5bmNocm9ub3VzbHkgYXMgdW5oYW5kbGVkLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wbGV0ZSAob3B0aW9uYWwpIEEgaGFuZGxlciBmb3IgYSB0ZXJtaW5hbCBldmVudCByZXN1bHRpbmcgZnJvbSBzdWNjZXNzZnVsIGNvbXBsZXRpb24uXG4gICAqIEByZXR1cm4ge1N1YnNjcmlwdGlvbn0gYSBzdWJzY3JpcHRpb24gcmVmZXJlbmNlIHRvIHRoZSByZWdpc3RlcmVkIGhhbmRsZXJzXG4gICAqIEBtZXRob2Qgc3Vic2NyaWJlXG4gICAqL1xuICBzdWJzY3JpYmUoXG4gICAgb2JzZXJ2ZXJPck5leHQ/OiBQYXJ0aWFsPE9ic2VydmVyPFQ+PiB8ICgodmFsdWU6IFQpID0+IHZvaWQpIHwgbnVsbCxcbiAgICBlcnJvcj86ICgoZXJyb3I6IGFueSkgPT4gdm9pZCkgfCBudWxsLFxuICAgIGNvbXBsZXRlPzogKCgpID0+IHZvaWQpIHwgbnVsbFxuICApOiBTdWJzY3JpcHRpb24ge1xuICAgIGNvbnN0IHN1YnNjcmliZXIgPSBpc1N1YnNjcmliZXIob2JzZXJ2ZXJPck5leHQpID8gb2JzZXJ2ZXJPck5leHQgOiBuZXcgU2FmZVN1YnNjcmliZXIob2JzZXJ2ZXJPck5leHQsIGVycm9yLCBjb21wbGV0ZSk7XG5cbiAgICBlcnJvckNvbnRleHQoKCkgPT4ge1xuICAgICAgY29uc3QgeyBvcGVyYXRvciwgc291cmNlIH0gPSB0aGlzO1xuICAgICAgc3Vic2NyaWJlci5hZGQoXG4gICAgICAgIG9wZXJhdG9yXG4gICAgICAgICAgPyAvLyBXZSdyZSBkZWFsaW5nIHdpdGggYSBzdWJzY3JpcHRpb24gaW4gdGhlXG4gICAgICAgICAgICAvLyBvcGVyYXRvciBjaGFpbiB0byBvbmUgb2Ygb3VyIGxpZnRlZCBvcGVyYXRvcnMuXG4gICAgICAgICAgICBvcGVyYXRvci5jYWxsKHN1YnNjcmliZXIsIHNvdXJjZSlcbiAgICAgICAgICA6IHNvdXJjZVxuICAgICAgICAgID8gLy8gSWYgYHNvdXJjZWAgaGFzIGEgdmFsdWUsIGJ1dCBgb3BlcmF0b3JgIGRvZXMgbm90LCBzb21ldGhpbmcgdGhhdFxuICAgICAgICAgICAgLy8gaGFkIGludGltYXRlIGtub3dsZWRnZSBvZiBvdXIgQVBJLCBsaWtlIG91ciBgU3ViamVjdGAsIG11c3QgaGF2ZVxuICAgICAgICAgICAgLy8gc2V0IGl0LiBXZSdyZSBnb2luZyB0byBqdXN0IGNhbGwgYF9zdWJzY3JpYmVgIGRpcmVjdGx5LlxuICAgICAgICAgICAgdGhpcy5fc3Vic2NyaWJlKHN1YnNjcmliZXIpXG4gICAgICAgICAgOiAvLyBJbiBhbGwgb3RoZXIgY2FzZXMsIHdlJ3JlIGxpa2VseSB3cmFwcGluZyBhIHVzZXItcHJvdmlkZWQgaW5pdGlhbGl6ZXJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uLCBzbyB3ZSBuZWVkIHRvIGNhdGNoIGVycm9ycyBhbmQgaGFuZGxlIHRoZW0gYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgIHRoaXMuX3RyeVN1YnNjcmliZShzdWJzY3JpYmVyKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdWJzY3JpYmVyO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgX3RyeVN1YnNjcmliZShzaW5rOiBTdWJzY3JpYmVyPFQ+KTogVGVhcmRvd25Mb2dpYyB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUoc2luayk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIHJldHVybiBhbnl0aGluZyBpbiB0aGlzIGNhc2UsXG4gICAgICAvLyBiZWNhdXNlIGl0J3MganVzdCBnb2luZyB0byB0cnkgdG8gYGFkZCgpYCB0byBhIHN1YnNjcmlwdGlvblxuICAgICAgLy8gYWJvdmUuXG4gICAgICBzaW5rLmVycm9yKGVycik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYXMgYSBOT04tQ0FOQ0VMTEFCTEUgbWVhbnMgb2Ygc3Vic2NyaWJpbmcgdG8gYW4gb2JzZXJ2YWJsZSwgZm9yIHVzZSB3aXRoXG4gICAqIEFQSXMgdGhhdCBleHBlY3QgcHJvbWlzZXMsIGxpa2UgYGFzeW5jL2F3YWl0YC4gWW91IGNhbm5vdCB1bnN1YnNjcmliZSBmcm9tIHRoaXMuXG4gICAqXG4gICAqICoqV0FSTklORyoqOiBPbmx5IHVzZSB0aGlzIHdpdGggb2JzZXJ2YWJsZXMgeW91ICprbm93KiB3aWxsIGNvbXBsZXRlLiBJZiB0aGUgc291cmNlXG4gICAqIG9ic2VydmFibGUgZG9lcyBub3QgY29tcGxldGUsIHlvdSB3aWxsIGVuZCB1cCB3aXRoIGEgcHJvbWlzZSB0aGF0IGlzIGh1bmcgdXAsIGFuZFxuICAgKiBwb3RlbnRpYWxseSBhbGwgb2YgdGhlIHN0YXRlIG9mIGFuIGFzeW5jIGZ1bmN0aW9uIGhhbmdpbmcgb3V0IGluIG1lbW9yeS4gVG8gYXZvaWRcbiAgICogdGhpcyBzaXR1YXRpb24sIGxvb2sgaW50byBhZGRpbmcgc29tZXRoaW5nIGxpa2Uge0BsaW5rIHRpbWVvdXR9LCB7QGxpbmsgdGFrZX0sXG4gICAqIHtAbGluayB0YWtlV2hpbGV9LCBvciB7QGxpbmsgdGFrZVVudGlsfSBhbW9uZ3N0IG90aGVycy5cbiAgICpcbiAgICogIyMjIEV4YW1wbGU6XG4gICAqXG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCB7IGludGVydmFsIH0gZnJvbSAncnhqcyc7XG4gICAqIGltcG9ydCB7IHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG4gICAqXG4gICAqIGNvbnN0IHNvdXJjZSQgPSBpbnRlcnZhbCgxMDAwKS5waXBlKHRha2UoNCkpO1xuICAgKlxuICAgKiBhc3luYyBmdW5jdGlvbiBnZXRUb3RhbCgpIHtcbiAgICogICAgbGV0IHRvdGFsID0gMDtcbiAgICpcbiAgICogICAgYXdhaXQgc291cmNlJC5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICogICAgICB0b3RhbCArPSB2YWx1ZTtcbiAgICogICAgICBjb25zb2xlLmxvZygnb2JzZXJ2YWJsZSAtPiAnLCB2YWx1ZSk7XG4gICAqICAgIH0pO1xuICAgKlxuICAgKiAgICByZXR1cm4gdG90YWw7XG4gICAqIH1cbiAgICpcbiAgICogZ2V0VG90YWwoKS50aGVuKFxuICAgKiAgICB0b3RhbCA9PiBjb25zb2xlLmxvZygnVG90YWw6JywgdG90YWwpXG4gICAqIClcbiAgICpcbiAgICogLy8gRXhwZWN0ZWQ6XG4gICAqIC8vIFwib2JzZXJ2YWJsZSAtPiAwXCJcbiAgICogLy8gXCJvYnNlcnZhYmxlIC0+IDFcIlxuICAgKiAvLyBcIm9ic2VydmFibGUgLT4gMlwiXG4gICAqIC8vIFwib2JzZXJ2YWJsZSAtPiAzXCJcbiAgICogLy8gXCJUb3RhbDogNlwiXG4gICAqIGBgYFxuICAgKiBAcGFyYW0gbmV4dCBhIGhhbmRsZXIgZm9yIGVhY2ggdmFsdWUgZW1pdHRlZCBieSB0aGUgb2JzZXJ2YWJsZVxuICAgKiBAcmV0dXJuIGEgcHJvbWlzZSB0aGF0IGVpdGhlciByZXNvbHZlcyBvbiBvYnNlcnZhYmxlIGNvbXBsZXRpb24gb3JcbiAgICogIHJlamVjdHMgd2l0aCB0aGUgaGFuZGxlZCBlcnJvclxuICAgKi9cbiAgZm9yRWFjaChuZXh0OiAodmFsdWU6IFQpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gbmV4dCBhIGhhbmRsZXIgZm9yIGVhY2ggdmFsdWUgZW1pdHRlZCBieSB0aGUgb2JzZXJ2YWJsZVxuICAgKiBAcGFyYW0gcHJvbWlzZUN0b3IgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB1c2VkIHRvIGluc3RhbnRpYXRlIHRoZSBQcm9taXNlXG4gICAqIEByZXR1cm4gYSBwcm9taXNlIHRoYXQgZWl0aGVyIHJlc29sdmVzIG9uIG9ic2VydmFibGUgY29tcGxldGlvbiBvclxuICAgKiAgcmVqZWN0cyB3aXRoIHRoZSBoYW5kbGVkIGVycm9yXG4gICAqIEBkZXByZWNhdGVkIFBhc3NpbmcgYSBQcm9taXNlIGNvbnN0cnVjdG9yIHdpbGwgbm8gbG9uZ2VyIGJlIGF2YWlsYWJsZVxuICAgKiBpbiB1cGNvbWluZyB2ZXJzaW9ucyBvZiBSeEpTLiBUaGlzIGlzIGJlY2F1c2UgaXQgYWRkcyB3ZWlnaHQgdG8gdGhlIGxpYnJhcnksIGZvciB2ZXJ5XG4gICAqIGxpdHRsZSBiZW5lZml0LiBJZiB5b3UgbmVlZCB0aGlzIGZ1bmN0aW9uYWxpdHksIGl0IGlzIHJlY29tbWVuZGVkIHRoYXQgeW91IGVpdGhlclxuICAgKiBwb2x5ZmlsbCBQcm9taXNlLCBvciB5b3UgY3JlYXRlIGFuIGFkYXB0ZXIgdG8gY29udmVydCB0aGUgcmV0dXJuZWQgbmF0aXZlIHByb21pc2VcbiAgICogdG8gd2hhdGV2ZXIgcHJvbWlzZSBpbXBsZW1lbnRhdGlvbiB5b3Ugd2FudGVkLiBXaWxsIGJlIHJlbW92ZWQgaW4gdjguXG4gICAqL1xuICBmb3JFYWNoKG5leHQ6ICh2YWx1ZTogVCkgPT4gdm9pZCwgcHJvbWlzZUN0b3I6IFByb21pc2VDb25zdHJ1Y3Rvckxpa2UpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIGZvckVhY2gobmV4dDogKHZhbHVlOiBUKSA9PiB2b2lkLCBwcm9taXNlQ3Rvcj86IFByb21pc2VDb25zdHJ1Y3Rvckxpa2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBwcm9taXNlQ3RvciA9IGdldFByb21pc2VDdG9yKHByb21pc2VDdG9yKTtcblxuICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3I8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gTXVzdCBiZSBkZWNsYXJlZCBpbiBhIHNlcGFyYXRlIHN0YXRlbWVudCB0byBhdm9pZCBhIFJlZmVyZW5jZUVycm9yIHdoZW5cbiAgICAgIC8vIGFjY2Vzc2luZyBzdWJzY3JpcHRpb24gYmVsb3cgaW4gdGhlIGNsb3N1cmUgZHVlIHRvIFRlbXBvcmFsIERlYWQgWm9uZS5cbiAgICAgIGxldCBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICAgIHN1YnNjcmlwdGlvbiA9IHRoaXMuc3Vic2NyaWJlKFxuICAgICAgICAodmFsdWUpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbmV4dCh2YWx1ZSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbj8udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlamVjdCxcbiAgICAgICAgcmVzb2x2ZVxuICAgICAgKTtcbiAgICB9KSBhcyBQcm9taXNlPHZvaWQ+O1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcm90ZWN0ZWQgX3N1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPGFueT4pOiBUZWFyZG93bkxvZ2ljIHtcbiAgICByZXR1cm4gdGhpcy5zb3VyY2U/LnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbiBpbnRlcm9wIHBvaW50IGRlZmluZWQgYnkgdGhlIGVzNy1vYnNlcnZhYmxlIHNwZWMgaHR0cHM6Ly9naXRodWIuY29tL3plbnBhcnNpbmcvZXMtb2JzZXJ2YWJsZVxuICAgKiBAbWV0aG9kIFN5bWJvbC5vYnNlcnZhYmxlXG4gICAqIEByZXR1cm4ge09ic2VydmFibGV9IHRoaXMgaW5zdGFuY2Ugb2YgdGhlIG9ic2VydmFibGVcbiAgICovXG4gIFtTeW1ib2xfb2JzZXJ2YWJsZV0oKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKiB0c2xpbnQ6ZGlzYWJsZTptYXgtbGluZS1sZW5ndGggKi9cbiAgcGlwZSgpOiBPYnNlcnZhYmxlPFQ+O1xuICBwaXBlPEE+KG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPik6IE9ic2VydmFibGU8QT47XG4gIHBpcGU8QSwgQj4ob3AxOiBPcGVyYXRvckZ1bmN0aW9uPFQsIEE+LCBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4pOiBPYnNlcnZhYmxlPEI+O1xuICBwaXBlPEEsIEIsIEM+KG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPiwgb3AyOiBPcGVyYXRvckZ1bmN0aW9uPEEsIEI+LCBvcDM6IE9wZXJhdG9yRnVuY3Rpb248QiwgQz4pOiBPYnNlcnZhYmxlPEM+O1xuICBwaXBlPEEsIEIsIEMsIEQ+KFxuICAgIG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPixcbiAgICBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4sXG4gICAgb3AzOiBPcGVyYXRvckZ1bmN0aW9uPEIsIEM+LFxuICAgIG9wNDogT3BlcmF0b3JGdW5jdGlvbjxDLCBEPlxuICApOiBPYnNlcnZhYmxlPEQ+O1xuICBwaXBlPEEsIEIsIEMsIEQsIEU+KFxuICAgIG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPixcbiAgICBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4sXG4gICAgb3AzOiBPcGVyYXRvckZ1bmN0aW9uPEIsIEM+LFxuICAgIG9wNDogT3BlcmF0b3JGdW5jdGlvbjxDLCBEPixcbiAgICBvcDU6IE9wZXJhdG9yRnVuY3Rpb248RCwgRT5cbiAgKTogT2JzZXJ2YWJsZTxFPjtcbiAgcGlwZTxBLCBCLCBDLCBELCBFLCBGPihcbiAgICBvcDE6IE9wZXJhdG9yRnVuY3Rpb248VCwgQT4sXG4gICAgb3AyOiBPcGVyYXRvckZ1bmN0aW9uPEEsIEI+LFxuICAgIG9wMzogT3BlcmF0b3JGdW5jdGlvbjxCLCBDPixcbiAgICBvcDQ6IE9wZXJhdG9yRnVuY3Rpb248QywgRD4sXG4gICAgb3A1OiBPcGVyYXRvckZ1bmN0aW9uPEQsIEU+LFxuICAgIG9wNjogT3BlcmF0b3JGdW5jdGlvbjxFLCBGPlxuICApOiBPYnNlcnZhYmxlPEY+O1xuICBwaXBlPEEsIEIsIEMsIEQsIEUsIEYsIEc+KFxuICAgIG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPixcbiAgICBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4sXG4gICAgb3AzOiBPcGVyYXRvckZ1bmN0aW9uPEIsIEM+LFxuICAgIG9wNDogT3BlcmF0b3JGdW5jdGlvbjxDLCBEPixcbiAgICBvcDU6IE9wZXJhdG9yRnVuY3Rpb248RCwgRT4sXG4gICAgb3A2OiBPcGVyYXRvckZ1bmN0aW9uPEUsIEY+LFxuICAgIG9wNzogT3BlcmF0b3JGdW5jdGlvbjxGLCBHPlxuICApOiBPYnNlcnZhYmxlPEc+O1xuICBwaXBlPEEsIEIsIEMsIEQsIEUsIEYsIEcsIEg+KFxuICAgIG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPixcbiAgICBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4sXG4gICAgb3AzOiBPcGVyYXRvckZ1bmN0aW9uPEIsIEM+LFxuICAgIG9wNDogT3BlcmF0b3JGdW5jdGlvbjxDLCBEPixcbiAgICBvcDU6IE9wZXJhdG9yRnVuY3Rpb248RCwgRT4sXG4gICAgb3A2OiBPcGVyYXRvckZ1bmN0aW9uPEUsIEY+LFxuICAgIG9wNzogT3BlcmF0b3JGdW5jdGlvbjxGLCBHPixcbiAgICBvcDg6IE9wZXJhdG9yRnVuY3Rpb248RywgSD5cbiAgKTogT2JzZXJ2YWJsZTxIPjtcbiAgcGlwZTxBLCBCLCBDLCBELCBFLCBGLCBHLCBILCBJPihcbiAgICBvcDE6IE9wZXJhdG9yRnVuY3Rpb248VCwgQT4sXG4gICAgb3AyOiBPcGVyYXRvckZ1bmN0aW9uPEEsIEI+LFxuICAgIG9wMzogT3BlcmF0b3JGdW5jdGlvbjxCLCBDPixcbiAgICBvcDQ6IE9wZXJhdG9yRnVuY3Rpb248QywgRD4sXG4gICAgb3A1OiBPcGVyYXRvckZ1bmN0aW9uPEQsIEU+LFxuICAgIG9wNjogT3BlcmF0b3JGdW5jdGlvbjxFLCBGPixcbiAgICBvcDc6IE9wZXJhdG9yRnVuY3Rpb248RiwgRz4sXG4gICAgb3A4OiBPcGVyYXRvckZ1bmN0aW9uPEcsIEg+LFxuICAgIG9wOTogT3BlcmF0b3JGdW5jdGlvbjxILCBJPlxuICApOiBPYnNlcnZhYmxlPEk+O1xuICBwaXBlPEEsIEIsIEMsIEQsIEUsIEYsIEcsIEgsIEk+KFxuICAgIG9wMTogT3BlcmF0b3JGdW5jdGlvbjxULCBBPixcbiAgICBvcDI6IE9wZXJhdG9yRnVuY3Rpb248QSwgQj4sXG4gICAgb3AzOiBPcGVyYXRvckZ1bmN0aW9uPEIsIEM+LFxuICAgIG9wNDogT3BlcmF0b3JGdW5jdGlvbjxDLCBEPixcbiAgICBvcDU6IE9wZXJhdG9yRnVuY3Rpb248RCwgRT4sXG4gICAgb3A2OiBPcGVyYXRvckZ1bmN0aW9uPEUsIEY+LFxuICAgIG9wNzogT3BlcmF0b3JGdW5jdGlvbjxGLCBHPixcbiAgICBvcDg6IE9wZXJhdG9yRnVuY3Rpb248RywgSD4sXG4gICAgb3A5OiBPcGVyYXRvckZ1bmN0aW9uPEgsIEk+LFxuICAgIC4uLm9wZXJhdGlvbnM6IE9wZXJhdG9yRnVuY3Rpb248YW55LCBhbnk+W11cbiAgKTogT2JzZXJ2YWJsZTx1bmtub3duPjtcbiAgLyogdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGggKi9cblxuICAvKipcbiAgICogVXNlZCB0byBzdGl0Y2ggdG9nZXRoZXIgZnVuY3Rpb25hbCBvcGVyYXRvcnMgaW50byBhIGNoYWluLlxuICAgKiBAbWV0aG9kIHBpcGVcbiAgICogQHJldHVybiB7T2JzZXJ2YWJsZX0gdGhlIE9ic2VydmFibGUgcmVzdWx0IG9mIGFsbCBvZiB0aGUgb3BlcmF0b3JzIGhhdmluZ1xuICAgKiBiZWVuIGNhbGxlZCBpbiB0aGUgb3JkZXIgdGhleSB3ZXJlIHBhc3NlZCBpbi5cbiAgICpcbiAgICogIyMjIEV4YW1wbGVcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgaW50ZXJ2YWwgfSBmcm9tICdyeGpzJztcbiAgICogaW1wb3J0IHsgbWFwLCBmaWx0ZXIsIHNjYW4gfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG4gICAqXG4gICAqIGludGVydmFsKDEwMDApXG4gICAqICAgLnBpcGUoXG4gICAqICAgICBmaWx0ZXIoeCA9PiB4ICUgMiA9PT0gMCksXG4gICAqICAgICBtYXAoeCA9PiB4ICsgeCksXG4gICAqICAgICBzY2FuKChhY2MsIHgpID0+IGFjYyArIHgpXG4gICAqICAgKVxuICAgKiAgIC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSlcbiAgICogYGBgXG4gICAqL1xuICBwaXBlKC4uLm9wZXJhdGlvbnM6IE9wZXJhdG9yRnVuY3Rpb248YW55LCBhbnk+W10pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiBwaXBlRnJvbUFycmF5KG9wZXJhdGlvbnMpKHRoaXMpO1xuICB9XG5cbiAgLyogdHNsaW50OmRpc2FibGU6bWF4LWxpbmUtbGVuZ3RoICovXG4gIC8qKiBAZGVwcmVjYXRlZCBSZXBsYWNlZCB3aXRoIHtAbGluayBmaXJzdFZhbHVlRnJvbX0gYW5kIHtAbGluayBsYXN0VmFsdWVGcm9tfS4gV2lsbCBiZSByZW1vdmVkIGluIHY4LiBEZXRhaWxzOiBodHRwczovL3J4anMuZGV2L2RlcHJlY2F0aW9ucy90by1wcm9taXNlICovXG4gIHRvUHJvbWlzZSgpOiBQcm9taXNlPFQgfCB1bmRlZmluZWQ+O1xuICAvKiogQGRlcHJlY2F0ZWQgUmVwbGFjZWQgd2l0aCB7QGxpbmsgZmlyc3RWYWx1ZUZyb219IGFuZCB7QGxpbmsgbGFzdFZhbHVlRnJvbX0uIFdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4gRGV0YWlsczogaHR0cHM6Ly9yeGpzLmRldi9kZXByZWNhdGlvbnMvdG8tcHJvbWlzZSAqL1xuICB0b1Byb21pc2UoUHJvbWlzZUN0b3I6IHR5cGVvZiBQcm9taXNlKTogUHJvbWlzZTxUIHwgdW5kZWZpbmVkPjtcbiAgLyoqIEBkZXByZWNhdGVkIFJlcGxhY2VkIHdpdGgge0BsaW5rIGZpcnN0VmFsdWVGcm9tfSBhbmQge0BsaW5rIGxhc3RWYWx1ZUZyb219LiBXaWxsIGJlIHJlbW92ZWQgaW4gdjguIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3RvLXByb21pc2UgKi9cbiAgdG9Qcm9taXNlKFByb21pc2VDdG9yOiBQcm9taXNlQ29uc3RydWN0b3JMaWtlKTogUHJvbWlzZTxUIHwgdW5kZWZpbmVkPjtcbiAgLyogdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGggKi9cblxuICAvKipcbiAgICogU3Vic2NyaWJlIHRvIHRoaXMgT2JzZXJ2YWJsZSBhbmQgZ2V0IGEgUHJvbWlzZSByZXNvbHZpbmcgb25cbiAgICogYGNvbXBsZXRlYCB3aXRoIHRoZSBsYXN0IGVtaXNzaW9uIChpZiBhbnkpLlxuICAgKlxuICAgKiAqKldBUk5JTkcqKjogT25seSB1c2UgdGhpcyB3aXRoIG9ic2VydmFibGVzIHlvdSAqa25vdyogd2lsbCBjb21wbGV0ZS4gSWYgdGhlIHNvdXJjZVxuICAgKiBvYnNlcnZhYmxlIGRvZXMgbm90IGNvbXBsZXRlLCB5b3Ugd2lsbCBlbmQgdXAgd2l0aCBhIHByb21pc2UgdGhhdCBpcyBodW5nIHVwLCBhbmRcbiAgICogcG90ZW50aWFsbHkgYWxsIG9mIHRoZSBzdGF0ZSBvZiBhbiBhc3luYyBmdW5jdGlvbiBoYW5naW5nIG91dCBpbiBtZW1vcnkuIFRvIGF2b2lkXG4gICAqIHRoaXMgc2l0dWF0aW9uLCBsb29rIGludG8gYWRkaW5nIHNvbWV0aGluZyBsaWtlIHtAbGluayB0aW1lb3V0fSwge0BsaW5rIHRha2V9LFxuICAgKiB7QGxpbmsgdGFrZVdoaWxlfSwgb3Ige0BsaW5rIHRha2VVbnRpbH0gYW1vbmdzdCBvdGhlcnMuXG4gICAqXG4gICAqIEBtZXRob2QgdG9Qcm9taXNlXG4gICAqIEBwYXJhbSBbcHJvbWlzZUN0b3JdIGEgY29uc3RydWN0b3IgZnVuY3Rpb24gdXNlZCB0byBpbnN0YW50aWF0ZVxuICAgKiB0aGUgUHJvbWlzZVxuICAgKiBAcmV0dXJuIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGxhc3QgdmFsdWUgZW1pdCwgb3JcbiAgICogcmVqZWN0cyBvbiBhbiBlcnJvci4gSWYgdGhlcmUgd2VyZSBubyBlbWlzc2lvbnMsIFByb21pc2VcbiAgICogcmVzb2x2ZXMgd2l0aCB1bmRlZmluZWQuXG4gICAqIEBkZXByZWNhdGVkIFJlcGxhY2VkIHdpdGgge0BsaW5rIGZpcnN0VmFsdWVGcm9tfSBhbmQge0BsaW5rIGxhc3RWYWx1ZUZyb219LiBXaWxsIGJlIHJlbW92ZWQgaW4gdjguIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3RvLXByb21pc2VcbiAgICovXG4gIHRvUHJvbWlzZShwcm9taXNlQ3Rvcj86IFByb21pc2VDb25zdHJ1Y3Rvckxpa2UpOiBQcm9taXNlPFQgfCB1bmRlZmluZWQ+IHtcbiAgICBwcm9taXNlQ3RvciA9IGdldFByb21pc2VDdG9yKHByb21pc2VDdG9yKTtcblxuICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IHZhbHVlOiBUIHwgdW5kZWZpbmVkO1xuICAgICAgdGhpcy5zdWJzY3JpYmUoXG4gICAgICAgICh4OiBUKSA9PiAodmFsdWUgPSB4KSxcbiAgICAgICAgKGVycjogYW55KSA9PiByZWplY3QoZXJyKSxcbiAgICAgICAgKCkgPT4gcmVzb2x2ZSh2YWx1ZSlcbiAgICAgICk7XG4gICAgfSkgYXMgUHJvbWlzZTxUIHwgdW5kZWZpbmVkPjtcbiAgfVxufVxuXG4vKipcbiAqIERlY2lkZXMgYmV0d2VlbiBhIHBhc3NlZCBwcm9taXNlIGNvbnN0cnVjdG9yIGZyb20gY29uc3VtaW5nIGNvZGUsXG4gKiBBIGRlZmF1bHQgY29uZmlndXJlZCBwcm9taXNlIGNvbnN0cnVjdG9yLCBhbmQgdGhlIG5hdGl2ZSBwcm9taXNlXG4gKiBjb25zdHJ1Y3RvciBhbmQgcmV0dXJucyBpdC4gSWYgbm90aGluZyBjYW4gYmUgZm91bmQsIGl0IHdpbGwgdGhyb3dcbiAqIGFuIGVycm9yLlxuICogQHBhcmFtIHByb21pc2VDdG9yIFRoZSBvcHRpb25hbCBwcm9taXNlIGNvbnN0cnVjdG9yIHRvIHBhc3NlZCBieSBjb25zdW1pbmcgY29kZVxuICovXG5mdW5jdGlvbiBnZXRQcm9taXNlQ3Rvcihwcm9taXNlQ3RvcjogUHJvbWlzZUNvbnN0cnVjdG9yTGlrZSB8IHVuZGVmaW5lZCkge1xuICByZXR1cm4gcHJvbWlzZUN0b3IgPz8gY29uZmlnLlByb21pc2UgPz8gUHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gaXNPYnNlcnZlcjxUPih2YWx1ZTogYW55KTogdmFsdWUgaXMgT2JzZXJ2ZXI8VD4ge1xuICByZXR1cm4gdmFsdWUgJiYgaXNGdW5jdGlvbih2YWx1ZS5uZXh0KSAmJiBpc0Z1bmN0aW9uKHZhbHVlLmVycm9yKSAmJiBpc0Z1bmN0aW9uKHZhbHVlLmNvbXBsZXRlKTtcbn1cblxuZnVuY3Rpb24gaXNTdWJzY3JpYmVyPFQ+KHZhbHVlOiBhbnkpOiB2YWx1ZSBpcyBTdWJzY3JpYmVyPFQ+IHtcbiAgcmV0dXJuICh2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIFN1YnNjcmliZXIpIHx8IChpc09ic2VydmVyKHZhbHVlKSAmJiBpc1N1YnNjcmlwdGlvbih2YWx1ZSkpO1xufVxuIiwiaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vdXRpbC9pc0Z1bmN0aW9uJztcbmltcG9ydCB7IE9ic2VydmVyLCBPYnNlcnZhYmxlTm90aWZpY2F0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBpc1N1YnNjcmlwdGlvbiwgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHsgcmVwb3J0VW5oYW5kbGVkRXJyb3IgfSBmcm9tICcuL3V0aWwvcmVwb3J0VW5oYW5kbGVkRXJyb3InO1xuaW1wb3J0IHsgbm9vcCB9IGZyb20gJy4vdXRpbC9ub29wJztcbmltcG9ydCB7IG5leHROb3RpZmljYXRpb24sIGVycm9yTm90aWZpY2F0aW9uLCBDT01QTEVURV9OT1RJRklDQVRJT04gfSBmcm9tICcuL05vdGlmaWNhdGlvbkZhY3Rvcmllcyc7XG5pbXBvcnQgeyB0aW1lb3V0UHJvdmlkZXIgfSBmcm9tICcuL3NjaGVkdWxlci90aW1lb3V0UHJvdmlkZXInO1xuaW1wb3J0IHsgY2FwdHVyZUVycm9yIH0gZnJvbSAnLi91dGlsL2Vycm9yQ29udGV4dCc7XG5cbi8qKlxuICogSW1wbGVtZW50cyB0aGUge0BsaW5rIE9ic2VydmVyfSBpbnRlcmZhY2UgYW5kIGV4dGVuZHMgdGhlXG4gKiB7QGxpbmsgU3Vic2NyaXB0aW9ufSBjbGFzcy4gV2hpbGUgdGhlIHtAbGluayBPYnNlcnZlcn0gaXMgdGhlIHB1YmxpYyBBUEkgZm9yXG4gKiBjb25zdW1pbmcgdGhlIHZhbHVlcyBvZiBhbiB7QGxpbmsgT2JzZXJ2YWJsZX0sIGFsbCBPYnNlcnZlcnMgZ2V0IGNvbnZlcnRlZCB0b1xuICogYSBTdWJzY3JpYmVyLCBpbiBvcmRlciB0byBwcm92aWRlIFN1YnNjcmlwdGlvbi1saWtlIGNhcGFiaWxpdGllcyBzdWNoIGFzXG4gKiBgdW5zdWJzY3JpYmVgLiBTdWJzY3JpYmVyIGlzIGEgY29tbW9uIHR5cGUgaW4gUnhKUywgYW5kIGNydWNpYWwgZm9yXG4gKiBpbXBsZW1lbnRpbmcgb3BlcmF0b3JzLCBidXQgaXQgaXMgcmFyZWx5IHVzZWQgYXMgYSBwdWJsaWMgQVBJLlxuICpcbiAqIEBjbGFzcyBTdWJzY3JpYmVyPFQ+XG4gKi9cbmV4cG9ydCBjbGFzcyBTdWJzY3JpYmVyPFQ+IGV4dGVuZHMgU3Vic2NyaXB0aW9uIGltcGxlbWVudHMgT2JzZXJ2ZXI8VD4ge1xuICAvKipcbiAgICogQSBzdGF0aWMgZmFjdG9yeSBmb3IgYSBTdWJzY3JpYmVyLCBnaXZlbiBhIChwb3RlbnRpYWxseSBwYXJ0aWFsKSBkZWZpbml0aW9uXG4gICAqIG9mIGFuIE9ic2VydmVyLlxuICAgKiBAcGFyYW0gbmV4dCBUaGUgYG5leHRgIGNhbGxiYWNrIG9mIGFuIE9ic2VydmVyLlxuICAgKiBAcGFyYW0gZXJyb3IgVGhlIGBlcnJvcmAgY2FsbGJhY2sgb2YgYW5cbiAgICogT2JzZXJ2ZXIuXG4gICAqIEBwYXJhbSBjb21wbGV0ZSBUaGUgYGNvbXBsZXRlYCBjYWxsYmFjayBvZiBhblxuICAgKiBPYnNlcnZlci5cbiAgICogQHJldHVybiBBIFN1YnNjcmliZXIgd3JhcHBpbmcgdGhlIChwYXJ0aWFsbHkgZGVmaW5lZClcbiAgICogT2JzZXJ2ZXIgcmVwcmVzZW50ZWQgYnkgdGhlIGdpdmVuIGFyZ3VtZW50cy5cbiAgICogQG5vY29sbGFwc2VcbiAgICogQGRlcHJlY2F0ZWQgRG8gbm90IHVzZS4gV2lsbCBiZSByZW1vdmVkIGluIHY4LiBUaGVyZSBpcyBubyByZXBsYWNlbWVudCBmb3IgdGhpc1xuICAgKiBtZXRob2QsIGFuZCB0aGVyZSBpcyBubyByZWFzb24gdG8gYmUgY3JlYXRpbmcgaW5zdGFuY2VzIG9mIGBTdWJzY3JpYmVyYCBkaXJlY3RseS5cbiAgICogSWYgeW91IGhhdmUgYSBzcGVjaWZpYyB1c2UgY2FzZSwgcGxlYXNlIGZpbGUgYW4gaXNzdWUuXG4gICAqL1xuICBzdGF0aWMgY3JlYXRlPFQ+KG5leHQ/OiAoeD86IFQpID0+IHZvaWQsIGVycm9yPzogKGU/OiBhbnkpID0+IHZvaWQsIGNvbXBsZXRlPzogKCkgPT4gdm9pZCk6IFN1YnNjcmliZXI8VD4ge1xuICAgIHJldHVybiBuZXcgU2FmZVN1YnNjcmliZXIobmV4dCwgZXJyb3IsIGNvbXBsZXRlKTtcbiAgfVxuXG4gIC8qKiBAZGVwcmVjYXRlZCBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGRvIG5vdCB1c2UgZGlyZWN0bHkuIFdpbGwgYmUgbWFkZSBpbnRlcm5hbCBpbiB2OC4gKi9cbiAgcHJvdGVjdGVkIGlzU3RvcHBlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAvKiogQGRlcHJlY2F0ZWQgSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gZGV0YWlsLCBkbyBub3QgdXNlIGRpcmVjdGx5LiBXaWxsIGJlIG1hZGUgaW50ZXJuYWwgaW4gdjguICovXG4gIHByb3RlY3RlZCBkZXN0aW5hdGlvbjogU3Vic2NyaWJlcjxhbnk+IHwgT2JzZXJ2ZXI8YW55PjsgLy8gdGhpcyBgYW55YCBpcyB0aGUgZXNjYXBlIGhhdGNoIHRvIGVyYXNlIGV4dHJhIHR5cGUgcGFyYW0gKGUuZy4gUilcblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gZGV0YWlsLCBkbyBub3QgdXNlIGRpcmVjdGx5LiBXaWxsIGJlIG1hZGUgaW50ZXJuYWwgaW4gdjguXG4gICAqIFRoZXJlIGlzIG5vIHJlYXNvbiB0byBkaXJlY3RseSBjcmVhdGUgYW4gaW5zdGFuY2Ugb2YgU3Vic2NyaWJlci4gVGhpcyB0eXBlIGlzIGV4cG9ydGVkIGZvciB0eXBpbmdzIHJlYXNvbnMuXG4gICAqL1xuICBjb25zdHJ1Y3RvcihkZXN0aW5hdGlvbj86IFN1YnNjcmliZXI8YW55PiB8IE9ic2VydmVyPGFueT4pIHtcbiAgICBzdXBlcigpO1xuICAgIGlmIChkZXN0aW5hdGlvbikge1xuICAgICAgdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uO1xuICAgICAgLy8gQXV0b21hdGljYWxseSBjaGFpbiBzdWJzY3JpcHRpb25zIHRvZ2V0aGVyIGhlcmUuXG4gICAgICAvLyBpZiBkZXN0aW5hdGlvbiBpcyBhIFN1YnNjcmlwdGlvbiwgdGhlbiBpdCBpcyBhIFN1YnNjcmliZXIuXG4gICAgICBpZiAoaXNTdWJzY3JpcHRpb24oZGVzdGluYXRpb24pKSB7XG4gICAgICAgIGRlc3RpbmF0aW9uLmFkZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kZXN0aW5hdGlvbiA9IEVNUFRZX09CU0VSVkVSO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUge0BsaW5rIE9ic2VydmVyfSBjYWxsYmFjayB0byByZWNlaXZlIG5vdGlmaWNhdGlvbnMgb2YgdHlwZSBgbmV4dGAgZnJvbVxuICAgKiB0aGUgT2JzZXJ2YWJsZSwgd2l0aCBhIHZhbHVlLiBUaGUgT2JzZXJ2YWJsZSBtYXkgY2FsbCB0aGlzIG1ldGhvZCAwIG9yIG1vcmVcbiAgICogdGltZXMuXG4gICAqIEBwYXJhbSB7VH0gW3ZhbHVlXSBUaGUgYG5leHRgIHZhbHVlLlxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgbmV4dCh2YWx1ZT86IFQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgIGhhbmRsZVN0b3BwZWROb3RpZmljYXRpb24obmV4dE5vdGlmaWNhdGlvbih2YWx1ZSksIHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9uZXh0KHZhbHVlISk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRoZSB7QGxpbmsgT2JzZXJ2ZXJ9IGNhbGxiYWNrIHRvIHJlY2VpdmUgbm90aWZpY2F0aW9ucyBvZiB0eXBlIGBlcnJvcmAgZnJvbVxuICAgKiB0aGUgT2JzZXJ2YWJsZSwgd2l0aCBhbiBhdHRhY2hlZCBgRXJyb3JgLiBOb3RpZmllcyB0aGUgT2JzZXJ2ZXIgdGhhdFxuICAgKiB0aGUgT2JzZXJ2YWJsZSBoYXMgZXhwZXJpZW5jZWQgYW4gZXJyb3IgY29uZGl0aW9uLlxuICAgKiBAcGFyYW0ge2FueX0gW2Vycl0gVGhlIGBlcnJvcmAgZXhjZXB0aW9uLlxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgZXJyb3IoZXJyPzogYW55KTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICBoYW5kbGVTdG9wcGVkTm90aWZpY2F0aW9uKGVycm9yTm90aWZpY2F0aW9uKGVyciksIHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICB0aGlzLl9lcnJvcihlcnIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUge0BsaW5rIE9ic2VydmVyfSBjYWxsYmFjayB0byByZWNlaXZlIGEgdmFsdWVsZXNzIG5vdGlmaWNhdGlvbiBvZiB0eXBlXG4gICAqIGBjb21wbGV0ZWAgZnJvbSB0aGUgT2JzZXJ2YWJsZS4gTm90aWZpZXMgdGhlIE9ic2VydmVyIHRoYXQgdGhlIE9ic2VydmFibGVcbiAgICogaGFzIGZpbmlzaGVkIHNlbmRpbmcgcHVzaC1iYXNlZCBub3RpZmljYXRpb25zLlxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgY29tcGxldGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICBoYW5kbGVTdG9wcGVkTm90aWZpY2F0aW9uKENPTVBMRVRFX05PVElGSUNBVElPTiwgdGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2NvbXBsZXRlKCk7XG4gICAgfVxuICB9XG5cbiAgdW5zdWJzY3JpYmUoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNsb3NlZCkge1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgc3VwZXIudW5zdWJzY3JpYmUoKTtcbiAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBudWxsITtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgX25leHQodmFsdWU6IFQpOiB2b2lkIHtcbiAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQodmFsdWUpO1xuICB9XG5cbiAgcHJvdGVjdGVkIF9lcnJvcihlcnI6IGFueSk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgX2NvbXBsZXRlKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNhZmVTdWJzY3JpYmVyPFQ+IGV4dGVuZHMgU3Vic2NyaWJlcjxUPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG9ic2VydmVyT3JOZXh0PzogUGFydGlhbDxPYnNlcnZlcjxUPj4gfCAoKHZhbHVlOiBUKSA9PiB2b2lkKSB8IG51bGwsXG4gICAgZXJyb3I/OiAoKGU/OiBhbnkpID0+IHZvaWQpIHwgbnVsbCxcbiAgICBjb21wbGV0ZT86ICgoKSA9PiB2b2lkKSB8IG51bGxcbiAgKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGxldCBuZXh0OiAoKHZhbHVlOiBUKSA9PiB2b2lkKSB8IHVuZGVmaW5lZDtcbiAgICBpZiAoaXNGdW5jdGlvbihvYnNlcnZlck9yTmV4dCkpIHtcbiAgICAgIC8vIFRoZSBmaXJzdCBhcmd1bWVudCBpcyBhIGZ1bmN0aW9uLCBub3QgYW4gb2JzZXJ2ZXIuIFRoZSBuZXh0XG4gICAgICAvLyB0d28gYXJndW1lbnRzICpjb3VsZCogYmUgb2JzZXJ2ZXJzLCBvciB0aGV5IGNvdWxkIGJlIGVtcHR5LlxuICAgICAgbmV4dCA9IG9ic2VydmVyT3JOZXh0O1xuICAgIH0gZWxzZSBpZiAob2JzZXJ2ZXJPck5leHQpIHtcbiAgICAgIC8vIFRoZSBmaXJzdCBhcmd1bWVudCBpcyBhbiBvYnNlcnZlciBvYmplY3QsIHdlIGhhdmUgdG8gcHVsbCB0aGUgaGFuZGxlcnNcbiAgICAgIC8vIG9mZiBhbmQgY2FwdHVyZSB0aGUgb3duZXIgb2JqZWN0IGFzIHRoZSBjb250ZXh0LiBUaGF0IGlzIGJlY2F1c2Ugd2UncmVcbiAgICAgIC8vIGdvaW5nIHRvIHB1dCB0aGVtIGFsbCBpbiBhIG5ldyBkZXN0aW5hdGlvbiB3aXRoIGVuc3VyZWQgbWV0aG9kc1xuICAgICAgLy8gZm9yIGBuZXh0YCwgYGVycm9yYCwgYW5kIGBjb21wbGV0ZWAuIFRoYXQncyBwYXJ0IG9mIHdoYXQgbWFrZXMgdGhpc1xuICAgICAgLy8gdGhlIFwiU2FmZVwiIFN1YnNjcmliZXIuXG4gICAgICAoeyBuZXh0LCBlcnJvciwgY29tcGxldGUgfSA9IG9ic2VydmVyT3JOZXh0KTtcbiAgICAgIGxldCBjb250ZXh0OiBhbnk7XG4gICAgICBpZiAodGhpcyAmJiBjb25maWcudXNlRGVwcmVjYXRlZE5leHRDb250ZXh0KSB7XG4gICAgICAgIC8vIFRoaXMgaXMgYSBkZXByZWNhdGVkIHBhdGggdGhhdCBtYWRlIGB0aGlzLnVuc3Vic2NyaWJlKClgIGF2YWlsYWJsZSBpblxuICAgICAgICAvLyBuZXh0IGhhbmRsZXIgZnVuY3Rpb25zIHBhc3NlZCB0byBzdWJzY3JpYmUuIFRoaXMgb25seSBleGlzdHMgYmVoaW5kIGEgZmxhZ1xuICAgICAgICAvLyBub3csIGFzIGl0IGlzICp2ZXJ5KiBzbG93LlxuICAgICAgICBjb250ZXh0ID0gT2JqZWN0LmNyZWF0ZShvYnNlcnZlck9yTmV4dCk7XG4gICAgICAgIGNvbnRleHQudW5zdWJzY3JpYmUgPSAoKSA9PiB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0ID0gb2JzZXJ2ZXJPck5leHQ7XG4gICAgICB9XG4gICAgICBuZXh0ID0gbmV4dD8uYmluZChjb250ZXh0KTtcbiAgICAgIGVycm9yID0gZXJyb3I/LmJpbmQoY29udGV4dCk7XG4gICAgICBjb21wbGV0ZSA9IGNvbXBsZXRlPy5iaW5kKGNvbnRleHQpO1xuICAgIH1cblxuICAgIC8vIE9uY2Ugd2Ugc2V0IHRoZSBkZXN0aW5hdGlvbiwgdGhlIHN1cGVyY2xhc3MgYFN1YnNjcmliZXJgIHdpbGxcbiAgICAvLyBkbyBpdCdzIG1hZ2ljIGluIHRoZSBgX25leHRgLCBgX2Vycm9yYCwgYW5kIGBfY29tcGxldGVgIG1ldGhvZHMuXG4gICAgdGhpcy5kZXN0aW5hdGlvbiA9IHtcbiAgICAgIG5leHQ6IG5leHQgPyB3cmFwRm9yRXJyb3JIYW5kbGluZyhuZXh0LCB0aGlzKSA6IG5vb3AsXG4gICAgICBlcnJvcjogd3JhcEZvckVycm9ySGFuZGxpbmcoZXJyb3IgPz8gZGVmYXVsdEVycm9ySGFuZGxlciwgdGhpcyksXG4gICAgICBjb21wbGV0ZTogY29tcGxldGUgPyB3cmFwRm9yRXJyb3JIYW5kbGluZyhjb21wbGV0ZSwgdGhpcykgOiBub29wLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBXcmFwcyBhIHVzZXItcHJvdmlkZWQgaGFuZGxlciAob3Igb3VyIHtAbGluayBkZWZhdWx0RXJyb3JIYW5kbGVyfSBpbiBvbmUgY2FzZSkgdG9cbiAqIGVuc3VyZSB0aGF0IGFueSB0aHJvd24gZXJyb3JzIGFyZSBjYXVnaHQgYW5kIGhhbmRsZWQgYXBwcm9wcmlhdGVseS5cbiAqXG4gKiBAcGFyYW0gaGFuZGxlciBUaGUgaGFuZGxlciB0byB3cmFwXG4gKiBAcGFyYW0gaW5zdGFuY2UgVGhlIFNhZmVTdWJzY3JpYmVyIGluc3RhbmNlIHdlJ3JlIGdvaW5nIHRvIG1hcmsgaWYgdGhlcmUncyBhbiBlcnJvci5cbiAqL1xuZnVuY3Rpb24gd3JhcEZvckVycm9ySGFuZGxpbmcoaGFuZGxlcjogKGFyZz86IGFueSkgPT4gdm9pZCwgaW5zdGFuY2U6IFNhZmVTdWJzY3JpYmVyPGFueT4pIHtcbiAgcmV0dXJuICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBoYW5kbGVyKC4uLmFyZ3MpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nKSB7XG4gICAgICAgIGNhcHR1cmVFcnJvcihlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSWRlYWwgcGF0aCwgd2UgcmVwb3J0IHRoaXMgYXMgYW4gdW5oYW5kbGVkIGVycm9yLFxuICAgICAgICAvLyB3aGljaCBpcyB0aHJvd24gb24gYSBuZXcgY2FsbCBzdGFjay5cbiAgICAgICAgcmVwb3J0VW5oYW5kbGVkRXJyb3IoZXJyKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG4vKipcbiAqIEFuIGVycm9yIGhhbmRsZXIgdXNlZCB3aGVuIG5vIGVycm9yIGhhbmRsZXIgd2FzIHN1cHBsaWVkXG4gKiB0byB0aGUgU2FmZVN1YnNjcmliZXIgLS0gbWVhbmluZyBubyBlcnJvciBoYW5kbGVyIHdhcyBzdXBwbGllZFxuICogZG8gdGhlIGBzdWJzY3JpYmVgIGNhbGwgb24gb3VyIG9ic2VydmFibGUuXG4gKiBAcGFyYW0gZXJyIFRoZSBlcnJvciB0byBoYW5kbGVcbiAqL1xuZnVuY3Rpb24gZGVmYXVsdEVycm9ySGFuZGxlcihlcnI6IGFueSkge1xuICB0aHJvdyBlcnI7XG59XG5cbi8qKlxuICogQSBoYW5kbGVyIGZvciBub3RpZmljYXRpb25zIHRoYXQgY2Fubm90IGJlIHNlbnQgdG8gYSBzdG9wcGVkIHN1YnNjcmliZXIuXG4gKiBAcGFyYW0gbm90aWZpY2F0aW9uIFRoZSBub3RpZmljYXRpb24gYmVpbmcgc2VudFxuICogQHBhcmFtIHN1YnNjcmliZXIgVGhlIHN0b3BwZWQgc3Vic2NyaWJlclxuICovXG5mdW5jdGlvbiBoYW5kbGVTdG9wcGVkTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbjogT2JzZXJ2YWJsZU5vdGlmaWNhdGlvbjxhbnk+LCBzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPGFueT4pIHtcbiAgY29uc3QgeyBvblN0b3BwZWROb3RpZmljYXRpb24gfSA9IGNvbmZpZztcbiAgb25TdG9wcGVkTm90aWZpY2F0aW9uICYmIHRpbWVvdXRQcm92aWRlci5zZXRUaW1lb3V0KCgpID0+IG9uU3RvcHBlZE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIHN1YnNjcmliZXIpKTtcbn1cblxuLyoqXG4gKiBUaGUgb2JzZXJ2ZXIgdXNlZCBhcyBhIHN0dWIgZm9yIHN1YnNjcmlwdGlvbnMgd2hlcmUgdGhlIHVzZXIgZGlkIG5vdFxuICogcGFzcyBhbnkgYXJndW1lbnRzIHRvIGBzdWJzY3JpYmVgLiBDb21lcyB3aXRoIHRoZSBkZWZhdWx0IGVycm9yIGhhbmRsaW5nXG4gKiBiZWhhdmlvci5cbiAqL1xuZXhwb3J0IGNvbnN0IEVNUFRZX09CU0VSVkVSOiBSZWFkb25seTxPYnNlcnZlcjxhbnk+PiAmIHsgY2xvc2VkOiB0cnVlIH0gPSB7XG4gIGNsb3NlZDogdHJ1ZSxcbiAgbmV4dDogbm9vcCxcbiAgZXJyb3I6IGRlZmF1bHRFcnJvckhhbmRsZXIsXG4gIGNvbXBsZXRlOiBub29wLFxufTtcbiIsImltcG9ydCB7IGlzRnVuY3Rpb24gfSBmcm9tICcuL3V0aWwvaXNGdW5jdGlvbic7XG5pbXBvcnQgeyBVbnN1YnNjcmlwdGlvbkVycm9yIH0gZnJvbSAnLi91dGlsL1Vuc3Vic2NyaXB0aW9uRXJyb3InO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uTGlrZSwgVGVhcmRvd25Mb2dpYywgVW5zdWJzY3JpYmFibGUgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGFyclJlbW92ZSB9IGZyb20gJy4vdXRpbC9hcnJSZW1vdmUnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkaXNwb3NhYmxlIHJlc291cmNlLCBzdWNoIGFzIHRoZSBleGVjdXRpb24gb2YgYW4gT2JzZXJ2YWJsZS4gQVxuICogU3Vic2NyaXB0aW9uIGhhcyBvbmUgaW1wb3J0YW50IG1ldGhvZCwgYHVuc3Vic2NyaWJlYCwgdGhhdCB0YWtlcyBubyBhcmd1bWVudFxuICogYW5kIGp1c3QgZGlzcG9zZXMgdGhlIHJlc291cmNlIGhlbGQgYnkgdGhlIHN1YnNjcmlwdGlvbi5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHN1YnNjcmlwdGlvbnMgbWF5IGJlIGdyb3VwZWQgdG9nZXRoZXIgdGhyb3VnaCB0aGUgYGFkZCgpYFxuICogbWV0aG9kLCB3aGljaCB3aWxsIGF0dGFjaCBhIGNoaWxkIFN1YnNjcmlwdGlvbiB0byB0aGUgY3VycmVudCBTdWJzY3JpcHRpb24uXG4gKiBXaGVuIGEgU3Vic2NyaXB0aW9uIGlzIHVuc3Vic2NyaWJlZCwgYWxsIGl0cyBjaGlsZHJlbiAoYW5kIGl0cyBncmFuZGNoaWxkcmVuKVxuICogd2lsbCBiZSB1bnN1YnNjcmliZWQgYXMgd2VsbC5cbiAqXG4gKiBAY2xhc3MgU3Vic2NyaXB0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHRpb24gaW1wbGVtZW50cyBTdWJzY3JpcHRpb25MaWtlIHtcbiAgLyoqIEBub2NvbGxhcHNlICovXG4gIHB1YmxpYyBzdGF0aWMgRU1QVFkgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGVtcHR5ID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgIGVtcHR5LmNsb3NlZCA9IHRydWU7XG4gICAgcmV0dXJuIGVtcHR5O1xuICB9KSgpO1xuXG4gIC8qKlxuICAgKiBBIGZsYWcgdG8gaW5kaWNhdGUgd2hldGhlciB0aGlzIFN1YnNjcmlwdGlvbiBoYXMgYWxyZWFkeSBiZWVuIHVuc3Vic2NyaWJlZC5cbiAgICovXG4gIHB1YmxpYyBjbG9zZWQgPSBmYWxzZTtcblxuICBwcml2YXRlIF9wYXJlbnRhZ2U6IFN1YnNjcmlwdGlvbltdIHwgU3Vic2NyaXB0aW9uIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIHJlZ2lzdGVyZWQgdGVhcmRvd25zIHRvIGV4ZWN1dGUgdXBvbiB1bnN1YnNjcmlwdGlvbi4gQWRkaW5nIGFuZCByZW1vdmluZyBmcm9tIHRoaXNcbiAgICogbGlzdCBvY2N1cnMgaW4gdGhlIHtAbGluayAjYWRkfSBhbmQge0BsaW5rICNyZW1vdmV9IG1ldGhvZHMuXG4gICAqL1xuICBwcml2YXRlIF90ZWFyZG93bnM6IEV4Y2x1ZGU8VGVhcmRvd25Mb2dpYywgdm9pZD5bXSB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gaW5pdGlhbFRlYXJkb3duIEEgZnVuY3Rpb24gZXhlY3V0ZWQgZmlyc3QgYXMgcGFydCBvZiB0aGUgdGVhcmRvd25cbiAgICogcHJvY2VzcyB0aGF0IGlzIGtpY2tlZCBvZmYgd2hlbiB7QGxpbmsgI3Vuc3Vic2NyaWJlfSBpcyBjYWxsZWQuXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluaXRpYWxUZWFyZG93bj86ICgpID0+IHZvaWQpIHt9XG5cbiAgLyoqXG4gICAqIERpc3Bvc2VzIHRoZSByZXNvdXJjZXMgaGVsZCBieSB0aGUgc3Vic2NyaXB0aW9uLiBNYXksIGZvciBpbnN0YW5jZSwgY2FuY2VsXG4gICAqIGFuIG9uZ29pbmcgT2JzZXJ2YWJsZSBleGVjdXRpb24gb3IgY2FuY2VsIGFueSBvdGhlciB0eXBlIG9mIHdvcmsgdGhhdFxuICAgKiBzdGFydGVkIHdoZW4gdGhlIFN1YnNjcmlwdGlvbiB3YXMgY3JlYXRlZC5cbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIHVuc3Vic2NyaWJlKCk6IHZvaWQge1xuICAgIGxldCBlcnJvcnM6IGFueVtdIHwgdW5kZWZpbmVkO1xuXG4gICAgaWYgKCF0aGlzLmNsb3NlZCkge1xuICAgICAgdGhpcy5jbG9zZWQgPSB0cnVlO1xuXG4gICAgICAvLyBSZW1vdmUgdGhpcyBmcm9tIGl0J3MgcGFyZW50cy5cbiAgICAgIGNvbnN0IHsgX3BhcmVudGFnZSB9ID0gdGhpcztcbiAgICAgIGlmIChfcGFyZW50YWdlKSB7XG4gICAgICAgIHRoaXMuX3BhcmVudGFnZSA9IG51bGw7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KF9wYXJlbnRhZ2UpKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBwYXJlbnQgb2YgX3BhcmVudGFnZSkge1xuICAgICAgICAgICAgcGFyZW50LnJlbW92ZSh0aGlzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3BhcmVudGFnZS5yZW1vdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBpbml0aWFsVGVhcmRvd24gfSA9IHRoaXM7XG4gICAgICBpZiAoaXNGdW5jdGlvbihpbml0aWFsVGVhcmRvd24pKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaW5pdGlhbFRlYXJkb3duKCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlcnJvcnMgPSBlIGluc3RhbmNlb2YgVW5zdWJzY3JpcHRpb25FcnJvciA/IGUuZXJyb3JzIDogW2VdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgX3RlYXJkb3ducyB9ID0gdGhpcztcbiAgICAgIGlmIChfdGVhcmRvd25zKSB7XG4gICAgICAgIHRoaXMuX3RlYXJkb3ducyA9IG51bGw7XG4gICAgICAgIGZvciAoY29uc3QgdGVhcmRvd24gb2YgX3RlYXJkb3ducykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBleGVjVGVhcmRvd24odGVhcmRvd24pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgZXJyb3JzID0gZXJyb3JzID8/IFtdO1xuICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIFVuc3Vic2NyaXB0aW9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgZXJyb3JzID0gWy4uLmVycm9ycywgLi4uZXJyLmVycm9yc107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlcnJvcnMucHVzaChlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZXJyb3JzKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1YnNjcmlwdGlvbkVycm9yKGVycm9ycyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSB0ZWFyZG93biB0byB0aGlzIHN1YnNjcmlwdGlvbiwgc28gdGhhdCB0ZWFyZG93biB3aWxsIGJlIHVuc3Vic2NyaWJlZC9jYWxsZWRcbiAgICogd2hlbiB0aGlzIHN1YnNjcmlwdGlvbiBpcyB1bnN1YnNjcmliZWQuIElmIHRoaXMgc3Vic2NyaXB0aW9uIGlzIGFscmVhZHkge0BsaW5rICNjbG9zZWR9LFxuICAgKiBiZWNhdXNlIGl0IGhhcyBhbHJlYWR5IGJlZW4gdW5zdWJzY3JpYmVkLCB0aGVuIHdoYXRldmVyIHRlYXJkb3duIGlzIHBhc3NlZCB0byBpdFxuICAgKiB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgZXhlY3V0ZWQgKHVubGVzcyB0aGUgdGVhcmRvd24gaXRzZWxmIGlzIGFsc28gYSBjbG9zZWQgc3Vic2NyaXB0aW9uKS5cbiAgICpcbiAgICogQ2xvc2VkIFN1YnNjcmlwdGlvbnMgY2Fubm90IGJlIGFkZGVkIGFzIHRlYXJkb3ducyB0byBhbnkgc3Vic2NyaXB0aW9uLiBBZGRpbmcgYSBjbG9zZWRcbiAgICogc3Vic2NyaXB0aW9uIHRvIGEgYW55IHN1YnNjcmlwdGlvbiB3aWxsIHJlc3VsdCBpbiBubyBvcGVyYXRpb24uIChBIG5vb3ApLlxuICAgKlxuICAgKiBBZGRpbmcgYSBzdWJzY3JpcHRpb24gdG8gaXRzZWxmLCBvciBhZGRpbmcgYG51bGxgIG9yIGB1bmRlZmluZWRgIHdpbGwgbm90IHBlcmZvcm0gYW55XG4gICAqIG9wZXJhdGlvbiBhdCBhbGwuIChBIG5vb3ApLlxuICAgKlxuICAgKiBgU3Vic2NyaXB0aW9uYCBpbnN0YW5jZXMgdGhhdCBhcmUgYWRkZWQgdG8gdGhpcyBpbnN0YW5jZSB3aWxsIGF1dG9tYXRpY2FsbHkgcmVtb3ZlIHRoZW1zZWx2ZXNcbiAgICogaWYgdGhleSBhcmUgdW5zdWJzY3JpYmVkLiBGdW5jdGlvbnMgYW5kIHtAbGluayBVbnN1YnNjcmliYWJsZX0gb2JqZWN0cyB0aGF0IHlvdSB3aXNoIHRvIHJlbW92ZVxuICAgKiB3aWxsIG5lZWQgdG8gYmUgcmVtb3ZlZCBtYW51YWxseSB3aXRoIHtAbGluayAjcmVtb3ZlfVxuICAgKlxuICAgKiBAcGFyYW0gdGVhcmRvd24gVGhlIHRlYXJkb3duIGxvZ2ljIHRvIGFkZCB0byB0aGlzIHN1YnNjcmlwdGlvbi5cbiAgICovXG4gIGFkZCh0ZWFyZG93bjogVGVhcmRvd25Mb2dpYyk6IHZvaWQge1xuICAgIC8vIE9ubHkgYWRkIHRoZSB0ZWFyZG93biBpZiBpdCdzIG5vdCB1bmRlZmluZWRcbiAgICAvLyBhbmQgZG9uJ3QgYWRkIGEgc3Vic2NyaXB0aW9uIHRvIGl0c2VsZi5cbiAgICBpZiAodGVhcmRvd24gJiYgdGVhcmRvd24gIT09IHRoaXMpIHtcbiAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAvLyBJZiB0aGlzIHN1YnNjcmlwdGlvbiBpcyBhbHJlYWR5IGNsb3NlZCxcbiAgICAgICAgLy8gZXhlY3V0ZSB3aGF0ZXZlciB0ZWFyZG93biBpcyBoYW5kZWQgdG8gaXQgYXV0b21hdGljYWxseS5cbiAgICAgICAgZXhlY1RlYXJkb3duKHRlYXJkb3duKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0ZWFyZG93biBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgIC8vIFdlIGRvbid0IGFkZCBjbG9zZWQgc3Vic2NyaXB0aW9ucywgYW5kIHdlIGRvbid0IGFkZCB0aGUgc2FtZSBzdWJzY3JpcHRpb25cbiAgICAgICAgICAvLyB0d2ljZS4gU3Vic2NyaXB0aW9uIHVuc3Vic2NyaWJlIGlzIGlkZW1wb3RlbnQuXG4gICAgICAgICAgaWYgKHRlYXJkb3duLmNsb3NlZCB8fCB0ZWFyZG93bi5faGFzUGFyZW50KHRoaXMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRlYXJkb3duLl9hZGRQYXJlbnQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgKHRoaXMuX3RlYXJkb3ducyA9IHRoaXMuX3RlYXJkb3ducyA/PyBbXSkucHVzaCh0ZWFyZG93bik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyB0byBzZWUgaWYgYSB0aGlzIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGhhcyBhIHBhcnRpY3VsYXIgcGFyZW50LlxuICAgKiBUaGlzIHdpbGwgc2lnbmFsIHRoYXQgdGhpcyBzdWJzY3JpcHRpb24gaGFzIGFscmVhZHkgYmVlbiBhZGRlZCB0byB0aGUgcGFyZW50IGluIHF1ZXN0aW9uLlxuICAgKiBAcGFyYW0gcGFyZW50IHRoZSBwYXJlbnQgdG8gY2hlY2sgZm9yXG4gICAqL1xuICBwcml2YXRlIF9oYXNQYXJlbnQocGFyZW50OiBTdWJzY3JpcHRpb24pIHtcbiAgICBjb25zdCB7IF9wYXJlbnRhZ2UgfSA9IHRoaXM7XG4gICAgcmV0dXJuIF9wYXJlbnRhZ2UgPT09IHBhcmVudCB8fCAoQXJyYXkuaXNBcnJheShfcGFyZW50YWdlKSAmJiBfcGFyZW50YWdlLmluY2x1ZGVzKHBhcmVudCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBwYXJlbnQgdG8gdGhpcyBzdWJzY3JpcHRpb24gc28gaXQgY2FuIGJlIHJlbW92ZWQgZnJvbSB0aGUgcGFyZW50IGlmIGl0XG4gICAqIHVuc3Vic2NyaWJlcyBvbiBpdCdzIG93bi5cbiAgICpcbiAgICogTk9URTogVEhJUyBBU1NVTUVTIFRIQVQge0BsaW5rIF9oYXNQYXJlbnR9IEhBUyBBTFJFQURZIEJFRU4gQ0hFQ0tFRC5cbiAgICogQHBhcmFtIHBhcmVudCBUaGUgcGFyZW50IHN1YnNjcmlwdGlvbiB0byBhZGRcbiAgICovXG4gIHByaXZhdGUgX2FkZFBhcmVudChwYXJlbnQ6IFN1YnNjcmlwdGlvbikge1xuICAgIGNvbnN0IHsgX3BhcmVudGFnZSB9ID0gdGhpcztcbiAgICB0aGlzLl9wYXJlbnRhZ2UgPSBBcnJheS5pc0FycmF5KF9wYXJlbnRhZ2UpID8gKF9wYXJlbnRhZ2UucHVzaChwYXJlbnQpLCBfcGFyZW50YWdlKSA6IF9wYXJlbnRhZ2UgPyBbX3BhcmVudGFnZSwgcGFyZW50XSA6IHBhcmVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgb24gYSBjaGlsZCB3aGVuIGl0IGlzIHJlbW92ZWQgdmlhIHtAbGluayAjcmVtb3ZlfS5cbiAgICogQHBhcmFtIHBhcmVudCBUaGUgcGFyZW50IHRvIHJlbW92ZVxuICAgKi9cbiAgcHJpdmF0ZSBfcmVtb3ZlUGFyZW50KHBhcmVudDogU3Vic2NyaXB0aW9uKSB7XG4gICAgY29uc3QgeyBfcGFyZW50YWdlIH0gPSB0aGlzO1xuICAgIGlmIChfcGFyZW50YWdlID09PSBwYXJlbnQpIHtcbiAgICAgIHRoaXMuX3BhcmVudGFnZSA9IG51bGw7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KF9wYXJlbnRhZ2UpKSB7XG4gICAgICBhcnJSZW1vdmUoX3BhcmVudGFnZSwgcGFyZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIHRlYXJkb3duIGZyb20gdGhpcyBzdWJzY3JpcHRpb24gdGhhdCB3YXMgcHJldmlvdXNseSBhZGRlZCB3aXRoIHRoZSB7QGxpbmsgI2FkZH0gbWV0aG9kLlxuICAgKlxuICAgKiBOb3RlIHRoYXQgYFN1YnNjcmlwdGlvbmAgaW5zdGFuY2VzLCB3aGVuIHVuc3Vic2NyaWJlZCwgd2lsbCBhdXRvbWF0aWNhbGx5IHJlbW92ZSB0aGVtc2VsdmVzXG4gICAqIGZyb20gZXZlcnkgb3RoZXIgYFN1YnNjcmlwdGlvbmAgdGhleSBoYXZlIGJlZW4gYWRkZWQgdG8uIFRoaXMgbWVhbnMgdGhhdCB1c2luZyB0aGUgYHJlbW92ZWAgbWV0aG9kXG4gICAqIGlzIG5vdCBhIGNvbW1vbiB0aGluZyBhbmQgc2hvdWxkIGJlIHVzZWQgdGhvdWdodGZ1bGx5LlxuICAgKlxuICAgKiBJZiB5b3UgYWRkIHRoZSBzYW1lIHRlYXJkb3duIGluc3RhbmNlIG9mIGEgZnVuY3Rpb24gb3IgYW4gdW5zdWJzY3JpYmFibGUgb2JqZWN0IHRvIGEgYFN1YmNyaXB0aW9uYCBpbnN0YW5jZVxuICAgKiBtb3JlIHRoYW4gb25jZSwgeW91IHdpbGwgbmVlZCB0byBjYWxsIGByZW1vdmVgIHRoZSBzYW1lIG51bWJlciBvZiB0aW1lcyB0byByZW1vdmUgYWxsIGluc3RhbmNlcy5cbiAgICpcbiAgICogQWxsIHRlYXJkb3duIGluc3RhbmNlcyBhcmUgcmVtb3ZlZCB0byBmcmVlIHVwIG1lbW9yeSB1cG9uIHVuc3Vic2NyaXB0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gdGVhcmRvd24gVGhlIHRlYXJkb3duIHRvIHJlbW92ZSBmcm9tIHRoaXMgc3Vic2NyaXB0aW9uXG4gICAqL1xuICByZW1vdmUodGVhcmRvd246IEV4Y2x1ZGU8VGVhcmRvd25Mb2dpYywgdm9pZD4pOiB2b2lkIHtcbiAgICBjb25zdCB7IF90ZWFyZG93bnMgfSA9IHRoaXM7XG4gICAgX3RlYXJkb3ducyAmJiBhcnJSZW1vdmUoX3RlYXJkb3ducywgdGVhcmRvd24pO1xuXG4gICAgaWYgKHRlYXJkb3duIGluc3RhbmNlb2YgU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0ZWFyZG93bi5fcmVtb3ZlUGFyZW50KHRoaXMpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgRU1QVFlfU1VCU0NSSVBUSU9OID0gU3Vic2NyaXB0aW9uLkVNUFRZO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNTdWJzY3JpcHRpb24odmFsdWU6IGFueSk6IHZhbHVlIGlzIFN1YnNjcmlwdGlvbiB7XG4gIHJldHVybiAoXG4gICAgdmFsdWUgaW5zdGFuY2VvZiBTdWJzY3JpcHRpb24gfHxcbiAgICAodmFsdWUgJiYgJ2Nsb3NlZCcgaW4gdmFsdWUgJiYgaXNGdW5jdGlvbih2YWx1ZS5yZW1vdmUpICYmIGlzRnVuY3Rpb24odmFsdWUuYWRkKSAmJiBpc0Z1bmN0aW9uKHZhbHVlLnVuc3Vic2NyaWJlKSlcbiAgKTtcbn1cblxuZnVuY3Rpb24gZXhlY1RlYXJkb3duKHRlYXJkb3duOiBVbnN1YnNjcmliYWJsZSB8ICgoKSA9PiB2b2lkKSkge1xuICBpZiAoaXNGdW5jdGlvbih0ZWFyZG93bikpIHtcbiAgICB0ZWFyZG93bigpO1xuICB9IGVsc2Uge1xuICAgIHRlYXJkb3duLnVuc3Vic2NyaWJlKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZU5vdGlmaWNhdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFRoZSB7QGxpbmsgR2xvYmFsQ29uZmlnfSBvYmplY3QgZm9yIFJ4SlMuIEl0IGlzIHVzZWQgdG8gY29uZmlndXJlIHRoaW5nc1xuICogbGlrZSBob3cgdG8gcmVhY3Qgb24gdW5oYW5kbGVkIGVycm9ycy5cbiAqL1xuZXhwb3J0IGNvbnN0IGNvbmZpZzogR2xvYmFsQ29uZmlnID0ge1xuICBvblVuaGFuZGxlZEVycm9yOiBudWxsLFxuICBvblN0b3BwZWROb3RpZmljYXRpb246IG51bGwsXG4gIFByb21pc2U6IHVuZGVmaW5lZCxcbiAgdXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZzogZmFsc2UsXG4gIHVzZURlcHJlY2F0ZWROZXh0Q29udGV4dDogZmFsc2UsXG59O1xuXG4vKipcbiAqIFRoZSBnbG9iYWwgY29uZmlndXJhdGlvbiBvYmplY3QgZm9yIFJ4SlMsIHVzZWQgdG8gY29uZmlndXJlIHRoaW5nc1xuICogbGlrZSBob3cgdG8gcmVhY3Qgb24gdW5oYW5kbGVkIGVycm9ycy4gQWNjZXNzaWJsZSB2aWEge0BsaW5rIGNvbmZpZ31cbiAqIG9iamVjdC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHbG9iYWxDb25maWcge1xuICAvKipcbiAgICogQSByZWdpc3RyYXRpb24gcG9pbnQgZm9yIHVuaGFuZGxlZCBlcnJvcnMgZnJvbSBSeEpTLiBUaGVzZSBhcmUgZXJyb3JzIHRoYXRcbiAgICogY2Fubm90IHdlcmUgbm90IGhhbmRsZWQgYnkgY29uc3VtaW5nIGNvZGUgaW4gdGhlIHVzdWFsIHN1YnNjcmlwdGlvbiBwYXRoLiBGb3JcbiAgICogZXhhbXBsZSwgaWYgeW91IGhhdmUgdGhpcyBjb25maWd1cmVkLCBhbmQgeW91IHN1YnNjcmliZSB0byBhbiBvYnNlcnZhYmxlIHdpdGhvdXRcbiAgICogcHJvdmlkaW5nIGFuIGVycm9yIGhhbmRsZXIsIGVycm9ycyBmcm9tIHRoYXQgc3Vic2NyaXB0aW9uIHdpbGwgZW5kIHVwIGhlcmUuIFRoaXNcbiAgICogd2lsbCBfYWx3YXlzXyBiZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkgb24gYW5vdGhlciBqb2IgaW4gdGhlIHJ1bnRpbWUuIFRoaXMgaXMgYmVjYXVzZVxuICAgKiB3ZSBkbyBub3Qgd2FudCBlcnJvcnMgdGhyb3duIGluIHRoaXMgdXNlci1jb25maWd1cmVkIGhhbmRsZXIgdG8gaW50ZXJmZXJlIHdpdGggdGhlXG4gICAqIGJlaGF2aW9yIG9mIHRoZSBsaWJyYXJ5LlxuICAgKi9cbiAgb25VbmhhbmRsZWRFcnJvcjogKChlcnI6IGFueSkgPT4gdm9pZCkgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBIHJlZ2lzdHJhdGlvbiBwb2ludCBmb3Igbm90aWZpY2F0aW9ucyB0aGF0IGNhbm5vdCBiZSBzZW50IHRvIHN1YnNjcmliZXJzIGJlY2F1c2UgdGhleVxuICAgKiBoYXZlIGNvbXBsZXRlZCwgZXJyb3JlZCBvciBoYXZlIGJlZW4gZXhwbGljaXRseSB1bnN1YnNjcmliZWQuIEJ5IGRlZmF1bHQsIG5leHQsIGNvbXBsZXRlXG4gICAqIGFuZCBlcnJvciBub3RpZmljYXRpb25zIHNlbnQgdG8gc3RvcHBlZCBzdWJzY3JpYmVycyBhcmUgbm9vcHMuIEhvd2V2ZXIsIHNvbWV0aW1lcyBjYWxsZXJzXG4gICAqIG1pZ2h0IHdhbnQgYSBkaWZmZXJlbnQgYmVoYXZpb3IuIEZvciBleGFtcGxlLCB3aXRoIHNvdXJjZXMgdGhhdCBhdHRlbXB0IHRvIHJlcG9ydCBlcnJvcnNcbiAgICogdG8gc3RvcHBlZCBzdWJzY3JpYmVycywgYSBjYWxsZXIgY2FuIGNvbmZpZ3VyZSBSeEpTIHRvIHRocm93IGFuIHVuaGFuZGxlZCBlcnJvciBpbnN0ZWFkLlxuICAgKiBUaGlzIHdpbGwgX2Fsd2F5c18gYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5IG9uIGFub3RoZXIgam9iIGluIHRoZSBydW50aW1lLiBUaGlzIGlzIGJlY2F1c2VcbiAgICogd2UgZG8gbm90IHdhbnQgZXJyb3JzIHRocm93biBpbiB0aGlzIHVzZXItY29uZmlndXJlZCBoYW5kbGVyIHRvIGludGVyZmVyZSB3aXRoIHRoZVxuICAgKiBiZWhhdmlvciBvZiB0aGUgbGlicmFyeS5cbiAgICovXG4gIG9uU3RvcHBlZE5vdGlmaWNhdGlvbjogKChub3RpZmljYXRpb246IE9ic2VydmFibGVOb3RpZmljYXRpb248YW55Piwgc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxhbnk+KSA9PiB2b2lkKSB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIHVzZWQgYnkgZGVmYXVsdCBmb3Ige0BsaW5rIE9ic2VydmFibGUjdG9Qcm9taXNlIHRvUHJvbWlzZX0gYW5kIHtAbGluayBPYnNlcnZhYmxlI2ZvckVhY2ggZm9yRWFjaH1cbiAgICogbWV0aG9kcy5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWQgQXMgb2YgdmVyc2lvbiA4LCBSeEpTIHdpbGwgbm8gbG9uZ2VyIHN1cHBvcnQgdGhpcyBzb3J0IG9mIGluamVjdGlvbiBvZiBhXG4gICAqIFByb21pc2UgY29uc3RydWN0b3IuIElmIHlvdSBuZWVkIGEgUHJvbWlzZSBpbXBsZW1lbnRhdGlvbiBvdGhlciB0aGFuIG5hdGl2ZSBwcm9taXNlcyxcbiAgICogcGxlYXNlIHBvbHlmaWxsL3BhdGNoIFByb21pc2UgYXMgeW91IHNlZSBhcHByb3ByaWF0ZS4gV2lsbCBiZSByZW1vdmVkIGluIHY4LlxuICAgKi9cbiAgUHJvbWlzZT86IFByb21pc2VDb25zdHJ1Y3Rvckxpa2U7XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHR1cm5zIG9uIHN5bmNocm9ub3VzIGVycm9yIHJldGhyb3dpbmcsIHdoaWNoIGlzIGEgZGVwcmVjYXRlZCBiZWhhdmlvclxuICAgKiBpbiB2NiBhbmQgaGlnaGVyLiBUaGlzIGJlaGF2aW9yIGVuYWJsZXMgYmFkIHBhdHRlcm5zIGxpa2Ugd3JhcHBpbmcgYSBzdWJzY3JpYmVcbiAgICogY2FsbCBpbiBhIHRyeS9jYXRjaCBibG9jay4gSXQgYWxzbyBlbmFibGVzIHByb2R1Y2VyIGludGVyZmVyZW5jZSwgYSBuYXN0eSBidWdcbiAgICogd2hlcmUgYSBtdWx0aWNhc3QgY2FuIGJlIGJyb2tlbiBmb3IgYWxsIG9ic2VydmVycyBieSBhIGRvd25zdHJlYW0gY29uc3VtZXIgd2l0aFxuICAgKiBhbiB1bmhhbmRsZWQgZXJyb3IuIERPIE5PVCBVU0UgVEhJUyBGTEFHIFVOTEVTUyBJVCdTIE5FRURFRCBUTyBCVVkgVElNRVxuICAgKiBGT1IgTUlHUkFUSU9OIFJFQVNPTlMuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIEFzIG9mIHZlcnNpb24gOCwgUnhKUyB3aWxsIG5vIGxvbmdlciBzdXBwb3J0IHN5bmNocm9ub3VzIHRocm93aW5nXG4gICAqIG9mIHVuaGFuZGxlZCBlcnJvcnMuIEFsbCBlcnJvcnMgd2lsbCBiZSB0aHJvd24gb24gYSBzZXBhcmF0ZSBjYWxsIHN0YWNrIHRvIHByZXZlbnQgYmFkXG4gICAqIGJlaGF2aW9ycyBkZXNjcmliZWQgYWJvdmUuIFdpbGwgYmUgcmVtb3ZlZCBpbiB2OC5cbiAgICovXG4gIHVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmc6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIGVuYWJsZXMgYW4gYXMtb2YteWV0IHVuZG9jdW1lbnRlZCBmZWF0dXJlIGZyb20gdjU6IFRoZSBhYmlsaXR5IHRvIGFjY2Vzc1xuICAgKiBgdW5zdWJzY3JpYmUoKWAgdmlhIGB0aGlzYCBjb250ZXh0IGluIGBuZXh0YCBmdW5jdGlvbnMgY3JlYXRlZCBpbiBvYnNlcnZlcnMgcGFzc2VkXG4gICAqIHRvIGBzdWJzY3JpYmVgLlxuICAgKlxuICAgKiBUaGlzIGlzIGJlaW5nIHJlbW92ZWQgYmVjYXVzZSB0aGUgcGVyZm9ybWFuY2Ugd2FzIHNldmVyZWx5IHByb2JsZW1hdGljLCBhbmQgaXQgY291bGQgYWxzbyBjYXVzZVxuICAgKiBpc3N1ZXMgd2hlbiB0eXBlcyBvdGhlciB0aGFuIFBPSk9zIGFyZSBwYXNzZWQgdG8gc3Vic2NyaWJlIGFzIHN1YnNjcmliZXJzLCBhcyB0aGV5IHdpbGwgbGlrZWx5IGhhdmVcbiAgICogdGhlaXIgYHRoaXNgIGNvbnRleHQgb3ZlcndyaXR0ZW4uXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIEFzIG9mIHZlcnNpb24gOCwgUnhKUyB3aWxsIG5vIGxvbmdlciBzdXBwb3J0IGFsdGVyaW5nIHRoZVxuICAgKiBjb250ZXh0IG9mIG5leHQgZnVuY3Rpb25zIHByb3ZpZGVkIGFzIHBhcnQgb2YgYW4gb2JzZXJ2ZXIgdG8gU3Vic2NyaWJlLiBJbnN0ZWFkLFxuICAgKiB5b3Ugd2lsbCBoYXZlIGFjY2VzcyB0byBhIHN1YnNjcmlwdGlvbiBvciBhIHNpZ25hbCBvciB0b2tlbiB0aGF0IHdpbGwgYWxsb3cgeW91IHRvIGRvIHRoaW5ncyBsaWtlXG4gICAqIHVuc3Vic2NyaWJlIGFuZCB0ZXN0IGNsb3NlZCBzdGF0dXMuIFdpbGwgYmUgcmVtb3ZlZCBpbiB2OC5cbiAgICovXG4gIHVzZURlcHJlY2F0ZWROZXh0Q29udGV4dDogYm9vbGVhbjtcbn1cbiIsImltcG9ydCB7IGlzQXJyYXlMaWtlIH0gZnJvbSAnLi4vdXRpbC9pc0FycmF5TGlrZSc7XG5pbXBvcnQgeyBpc1Byb21pc2UgfSBmcm9tICcuLi91dGlsL2lzUHJvbWlzZSc7XG5pbXBvcnQgeyBvYnNlcnZhYmxlIGFzIFN5bWJvbF9vYnNlcnZhYmxlIH0gZnJvbSAnLi4vc3ltYm9sL29ic2VydmFibGUnO1xuaW1wb3J0IHsgU3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YnNjcmliZXInO1xuXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlSW5wdXQsIFNjaGVkdWxlckxpa2UsIE9ic2VydmVkVmFsdWVPZiwgUmVhZGFibGVTdHJlYW1MaWtlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgc2NoZWR1bGVkIH0gZnJvbSAnLi4vc2NoZWR1bGVkL3NjaGVkdWxlZCc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi4vdXRpbC9pc0Z1bmN0aW9uJztcbmltcG9ydCB7IHJlcG9ydFVuaGFuZGxlZEVycm9yIH0gZnJvbSAnLi4vdXRpbC9yZXBvcnRVbmhhbmRsZWRFcnJvcic7XG5pbXBvcnQgeyBpc0ludGVyb3BPYnNlcnZhYmxlIH0gZnJvbSAnLi4vdXRpbC9pc0ludGVyb3BPYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzQXN5bmNJdGVyYWJsZSB9IGZyb20gJy4uL3V0aWwvaXNBc3luY0l0ZXJhYmxlJztcbmltcG9ydCB7IGNyZWF0ZUludmFsaWRPYnNlcnZhYmxlVHlwZUVycm9yIH0gZnJvbSAnLi4vdXRpbC90aHJvd1Vub2JzZXJ2YWJsZUVycm9yJztcbmltcG9ydCB7IGlzSXRlcmFibGUgfSBmcm9tICcuLi91dGlsL2lzSXRlcmFibGUnO1xuaW1wb3J0IHsgaXNSZWFkYWJsZVN0cmVhbUxpa2UsIHJlYWRhYmxlU3RyZWFtTGlrZVRvQXN5bmNHZW5lcmF0b3IgfSBmcm9tICcuLi91dGlsL2lzUmVhZGFibGVTdHJlYW1MaWtlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZyb208TyBleHRlbmRzIE9ic2VydmFibGVJbnB1dDxhbnk+PihpbnB1dDogTyk6IE9ic2VydmFibGU8T2JzZXJ2ZWRWYWx1ZU9mPE8+Pjtcbi8qKiBAZGVwcmVjYXRlZCBUaGUgYHNjaGVkdWxlcmAgcGFyYW1ldGVyIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4gVXNlIGBzY2hlZHVsZWRgLiBEZXRhaWxzOiBodHRwczovL3J4anMuZGV2L2RlcHJlY2F0aW9ucy9zY2hlZHVsZXItYXJndW1lbnQgKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tPE8gZXh0ZW5kcyBPYnNlcnZhYmxlSW5wdXQ8YW55Pj4oaW5wdXQ6IE8sIHNjaGVkdWxlcjogU2NoZWR1bGVyTGlrZSk6IE9ic2VydmFibGU8T2JzZXJ2ZWRWYWx1ZU9mPE8+PjtcblxuLyoqXG4gKiBDcmVhdGVzIGFuIE9ic2VydmFibGUgZnJvbSBhbiBBcnJheSwgYW4gYXJyYXktbGlrZSBvYmplY3QsIGEgUHJvbWlzZSwgYW4gaXRlcmFibGUgb2JqZWN0LCBvciBhbiBPYnNlcnZhYmxlLWxpa2Ugb2JqZWN0LlxuICpcbiAqIDxzcGFuIGNsYXNzPVwiaW5mb3JtYWxcIj5Db252ZXJ0cyBhbG1vc3QgYW55dGhpbmcgdG8gYW4gT2JzZXJ2YWJsZS48L3NwYW4+XG4gKlxuICogIVtdKGZyb20ucG5nKVxuICpcbiAqIGBmcm9tYCBjb252ZXJ0cyB2YXJpb3VzIG90aGVyIG9iamVjdHMgYW5kIGRhdGEgdHlwZXMgaW50byBPYnNlcnZhYmxlcy4gSXQgYWxzbyBjb252ZXJ0cyBhIFByb21pc2UsIGFuIGFycmF5LWxpa2UsIG9yIGFuXG4gKiA8YSBocmVmPVwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvSXRlcmF0aW9uX3Byb3RvY29scyNpdGVyYWJsZVwiIHRhcmdldD1cIl9ibGFua1wiPml0ZXJhYmxlPC9hPlxuICogb2JqZWN0IGludG8gYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIHRoZSBpdGVtcyBpbiB0aGF0IHByb21pc2UsIGFycmF5LCBvciBpdGVyYWJsZS4gQSBTdHJpbmcsIGluIHRoaXMgY29udGV4dCwgaXMgdHJlYXRlZFxuICogYXMgYW4gYXJyYXkgb2YgY2hhcmFjdGVycy4gT2JzZXJ2YWJsZS1saWtlIG9iamVjdHMgKGNvbnRhaW5zIGEgZnVuY3Rpb24gbmFtZWQgd2l0aCB0aGUgRVMyMDE1IFN5bWJvbCBmb3IgT2JzZXJ2YWJsZSkgY2FuIGFsc28gYmVcbiAqIGNvbnZlcnRlZCB0aHJvdWdoIHRoaXMgb3BlcmF0b3IuXG4gKlxuICogIyMgRXhhbXBsZXNcbiAqXG4gKiAjIyMgQ29udmVydHMgYW4gYXJyYXkgdG8gYW4gT2JzZXJ2YWJsZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmcm9tIH0gZnJvbSAncnhqcyc7XG4gKlxuICogY29uc3QgYXJyYXkgPSBbMTAsIDIwLCAzMF07XG4gKiBjb25zdCByZXN1bHQgPSBmcm9tKGFycmF5KTtcbiAqXG4gKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpO1xuICpcbiAqIC8vIExvZ3M6XG4gKiAvLyAxMFxuICogLy8gMjBcbiAqIC8vIDMwXG4gKiBgYGBcbiAqXG4gKiAtLS1cbiAqXG4gKiAjIyMgQ29udmVydCBhbiBpbmZpbml0ZSBpdGVyYWJsZSAoZnJvbSBhIGdlbmVyYXRvcikgdG8gYW4gT2JzZXJ2YWJsZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmcm9tIH0gZnJvbSAncnhqcyc7XG4gKiBpbXBvcnQgeyB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuICpcbiAqIGZ1bmN0aW9uKiBnZW5lcmF0ZURvdWJsZXMoc2VlZCkge1xuICogICAgbGV0IGkgPSBzZWVkO1xuICogICAgd2hpbGUgKHRydWUpIHtcbiAqICAgICAgeWllbGQgaTtcbiAqICAgICAgaSA9IDIgKiBpOyAvLyBkb3VibGUgaXRcbiAqICAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBpdGVyYXRvciA9IGdlbmVyYXRlRG91YmxlcygzKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGZyb20oaXRlcmF0b3IpLnBpcGUodGFrZSgxMCkpO1xuICpcbiAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7XG4gKlxuICogLy8gTG9nczpcbiAqIC8vIDNcbiAqIC8vIDZcbiAqIC8vIDEyXG4gKiAvLyAyNFxuICogLy8gNDhcbiAqIC8vIDk2XG4gKiAvLyAxOTJcbiAqIC8vIDM4NFxuICogLy8gNzY4XG4gKiAvLyAxNTM2XG4gKiBgYGBcbiAqXG4gKiAtLS1cbiAqXG4gKiAjIyMgV2l0aCBhc3luYyBzY2hlZHVsZXJcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZnJvbSwgYXN5bmNTY2hlZHVsZXIgfSBmcm9tICdyeGpzJztcbiAqXG4gKiBjb25zb2xlLmxvZygnc3RhcnQnKTtcbiAqXG4gKiBjb25zdCBhcnJheSA9IFsxMCwgMjAsIDMwXTtcbiAqIGNvbnN0IHJlc3VsdCA9IGZyb20oYXJyYXksIGFzeW5jU2NoZWR1bGVyKTtcbiAqXG4gKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpO1xuICpcbiAqIGNvbnNvbGUubG9nKCdlbmQnKTtcbiAqXG4gKiAvLyBMb2dzOlxuICogLy8gc3RhcnRcbiAqIC8vIGVuZFxuICogLy8gMTBcbiAqIC8vIDIwXG4gKiAvLyAzMFxuICogYGBgXG4gKlxuICogQHNlZSB7QGxpbmsgZnJvbUV2ZW50fVxuICogQHNlZSB7QGxpbmsgZnJvbUV2ZW50UGF0dGVybn1cbiAqXG4gKiBAcGFyYW0ge09ic2VydmFibGVJbnB1dDxUPn0gQSBzdWJzY3JpcHRpb24gb2JqZWN0LCBhIFByb21pc2UsIGFuIE9ic2VydmFibGUtbGlrZSxcbiAqIGFuIEFycmF5LCBhbiBpdGVyYWJsZSwgb3IgYW4gYXJyYXktbGlrZSBvYmplY3QgdG8gYmUgY29udmVydGVkLlxuICogQHBhcmFtIHtTY2hlZHVsZXJMaWtlfSBBbiBvcHRpb25hbCB7QGxpbmsgU2NoZWR1bGVyTGlrZX0gb24gd2hpY2ggdG8gc2NoZWR1bGUgdGhlIGVtaXNzaW9uIG9mIHZhbHVlcy5cbiAqIEByZXR1cm4ge09ic2VydmFibGU8VD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tPFQ+KGlucHV0OiBPYnNlcnZhYmxlSW5wdXQ8VD4sIHNjaGVkdWxlcj86IFNjaGVkdWxlckxpa2UpOiBPYnNlcnZhYmxlPFQ+IHtcbiAgcmV0dXJuIHNjaGVkdWxlciA/IHNjaGVkdWxlZChpbnB1dCwgc2NoZWR1bGVyKSA6IGlubmVyRnJvbShpbnB1dCk7XG59XG5cbi8vIFRPRE86IFVzZSB0aGlzIHRocm91Z2hvdXQgdGhlIGxpYnJhcnksIHJhdGhlciB0aGFuIHRoZSBgZnJvbWAgYWJvdmUsIHRvIGF2b2lkXG4vLyB0aGUgdW5uZWNlc3Nhcnkgc2NoZWR1bGluZyBjaGVjayBhbmQgcmVkdWNlIGJ1bmRsZWQgc2l6ZXMgb2Ygb3BlcmF0b3JzIHRoYXQgdXNlIGBmcm9tYC5cbi8vIFRPRE86IEV2ZW50dWFsbHksIHRoaXMganVzdCBiZWNvbWVzIGBmcm9tYCwgYXMgd2UgZG9uJ3QgaGF2ZSB0aGUgZGVwcmVjYXRlZCBzY2hlZHVsZWQgcGF0aCBhbnltb3JlLlxuZXhwb3J0IGZ1bmN0aW9uIGlubmVyRnJvbTxUPihpbnB1dDogT2JzZXJ2YWJsZUlucHV0PFQ+KTogT2JzZXJ2YWJsZTxUPiB7XG4gIGlmIChpbnB1dCBpbnN0YW5jZW9mIE9ic2VydmFibGUpIHtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cbiAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICBpZiAoaXNJbnRlcm9wT2JzZXJ2YWJsZShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBmcm9tSW50ZXJvcE9ic2VydmFibGUoaW5wdXQpO1xuICAgIH1cbiAgICBpZiAoaXNBcnJheUxpa2UoaW5wdXQpKSB7XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZShpbnB1dCk7XG4gICAgfVxuICAgIGlmIChpc1Byb21pc2UoaW5wdXQpKSB7XG4gICAgICByZXR1cm4gZnJvbVByb21pc2UoaW5wdXQpO1xuICAgIH1cbiAgICBpZiAoaXNBc3luY0l0ZXJhYmxlKGlucHV0KSkge1xuICAgICAgcmV0dXJuIGZyb21Bc3luY0l0ZXJhYmxlKGlucHV0KTtcbiAgICB9XG4gICAgaWYgKGlzSXRlcmFibGUoaW5wdXQpKSB7XG4gICAgICByZXR1cm4gZnJvbUl0ZXJhYmxlKGlucHV0KTtcbiAgICB9XG4gICAgaWYgKGlzUmVhZGFibGVTdHJlYW1MaWtlKGlucHV0KSkge1xuICAgICAgcmV0dXJuIGZyb21SZWFkYWJsZVN0cmVhbUxpa2UoaW5wdXQpO1xuICAgIH1cbiAgfVxuXG4gIHRocm93IGNyZWF0ZUludmFsaWRPYnNlcnZhYmxlVHlwZUVycm9yKGlucHV0KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIFJ4SlMgT2JzZXJ2YWJsZSBmcm9tIGFuIG9iamVjdCB0aGF0IGltcGxlbWVudHMgYFN5bWJvbC5vYnNlcnZhYmxlYC5cbiAqIEBwYXJhbSBvYmogQW4gb2JqZWN0IHRoYXQgcHJvcGVybHkgaW1wbGVtZW50cyBgU3ltYm9sLm9ic2VydmFibGVgLlxuICovXG5mdW5jdGlvbiBmcm9tSW50ZXJvcE9ic2VydmFibGU8VD4ob2JqOiBhbnkpIHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKChzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSA9PiB7XG4gICAgY29uc3Qgb2JzID0gb2JqW1N5bWJvbF9vYnNlcnZhYmxlXSgpO1xuICAgIGlmIChpc0Z1bmN0aW9uKG9icy5zdWJzY3JpYmUpKSB7XG4gICAgICByZXR1cm4gb2JzLnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICB9XG4gICAgLy8gU2hvdWxkIGJlIGNhdWdodCBieSBvYnNlcnZhYmxlIHN1YnNjcmliZSBmdW5jdGlvbiBlcnJvciBoYW5kbGluZy5cbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm92aWRlZCBvYmplY3QgZG9lcyBub3QgY29ycmVjdGx5IGltcGxlbWVudCBTeW1ib2wub2JzZXJ2YWJsZScpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBTeW5jaHJvbm91c2x5IGVtaXRzIHRoZSB2YWx1ZXMgb2YgYW4gYXJyYXkgbGlrZSBhbmQgY29tcGxldGVzLlxuICogVGhpcyBpcyBleHBvcnRlZCBiZWNhdXNlIHRoZXJlIGFyZSBjcmVhdGlvbiBmdW5jdGlvbnMgYW5kIG9wZXJhdG9ycyB0aGF0IG5lZWQgdG9cbiAqIG1ha2UgZGlyZWN0IHVzZSBvZiB0aGUgc2FtZSBsb2dpYywgYW5kIHRoZXJlJ3Mgbm8gcmVhc29uIHRvIG1ha2UgdGhlbSBydW4gdGhyb3VnaFxuICogYGZyb21gIGNvbmRpdGlvbmFscyBiZWNhdXNlIHdlICprbm93KiB0aGV5J3JlIGRlYWxpbmcgd2l0aCBhbiBhcnJheS5cbiAqIEBwYXJhbSBhcnJheSBUaGUgYXJyYXkgdG8gZW1pdCB2YWx1ZXMgZnJvbVxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbUFycmF5TGlrZTxUPihhcnJheTogQXJyYXlMaWtlPFQ+KSB7XG4gIHJldHVybiBuZXcgT2JzZXJ2YWJsZSgoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikgPT4ge1xuICAgIC8vIExvb3Agb3ZlciB0aGUgYXJyYXkgYW5kIGVtaXQgZWFjaCB2YWx1ZS4gTm90ZSB0d28gdGhpbmdzIGhlcmU6XG4gICAgLy8gMS4gV2UncmUgbWFraW5nIHN1cmUgdGhhdCB0aGUgc3Vic2NyaWJlciBpcyBub3QgY2xvc2VkIG9uIGVhY2ggbG9vcC5cbiAgICAvLyAgICBUaGlzIGlzIHNvIHdlIGRvbid0IGNvbnRpbnVlIGxvb3Bpbmcgb3ZlciBhIHZlcnkgbGFyZ2UgYXJyYXkgYWZ0ZXJcbiAgICAvLyAgICBzb21ldGhpbmcgbGlrZSBhIGB0YWtlYCwgYHRha2VXaGlsZWAsIG9yIG90aGVyIHN5bmNocm9ub3VzIHVuc3Vic2NyaXB0aW9uXG4gICAgLy8gICAgaGFzIGFscmVhZHkgdW5zdWJzY3JpYmVkLlxuICAgIC8vIDIuIEluIHRoaXMgZm9ybSwgcmVlbnRyYW50IGNvZGUgY2FuIGFsdGVyIHRoYXQgYXJyYXkgd2UncmUgbG9vcGluZyBvdmVyLlxuICAgIC8vICAgIFRoaXMgaXMgYSBrbm93biBpc3N1ZSwgYnV0IGNvbnNpZGVyZWQgYW4gZWRnZSBjYXNlLiBUaGUgYWx0ZXJuYXRpdmUgd291bGRcbiAgICAvLyAgICBiZSB0byBjb3B5IHRoZSBhcnJheSBiZWZvcmUgZXhlY3V0aW5nIHRoZSBsb29wLCBidXQgdGhpcyBoYXNcbiAgICAvLyAgICBwZXJmb3JtYW5jZSBpbXBsaWNhdGlvbnMuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGggJiYgIXN1YnNjcmliZXIuY2xvc2VkOyBpKyspIHtcbiAgICAgIHN1YnNjcmliZXIubmV4dChhcnJheVtpXSk7XG4gICAgfVxuICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZyb21Qcm9taXNlPFQ+KHByb21pc2U6IFByb21pc2VMaWtlPFQ+KSB7XG4gIHJldHVybiBuZXcgT2JzZXJ2YWJsZSgoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikgPT4ge1xuICAgIHByb21pc2VcbiAgICAgIC50aGVuKFxuICAgICAgICAodmFsdWUpID0+IHtcbiAgICAgICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgKGVycjogYW55KSA9PiBzdWJzY3JpYmVyLmVycm9yKGVycilcbiAgICAgIClcbiAgICAgIC50aGVuKG51bGwsIHJlcG9ydFVuaGFuZGxlZEVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZyb21JdGVyYWJsZTxUPihpdGVyYWJsZTogSXRlcmFibGU8VD4pIHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKChzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSA9PiB7XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBpdGVyYWJsZSkge1xuICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZyb21Bc3luY0l0ZXJhYmxlPFQ+KGFzeW5jSXRlcmFibGU6IEFzeW5jSXRlcmFibGU8VD4pIHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKChzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSA9PiB7XG4gICAgcHJvY2Vzcyhhc3luY0l0ZXJhYmxlLCBzdWJzY3JpYmVyKS5jYXRjaCgoZXJyKSA9PiBzdWJzY3JpYmVyLmVycm9yKGVycikpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZnJvbVJlYWRhYmxlU3RyZWFtTGlrZTxUPihyZWFkYWJsZVN0cmVhbTogUmVhZGFibGVTdHJlYW1MaWtlPFQ+KSB7XG4gIHJldHVybiBmcm9tQXN5bmNJdGVyYWJsZShyZWFkYWJsZVN0cmVhbUxpa2VUb0FzeW5jR2VuZXJhdG9yKHJlYWRhYmxlU3RyZWFtKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3M8VD4oYXN5bmNJdGVyYWJsZTogQXN5bmNJdGVyYWJsZTxUPiwgc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikge1xuICBmb3IgYXdhaXQgKGNvbnN0IHZhbHVlIG9mIGFzeW5jSXRlcmFibGUpIHtcbiAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpO1xuICAgIC8vIEEgc2lkZS1lZmZlY3QgbWF5IGhhdmUgY2xvc2VkIG91ciBzdWJzY3JpYmVyLFxuICAgIC8vIGNoZWNrIGJlZm9yZSB0aGUgbmV4dCBpdGVyYXRpb24uXG4gICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbn1cbiIsImltcG9ydCB7IFNjaGVkdWxlckxpa2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBzY2hlZHVsZUFycmF5IH0gZnJvbSAnLi4vc2NoZWR1bGVkL3NjaGVkdWxlQXJyYXknO1xuaW1wb3J0IHsgZnJvbUFycmF5TGlrZSB9IGZyb20gJy4vZnJvbSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcm5hbEZyb21BcnJheTxUPihpbnB1dDogQXJyYXlMaWtlPFQ+LCBzY2hlZHVsZXI/OiBTY2hlZHVsZXJMaWtlKSB7XG4gIHJldHVybiBzY2hlZHVsZXIgPyBzY2hlZHVsZUFycmF5KGlucHV0LCBzY2hlZHVsZXIpIDogZnJvbUFycmF5TGlrZShpbnB1dCk7XG59XG4iLCJpbXBvcnQgeyBTY2hlZHVsZXJMaWtlLCBWYWx1ZUZyb21BcnJheSB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IGludGVybmFsRnJvbUFycmF5IH0gZnJvbSAnLi9mcm9tQXJyYXknO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgc2NoZWR1bGVBcnJheSB9IGZyb20gJy4uL3NjaGVkdWxlZC9zY2hlZHVsZUFycmF5JztcbmltcG9ydCB7IHBvcFNjaGVkdWxlciB9IGZyb20gJy4uL3V0aWwvYXJncyc7XG5cbi8vIERldnMgYXJlIG1vcmUgbGlrZWx5IHRvIHBhc3MgbnVsbCBvciB1bmRlZmluZWQgdGhhbiB0aGV5IGFyZSBhIHNjaGVkdWxlclxuLy8gd2l0aG91dCBhY2NvbXBhbnlpbmcgdmFsdWVzLiBUbyBtYWtlIHRoaW5ncyBlYXNpZXIgZm9yIChuYXVnaHR5KSBkZXZzIHdob1xuLy8gdXNlIHRoZSBgc3RyaWN0TnVsbENoZWNrczogZmFsc2VgIFR5cGVTY3JpcHQgY29tcGlsZXIgb3B0aW9uLCB0aGVzZVxuLy8gb3ZlcmxvYWRzIHdpdGggZXhwbGljaXQgbnVsbCBhbmQgdW5kZWZpbmVkIHZhbHVlcyBhcmUgaW5jbHVkZWQuXG5cbmV4cG9ydCBmdW5jdGlvbiBvZih2YWx1ZTogbnVsbCk6IE9ic2VydmFibGU8bnVsbD47XG5leHBvcnQgZnVuY3Rpb24gb2YodmFsdWU6IHVuZGVmaW5lZCk6IE9ic2VydmFibGU8dW5kZWZpbmVkPjtcblxuLyoqIEBkZXByZWNhdGVkIFRoZSBgc2NoZWR1bGVyYCBwYXJhbWV0ZXIgd2lsbCBiZSByZW1vdmVkIGluIHY4LiBVc2UgYHNjaGVkdWxlZGAuIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3NjaGVkdWxlci1hcmd1bWVudCAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9mKHNjaGVkdWxlcjogU2NoZWR1bGVyTGlrZSk6IE9ic2VydmFibGU8bmV2ZXI+O1xuLyoqIEBkZXByZWNhdGVkIFRoZSBgc2NoZWR1bGVyYCBwYXJhbWV0ZXIgd2lsbCBiZSByZW1vdmVkIGluIHY4LiBVc2UgYHNjaGVkdWxlZGAuIERldGFpbHM6IGh0dHBzOi8vcnhqcy5kZXYvZGVwcmVjYXRpb25zL3NjaGVkdWxlci1hcmd1bWVudCAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9mPEEgZXh0ZW5kcyByZWFkb25seSB1bmtub3duW10+KC4uLnZhbHVlc0FuZFNjaGVkdWxlcjogWy4uLkEsIFNjaGVkdWxlckxpa2VdKTogT2JzZXJ2YWJsZTxWYWx1ZUZyb21BcnJheTxBPj47XG5cbmV4cG9ydCBmdW5jdGlvbiBvZigpOiBPYnNlcnZhYmxlPG5ldmVyPjtcbi8qKiBAZGVwcmVjYXRlZCBEbyBub3Qgc3BlY2lmeSBleHBsaWNpdCB0eXBlIHBhcmFtZXRlcnMuIFNpZ25hdHVyZXMgd2l0aCB0eXBlIHBhcmFtZXRlcnMgdGhhdCBjYW5ub3QgYmUgaW5mZXJyZWQgd2lsbCBiZSByZW1vdmVkIGluIHY4LiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9mPFQ+KCk6IE9ic2VydmFibGU8VD47XG5leHBvcnQgZnVuY3Rpb24gb2Y8VD4odmFsdWU6IFQpOiBPYnNlcnZhYmxlPFQ+O1xuZXhwb3J0IGZ1bmN0aW9uIG9mPEEgZXh0ZW5kcyByZWFkb25seSB1bmtub3duW10+KC4uLnZhbHVlczogQSk6IE9ic2VydmFibGU8VmFsdWVGcm9tQXJyYXk8QT4+O1xuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBhcmd1bWVudHMgdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAqXG4gKiA8c3BhbiBjbGFzcz1cImluZm9ybWFsXCI+RWFjaCBhcmd1bWVudCBiZWNvbWVzIGEgYG5leHRgIG5vdGlmaWNhdGlvbi48L3NwYW4+XG4gKlxuICogIVtdKG9mLnBuZylcbiAqXG4gKiBVbmxpa2Uge0BsaW5rIGZyb219LCBpdCBkb2VzIG5vdCBkbyBhbnkgZmxhdHRlbmluZyBhbmQgZW1pdHMgZWFjaCBhcmd1bWVudCBpbiB3aG9sZVxuICogYXMgYSBzZXBhcmF0ZSBgbmV4dGAgbm90aWZpY2F0aW9uLlxuICpcbiAqICMjIEV4YW1wbGVzXG4gKlxuICogRW1pdCB0aGUgdmFsdWVzIGAxMCwgMjAsIDMwYFxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnO1xuICpcbiAqIG9mKDEwLCAyMCwgMzApXG4gKiAuc3Vic2NyaWJlKFxuICogICBuZXh0ID0+IGNvbnNvbGUubG9nKCduZXh0OicsIG5leHQpLFxuICogICBlcnIgPT4gY29uc29sZS5sb2coJ2Vycm9yOicsIGVyciksXG4gKiAgICgpID0+IGNvbnNvbGUubG9nKCd0aGUgZW5kJyksXG4gKiApO1xuICpcbiAqIC8vIE91dHB1dHNcbiAqIC8vIG5leHQ6IDEwXG4gKiAvLyBuZXh0OiAyMFxuICogLy8gbmV4dDogMzBcbiAqIC8vIHRoZSBlbmRcbiAqIGBgYFxuICpcbiAqIEVtaXQgdGhlIGFycmF5IGBbMSwgMiwgM11gXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XG4gKlxuICogb2YoWzEsIDIsIDNdKVxuICogLnN1YnNjcmliZShcbiAqICAgbmV4dCA9PiBjb25zb2xlLmxvZygnbmV4dDonLCBuZXh0KSxcbiAqICAgZXJyID0+IGNvbnNvbGUubG9nKCdlcnJvcjonLCBlcnIpLFxuICogICAoKSA9PiBjb25zb2xlLmxvZygndGhlIGVuZCcpLFxuICogKTtcbiAqXG4gKiAvLyBPdXRwdXRzXG4gKiAvLyBuZXh0OiBbMSwgMiwgM11cbiAqIC8vIHRoZSBlbmRcbiAqIGBgYFxuICpcbiAqIEBzZWUge0BsaW5rIGZyb219XG4gKiBAc2VlIHtAbGluayByYW5nZX1cbiAqXG4gKiBAcGFyYW0gey4uLlR9IHZhbHVlcyBBIGNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIGFyZ3VtZW50cyB5b3Ugd2FudCB0byBiZSBlbWl0dGVkXG4gKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgdGhlIGFyZ3VtZW50c1xuICogZGVzY3JpYmVkIGFib3ZlIGFuZCB0aGVuIGNvbXBsZXRlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9mPFQ+KC4uLmFyZ3M6IEFycmF5PFQgfCBTY2hlZHVsZXJMaWtlPik6IE9ic2VydmFibGU8VD4ge1xuICBjb25zdCBzY2hlZHVsZXIgPSBwb3BTY2hlZHVsZXIoYXJncyk7XG4gIHJldHVybiBzY2hlZHVsZXIgPyBzY2hlZHVsZUFycmF5KGFyZ3MgYXMgVFtdLCBzY2hlZHVsZXIpIDogaW50ZXJuYWxGcm9tQXJyYXkoYXJncyBhcyBUW10pO1xufVxuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU2NoZWR1bGVyTGlrZSB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNjaGVkdWxlQXJyYXk8VD4oaW5wdXQ6IEFycmF5TGlrZTxUPiwgc2NoZWR1bGVyOiBTY2hlZHVsZXJMaWtlKSB7XG4gIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxUPigoc3Vic2NyaWJlcikgPT4ge1xuICAgIC8vIFRoZSBjdXJyZW50IGFycmF5IGluZGV4LlxuICAgIGxldCBpID0gMDtcbiAgICAvLyBTdGFydCBpdGVyYXRpbmcgb3ZlciB0aGUgYXJyYXkgbGlrZSBvbiBhIHNjaGVkdWxlLlxuICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGkgPT09IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGhpdCB0aGUgZW5kIG9mIHRoZSBhcnJheSBsaWtlIGluIHRoZVxuICAgICAgICAvLyBwcmV2aW91cyBqb2IsIHdlIGNhbiBjb21wbGV0ZS5cbiAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gT3RoZXJ3aXNlIGxldCdzIG5leHQgdGhlIHZhbHVlIGF0IHRoZSBjdXJyZW50IGluZGV4LFxuICAgICAgICAvLyB0aGVuIGluY3JlbWVudCBvdXIgaW5kZXguXG4gICAgICAgIHN1YnNjcmliZXIubmV4dChpbnB1dFtpKytdKTtcbiAgICAgICAgLy8gSWYgdGhlIGxhc3QgZW1pc3Npb24gZGlkbid0IGNhdXNlIHVzIHRvIGNsb3NlIHRoZSBzdWJzY3JpYmVyXG4gICAgICAgIC8vICh2aWEgdGFrZSBvciBzb21lIHNpZGUgZWZmZWN0KSwgcmVzY2hlZHVsZSB0aGUgam9iIGFuZCB3ZSdsbFxuICAgICAgICAvLyBtYWtlIGFub3RoZXIgcGFzcy5cbiAgICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICAgIHRoaXMuc2NoZWR1bGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cbiIsImltcG9ydCB7IFNjaGVkdWxlckxpa2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICcuLi9TdWJzY3JpcHRpb24nO1xuXG5leHBvcnQgZnVuY3Rpb24gc2NoZWR1bGVBc3luY0l0ZXJhYmxlPFQ+KGlucHV0OiBBc3luY0l0ZXJhYmxlPFQ+LCBzY2hlZHVsZXI6IFNjaGVkdWxlckxpa2UpIHtcbiAgaWYgKCFpbnB1dCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSXRlcmFibGUgY2Fubm90IGJlIG51bGwnKTtcbiAgfVxuICByZXR1cm4gbmV3IE9ic2VydmFibGU8VD4oc3Vic2NyaWJlciA9PiB7XG4gICAgY29uc3Qgc3ViID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgIHN1Yi5hZGQoXG4gICAgICBzY2hlZHVsZXIuc2NoZWR1bGUoKCkgPT4ge1xuICAgICAgICBjb25zdCBpdGVyYXRvciA9IGlucHV0W1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpO1xuICAgICAgICBzdWIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaXRlcmF0b3IubmV4dCgpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuZG9uZSkge1xuICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQocmVzdWx0LnZhbHVlKTtcbiAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KSk7XG4gICAgICB9KVxuICAgICk7XG4gICAgcmV0dXJuIHN1YjtcbiAgfSk7XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTY2hlZHVsZXJMaWtlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgaXRlcmF0b3IgYXMgU3ltYm9sX2l0ZXJhdG9yIH0gZnJvbSAnLi4vc3ltYm9sL2l0ZXJhdG9yJztcbmltcG9ydCB7IGlzRnVuY3Rpb24gfSBmcm9tICcuLi91dGlsL2lzRnVuY3Rpb24nO1xuaW1wb3J0IHsgY2F1Z2h0U2NoZWR1bGUgfSBmcm9tICcuLi91dGlsL2NhdWdodFNjaGVkdWxlJztcblxuLyoqXG4gKiBVc2VkIGluIHtAbGluayBzY2hlZHVsZWR9IHRvIGNyZWF0ZSBhbiBvYnNlcnZhYmxlIGZyb20gYW4gSXRlcmFibGUuXG4gKiBAcGFyYW0gaW5wdXQgVGhlIGl0ZXJhYmxlIHRvIGNyZWF0ZSBhbiBvYnNlcnZhYmxlIGZyb21cbiAqIEBwYXJhbSBzY2hlZHVsZXIgVGhlIHNjaGVkdWxlciB0byB1c2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjaGVkdWxlSXRlcmFibGU8VD4oaW5wdXQ6IEl0ZXJhYmxlPFQ+LCBzY2hlZHVsZXI6IFNjaGVkdWxlckxpa2UpIHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFQ+KChzdWJzY3JpYmVyKSA9PiB7XG4gICAgbGV0IGl0ZXJhdG9yOiBJdGVyYXRvcjxULCBUPjtcblxuICAgIC8vIFNjaGVkdWxlIHRoZSBpbml0aWFsIGNyZWF0aW9uIG9mIHRoZSBpdGVyYXRvciBmcm9tXG4gICAgLy8gdGhlIGl0ZXJhYmxlLiBUaGlzIGlzIHNvIHRoZSBjb2RlIGluIHRoZSBpdGVyYWJsZSBpc1xuICAgIC8vIG5vdCBjYWxsZWQgdW50aWwgdGhlIHNjaGVkdWxlZCBqb2IgZmlyZXMuXG4gICAgc3Vic2NyaWJlci5hZGQoXG4gICAgICBzY2hlZHVsZXIuc2NoZWR1bGUoKCkgPT4ge1xuICAgICAgICAvLyBDcmVhdGUgdGhlIGl0ZXJhdG9yLlxuICAgICAgICBpdGVyYXRvciA9IChpbnB1dCBhcyBhbnkpW1N5bWJvbF9pdGVyYXRvcl0oKTtcblxuICAgICAgICAvLyBTY2hlZHVsZSB0aGUgZmlyc3QgaXRlcmF0aW9uIGFuZCBlbWlzc2lvbi5cbiAgICAgICAgY2F1Z2h0U2NoZWR1bGUoc3Vic2NyaWJlciwgc2NoZWR1bGVyLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gUHVsbCB0aGUgdmFsdWUgb3V0IG9mIHRoZSBpdGVyYXRvclxuICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGl0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgLy8gSWYgaXQgaXMgXCJkb25lXCIgd2UganVzdCBjb21wbGV0ZS4gVGhpcyBtaW1pY3MgdGhlXG4gICAgICAgICAgICAvLyBiZWhhdmlvciBvZiBKYXZhU2NyaXB0J3MgYGZvci4ub2ZgIGNvbnN1bXB0aW9uIG9mXG4gICAgICAgICAgICAvLyBpdGVyYWJsZXMsIHdoaWNoIHdpbGwgbm90IGVtaXQgdGhlIHZhbHVlIGZyb20gYW4gaXRlcmF0b3JcbiAgICAgICAgICAgIC8vIHJlc3VsdCBvZiBgeyBkb25lOiB0cnVlOiB2YWx1ZTogJ2hlcmUnIH1gLlxuICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGUgaXRlcmFibGUgaXMgbm90IGRvbmUsIGVtaXQgdGhlIHZhbHVlLlxuICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgIC8vIFJlc2NoZWR1bGUuIFRoaXMgd2lsbCBjYXVzZSB0aGlzIGZ1bmN0aW9uIHRvIGJlXG4gICAgICAgICAgICAvLyBjYWxsZWQgYWdhaW4gb24gdGhlIHNhbWUgc2NoZWR1bGVkIGRlbGF5LlxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBEdXJpbmcgdGVhcmRvd24sIGlmIHdlIHNlZSB0aGlzIGl0ZXJhdG9yIGhhcyBhIGByZXR1cm5gIG1ldGhvZCxcbiAgICAvLyB0aGVuIHdlIGtub3cgaXQgaXMgYSBHZW5lcmF0b3IsIGFuZCBub3QganVzdCBhbiBJdGVyYXRvci4gU28gd2UgY2FsbFxuICAgIC8vIHRoZSBgcmV0dXJuKClgIGZ1bmN0aW9uLiBUaGlzIHdpbGwgZW5zdXJlIHRoYXQgYW55IGBmaW5hbGx5IHsgfWAgYmxvY2tzXG4gICAgLy8gaW5zaWRlIG9mIHRoZSBnZW5lcmF0b3Igd2UgY2FuIGhpdCB3aWxsIGJlIGhpdCBwcm9wZXJseS5cbiAgICByZXR1cm4gKCkgPT4gaXNGdW5jdGlvbihpdGVyYXRvcj8ucmV0dXJuKSAmJiBpdGVyYXRvci5yZXR1cm4oKTtcbiAgfSk7XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICcuLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgb2JzZXJ2YWJsZSBhcyBTeW1ib2xfb2JzZXJ2YWJsZSB9IGZyb20gJy4uL3N5bWJvbC9vYnNlcnZhYmxlJztcbmltcG9ydCB7IEludGVyb3BPYnNlcnZhYmxlLCBTY2hlZHVsZXJMaWtlLCBTdWJzY3JpYmFibGUgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzY2hlZHVsZU9ic2VydmFibGU8VD4oaW5wdXQ6IEludGVyb3BPYnNlcnZhYmxlPFQ+LCBzY2hlZHVsZXI6IFNjaGVkdWxlckxpa2UpIHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFQ+KHN1YnNjcmliZXIgPT4ge1xuICAgIGNvbnN0IHN1YiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICBzdWIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiB7XG4gICAgICBjb25zdCBvYnNlcnZhYmxlOiBTdWJzY3JpYmFibGU8VD4gPSAoaW5wdXQgYXMgYW55KVtTeW1ib2xfb2JzZXJ2YWJsZV0oKTtcbiAgICAgIHN1Yi5hZGQob2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICBuZXh0KHZhbHVlKSB7IHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKCgpID0+IHN1YnNjcmliZXIubmV4dCh2YWx1ZSkpKTsgfSxcbiAgICAgICAgZXJyb3IoZXJyKSB7IHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKCgpID0+IHN1YnNjcmliZXIuZXJyb3IoZXJyKSkpOyB9LFxuICAgICAgICBjb21wbGV0ZSgpIHsgc3ViLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoKCkgPT4gc3Vic2NyaWJlci5jb21wbGV0ZSgpKSk7IH0sXG4gICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBzdWI7XG4gIH0pO1xufVxuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU2NoZWR1bGVyTGlrZSB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNjaGVkdWxlUHJvbWlzZTxUPihpbnB1dDogUHJvbWlzZUxpa2U8VD4sIHNjaGVkdWxlcjogU2NoZWR1bGVyTGlrZSkge1xuICByZXR1cm4gbmV3IE9ic2VydmFibGU8VD4oKHN1YnNjcmliZXIpID0+IHtcbiAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKCgpID0+XG4gICAgICBpbnB1dC50aGVuKFxuICAgICAgICAodmFsdWUpID0+IHtcbiAgICAgICAgICBzdWJzY3JpYmVyLmFkZChcbiAgICAgICAgICAgIHNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiB7XG4gICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgIHN1YnNjcmliZXIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiBzdWJzY3JpYmVyLmNvbXBsZXRlKCkpKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKTtcbiAgICAgICAgfSxcbiAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgIHN1YnNjcmliZXIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiBzdWJzY3JpYmVyLmVycm9yKGVycikpKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgICk7XG4gIH0pO1xufVxuIiwiaW1wb3J0IHsgU2NoZWR1bGVyTGlrZSwgUmVhZGFibGVTdHJlYW1MaWtlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgc2NoZWR1bGVBc3luY0l0ZXJhYmxlIH0gZnJvbSAnLi9zY2hlZHVsZUFzeW5jSXRlcmFibGUnO1xuaW1wb3J0IHsgcmVhZGFibGVTdHJlYW1MaWtlVG9Bc3luY0dlbmVyYXRvciB9IGZyb20gJy4uL3V0aWwvaXNSZWFkYWJsZVN0cmVhbUxpa2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gc2NoZWR1bGVSZWFkYWJsZVN0cmVhbUxpa2U8VD4oaW5wdXQ6IFJlYWRhYmxlU3RyZWFtTGlrZTxUPiwgc2NoZWR1bGVyOiBTY2hlZHVsZXJMaWtlKTogT2JzZXJ2YWJsZTxUPiB7XG4gIHJldHVybiBzY2hlZHVsZUFzeW5jSXRlcmFibGUocmVhZGFibGVTdHJlYW1MaWtlVG9Bc3luY0dlbmVyYXRvcihpbnB1dCksIHNjaGVkdWxlcik7XG59XG4iLCJpbXBvcnQgeyBzY2hlZHVsZU9ic2VydmFibGUgfSBmcm9tICcuL3NjaGVkdWxlT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBzY2hlZHVsZVByb21pc2UgfSBmcm9tICcuL3NjaGVkdWxlUHJvbWlzZSc7XG5pbXBvcnQgeyBzY2hlZHVsZUFycmF5IH0gZnJvbSAnLi9zY2hlZHVsZUFycmF5JztcbmltcG9ydCB7IHNjaGVkdWxlSXRlcmFibGUgfSBmcm9tICcuL3NjaGVkdWxlSXRlcmFibGUnO1xuaW1wb3J0IHsgc2NoZWR1bGVBc3luY0l0ZXJhYmxlIH0gZnJvbSAnLi9zY2hlZHVsZUFzeW5jSXRlcmFibGUnO1xuaW1wb3J0IHsgaXNJbnRlcm9wT2JzZXJ2YWJsZSB9IGZyb20gJy4uL3V0aWwvaXNJbnRlcm9wT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBpc1Byb21pc2UgfSBmcm9tICcuLi91dGlsL2lzUHJvbWlzZSc7XG5pbXBvcnQgeyBpc0FycmF5TGlrZSB9IGZyb20gJy4uL3V0aWwvaXNBcnJheUxpa2UnO1xuaW1wb3J0IHsgaXNJdGVyYWJsZSB9IGZyb20gJy4uL3V0aWwvaXNJdGVyYWJsZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlSW5wdXQsIFNjaGVkdWxlckxpa2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBpc0FzeW5jSXRlcmFibGUgfSBmcm9tICcuLi91dGlsL2lzQXN5bmNJdGVyYWJsZSc7XG5pbXBvcnQgeyBjcmVhdGVJbnZhbGlkT2JzZXJ2YWJsZVR5cGVFcnJvciB9IGZyb20gJy4uL3V0aWwvdGhyb3dVbm9ic2VydmFibGVFcnJvcic7XG5pbXBvcnQgeyBpc1JlYWRhYmxlU3RyZWFtTGlrZSB9IGZyb20gJy4uL3V0aWwvaXNSZWFkYWJsZVN0cmVhbUxpa2UnO1xuaW1wb3J0IHsgc2NoZWR1bGVSZWFkYWJsZVN0cmVhbUxpa2UgfSBmcm9tICcuL3NjaGVkdWxlUmVhZGFibGVTdHJlYW1MaWtlJztcblxuLyoqXG4gKiBDb252ZXJ0cyBmcm9tIGEgY29tbW9uIHtAbGluayBPYnNlcnZhYmxlSW5wdXR9IHR5cGUgdG8gYW4gb2JzZXJ2YWJsZSB3aGVyZSBzdWJzY3JpcHRpb24gYW5kIGVtaXNzaW9uc1xuICogYXJlIHNjaGVkdWxlZCBvbiB0aGUgcHJvdmlkZWQgc2NoZWR1bGVyLlxuICpcbiAqIEBzZWUge0BsaW5rIGZyb219XG4gKiBAc2VlIHtAbGluayBvZn1cbiAqXG4gKiBAcGFyYW0gaW5wdXQgVGhlIG9ic2VydmFibGUsIGFycmF5LCBwcm9taXNlLCBpdGVyYWJsZSwgZXRjIHlvdSB3b3VsZCBsaWtlIHRvIHNjaGVkdWxlXG4gKiBAcGFyYW0gc2NoZWR1bGVyIFRoZSBzY2hlZHVsZXIgdG8gdXNlIHRvIHNjaGVkdWxlIHRoZSBzdWJzY3JpcHRpb24gYW5kIGVtaXNzaW9ucyBmcm9tXG4gKiB0aGUgcmV0dXJuZWQgb2JzZXJ2YWJsZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjaGVkdWxlZDxUPihpbnB1dDogT2JzZXJ2YWJsZUlucHV0PFQ+LCBzY2hlZHVsZXI6IFNjaGVkdWxlckxpa2UpOiBPYnNlcnZhYmxlPFQ+IHtcbiAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICBpZiAoaXNJbnRlcm9wT2JzZXJ2YWJsZShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBzY2hlZHVsZU9ic2VydmFibGUoaW5wdXQsIHNjaGVkdWxlcik7XG4gICAgfVxuICAgIGlmIChpc0FycmF5TGlrZShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBzY2hlZHVsZUFycmF5KGlucHV0LCBzY2hlZHVsZXIpO1xuICAgIH1cbiAgICBpZiAoaXNQcm9taXNlKGlucHV0KSkge1xuICAgICAgcmV0dXJuIHNjaGVkdWxlUHJvbWlzZShpbnB1dCwgc2NoZWR1bGVyKTtcbiAgICB9XG4gICAgaWYgKGlzQXN5bmNJdGVyYWJsZShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBzY2hlZHVsZUFzeW5jSXRlcmFibGUoaW5wdXQsIHNjaGVkdWxlcik7XG4gICAgfVxuICAgIGlmIChpc0l0ZXJhYmxlKGlucHV0KSkge1xuICAgICAgcmV0dXJuIHNjaGVkdWxlSXRlcmFibGUoaW5wdXQsIHNjaGVkdWxlcik7XG4gICAgfVxuICAgIGlmIChpc1JlYWRhYmxlU3RyZWFtTGlrZShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBzY2hlZHVsZVJlYWRhYmxlU3RyZWFtTGlrZShpbnB1dCwgc2NoZWR1bGVyKTtcbiAgICB9XG4gIH1cbiAgdGhyb3cgY3JlYXRlSW52YWxpZE9ic2VydmFibGVUeXBlRXJyb3IoaW5wdXQpO1xufVxuIiwidHlwZSBTZXRUaW1lb3V0RnVuY3Rpb24gPSAoaGFuZGxlcjogKCkgPT4gdm9pZCwgdGltZW91dD86IG51bWJlciwgLi4uYXJnczogYW55W10pID0+IG51bWJlcjtcbnR5cGUgQ2xlYXJUaW1lb3V0RnVuY3Rpb24gPSAoaGFuZGxlOiBudW1iZXIpID0+IHZvaWQ7XG5cbmludGVyZmFjZSBUaW1lb3V0UHJvdmlkZXIge1xuICBzZXRUaW1lb3V0OiBTZXRUaW1lb3V0RnVuY3Rpb247XG4gIGNsZWFyVGltZW91dDogQ2xlYXJUaW1lb3V0RnVuY3Rpb247XG4gIGRlbGVnYXRlOlxuICAgIHwge1xuICAgICAgICBzZXRUaW1lb3V0OiBTZXRUaW1lb3V0RnVuY3Rpb247XG4gICAgICAgIGNsZWFyVGltZW91dDogQ2xlYXJUaW1lb3V0RnVuY3Rpb247XG4gICAgICB9XG4gICAgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCB0aW1lb3V0UHJvdmlkZXI6IFRpbWVvdXRQcm92aWRlciA9IHtcbiAgLy8gV2hlbiBhY2Nlc3NpbmcgdGhlIGRlbGVnYXRlLCB1c2UgdGhlIHZhcmlhYmxlIHJhdGhlciB0aGFuIGB0aGlzYCBzbyB0aGF0XG4gIC8vIHRoZSBmdW5jdGlvbnMgY2FuIGJlIGNhbGxlZCB3aXRob3V0IGJlaW5nIGJvdW5kIHRvIHRoZSBwcm92aWRlci5cbiAgc2V0VGltZW91dCguLi5hcmdzKSB7XG4gICAgY29uc3QgeyBkZWxlZ2F0ZSB9ID0gdGltZW91dFByb3ZpZGVyO1xuICAgIHJldHVybiAoZGVsZWdhdGU/LnNldFRpbWVvdXQgfHwgc2V0VGltZW91dCkoLi4uYXJncyk7XG4gIH0sXG4gIGNsZWFyVGltZW91dChoYW5kbGUpIHtcbiAgICBjb25zdCB7IGRlbGVnYXRlIH0gPSB0aW1lb3V0UHJvdmlkZXI7XG4gICAgcmV0dXJuIChkZWxlZ2F0ZT8uY2xlYXJUaW1lb3V0IHx8IGNsZWFyVGltZW91dCkoaGFuZGxlKTtcbiAgfSxcbiAgZGVsZWdhdGU6IHVuZGVmaW5lZCxcbn07XG4iLCJleHBvcnQgZnVuY3Rpb24gZ2V0U3ltYm9sSXRlcmF0b3IoKTogc3ltYm9sIHtcbiAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICdmdW5jdGlvbicgfHwgIVN5bWJvbC5pdGVyYXRvcikge1xuICAgIHJldHVybiAnQEBpdGVyYXRvcicgYXMgYW55O1xuICB9XG5cbiAgcmV0dXJuIFN5bWJvbC5pdGVyYXRvcjtcbn1cblxuZXhwb3J0IGNvbnN0IGl0ZXJhdG9yID0gZ2V0U3ltYm9sSXRlcmF0b3IoKTtcbiIsIi8qKiBTeW1ib2wub2JzZXJ2YWJsZSBvciBhIHN0cmluZyBcIkBAb2JzZXJ2YWJsZVwiLiBVc2VkIGZvciBpbnRlcm9wICovXG5leHBvcnQgY29uc3Qgb2JzZXJ2YWJsZTogc3RyaW5nIHwgc3ltYm9sID0gKCgpID0+ICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5vYnNlcnZhYmxlKSB8fCAnQEBvYnNlcnZhYmxlJykoKTtcbiIsImltcG9ydCB7IGNyZWF0ZUVycm9yQ2xhc3MgfSBmcm9tICcuL2NyZWF0ZUVycm9yQ2xhc3MnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVuc3Vic2NyaXB0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHJlYWRvbmx5IGVycm9yczogYW55W107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5zdWJzY3JpcHRpb25FcnJvckN0b3Ige1xuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gZGV0YWlsLiBEbyBub3QgY29uc3RydWN0IGVycm9yIGluc3RhbmNlcy5cbiAgICogQ2Fubm90IGJlIHRhZ2dlZCBhcyBpbnRlcm5hbDogaHR0cHM6Ly9naXRodWIuY29tL1JlYWN0aXZlWC9yeGpzL2lzc3Vlcy82MjY5XG4gICAqL1xuICBuZXcgKGVycm9yczogYW55W10pOiBVbnN1YnNjcmlwdGlvbkVycm9yO1xufVxuXG4vKipcbiAqIEFuIGVycm9yIHRocm93biB3aGVuIG9uZSBvciBtb3JlIGVycm9ycyBoYXZlIG9jY3VycmVkIGR1cmluZyB0aGVcbiAqIGB1bnN1YnNjcmliZWAgb2YgYSB7QGxpbmsgU3Vic2NyaXB0aW9ufS5cbiAqL1xuZXhwb3J0IGNvbnN0IFVuc3Vic2NyaXB0aW9uRXJyb3I6IFVuc3Vic2NyaXB0aW9uRXJyb3JDdG9yID0gY3JlYXRlRXJyb3JDbGFzcyhcbiAgKF9zdXBlcikgPT5cbiAgICBmdW5jdGlvbiBVbnN1YnNjcmlwdGlvbkVycm9ySW1wbCh0aGlzOiBhbnksIGVycm9yczogKEVycm9yIHwgc3RyaW5nKVtdKSB7XG4gICAgICBfc3VwZXIodGhpcyk7XG4gICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvcnNcbiAgICAgICAgPyBgJHtlcnJvcnMubGVuZ3RofSBlcnJvcnMgb2NjdXJyZWQgZHVyaW5nIHVuc3Vic2NyaXB0aW9uOlxuJHtlcnJvcnMubWFwKChlcnIsIGkpID0+IGAke2kgKyAxfSkgJHtlcnIudG9TdHJpbmcoKX1gKS5qb2luKCdcXG4gICcpfWBcbiAgICAgICAgOiAnJztcbiAgICAgIHRoaXMubmFtZSA9ICdVbnN1YnNjcmlwdGlvbkVycm9yJztcbiAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xuICAgIH1cbik7XG4iLCJpbXBvcnQgeyBTY2hlZHVsZXJMaWtlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vaXNGdW5jdGlvbic7XG5pbXBvcnQgeyBpc1NjaGVkdWxlciB9IGZyb20gJy4vaXNTY2hlZHVsZXInO1xuXG5mdW5jdGlvbiBsYXN0PFQ+KGFycjogVFtdKTogVCB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiBhcnJbYXJyLmxlbmd0aCAtIDFdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcG9wUmVzdWx0U2VsZWN0b3IoYXJnczogYW55W10pOiAoKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93bikgfCB1bmRlZmluZWQge1xuICByZXR1cm4gaXNGdW5jdGlvbihsYXN0KGFyZ3MpKSA/IGFyZ3MucG9wKCkgOiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3BTY2hlZHVsZXIoYXJnczogYW55W10pOiBTY2hlZHVsZXJMaWtlIHwgdW5kZWZpbmVkIHtcbiAgcmV0dXJuIGlzU2NoZWR1bGVyKGxhc3QoYXJncykpID8gYXJncy5wb3AoKSA6IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvcE51bWJlcihhcmdzOiBhbnlbXSwgZGVmYXVsdFZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gdHlwZW9mIGxhc3QoYXJncykgPT09ICdudW1iZXInID8gYXJncy5wb3AoKSEgOiBkZWZhdWx0VmFsdWU7XG59XG4iLCIvKipcbiAqIFJlbW92ZXMgYW4gaXRlbSBmcm9tIGFuIGFycmF5LCBtdXRhdGluZyBpdC5cbiAqIEBwYXJhbSBhcnIgVGhlIGFycmF5IHRvIHJlbW92ZSB0aGUgaXRlbSBmcm9tXG4gKiBAcGFyYW0gaXRlbSBUaGUgaXRlbSB0byByZW1vdmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFyclJlbW92ZTxUPihhcnI6IFRbXSB8IHVuZGVmaW5lZCB8IG51bGwsIGl0ZW06IFQpIHtcbiAgaWYgKGFycikge1xuICAgIGNvbnN0IGluZGV4ID0gYXJyLmluZGV4T2YoaXRlbSk7XG4gICAgMCA8PSBpbmRleCAmJiBhcnIuc3BsaWNlKGluZGV4LCAxKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgU3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IFNjaGVkdWxlckFjdGlvbiwgU2NoZWR1bGVyTGlrZSB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNhdWdodFNjaGVkdWxlKFxuICBzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPGFueT4sXG4gIHNjaGVkdWxlcjogU2NoZWR1bGVyTGlrZSxcbiAgZXhlY3V0ZTogKHRoaXM6IFNjaGVkdWxlckFjdGlvbjxhbnk+KSA9PiB2b2lkLFxuICBkZWxheSA9IDBcbik6IFN1YnNjcmlwdGlvbiB7XG4gIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGV4ZWN1dGUuY2FsbCh0aGlzKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICB9XG4gIH0sIGRlbGF5KTtcbiAgc3Vic2NyaWJlci5hZGQoc3Vic2NyaXB0aW9uKTtcbiAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbn1cbiIsIi8qKlxuICogVXNlZCB0byBjcmVhdGUgRXJyb3Igc3ViY2xhc3NlcyB1bnRpbCB0aGUgY29tbXVuaXR5IG1vdmVzIGF3YXkgZnJvbSBFUzUuXG4gKlxuICogVGhpcyBpcyBiZWNhdXNlIGNvbXBpbGluZyBmcm9tIFR5cGVTY3JpcHQgZG93biB0byBFUzUgaGFzIGlzc3VlcyB3aXRoIHN1YmNsYXNzaW5nIEVycm9yc1xuICogYXMgd2VsbCBhcyBvdGhlciBidWlsdC1pbiB0eXBlczogaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xMjEyM1xuICpcbiAqIEBwYXJhbSBjcmVhdGVJbXBsIEEgZmFjdG9yeSBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGFjdHVhbCBjb25zdHJ1Y3RvciBpbXBsZW1lbnRhdGlvbi4gVGhlIHJldHVybmVkXG4gKiBmdW5jdGlvbiBzaG91bGQgYmUgYSBuYW1lZCBmdW5jdGlvbiB0aGF0IGNhbGxzIGBfc3VwZXJgIGludGVybmFsbHkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFcnJvckNsYXNzPFQ+KGNyZWF0ZUltcGw6IChfc3VwZXI6IGFueSkgPT4gYW55KTogVCB7XG4gIGNvbnN0IF9zdXBlciA9IChpbnN0YW5jZTogYW55KSA9PiB7XG4gICAgRXJyb3IuY2FsbChpbnN0YW5jZSk7XG4gICAgaW5zdGFuY2Uuc3RhY2sgPSBuZXcgRXJyb3IoKS5zdGFjaztcbiAgfTtcblxuICBjb25zdCBjdG9yRnVuYyA9IGNyZWF0ZUltcGwoX3N1cGVyKTtcbiAgY3RvckZ1bmMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBjdG9yRnVuYy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjdG9yRnVuYztcbiAgcmV0dXJuIGN0b3JGdW5jO1xufVxuIiwiaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi4vY29uZmlnJztcblxubGV0IGNvbnRleHQ6IHsgZXJyb3JUaHJvd246IGJvb2xlYW47IGVycm9yOiBhbnkgfSB8IG51bGwgPSBudWxsO1xuXG4vKipcbiAqIEhhbmRsZXMgZGVhbGluZyB3aXRoIGVycm9ycyBmb3Igc3VwZXItZ3Jvc3MgbW9kZS4gQ3JlYXRlcyBhIGNvbnRleHQsIGluIHdoaWNoXG4gKiBhbnkgc3luY2hyb25vdXNseSB0aHJvd24gZXJyb3JzIHdpbGwgYmUgcGFzc2VkIHRvIHtAbGluayBjYXB0dXJlRXJyb3J9LiBXaGljaFxuICogd2lsbCByZWNvcmQgdGhlIGVycm9yIHN1Y2ggdGhhdCBpdCB3aWxsIGJlIHJldGhyb3duIGFmdGVyIHRoZSBjYWxsIGJhY2sgaXMgY29tcGxldGUuXG4gKiBUT0RPOiBSZW1vdmUgaW4gdjhcbiAqIEBwYXJhbSBjYiBBbiBpbW1lZGlhdGVseSBleGVjdXRlZCBmdW5jdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9yQ29udGV4dChjYjogKCkgPT4gdm9pZCkge1xuICBpZiAoY29uZmlnLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpIHtcbiAgICBjb25zdCBpc1Jvb3QgPSAhY29udGV4dDtcbiAgICBpZiAoaXNSb290KSB7XG4gICAgICBjb250ZXh0ID0geyBlcnJvclRocm93bjogZmFsc2UsIGVycm9yOiBudWxsIH07XG4gICAgfVxuICAgIGNiKCk7XG4gICAgaWYgKGlzUm9vdCkge1xuICAgICAgY29uc3QgeyBlcnJvclRocm93biwgZXJyb3IgfSA9IGNvbnRleHQhO1xuICAgICAgY29udGV4dCA9IG51bGw7XG4gICAgICBpZiAoZXJyb3JUaHJvd24pIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIFRoaXMgaXMgdGhlIGdlbmVyYWwgbm9uLWRlcHJlY2F0ZWQgcGF0aCBmb3IgZXZlcnlvbmUgdGhhdFxuICAgIC8vIGlzbid0IGNyYXp5IGVub3VnaCB0byB1c2Ugc3VwZXItZ3Jvc3MgbW9kZSAodXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZylcbiAgICBjYigpO1xuICB9XG59XG5cbi8qKlxuICogQ2FwdHVyZXMgZXJyb3JzIG9ubHkgaW4gc3VwZXItZ3Jvc3MgbW9kZS5cbiAqIEBwYXJhbSBlcnIgdGhlIGVycm9yIHRvIGNhcHR1cmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhcHR1cmVFcnJvcihlcnI6IGFueSkge1xuICBpZiAoY29uZmlnLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcgJiYgY29udGV4dCkge1xuICAgIGNvbnRleHQuZXJyb3JUaHJvd24gPSB0cnVlO1xuICAgIGNvbnRleHQuZXJyb3IgPSBlcnI7XG4gIH1cbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBpZGVudGl0eTxUPih4OiBUKTogVCB7XG4gIHJldHVybiB4O1xufVxuIiwiZXhwb3J0IGNvbnN0IGlzQXJyYXlMaWtlID0gKDxUPih4OiBhbnkpOiB4IGlzIEFycmF5TGlrZTxUPiA9PiB4ICYmIHR5cGVvZiB4Lmxlbmd0aCA9PT0gJ251bWJlcicgJiYgdHlwZW9mIHggIT09ICdmdW5jdGlvbicpOyIsImltcG9ydCB7IGlzRnVuY3Rpb24gfSBmcm9tICcuL2lzRnVuY3Rpb24nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNBc3luY0l0ZXJhYmxlPFQ+KG9iajogYW55KTogb2JqIGlzIEFzeW5jSXRlcmFibGU8VD4ge1xuICByZXR1cm4gU3ltYm9sLmFzeW5jSXRlcmF0b3IgJiYgaXNGdW5jdGlvbihvYmo/LltTeW1ib2wuYXN5bmNJdGVyYXRvcl0pO1xufVxuIiwiLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIG9iamVjdCBpcyBhIGZ1bmN0aW9uLlxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVja1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZTogYW55KTogdmFsdWUgaXMgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nO1xufVxuIiwiaW1wb3J0IHsgSW50ZXJvcE9ic2VydmFibGUgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBvYnNlcnZhYmxlIGFzIFN5bWJvbF9vYnNlcnZhYmxlIH0gZnJvbSAnLi4vc3ltYm9sL29ic2VydmFibGUnO1xuaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vaXNGdW5jdGlvbic7XG5cbi8qKiBJZGVudGlmaWVzIGFuIGlucHV0IGFzIGJlaW5nIE9ic2VydmFibGUgKGJ1dCBub3QgbmVjZXNzYXJ5IGFuIFJ4IE9ic2VydmFibGUpICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbnRlcm9wT2JzZXJ2YWJsZShpbnB1dDogYW55KTogaW5wdXQgaXMgSW50ZXJvcE9ic2VydmFibGU8YW55PiB7XG4gIHJldHVybiBpc0Z1bmN0aW9uKGlucHV0W1N5bWJvbF9vYnNlcnZhYmxlXSk7XG59XG4iLCJpbXBvcnQgeyBpdGVyYXRvciBhcyBTeW1ib2xfaXRlcmF0b3IgfSBmcm9tICcuLi9zeW1ib2wvaXRlcmF0b3InO1xuaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vaXNGdW5jdGlvbic7XG5cbi8qKiBJZGVudGlmaWVzIGFuIGlucHV0IGFzIGJlaW5nIGFuIEl0ZXJhYmxlICovXG5leHBvcnQgZnVuY3Rpb24gaXNJdGVyYWJsZShpbnB1dDogYW55KTogaW5wdXQgaXMgSXRlcmFibGU8YW55PiB7XG4gIHJldHVybiBpc0Z1bmN0aW9uKGlucHV0Py5bU3ltYm9sX2l0ZXJhdG9yXSk7XG59XG4iLCJpbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSBcIi4vaXNGdW5jdGlvblwiO1xuXG4vKipcbiAqIFRlc3RzIHRvIHNlZSBpZiB0aGUgb2JqZWN0IGlzIFwidGhlbm5hYmxlXCIuXG4gKiBAcGFyYW0gdmFsdWUgdGhlIG9iamVjdCB0byB0ZXN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb21pc2UodmFsdWU6IGFueSk6IHZhbHVlIGlzIFByb21pc2VMaWtlPGFueT4ge1xuICByZXR1cm4gaXNGdW5jdGlvbih2YWx1ZT8udGhlbik7XG59XG4iLCJpbXBvcnQgeyBSZWFkYWJsZVN0cmVhbUxpa2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi9pc0Z1bmN0aW9uJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uKiByZWFkYWJsZVN0cmVhbUxpa2VUb0FzeW5jR2VuZXJhdG9yPFQ+KHJlYWRhYmxlU3RyZWFtOiBSZWFkYWJsZVN0cmVhbUxpa2U8VD4pOiBBc3luY0dlbmVyYXRvcjxUPiB7XG4gIGNvbnN0IHJlYWRlciA9IHJlYWRhYmxlU3RyZWFtLmdldFJlYWRlcigpO1xuICB0cnkge1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgeWllbGQgdmFsdWUhO1xuICAgIH1cbiAgfSBmaW5hbGx5IHtcbiAgICByZWFkZXIucmVsZWFzZUxvY2soKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZWFkYWJsZVN0cmVhbUxpa2U8VD4ob2JqOiBhbnkpOiBvYmogaXMgUmVhZGFibGVTdHJlYW1MaWtlPFQ+IHtcbiAgLy8gV2UgZG9uJ3Qgd2FudCB0byB1c2UgaW5zdGFuY2VvZiBjaGVja3MgYmVjYXVzZSB0aGV5IHdvdWxkIHJldHVyblxuICAvLyBmYWxzZSBmb3IgaW5zdGFuY2VzIGZyb20gYW5vdGhlciBSZWFsbSwgbGlrZSBhbiA8aWZyYW1lPi5cbiAgcmV0dXJuIGlzRnVuY3Rpb24ob2JqPy5nZXRSZWFkZXIpO1xufVxuIiwiaW1wb3J0IHsgU2NoZWR1bGVyTGlrZSB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IGlzRnVuY3Rpb24gfSBmcm9tICcuL2lzRnVuY3Rpb24nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNTY2hlZHVsZXIodmFsdWU6IGFueSk6IHZhbHVlIGlzIFNjaGVkdWxlckxpa2Uge1xuICByZXR1cm4gdmFsdWUgJiYgaXNGdW5jdGlvbih2YWx1ZS5zY2hlZHVsZSk7XG59XG4iLCIvKiB0c2xpbnQ6ZGlzYWJsZTpuby1lbXB0eSAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vb3AoKSB7IH1cbiIsImltcG9ydCB7IGlkZW50aXR5IH0gZnJvbSAnLi9pZGVudGl0eSc7XG5pbXBvcnQgeyBVbmFyeUZ1bmN0aW9uIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgZnVuY3Rpb24gcGlwZSgpOiB0eXBlb2YgaWRlbnRpdHk7XG5leHBvcnQgZnVuY3Rpb24gcGlwZTxULCBBPihmbjE6IFVuYXJ5RnVuY3Rpb248VCwgQT4pOiBVbmFyeUZ1bmN0aW9uPFQsIEE+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQj4oZm4xOiBVbmFyeUZ1bmN0aW9uPFQsIEE+LCBmbjI6IFVuYXJ5RnVuY3Rpb248QSwgQj4pOiBVbmFyeUZ1bmN0aW9uPFQsIEI+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQiwgQz4oZm4xOiBVbmFyeUZ1bmN0aW9uPFQsIEE+LCBmbjI6IFVuYXJ5RnVuY3Rpb248QSwgQj4sIGZuMzogVW5hcnlGdW5jdGlvbjxCLCBDPik6IFVuYXJ5RnVuY3Rpb248VCwgQz47XG5leHBvcnQgZnVuY3Rpb24gcGlwZTxULCBBLCBCLCBDLCBEPihcbiAgZm4xOiBVbmFyeUZ1bmN0aW9uPFQsIEE+LFxuICBmbjI6IFVuYXJ5RnVuY3Rpb248QSwgQj4sXG4gIGZuMzogVW5hcnlGdW5jdGlvbjxCLCBDPixcbiAgZm40OiBVbmFyeUZ1bmN0aW9uPEMsIEQ+XG4pOiBVbmFyeUZ1bmN0aW9uPFQsIEQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQiwgQywgRCwgRT4oXG4gIGZuMTogVW5hcnlGdW5jdGlvbjxULCBBPixcbiAgZm4yOiBVbmFyeUZ1bmN0aW9uPEEsIEI+LFxuICBmbjM6IFVuYXJ5RnVuY3Rpb248QiwgQz4sXG4gIGZuNDogVW5hcnlGdW5jdGlvbjxDLCBEPixcbiAgZm41OiBVbmFyeUZ1bmN0aW9uPEQsIEU+XG4pOiBVbmFyeUZ1bmN0aW9uPFQsIEU+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQiwgQywgRCwgRSwgRj4oXG4gIGZuMTogVW5hcnlGdW5jdGlvbjxULCBBPixcbiAgZm4yOiBVbmFyeUZ1bmN0aW9uPEEsIEI+LFxuICBmbjM6IFVuYXJ5RnVuY3Rpb248QiwgQz4sXG4gIGZuNDogVW5hcnlGdW5jdGlvbjxDLCBEPixcbiAgZm41OiBVbmFyeUZ1bmN0aW9uPEQsIEU+LFxuICBmbjY6IFVuYXJ5RnVuY3Rpb248RSwgRj5cbik6IFVuYXJ5RnVuY3Rpb248VCwgRj47XG5leHBvcnQgZnVuY3Rpb24gcGlwZTxULCBBLCBCLCBDLCBELCBFLCBGLCBHPihcbiAgZm4xOiBVbmFyeUZ1bmN0aW9uPFQsIEE+LFxuICBmbjI6IFVuYXJ5RnVuY3Rpb248QSwgQj4sXG4gIGZuMzogVW5hcnlGdW5jdGlvbjxCLCBDPixcbiAgZm40OiBVbmFyeUZ1bmN0aW9uPEMsIEQ+LFxuICBmbjU6IFVuYXJ5RnVuY3Rpb248RCwgRT4sXG4gIGZuNjogVW5hcnlGdW5jdGlvbjxFLCBGPixcbiAgZm43OiBVbmFyeUZ1bmN0aW9uPEYsIEc+XG4pOiBVbmFyeUZ1bmN0aW9uPFQsIEc+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQiwgQywgRCwgRSwgRiwgRywgSD4oXG4gIGZuMTogVW5hcnlGdW5jdGlvbjxULCBBPixcbiAgZm4yOiBVbmFyeUZ1bmN0aW9uPEEsIEI+LFxuICBmbjM6IFVuYXJ5RnVuY3Rpb248QiwgQz4sXG4gIGZuNDogVW5hcnlGdW5jdGlvbjxDLCBEPixcbiAgZm41OiBVbmFyeUZ1bmN0aW9uPEQsIEU+LFxuICBmbjY6IFVuYXJ5RnVuY3Rpb248RSwgRj4sXG4gIGZuNzogVW5hcnlGdW5jdGlvbjxGLCBHPixcbiAgZm44OiBVbmFyeUZ1bmN0aW9uPEcsIEg+XG4pOiBVbmFyeUZ1bmN0aW9uPFQsIEg+O1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGU8VCwgQSwgQiwgQywgRCwgRSwgRiwgRywgSCwgST4oXG4gIGZuMTogVW5hcnlGdW5jdGlvbjxULCBBPixcbiAgZm4yOiBVbmFyeUZ1bmN0aW9uPEEsIEI+LFxuICBmbjM6IFVuYXJ5RnVuY3Rpb248QiwgQz4sXG4gIGZuNDogVW5hcnlGdW5jdGlvbjxDLCBEPixcbiAgZm41OiBVbmFyeUZ1bmN0aW9uPEQsIEU+LFxuICBmbjY6IFVuYXJ5RnVuY3Rpb248RSwgRj4sXG4gIGZuNzogVW5hcnlGdW5jdGlvbjxGLCBHPixcbiAgZm44OiBVbmFyeUZ1bmN0aW9uPEcsIEg+LFxuICBmbjk6IFVuYXJ5RnVuY3Rpb248SCwgST5cbik6IFVuYXJ5RnVuY3Rpb248VCwgST47XG5leHBvcnQgZnVuY3Rpb24gcGlwZTxULCBBLCBCLCBDLCBELCBFLCBGLCBHLCBILCBJPihcbiAgZm4xOiBVbmFyeUZ1bmN0aW9uPFQsIEE+LFxuICBmbjI6IFVuYXJ5RnVuY3Rpb248QSwgQj4sXG4gIGZuMzogVW5hcnlGdW5jdGlvbjxCLCBDPixcbiAgZm40OiBVbmFyeUZ1bmN0aW9uPEMsIEQ+LFxuICBmbjU6IFVuYXJ5RnVuY3Rpb248RCwgRT4sXG4gIGZuNjogVW5hcnlGdW5jdGlvbjxFLCBGPixcbiAgZm43OiBVbmFyeUZ1bmN0aW9uPEYsIEc+LFxuICBmbjg6IFVuYXJ5RnVuY3Rpb248RywgSD4sXG4gIGZuOTogVW5hcnlGdW5jdGlvbjxILCBJPixcbiAgLi4uZm5zOiBVbmFyeUZ1bmN0aW9uPGFueSwgYW55PltdXG4pOiBVbmFyeUZ1bmN0aW9uPFQsIHVua25vd24+O1xuXG5leHBvcnQgZnVuY3Rpb24gcGlwZSguLi5mbnM6IEFycmF5PFVuYXJ5RnVuY3Rpb248YW55LCBhbnk+Pik6IFVuYXJ5RnVuY3Rpb248YW55LCBhbnk+IHtcbiAgcmV0dXJuIHBpcGVGcm9tQXJyYXkoZm5zKTtcbn1cblxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBpcGVGcm9tQXJyYXk8VCwgUj4oZm5zOiBBcnJheTxVbmFyeUZ1bmN0aW9uPFQsIFI+Pik6IFVuYXJ5RnVuY3Rpb248VCwgUj4ge1xuICBpZiAoZm5zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBpZGVudGl0eSBhcyBVbmFyeUZ1bmN0aW9uPGFueSwgYW55PjtcbiAgfVxuXG4gIGlmIChmbnMubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIGZuc1swXTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiBwaXBlZChpbnB1dDogVCk6IFIge1xuICAgIHJldHVybiBmbnMucmVkdWNlKChwcmV2OiBhbnksIGZuOiBVbmFyeUZ1bmN0aW9uPFQsIFI+KSA9PiBmbihwcmV2KSwgaW5wdXQgYXMgYW55KTtcbiAgfTtcbn1cbiIsImltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4uL2NvbmZpZyc7XG5pbXBvcnQgeyB0aW1lb3V0UHJvdmlkZXIgfSBmcm9tICcuLi9zY2hlZHVsZXIvdGltZW91dFByb3ZpZGVyJztcblxuLyoqXG4gKiBIYW5kbGVzIGFuIGVycm9yIG9uIGFub3RoZXIgam9iIGVpdGhlciB3aXRoIHRoZSB1c2VyLWNvbmZpZ3VyZWQge0BsaW5rIG9uVW5oYW5kbGVkRXJyb3J9LFxuICogb3IgYnkgdGhyb3dpbmcgaXQgb24gdGhhdCBuZXcgam9iIHNvIGl0IGNhbiBiZSBwaWNrZWQgdXAgYnkgYHdpbmRvdy5vbmVycm9yYCwgYHByb2Nlc3Mub24oJ2Vycm9yJylgLCBldGMuXG4gKlxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHRoZXJlIGlzIGFuIGVycm9yIHRoYXQgaXMgb3V0LW9mLWJhbmQgd2l0aCB0aGUgc3Vic2NyaXB0aW9uXG4gKiBvciB3aGVuIGFuIGVycm9yIGhpdHMgYSB0ZXJtaW5hbCBib3VuZGFyeSBvZiB0aGUgc3Vic2NyaXB0aW9uIGFuZCBubyBlcnJvciBoYW5kbGVyIHdhcyBwcm92aWRlZC5cbiAqXG4gKiBAcGFyYW0gZXJyIHRoZSBlcnJvciB0byByZXBvcnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlcG9ydFVuaGFuZGxlZEVycm9yKGVycjogYW55KSB7XG4gIHRpbWVvdXRQcm92aWRlci5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICBjb25zdCB7IG9uVW5oYW5kbGVkRXJyb3IgfSA9IGNvbmZpZztcbiAgICBpZiAob25VbmhhbmRsZWRFcnJvcikge1xuICAgICAgLy8gRXhlY3V0ZSB0aGUgdXNlci1jb25maWd1cmVkIGVycm9yIGhhbmRsZXIuXG4gICAgICBvblVuaGFuZGxlZEVycm9yKGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFRocm93IHNvIGl0IGlzIHBpY2tlZCB1cCBieSB0aGUgcnVudGltZSdzIHVuY2F1Z2h0IGVycm9yIG1lY2hhbmlzbS5cbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH0pO1xufVxuIiwiLyoqXG4gKiBDcmVhdGVzIHRoZSBUeXBlRXJyb3IgdG8gdGhyb3cgaWYgYW4gaW52YWxpZCBvYmplY3QgaXMgcGFzc2VkIHRvIGBmcm9tYCBvciBgc2NoZWR1bGVkYC5cbiAqIEBwYXJhbSBpbnB1dCBUaGUgb2JqZWN0IHRoYXQgd2FzIHBhc3NlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludmFsaWRPYnNlcnZhYmxlVHlwZUVycm9yKGlucHV0OiBhbnkpIHtcbiAgLy8gVE9ETzogV2Ugc2hvdWxkIGNyZWF0ZSBlcnJvciBjb2RlcyB0aGF0IGNhbiBiZSBsb29rZWQgdXAsIHNvIHRoaXMgY2FuIGJlIGxlc3MgdmVyYm9zZS5cbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXG4gICAgYFlvdSBwcm92aWRlZCAke1xuICAgICAgaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ID09PSAnb2JqZWN0JyA/ICdhbiBpbnZhbGlkIG9iamVjdCcgOiBgJyR7aW5wdXR9J2BcbiAgICB9IHdoZXJlIGEgc3RyZWFtIHdhcyBleHBlY3RlZC4gWW91IGNhbiBwcm92aWRlIGFuIE9ic2VydmFibGUsIFByb21pc2UsIFJlYWRhYmxlU3RyZWFtLCBBcnJheSwgQXN5bmNJdGVyYWJsZSwgb3IgSXRlcmFibGUuYFxuICApO1xufVxuIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcclxufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBvW2syXSA9IG1ba107XHJcbn0pO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20pIHtcclxuICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGZyb20ubGVuZ3RoLCBqID0gdG8ubGVuZ3RoOyBpIDwgaWw7IGkrKywgaisrKVxyXG4gICAgICAgIHRvW2pdID0gZnJvbVtpXTtcclxuICAgIHJldHVybiB0bztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgcHJpdmF0ZU1hcCkge1xyXG4gICAgaWYgKCFwcml2YXRlTWFwLmhhcyhyZWNlaXZlcikpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIGdldCBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwcml2YXRlTWFwLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBwcml2YXRlTWFwLCB2YWx1ZSkge1xyXG4gICAgaWYgKCFwcml2YXRlTWFwLmhhcyhyZWNlaXZlcikpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHNldCBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcclxuICAgIH1cclxuICAgIHByaXZhdGVNYXAuc2V0KHJlY2VpdmVyLCB2YWx1ZSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuIiwiaW1wb3J0IHsgQmFzZVBsdWdpbiB9IGZyb20gXCIuL2luZGV4XCI7XG5leHBvcnQgY2xhc3MgQXVkaW9QbHVnaW4gZXh0ZW5kcyBCYXNlUGx1Z2luIHtcbiAgICBjb25zdHJ1Y3RvcihmYWN0b3J5LCBwbHVnaW5Pd25lciwgcHJvdG90eXBlT2JqZWN0KSB7XG4gICAgICAgIHN1cGVyKGZhY3RvcnksIHBsdWdpbk93bmVyLCBwcm90b3R5cGVPYmplY3QpO1xuICAgICAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5O1xuICAgICAgICB0aGlzLnByb3RvdHlwZU9iamVjdCA9IHByb3RvdHlwZU9iamVjdDtcbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgTGlua2VkU3RvcmVJbnRlcmZhY2Uge1xuICAgIGNvbnN0cnVjdG9yKG93bmVyLCBsaW5rZWRTdG9yZSkge1xuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgIHRoaXMubGlua2VkU3RvcmUgPSBsaW5rZWRTdG9yZTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGxpbmtlZFN0b3JlLmFkZEV2ZW50TGlzdGVuZXIoXCJhbHRlcmVkXCIsIHRoaXMpO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChlKSB7XG4gICAgICAgIGNvbnN0IHRlcm0gPSBlLmRldGFpbC50ZXJtO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGUuZGV0YWlsLnZhbHVlO1xuICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnNbdGVybV0gJiYgdHlwZW9mIHRoaXMubGlzdGVuZXJzW3Rlcm1dID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNbdGVybV0uY2FsbCh0aGlzLm93bmVyLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5saW5rZWRTdG9yZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiYWx0ZXJlZFwiLCB0aGlzKTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMuY2xlYXIoKTtcbiAgICB9XG4gICAgcmVxdWVzdFRlcm0odGVybSkge1xuICAgICAgICByZXR1cm4gdGhpcy5saW5rZWRTdG9yZS5nZXRUZXJtKHRlcm0pO1xuICAgIH1cbiAgICBsaXN0ZW5Gb3JUZXJtKHRlcm0sIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5oYXNPd25Qcm9wZXJ0eSh0ZXJtKSkge1xuICAgICAgICAgICAgdGhyb3cgXCJMaXN0ZW5lciBhbHJlYWR5IGV4aXN0c1wiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnNldCh0ZXJtLCBjYWxsYmFjayk7XG4gICAgfVxuICAgIHJlbGVhc2VMaXN0ZW5lckZvclRlcm0odGVybSkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5kZWxldGUodGVybSk7XG4gICAgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuaW1wb3J0IHsgTnVtYmVyUGFyYW1ldGVyIH0gZnJvbSBcIi4vcGFyYW1ldGVycy9OdW1iZXJQYXJhbWV0ZXJcIjtcbmltcG9ydCB7IFN0cmluZ1BhcmFtZXRlciB9IGZyb20gXCIuL3BhcmFtZXRlcnMvU3RyaW5nUGFyYW1ldGVyXCI7XG5pbXBvcnQgeyBCdXR0b25QYXJhbWV0ZXIgfSBmcm9tIFwiLi9wYXJhbWV0ZXJzL0J1dHRvblBhcmFtZXRlclwiO1xuaW1wb3J0IHsgU3dpdGNoUGFyYW1ldGVyIH0gZnJvbSBcIi4vcGFyYW1ldGVycy9Td2l0Y2hQYXJhbWV0ZXJcIjtcbmltcG9ydCB7IExpc3RQYXJhbWV0ZXIgfSBmcm9tIFwiLi9wYXJhbWV0ZXJzL0xpc3RQYXJhbWV0ZXJcIjtcbmltcG9ydCB7IFVSTFBhcmFtZXRlciB9IGZyb20gXCIuL3BhcmFtZXRlcnMvVVJMUGFyYW1ldGVyXCI7XG5pbXBvcnQgeyBBc3NldFBhcmFtZXRlciB9IGZyb20gXCIuL3BhcmFtZXRlcnMvQXNzZXRQYXJhbWV0ZXJcIjtcbmltcG9ydCB7IGlzUGx1Z2luUGFyYW1ldGVyIH0gZnJvbSBcIi4vcGFyYW1ldGVycy9JUGx1Z2luUGFyYW1ldGVyXCI7XG5mdW5jdGlvbiBmb3JtYXRQYXJhbWV0ZXJOYW1lKG5hbWUpIHtcbiAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoXCIvXCIsIFwiX1wiKTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmV4cG9ydCBjbGFzcyBQYXJhbWV0ZXJNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3Rvcihvd25lciwgcGx1Z2luRXh0ZXJuYWxJbnRlcmZhY2UsIG5hbWUgPSBcImRlZmF1bHRcIiwgZXhwb3NlZCA9IHRydWUpIHtcbiAgICAgICAgdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICB0aGlzLnBsdWdpbkV4dGVybmFsSW50ZXJmYWNlID0gcGx1Z2luRXh0ZXJuYWxJbnRlcmZhY2U7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuZXhwb3NlZCA9IGV4cG9zZWQ7XG4gICAgICAgIHRoaXMucGFyYW1ldGVyTGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG4gICAgICAgIHRoaXMudmlzaWJsZU5hbWUgPSB0aGlzLm5hbWU7XG4gICAgfVxuICAgIGZpbmRQYXJhbWV0ZXIoYmFzZU5hbWUpIHtcbiAgICAgICAgbGV0IG5hbWUgPSBiYXNlTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9cIikuc3BsaXQoXCIuXCIpLnJldmVyc2UoKTtcbiAgICAgICAgY29uc3QgbG93ZXJDYXNlUGFyYW1ldGVyTmFtZXMgPSB0aGlzLnBhcmFtZXRlckxpc3QubWFwKGkgPT4gZm9ybWF0UGFyYW1ldGVyTmFtZShpLm5hbWUpKTtcbiAgICAgICAgY29uc3QgcGFyYW0gPSB0aGlzLnBhcmFtZXRlckxpc3RbbG93ZXJDYXNlUGFyYW1ldGVyTmFtZXMuaW5kZXhPZihuYW1lLnBvcCgpLnRvTG93ZXJDYXNlKCkpXTtcbiAgICAgICAgaWYgKHBhcmFtIGluc3RhbmNlb2YgUGFyYW1ldGVyTWFuYWdlciAmJiBuYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbS5nZXRQYXJhbWV0ZXJCeU5hbWUobmFtZS5yZXZlcnNlKCkuam9pbihcIi5cIikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzUGFyYW1ldGVyTmFtZUF2YWlsYWJsZShuYW1lKSB7XG4gICAgICAgIG5hbWUgPSBmb3JtYXRQYXJhbWV0ZXJOYW1lKG5hbWUpO1xuICAgICAgICBpZiAoIS9eXFx3KyggXFx3KykqKC1cXHcrKSooX1xcdyspKiQvLnRlc3QobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkludmFsaWQgc3RyaW5nIGZvciBuYW1lXCIsIG5hbWUsIFwiV2lsbCBub3QgZXhwb3NlIGFzIGRvdCBub3RhdGlvbnNcIik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmFtZSBpcyByZXNlcnZlZCBvciBhbHJlYWR5IGRlZmluZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGJ1aWxkUGFyYW1ldGVyT2JqZWN0KCkge1xuICAgICAgICBjb25zdCBvYmogPSB7fTtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJMaXN0LmZpbHRlcihmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgcmV0dXJuIHAuZXhwb3NlZDtcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgb2JqW2UubmFtZV0gPSBlLmdldFBhcmFtZXRlck9iamVjdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgYWRkUGFyYW1ldGVyKHBhcmFtKSB7XG4gICAgICAgIGlmIChwYXJhbS5uYW1lLmluY2x1ZGVzKFwiLlwiKSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiTmFtZSBjYW5ub3QgaW5jbHVkZSBhIHBlcmlvZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXhpc3RzID0gdGhpcy5wYXJhbWV0ZXJMaXN0LmZpbmRJbmRleChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUgPT09IHBhcmFtO1xuICAgICAgICB9LCBwYXJhbSk7XG4gICAgICAgIGlmIChleGlzdHMgPT09IC0xKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgcGFyYW0ubmFtZSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJhbVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnBhcmFtZXRlckxpc3QucHVzaChwYXJhbSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgIH1cbiAgICBhZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICByZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChlKSB7XG4gICAgICAgIGxldCBkZXRhaWwgPSBlLmRldGFpbDtcbiAgICAgICAgaWYgKGRldGFpbC51cGRhdGVJbnRlcmZhY2VzID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbkV4dGVybmFsSW50ZXJmYWNlLnVwZGF0ZUludGVyZmFjZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYW1lICE9PSBcImRlZmF1bHRcIikge1xuICAgICAgICAgICAgZGV0YWlsLnBhcmFtZXRlci5uYW1lID0gYCR7dGhpcy5uYW1lfS4ke2RldGFpbC5wYXJhbWV0ZXIubmFtZX1gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLnR5cGUgPT0gXCJwYXJhbWV0ZXJzZXRcIiAmJiBkZXRhaWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5ldmVudFRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInBhcmFtZXRlcnNldFwiLCB7IGRldGFpbDogZGV0YWlsIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmRlbGV0ZUFsbFBhcmFtZXRlcnMoKTtcbiAgICB9XG4gICAgY3JlYXRlTnVtYmVyUGFyYW1ldGVyKG5hbWUsIGRlZmF1bHRWYWx1ZSwgbWluaW11bSwgbWF4aW11bSwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCkge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJudW1iZXJcIiB8fCAobWluaW11bSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBtaW5pbXVtICE9PSBcIm51bWJlclwiKSB8fCAobWF4aW11bSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBtYXhpbXVtICE9PSBcIm51bWJlclwiKSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdG9TdHJpbmdGdW5jICE9IFwiZnVuY3Rpb25cIiAmJiB0b1N0cmluZ0Z1bmMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgKFwidG9TdHJpbmdGdW5jIG11c3QgYmUgYSBmdW5jdGlvbiBvciB1bmRlZmluZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKHRoaXMuaXNQYXJhbWV0ZXJOYW1lQXZhaWxhYmxlKG5hbWUpKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbSA9IG5ldyBOdW1iZXJQYXJhbWV0ZXIodGhpcy5vd25lciwgbmFtZSwgZGVmYXVsdFZhbHVlLCBtaW5pbXVtLCBtYXhpbXVtLCB0b1N0cmluZ0Z1bmMsIHZpc2libGVOYW1lLCBleHBvc2VkKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUGFyYW1ldGVyKHBhcmFtKTtcbiAgICAgICAgICAgIHBhcmFtLmFkZEV2ZW50TGlzdGVuZXIoXCJwYXJhbWV0ZXJzZXRcIiwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlU3RyaW5nUGFyYW1ldGVyKG5hbWUsIGRlZmF1bHRWYWx1ZSwgbWF4TGVuZ3RoLCB0b1N0cmluZ0Z1bmMsIHZpc2libGVOYW1lLCBleHBvc2VkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInN0cmluZ1wiIHx8IChtYXhMZW5ndGggIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgbWF4TGVuZ3RoICE9PSBcIm51bWJlclwiKSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdG9TdHJpbmdGdW5jICE9IFwiZnVuY3Rpb25cIiAmJiB0b1N0cmluZ0Z1bmMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgKFwidG9TdHJpbmdGdW5jIG11c3QgYmUgYSBmdW5jdGlvbiBvciB1bmRlZmluZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKHRoaXMuaXNQYXJhbWV0ZXJOYW1lQXZhaWxhYmxlKG5hbWUpKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW0gPSBuZXcgU3RyaW5nUGFyYW1ldGVyKHRoaXMub3duZXIsIG5hbWUsIGRlZmF1bHRWYWx1ZSwgbWF4TGVuZ3RoLCB0b1N0cmluZ0Z1bmMsIHZpc2libGVOYW1lLCBleHBvc2VkKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUGFyYW1ldGVyKHBhcmFtKTtcbiAgICAgICAgICAgIHBhcmFtLmFkZEV2ZW50TGlzdGVuZXIoXCJwYXJhbWV0ZXJzZXRcIiwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlQnV0dG9uUGFyYW1ldGVyKG5hbWUsIHZpc2libGVOYW1lLCBleHBvc2VkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBjb25zdHJ1Y3RvclwiKTtcbiAgICAgICAgfVxuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAodGhpcy5pc1BhcmFtZXRlck5hbWVBdmFpbGFibGUobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtID0gbmV3IEJ1dHRvblBhcmFtZXRlcih0aGlzLm93bmVyLCBuYW1lLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgICAgICB0aGlzLmFkZFBhcmFtZXRlcihwYXJhbSk7XG4gICAgICAgICAgICBwYXJhbS5hZGRFdmVudExpc3RlbmVyKFwicGFyYW1ldGVyc2V0XCIsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVN3aXRjaFBhcmFtZXRlcihuYW1lLCBkZWZhdWx0VmFsdWUsIG1pblN0YXRlLCBtYXhTdGF0ZSwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCkge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgbWluU3RhdGUgIT09IFwibnVtYmVyXCIgfHwgdHlwZW9mIG1heFN0YXRlICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJJbnZsaWQgY29uc3RydWN0b3JcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB0b1N0cmluZ0Z1bmMgIT0gXCJmdW5jdGlvblwiICYmIHRvU3RyaW5nRnVuYyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJ0b1N0cmluZ0Z1bmMgbXVzdCBiZSBhIGZ1bmN0aW9uIG9yIHVuZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAodGhpcy5pc1BhcmFtZXRlck5hbWVBdmFpbGFibGUobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtID0gbmV3IFN3aXRjaFBhcmFtZXRlcih0aGlzLm93bmVyLCBuYW1lLCBkZWZhdWx0VmFsdWUsIG1pblN0YXRlLCBtYXhTdGF0ZSwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgICAgICB0aGlzLmFkZFBhcmFtZXRlcihwYXJhbSk7XG4gICAgICAgICAgICBwYXJhbS5hZGRFdmVudExpc3RlbmVyKFwicGFyYW1ldGVyc2V0XCIsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZUxpc3RQYXJhbWV0ZXIobmFtZSwgZGVmYXVsdFZhbHVlLCBsaXN0T2ZWYWx1ZXMsIHRvU3RyaW5nRnVuYywgdmlzaWJsZU5hbWUsIGV4cG9zZWQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBkZWZhdWx0VmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgIUFycmF5LmlzQXJyYXkobGlzdE9mVmFsdWVzKSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdG9TdHJpbmdGdW5jICE9IFwiZnVuY3Rpb25cIiAmJiB0b1N0cmluZ0Z1bmMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgKFwidG9TdHJpbmdGdW5jIG11c3QgYmUgYSBmdW5jdGlvbiBvciB1bmRlZmluZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3RPZlZhbHVlcy5pbmNsdWRlcyhkZWZhdWx0VmFsdWUpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yIC0gZGVmYXVsdCB2YWx1ZSBtaXNzaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICh0aGlzLmlzUGFyYW1ldGVyTmFtZUF2YWlsYWJsZShuYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgcGFyYW0gPSBuZXcgTGlzdFBhcmFtZXRlcih0aGlzLm93bmVyLCBuYW1lLCBkZWZhdWx0VmFsdWUsIGxpc3RPZlZhbHVlcywgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgICAgICB0aGlzLmFkZFBhcmFtZXRlcihwYXJhbSk7XG4gICAgICAgICAgICBwYXJhbS5hZGRFdmVudExpc3RlbmVyKFwicGFyYW1ldGVyc2V0XCIsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVVSTFBhcmFtZXRlcihuYW1lLCBkZWZhdWx0VmFsdWUsIG1heExlbmd0aCwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCkge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIgfHwgKG1heExlbmd0aCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBtYXhMZW5ndGggIT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJJbnZsaWQgY29uc3RydWN0b3JcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB0b1N0cmluZ0Z1bmMgIT0gXCJmdW5jdGlvblwiICYmIHRvU3RyaW5nRnVuYyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJ0b1N0cmluZ0Z1bmMgbXVzdCBiZSBhIGZ1bmN0aW9uIG9yIHVuZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAodGhpcy5pc1BhcmFtZXRlck5hbWVBdmFpbGFibGUobmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtID0gbmV3IFVSTFBhcmFtZXRlcih0aGlzLm93bmVyLCBuYW1lLCBkZWZhdWx0VmFsdWUsIG1heExlbmd0aCwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgICAgICB0aGlzLmFkZFBhcmFtZXRlcihwYXJhbSk7XG4gICAgICAgICAgICBwYXJhbS5hZGRFdmVudExpc3RlbmVyKFwicGFyYW1ldGVyc2V0XCIsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZUFzc2V0UGFyYW1ldGVyKG5hbWUsIHZpc2libGVOYW1lLCBleHBvc2VkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICh0aGlzLmlzUGFyYW1ldGVyTmFtZUF2YWlsYWJsZSh0aGlzKSkge1xuICAgICAgICAgICAgY29uc3QgcGFyYW0gPSBuZXcgQXNzZXRQYXJhbWV0ZXIodGhpcy5vd25lciwgbmFtZSwgdmlzaWJsZU5hbWUsIGV4cG9zZWQpO1xuICAgICAgICAgICAgdGhpcy5hZGRQYXJhbWV0ZXIocGFyYW0pO1xuICAgICAgICAgICAgcGFyYW0uYWRkRXZlbnRMaXN0ZW5lcihcInBhcmFtZXRlcnNldFwiLCB0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVQYXJhbWV0ZXJNYW5hZ2VyKG5hbWUsIHZpc2libGVOYW1lLCBleHBvc2VkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52bGlkIGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICh0aGlzLmlzUGFyYW1ldGVyTmFtZUF2YWlsYWJsZSh0aGlzKSkge1xuICAgICAgICAgICAgY29uc3QgcGFyYW0gPSBuZXcgQXNzZXRQYXJhbWV0ZXIodGhpcy5vd25lciwgbmFtZSwgdmlzaWJsZU5hbWUsIGV4cG9zZWQpO1xuICAgICAgICAgICAgdGhpcy5hZGRQYXJhbWV0ZXIocGFyYW0pO1xuICAgICAgICAgICAgcGFyYW0uYWRkRXZlbnRMaXN0ZW5lcihcInBhcmFtZXRlcnNldFwiLCB0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kUGFyYW1ldGVyKG5hbWUpO1xuICAgIH1cbiAgICBnZXRQYXJhbWV0ZXJPYmplY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1aWxkUGFyYW1ldGVyT2JqZWN0KCk7XG4gICAgfVxuICAgIGdldFBhcmFtZXRlck5hbWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJMaXN0LmZpbHRlcigocCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHAuZXhwb3NlZDtcbiAgICAgICAgfSkubWFwKChwKSA9PiB7XG4gICAgICAgICAgICBpZiAocCBpbnN0YW5jZW9mIFBhcmFtZXRlck1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcC5nZXRQYXJhbWV0ZXJOYW1lcygpLm1hcChyZWN1cnNpdmVOYW1lID0+IGAke3AubmFtZX0uJHtyZWN1cnNpdmVOYW1lfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtwLm5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5mbGF0KCk7XG4gICAgfVxuICAgIHNldFBhcmFtZXRlckJ5TmFtZShuYW1lLCB2YWx1ZSwgdXBkYXRlSW50ZXJmYWNlcyA9IHRydWUpIHtcbiAgICAgICAgdmFyIHBhcmFtZXRlciA9IHRoaXMuZmluZFBhcmFtZXRlcihuYW1lKTtcbiAgICAgICAgaWYgKCFwYXJhbWV0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVyLmV4cG9zZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDYW5ub3Qgc2V0IGhpZGRlbiBwYXJhbWV0ZXJcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzUGx1Z2luUGFyYW1ldGVyKHBhcmFtZXRlcikpIHtcbiAgICAgICAgICAgIHBhcmFtZXRlci5zZXRWYWx1ZSh2YWx1ZSwgdXBkYXRlSW50ZXJmYWNlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVsZXRlUGFyYW1ldGVyKHBhcmFtZXRlcikge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGFyYW1ldGVyTGlzdC5maW5kSW5kZXgoZSA9PiBlID09PSBwYXJhbWV0ZXIpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgLy8gRG9lcyBleGlzdFxuICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXJMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgcGFyYW1ldGVyLm5hbWUsIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHBhcmFtZXRlci5kZXN0cm95KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGRlbGV0ZUFsbFBhcmFtZXRlcnMoKSB7XG4gICAgICAgIGZvciAoY29uc3QgcGFyYW1ldGVyIG9mIEFycmF5LmZyb20odGhpcy5wYXJhbWV0ZXJMaXN0KSkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVQYXJhbWV0ZXIocGFyYW1ldGVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgc2V0UGFyYW1ldGVyc0J5T2JqZWN0KG9iamVjdCwgdXBkYXRlSW50ZXJmYWNlcyA9IHRydWUpIHtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgICBpZiAob2JqZWN0Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRyeSA9IG9iamVjdFtrZXldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZW50cnkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbWV0ZXIgPSB0aGlzLmZpbmRQYXJhbWV0ZXIoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtZXRlciBpbnN0YW5jZW9mIFBhcmFtZXRlck1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5lc3RlZCBQYXJhbWV0ZXIgc3RvcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlci5zZXRQYXJhbWV0ZXJzQnlPYmplY3QoZW50cnksIHVwZGF0ZUludGVyZmFjZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzUGx1Z2luUGFyYW1ldGVyKHBhcmFtZXRlcikgJiYgZW50cnkuaGFzT3duUHJvcGVydHkoXCJ2YWx1ZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQYXJhbWV0ZXJCeU5hbWUoa2V5LCBlbnRyeS52YWx1ZSwgdXBkYXRlSW50ZXJmYWNlcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBhcmFtZXRlckJ5TmFtZShrZXksIGVudHJ5LCB1cGRhdGVJbnRlcmZhY2VzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZW50cnkgPT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgZW50cnkgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBhcmFtZXRlckJ5TmFtZShrZXksIGVudHJ5LCB1cGRhdGVJbnRlcmZhY2VzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IChcIkNhbm5vdCBzZXQgXCIgKyBrZXkgKyBcIjogTm90IGEgdmFsaWQgb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmFtZXRlckxpc3QuZmlsdGVyKHAgPT4gcC5leHBvc2VkKVxuICAgICAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAob2JqLCBlKSB7XG4gICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFBhcmFtZXRlck1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICBvYmpbZS5uYW1lXSA9IGUudG9KU09OKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1BsdWdpblBhcmFtZXRlcihlKSkge1xuICAgICAgICAgICAgICAgIG9ialtlLm5hbWVdID0gZS5nZXRQYXJhbWV0ZXJPYmplY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH0sIHt9KTtcbiAgICB9XG4gICAgZ2V0IHBhcmFtZXRlcnMoKSB7IHJldHVybiB0aGlzLmJ1aWxkUGFyYW1ldGVyT2JqZWN0KCk7IH1cbiAgICBnZXQgbnVtUGFyYW1ldGVycygpIHsgcmV0dXJuIHRoaXMucGFyYW1ldGVyTGlzdC5sZW5ndGg7IH1cbn1cbiIsImZ1bmN0aW9uIGNoZWNrRmVhdHVyZUFyZ3Moc291cmNlLCBmZWF0dXJlT2JqZWN0KSB7XG4gICAgaWYgKHNvdXJjZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IChcIlNvdXJjZSBwbHVnaW4gbXVzdCBiZSBkZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAoZmVhdHVyZU9iamVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IChcIkZlYXR1cmVPYmplY3QgbXVzdCBiZSBkZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGZlYXR1cmVPYmplY3Qub3V0cHV0SW5kZXggIT09IFwibnVtYmVyXCIgfHwgdHlwZW9mIGZlYXR1cmVPYmplY3QuZnJhbWVTaXplICE9PSBcIm51bWJlclwiIHx8IHR5cGVvZiBmZWF0dXJlT2JqZWN0LmZlYXR1cmVzICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHRocm93IChcIk1hbGZvcm1lZCBmZWF0dXJlT2JqZWN0XCIpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbmV4cG9ydCBjbGFzcyBQbHVnaW5GZWF0dXJlSW50ZXJmYWNlUmVjZWl2ZXIge1xuICAgIGNvbnN0cnVjdG9yKEZlYXR1cmVJbnRlcmZhY2VJbnN0YW5jZSwgRmFjdG9yeUZlYXR1cmVNYXApIHtcbiAgICAgICAgdGhpcy5GZWF0dXJlSW50ZXJmYWNlSW5zdGFuY2UgPSBGZWF0dXJlSW50ZXJmYWNlSW5zdGFuY2U7XG4gICAgICAgIHRoaXMuRmFjdG9yeUZlYXR1cmVNYXAgPSBGYWN0b3J5RmVhdHVyZU1hcDtcbiAgICB9XG4gICAgcmVxdWVzdEZlYXR1cmVzKGZlYXR1cmVMaXN0KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmVhdHVyZUxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdEZlYXR1cmVzRnJvbVBsdWdpbihmZWF0dXJlTGlzdFtpXS5wbHVnaW4sIHtcbiAgICAgICAgICAgICAgICAnb3V0cHV0SW5kZXgnOiBmZWF0dXJlTGlzdFtpXS5vdXRwdXRJbmRleCxcbiAgICAgICAgICAgICAgICAnZnJhbWVTaXplJzogZmVhdHVyZUxpc3RbaV0uZnJhbWVTaXplLFxuICAgICAgICAgICAgICAgICdmZWF0dXJlcyc6IGZlYXR1cmVMaXN0W2ldLmZlYXR1cmVzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXF1ZXN0RmVhdHVyZXNGcm9tUGx1Z2luKHNvdXJjZSwgZmVhdHVyZU9iamVjdCkge1xuICAgICAgICBjaGVja0ZlYXR1cmVBcmdzKHNvdXJjZSwgZmVhdHVyZU9iamVjdCk7XG4gICAgICAgIHRoaXMuRmFjdG9yeUZlYXR1cmVNYXAucmVxdWVzdEZlYXR1cmVzKHRoaXMsIHNvdXJjZS5mZWF0dXJlTWFwLlNlbmRlciwgZmVhdHVyZU9iamVjdCk7XG4gICAgfVxuICAgIGNhbmNlbEZlYXR1cmVzRnJvbVBsdWdpbihzb3VyY2UsIGZlYXR1cmVPYmplY3QpIHtcbiAgICAgICAgY2hlY2tGZWF0dXJlQXJncyhzb3VyY2UsIGZlYXR1cmVPYmplY3QpO1xuICAgICAgICB0aGlzLkZhY3RvcnlGZWF0dXJlTWFwLmRlbGV0ZUZlYXR1cmVzKHRoaXMsIHNvdXJjZS5mZWF0dXJlTWFwLlNlbmRlciwgZmVhdHVyZU9iamVjdCk7XG4gICAgfVxuICAgIGNhbmNlbEFsbEZlYXR1cmVzRnJvbVBsdWdpbihzb3VyY2UpIHtcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJTb3VyY2UgcGx1Z2luIG11c3QgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLkZhY3RvcnlGZWF0dXJlTWFwLmRlbGV0ZUZlYXR1cmVzKHRoaXMsIHNvdXJjZS5mZWF0dXJlTWFwLlNlbmRlcik7XG4gICAgfVxuICAgIGNhbmNlbEFsbEZlYXR1cmVzKCkge1xuICAgICAgICB0aGlzLkZhY3RvcnlGZWF0dXJlTWFwLmRlbGV0ZUZlYXR1cmVzKHRoaXMpO1xuICAgIH1cbiAgICBwb3N0RmVhdHVyZXMobWVzc2FnZSkge1xuICAgICAgICAvKlxuICAgICAgICAgICAgQ2FsbGVkIGJ5IHRoZSBQbHVnaW4gRmFjdG9yeSB3aXRoIHRoZSBmZWF0dXJlIG1lc3NhZ2VcbiAgICAgICAgICAgIG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgJ3BsdWdpbic6IHNvdXJjZVBsdWdpbkluc3RhbmNlLFxuICAgICAgICAgICAgICAgICdvdXRwdXRJbmRleCc6IG91dHB1dEluZGV4LFxuICAgICAgICAgICAgICAgICdmcmFtZVNpemUnOiBmcmFtZVNpemUsXG4gICAgICAgICAgICAgICAgJ2ZlYXR1cmVzJzoge30gSlMtWHRyYWN0IGZlYXR1cmUgcmVzdWx0cyBvYmplY3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNfZmVhdHVyZXMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5jX2ZlYXR1cmVzKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIDtcbiAgICBnZXQgb25mZWF0dXJlcygpIHsgcmV0dXJuIHRoaXMuY19mZWF0dXJlczsgfVxuICAgIHNldCBvbmZlYXR1cmVzKGZ1bmMpIHsgdGhpcy5jX2ZlYXR1cmVzID0gZnVuYzsgfVxufVxuIiwiaW1wb3J0IHsgT3V0cHV0Tm9kZSB9IGZyb20gXCIuLi8uLi9GYWN0b3J5L0V4dHJhY3RvcnMvT3V0cHV0Tm9kZVwiO1xuZXhwb3J0IGNsYXNzIFBsdWdpbkZlYXR1cmVJbnRlcmZhY2VTZW5kZXIge1xuICAgIGNvbnN0cnVjdG9yKEZlYXR1cmVJbnRlcmZhY2VJbnN0YW5jZSwgRmFjdG9yeUZlYXR1cmVNYXApIHtcbiAgICAgICAgdGhpcy5GZWF0dXJlSW50ZXJmYWNlSW5zdGFuY2UgPSBGZWF0dXJlSW50ZXJmYWNlSW5zdGFuY2U7XG4gICAgICAgIHRoaXMuRmFjdG9yeUZlYXR1cmVNYXAgPSBGYWN0b3J5RmVhdHVyZU1hcDtcbiAgICAgICAgdGhpcy5vdXRwdXROb2RlcyA9IFtdO1xuICAgIH1cbiAgICB1cGRhdGVGZWF0dXJlcyhmZWF0dXJlT2JqZWN0LCBvdXRwdXRJbmRleCA9IDApIHtcbiAgICAgICAgaWYgKHRoaXMub3V0cHV0Tm9kZXNbb3V0cHV0SW5kZXhdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmIChvdXRwdXRJbmRleCA+IHRoaXMuRmVhdHVyZUludGVyZmFjZUluc3RhbmNlLm51bU91dHB1dHMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZXF1ZXN0ZWQgYW4gb3V0cHV0IHRoYXQgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm91dHB1dE5vZGVzW291dHB1dEluZGV4XSA9IG5ldyBPdXRwdXROb2RlKHRoaXMsIHRoaXMuRmVhdHVyZUludGVyZmFjZUluc3RhbmNlLm91dHB1dHNbb3V0cHV0SW5kZXhdLCBvdXRwdXRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgc2kgPSAwOyBzaSA8IGZlYXR1cmVPYmplY3QubGVuZ3RoOyBzaSsrKSB7XG4gICAgICAgICAgICBsZXQgZXh0cmFjdG9yID0gdGhpcy5vdXRwdXROb2Rlc1tvdXRwdXRJbmRleF0uZmluZEV4dHJhY3RvcihmZWF0dXJlT2JqZWN0W3NpXS5mcmFtZVNpemUpO1xuICAgICAgICAgICAgaWYgKCFleHRyYWN0b3IpIHtcbiAgICAgICAgICAgICAgICBleHRyYWN0b3IgPSB0aGlzLm91dHB1dE5vZGVzW291dHB1dEluZGV4XS5hZGRFeHRyYWN0b3IoZmVhdHVyZU9iamVjdFtzaV0uZnJhbWVTaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4dHJhY3Rvci5zZXRGZWF0dXJlcyhmZWF0dXJlT2JqZWN0W3NpXS5mZWF0dXJlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcG9zdEZlYXR1cmVzKGZlYXR1cmVPYmplY3QpIHtcbiAgICAgICAgLypcbiAgICAgICAgICAgIENhbGxlZCBieSB0aGUgaW5kaXZpZHVhbCBleHRyYWN0b3IgaW5zdGFuY2VzOlxuICAgICAgICAgICAgZmVhdHVyZU9iamVjdCA9IHsnZnJhbWVTaXplJzogZnJhbWVTaXplLFxuICAgICAgICAgICAgJ291dHB1dEluZGV4Jzogb3V0cHV0SW5kZXgsXG4gICAgICAgICAgICAncmVzdWx0cyc6W119XG4gICAgICAgICovXG4gICAgICAgIHRoaXMuRmVhdHVyZUludGVyZmFjZUluc3RhbmNlLmZhY3RvcnkuRmVhdHVyZU1hcC5wb3N0RmVhdHVyZXMoe1xuICAgICAgICAgICAgJ3NvdXJjZSc6IHRoaXMsXG4gICAgICAgICAgICAnb3V0cHV0SW5kZXgnOiBmZWF0dXJlT2JqZWN0Lm91dHB1dEluZGV4LFxuICAgICAgICAgICAgJ2ZyYW1lU2l6ZSc6IGZlYXR1cmVPYmplY3QuZnJhbWVTaXplLFxuICAgICAgICAgICAgJ3Jlc3VsdHMnOiBmZWF0dXJlT2JqZWN0LnJlc3VsdHNcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIDtcbn1cbiIsImltcG9ydCB7IFBsdWdpbkZlYXR1cmVJbnRlcmZhY2VSZWNlaXZlciB9IGZyb20gXCIuL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2VSZWNlaXZlclwiO1xuaW1wb3J0IHsgUGx1Z2luRmVhdHVyZUludGVyZmFjZVNlbmRlciB9IGZyb20gXCIuL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2VTZW5kZXJcIjtcbmV4cG9ydCBjbGFzcyBQbHVnaW5GZWF0dXJlSW50ZXJmYWNlIHtcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuUmVjZWl2ZXIgPSBuZXcgUGx1Z2luRmVhdHVyZUludGVyZmFjZVJlY2VpdmVyKHRoaXMucGx1Z2luLCB0aGlzLnBsdWdpbi5mYWN0b3J5LkZlYXR1cmVNYXApO1xuICAgICAgICB0aGlzLlNlbmRlciA9IG5ldyBQbHVnaW5GZWF0dXJlSW50ZXJmYWNlU2VuZGVyKHRoaXMucGx1Z2luLCB0aGlzLnBsdWdpbi5mYWN0b3J5LkZlYXR1cmVNYXApO1xuICAgIH1cbiAgICBnZXQgb25mZWF0dXJlcygpIHsgcmV0dXJuIHRoaXMuUmVjZWl2ZXIub25mZWF0dXJlczsgfVxuICAgIHNldCBvbmZlYXR1cmVzKGZ1bmMpIHsgdGhpcy5SZWNlaXZlci5vbmZlYXR1cmVzID0gZnVuYzsgfVxufVxuIiwiaW1wb3J0IHsgaXNBdXRvbWF0ZWRQbHVnaW5QYXJhbWV0ZXIsIGlzUGx1Z2luUGFyYW1ldGVyIH0gZnJvbSBcIi4vcGFyYW1ldGVycy9JUGx1Z2luUGFyYW1ldGVyXCI7XG5leHBvcnQgY2xhc3MgUGx1Z2luSW50ZXJmYWNlTWVzc2FnZUh1YiB7XG4gICAgY29uc3RydWN0b3Iob3duZXIpIHtcbiAgICAgICAgdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICB0aGlzLndpbmRvd01lc3NhZ2VMaXN0ID0gW107XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBuZXcgRXZlbnRUYXJnZXQoKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMpO1xuICAgIH1cbiAgICBidWlsZFBsdWdpblBhcmFtZXRlckpTT04oc291cmNlcykge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHRoaXMub3duZXIucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJOYW1lcygpO1xuICAgICAgICBjb25zdCBPID0ge307XG4gICAgICAgIGlmIChzb3VyY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBzb3VyY2VzID0gbmFtZXM7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZXMuZmlsdGVyKChuYW1lKSA9PiBzb3VyY2VzLmluY2x1ZGVzKG5hbWUpKS5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbSA9IHRoaXMub3duZXIucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSk7XG4gICAgICAgICAgICBpZiAoaXNQbHVnaW5QYXJhbWV0ZXIocGFyYW0pKSB7XG4gICAgICAgICAgICAgICAgT1tuYW1lXSA9IHBhcmFtLmdldFBhcmFtZXRlck9iamVjdCgpO1xuICAgICAgICAgICAgICAgIE9bbmFtZV0ubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGlzQXV0b21hdGVkUGx1Z2luUGFyYW1ldGVyKHBhcmFtKSkge1xuICAgICAgICAgICAgICAgICAgICBPW25hbWVdLmF1dG9tYXRlZCA9IHBhcmFtLmVuYWJsZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE87XG4gICAgfVxuICAgIGJ1aWxkUGFyYW1ldGVyVXBkYXRlUGF5bG9hZChzZW5kZXJfaWQsIHNvdXJjZXMgPSBbXSkge1xuICAgICAgICBjb25zdCBtc2cgPSB7XG4gICAgICAgICAgICBzZW5kZXJfaWQsXG4gICAgICAgICAgICBtZXNzYWdlOiBcInVwZGF0ZVBhcmFtZXRlcnNcIixcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHRoaXMuYnVpbGRQbHVnaW5QYXJhbWV0ZXJKU09OKHNvdXJjZXMpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBtc2c7XG4gICAgfVxuICAgIHNlbmRQYXJhbWV0ZXJVcGRhdGVzKGNoYW5uZWwsIHNvdXJjZXMgPSBbXSkge1xuICAgICAgICBjaGFubmVsLnBvc3RNZXNzYWdlKHRoaXMuYnVpbGRQYXJhbWV0ZXJVcGRhdGVQYXlsb2FkKHVuZGVmaW5lZCwgc291cmNlcyksIGxvY2F0aW9uLm9yaWdpbik7XG4gICAgfVxuICAgIGJyb2FkY2FzdFBhcmFtZXRlclVwZGF0ZXMoc2VuZGVyX2lkLCBzb3VyY2VzKSB7XG4gICAgICAgIGNvbnN0IG1zZyA9IHRoaXMuYnVpbGRQYXJhbWV0ZXJVcGRhdGVQYXlsb2FkKHNlbmRlcl9pZCwgc291cmNlcyk7XG4gICAgICAgIHRoaXMud2luZG93TWVzc2FnZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAodykge1xuICAgICAgICAgICAgdy5wb3N0TWVzc2FnZShtc2csIGxvY2F0aW9uLm9yaWdpbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBicm9hZGNhc3RTdGF0ZUNoYW5nZShsZXZlbCwgdGVybSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG1zZyA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwidXBkYXRlU3RhdGVcIixcbiAgICAgICAgICAgIGxldmVsLFxuICAgICAgICAgICAgdGVybSxcbiAgICAgICAgICAgIHZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMud2luZG93TWVzc2FnZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAodykge1xuICAgICAgICAgICAgdy5wb3N0TWVzc2FnZShtc2csIGxvY2F0aW9uLm9yaWdpbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRQYXJhbWV0ZXJNZXNzYWdlKGUpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlT2JqZWN0cyA9IFtdO1xuICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gSlNPTi5wYXJzZShlLmRhdGEucGFyYW1ldGVycyk7XG4gICAgICAgIE9iamVjdC5rZXlzKHBhcmFtZXRlcnMpLmZvckVhY2goKG5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtZXRlck9iamVjdCA9IHRoaXMub3duZXIucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSk7XG4gICAgICAgICAgICBpZiAoaXNQbHVnaW5QYXJhbWV0ZXIocGFyYW1ldGVyT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgIHBhcmFtZXRlck9iamVjdC5zZXRWYWx1ZShwYXJhbWV0ZXJzW25hbWVdLnZhbHVlLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdXBkYXRlT2JqZWN0cy5wdXNoKG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHVwZGF0ZU9iamVjdHM7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCB0aGlzKTtcbiAgICB9XG4gICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICByZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIGhhbmRsZUV2ZW50KGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLndpbmRvd01lc3NhZ2VMaXN0LmluY2x1ZGVzKGUuc291cmNlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdpbmRvdyA9IGUuc291cmNlO1xuICAgICAgICBzd2l0Y2ggKGUuZGF0YS5tZXNzYWdlKSB7XG4gICAgICAgICAgICBjYXNlIFwic2V0UGFyYW1ldGVyQnlOYW1lXCI6XG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YS5wYXJhbWV0ZXIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJPYmplY3QgPSB0aGlzLm93bmVyLnBhcmFtZXRlcnMuZ2V0UGFyYW1ldGVyQnlOYW1lKGUuZGF0YS5wYXJhbWV0ZXIubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1BsdWdpblBhcmFtZXRlcihwYXJhbWV0ZXJPYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJPYmplY3Quc2V0VmFsdWUoZS5kYXRhLnBhcmFtZXRlci52YWx1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5icm9hZGNhc3RQYXJhbWV0ZXJVcGRhdGVzKGUuZGF0YS5zZW5kZXJfaWQsIFtlLmRhdGEucGFyYW1ldGVyLm5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzZXRQYXJhbWV0ZXJzQnlPYmplY3RcIjpcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhLnBhcmFtZXRlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVPYmplY3RzID0gdGhpcy5zZXRQYXJhbWV0ZXJNZXNzYWdlKGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyb2FkY2FzdFBhcmFtZXRlclVwZGF0ZXMoZS5kYXRhLnNlbmRlcl9pZCwgdXBkYXRlT2JqZWN0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJlcXVlc3RQYXJhbWV0ZXJzXCI6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlLmRhdGEubmFtZSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFBhcmFtZXRlclVwZGF0ZXMod2luZG93LCBbZS5kYXRhLm5hbWVdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFBhcmFtZXRlclVwZGF0ZXMod2luZG93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVxdWVzdFNlc3Npb25TdGF0ZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0U3RhdGVDaGFuZ2UoXCJzZXNzaW9uXCIsIGUuZGF0YS50ZXJtLCB0aGlzLm93bmVyLnNlc3Npb25EYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKGUuZGF0YS50ZXJtKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVxdWVzdFRyYWNrU3RhdGVcIjpcbiAgICAgICAgICAgICAgICB0aGlzLmJyb2FkY2FzdFN0YXRlQ2hhbmdlKFwidHJhY2tcIiwgZS5kYXRhLnRlcm0sIHRoaXMub3duZXIudHJhY2tEYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKGUuZGF0YS50ZXJtKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVxdWVzdFVzZXJTdGF0ZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0U3RhdGVDaGFuZ2UoXCJ1c2VyXCIsIGUuZGF0YS50ZXJtLCB0aGlzLm93bmVyLnVzZXJEYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKGUuZGF0YS50ZXJtKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVxdWVzdFBsdWdpblN0YXRlXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5icm9hZGNhc3RTdGF0ZUNoYW5nZShcInBsdWdpblwiLCBlLmRhdGEudGVybSwgdGhpcy5vd25lci5wbHVnaW5EYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKGUuZGF0YS50ZXJtKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY3VzdG9tTWVzc2FnZVwiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyAoXCJVbmtub3duIG1lc3NhZ2UgdHlwZSBcXFwiXCIgKyBlLmRhdGEubWVzc2FnZSArIFwiXFxcIlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZW5kU3RhdGUobGV2ZWwsIHRlcm0pIHtcbiAgICAgICAgaWYgKGxldmVsID09IFwic2Vzc2lvblwiKSB7XG4gICAgICAgICAgICB0aGlzLmJyb2FkY2FzdFN0YXRlQ2hhbmdlKFwic2Vzc2lvblwiLCB0ZXJtLCB0aGlzLm93bmVyLnNlc3Npb25EYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKHRlcm0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsZXZlbCA9PSBcInRyYWNrXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0U3RhdGVDaGFuZ2UoXCJ0cmFja1wiLCB0ZXJtLCB0aGlzLm93bmVyLnRyYWNrRGF0YUludGVyZmFjZS5yZXF1ZXN0VGVybSh0ZXJtKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGV2ZWwgPT0gXCJ1c2VyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0U3RhdGVDaGFuZ2UoXCJ1c2VyXCIsIHRlcm0sIHRoaXMub3duZXIudXNlckRhdGFJbnRlcmZhY2UucmVxdWVzdFRlcm0odGVybSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxldmVsID09IFwicGx1Z2luXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0U3RhdGVDaGFuZ2UoXCJwbHVnaW5cIiwgdGVybSwgdGhpcy5vd25lci5wbHVnaW5EYXRhSW50ZXJmYWNlLnJlcXVlc3RUZXJtKHRlcm0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IFwiSW52YWxpZCBzdGF0ZSBsZXZlbCBvcHRpb25cIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVJbnRlcmZhY2VzKGF1dG9tYXRpb25Pbmx5ID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGF1dG9tYXRpb25Pbmx5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGF1dG9tYXRpb25Pbmx5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1dG9tYXRpb25Pbmx5KSB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbWV0ZXJOYW1lcyA9IHRoaXMub3duZXIucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJOYW1lcygpO1xuICAgICAgICAgICAgY29uc3Qgc291cmNlcyA9IHBhcmFtZXRlck5hbWVzLmZpbHRlcihmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbSA9IHRoaXMub3duZXIucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChwYXJhbS5hdXRvbWF0YWJsZSAmJiBwYXJhbS5lbmFibGVkID09PSB0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0UGFyYW1ldGVyVXBkYXRlcyh1bmRlZmluZWQsIHNvdXJjZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5icm9hZGNhc3RQYXJhbWV0ZXJVcGRhdGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xvc2VXaW5kb3dzKCkge1xuICAgICAgICB3aGlsZSAodGhpcy53aW5kb3dNZXNzYWdlTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB3ID0gdGhpcy53aW5kb3dNZXNzYWdlTGlzdC5wb3AoKTtcbiAgICAgICAgICAgIHcuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcyk7XG4gICAgfVxuICAgIHJlZ2lzdGVyV2luZG93KHcpIHtcbiAgICAgICAgaWYgKHRoaXMud2luZG93TWVzc2FnZUxpc3QuaW5jbHVkZXModykpIHtcbiAgICAgICAgICAgIHRoaXMud2luZG93TWVzc2FnZUxpc3Quc3BsaWNlKHRoaXMud2luZG93TWVzc2FnZUxpc3QuaW5kZXhPZih3KSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53aW5kb3dNZXNzYWdlTGlzdC5wdXNoKHcpO1xuICAgICAgICB3LnBsdWdpbkluc3RhbmNlID0gdGhpcy5vd25lcjtcbiAgICAgICAgdGhpcy5zZW5kUGFyYW1ldGVyVXBkYXRlcyh3KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJlbW92ZVdpbmRvdyh3KSB7XG4gICAgICAgIGlmICh0aGlzLndpbmRvd01lc3NhZ2VMaXN0LmluY2x1ZGVzKHcpKSB7XG4gICAgICAgICAgICB0aGlzLndpbmRvd01lc3NhZ2VMaXN0LnNwbGljZSh0aGlzLndpbmRvd01lc3NhZ2VMaXN0LmluZGV4T2YodyksIDEpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiLy8gQWRkIGdldElucHV0cyB0byBhbGwgQXVkaW9Ob2RlcyB0byBlYXNlIGRlcGxveW1lbnRcbi8qZ2xvYmFscyBBdWRpb05vZGUsIFdvcmtlciwgY29uc29sZSwgd2luZG93LCBkb2N1bWVudCwgUHJvbWlzZSwgWE1MSHR0cFJlcXVlc3QgKi9cbi8qZXNsaW50LWVudiBicm93c2VyICovXG4vKmpzaGludCBlc3ZlcnNpb246IDYgKi9cbmltcG9ydCB7IFBhcmFtZXRlck1hbmFnZXIgfSBmcm9tIFwiLi9QYXJhbWV0ZXJNYW5hZ2VyXCI7XG5pbXBvcnQgeyBQbHVnaW5JbnRlcmZhY2VNZXNzYWdlSHViIH0gZnJvbSBcIi4vUGx1Z2luSW50ZXJmYWNlTWVzc2FnZUh1YlwiO1xuaW1wb3J0IHsgUGx1Z2luRmVhdHVyZUludGVyZmFjZSB9IGZyb20gXCIuL1BsdWdpbkZlYXR1cmVJbnRlcmZhY2UvaW5kZXhcIjtcbmltcG9ydCB7IExpbmtlZFN0b3JlIH0gZnJvbSBcIi4uL0xpbmtlZFN0b3JlXCI7XG5pbXBvcnQgeyBMaW5rZWRTdG9yZUludGVyZmFjZSB9IGZyb20gXCIuL0xpbmtlZFN0b3JlSW50ZXJmYWNlXCI7XG5pbXBvcnQgeyBvZiB9IGZyb20gXCJyeGpzXCI7XG4vLyBpZiAodHlwZW9mIEF1ZGlvTm9kZSA9PT0gXCJmdW5jdGlvblwiICYmIHdpbmRvdy5pbXBvcnRTY3JpcHRzID09PSB1bmRlZmluZWQpIHtcbi8vICAgICBBdWRpb05vZGUucHJvdG90eXBlLmdldElucHV0cyA9IGZ1bmN0aW9uICgpIHtcbi8vICAgICAgICAgcmV0dXJuIFt0aGlzXTtcbi8vICAgICB9O1xuLy8gfVxuZXhwb3J0IGNsYXNzIEJhc2VQbHVnaW4ge1xuICAgIGNvbnN0cnVjdG9yKGZhY3RvcnksIHBsdWdpbk93bmVyLCBwcm90b3R5cGVPYmplY3QpIHtcbiAgICAgICAgdGhpcy5mYWN0b3J5ID0gZmFjdG9yeTtcbiAgICAgICAgdGhpcy5wbHVnaW5Pd25lciA9IHBsdWdpbk93bmVyO1xuICAgICAgICB0aGlzLnByb3RvdHlwZU9iamVjdCA9IHByb3RvdHlwZU9iamVjdDtcbiAgICAgICAgdGhpcy5pbnB1dExpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5vdXRwdXRMaXN0ID0gW107XG4gICAgICAgIHRoaXMuZGVsYXlTYW1wbGVzID0gMDtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldCA9IG5ldyBFdmVudFRhcmdldCgpO1xuICAgICAgICB0aGlzLmV4dGVybmFsSW50ZXJmYWNlID0gbmV3IFBsdWdpbkludGVyZmFjZU1lc3NhZ2VIdWIodGhpcyk7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuZmFjdG9yeS5jb250ZXh0O1xuICAgICAgICB0aGlzLmZlYXR1cmVNYXAgPSBuZXcgUGx1Z2luRmVhdHVyZUludGVyZmFjZSh0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gbmV3IFBhcmFtZXRlck1hbmFnZXIodGhpcywgdGhpcy5leHRlcm5hbEludGVyZmFjZSk7XG4gICAgICAgIHRoaXMuUGx1Z2luRGF0YSA9IG5ldyBMaW5rZWRTdG9yZShcIlBsdWdpblwiKTtcbiAgICAgICAgdGhpcy5zZXNzaW9uRGF0YUludGVyZmFjZSA9IG5ldyBMaW5rZWRTdG9yZUludGVyZmFjZSh0aGlzLCB0aGlzLmZhY3RvcnkuU2Vzc2lvbkRhdGEpO1xuICAgICAgICB0aGlzLnVzZXJEYXRhSW50ZXJmYWNlID0gbmV3IExpbmtlZFN0b3JlSW50ZXJmYWNlKHRoaXMsIHRoaXMuZmFjdG9yeS5Vc2VyRGF0YSk7XG4gICAgICAgIHRoaXMudHJhY2tEYXRhSW50ZXJmYWNlID0gbmV3IExpbmtlZFN0b3JlSW50ZXJmYWNlKHRoaXMsIHRoaXMuVHJhY2tEYXRhKTtcbiAgICAgICAgdGhpcy5wbHVnaW5EYXRhSW50ZXJmYWNlID0gbmV3IExpbmtlZFN0b3JlSW50ZXJmYWNlKHRoaXMsIHRoaXMuUGx1Z2luRGF0YSk7XG4gICAgICAgIHRoaXMuU2Vzc2lvbkRhdGEgPSB0aGlzLmZhY3RvcnkuU2Vzc2lvbkRhdGE7XG4gICAgICAgIHRoaXMuVXNlckRhdGEgPSB0aGlzLmZhY3RvcnkuVXNlckRhdGE7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMucHJvdG90eXBlT2JqZWN0Lm5hbWU7XG4gICAgICAgIHRoaXMudW5pcXVlSUQgPSB0aGlzLnByb3RvdHlwZU9iamVjdC51bmlxdWVJRDtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdGhpcy5wcm90b3R5cGVPYmplY3QudmVyc2lvbjtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLmFkZEV2ZW50TGlzdGVuZXIoXCJwYXJhbWV0ZXJzZXRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJwYXJhbWV0ZXJzZXRcIiwgeyBkZXRhaWw6IGUuZGV0YWlsIH0pKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXJ0KCkgeyB9XG4gICAgc3RvcCgpIHsgfVxuICAgIG9ubG9hZGVkKCkgeyB9XG4gICAgb251bmxvYWRlZCgpIHsgfVxuICAgIGRlY29uc3RydWN0KCkgeyB9XG4gICAgZGVsZXRlSU8obm9kZSwgbGlzdCkge1xuICAgICAgICB2YXIgaSA9IGxpc3QuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gZSA9PT0gdGhpcztcbiAgICAgICAgfSwgbm9kZSk7XG4gICAgICAgIGlmIChpID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxpc3Quc3BsaWNlKGksIDEpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY2hhbmdlT3duZXIobmV3T3duZXIpIHtcbiAgICAgICAgdGhpcy5wbHVnaW5Pd25lciA9IG5ld093bmVyO1xuICAgIH1cbiAgICBkZWxldGUoKSB7XG4gICAgICAgIHRoaXMuc2Vzc2lvbkRhdGFJbnRlcmZhY2UuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnVzZXJEYXRhSW50ZXJmYWNlLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy50cmFja0RhdGFJbnRlcmZhY2UuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnBsdWdpbkRhdGFJbnRlcmZhY2UuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgdGhpcy5vbnVubG9hZGVkKCk7XG4gICAgICAgIGlmICh0aGlzLmRlY29uc3RydWN0ICYmIHR5cGVvZiB0aGlzLmRlY29uc3RydWN0ID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5kZWNvbnN0cnVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIERlcGNyZWNhdGVkIC0gVXNlIC5kZWxldGUoKSBpbnN0ZWFkXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkRFUFJFQ0FURUQgLSBVc2UgLmRlbGV0ZSgpIGluc3RlYWRcIik7XG4gICAgICAgIHRoaXMuZGVsZXRlKCk7XG4gICAgfVxuICAgIGFkZElucHV0KG5vZGUpIHtcbiAgICAgICAgdGhpcy5pbnB1dExpc3QucHVzaChub2RlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRMaXN0O1xuICAgIH1cbiAgICBkZWxldGVJbnB1dChub2RlKSB7XG4gICAgICAgIHRoaXMuZGVsZXRlSU8obm9kZSwgdGhpcy5pbnB1dExpc3QpO1xuICAgICAgICByZXR1cm4gdGhpcy5pbnB1dExpc3Q7XG4gICAgfVxuICAgIGFkZE91dHB1dChub2RlKSB7XG4gICAgICAgIHRoaXMub3V0cHV0TGlzdC5wdXNoKG5vZGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXRMaXN0O1xuICAgIH1cbiAgICA7XG4gICAgZGVsZXRlT3V0cHV0KG5vZGUpIHtcbiAgICAgICAgdGhpcy5kZWxldGVJTyhub2RlLCB0aGlzLm91dHB1dExpc3QpO1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXRMaXN0O1xuICAgIH1cbiAgICA7XG4gICAgc2V0UHJvY2Vzc2luZ0RlbGF5QXNTZWNvbmRzKHNlY29uZHMpIHtcbiAgICAgICAgY29uc3QgZnMgPSB0aGlzLmZhY3RvcnkuY29udGV4dC5zYW1wbGVSYXRlO1xuICAgICAgICBpZiAodHlwZW9mIHNlY29uZHMgPT0gXCJudW1iZXJcIiAmJiBpc0Zpbml0ZShzZWNvbmRzKSAmJiBzZWNvbmRzID49IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcyhzZWNvbmRzICogZnMpIC8gZnM7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic2V0UHJvY2Vzc2luZ0RlbGF5QXNTZWNvbmRzIEludmFsaWQgYXJndW1lbnRcIik7XG4gICAgfVxuICAgIHNldFByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcyhzYW1wbGVzKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2FtcGxlcyA9PSBcIm51bWJlclwiICYmIGlzRmluaXRlKHNhbXBsZXMpICYmIHNhbXBsZXMgPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5kZWxheVNhbXBsZXMgPSBzYW1wbGVzO1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBFdmVudChcImFsdGVyZGVsYXlcIik7XG4gICAgICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LmRpc3BhdGNoRXZlbnQoZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheVNhbXBsZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzZXRQcm9jZXNzaW5nRGVsYXlBc1NhbXBsZXMgSW52YWxpZCBhcmd1bWVudFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0KGRlc3QsIG91dHB1dCwgaW5wdXQpIHtcbiAgICAgICAgaWYgKGRlc3QgaW5zdGFuY2VvZiBBdWRpb1BhcmFtKSB7XG4gICAgICAgICAgICB0aGlzLm91dHB1dHNbMF0uY29ubmVjdChkZXN0LCBvdXRwdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vdXRwdXRzWzBdLmNvbm5lY3QoZGVzdCwgb3V0cHV0LCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdChkZXN0LCBvdXRwdXQsIGlucHV0KSB7XG4gICAgICAgIGlmIChkZXN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3V0cHV0c1swXS5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZGVzdCBpbnN0YW5jZW9mIEF1ZGlvUGFyYW0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm91dHB1dHNbMF0uZGlzY29ubmVjdChkZXN0LCBvdXRwdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRzWzBdLmRpc2Nvbm5lY3QoZGVzdCwgb3V0cHV0LCBpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0SW5wdXRzKCkgeyByZXR1cm4gdGhpcy5pbnB1dExpc3Q7IH1cbiAgICBnZXRPdXRwdXRzKCkgeyByZXR1cm4gdGhpcy5vdXRwdXRMaXN0OyB9XG4gICAgZ2V0UGFyYW1ldGVyTmFtZXMoKSB7IHJldHVybiB0aGlzLnBhcmFtZXRlcnMuZ2V0UGFyYW1ldGVyTmFtZXMoKTsgfVxuICAgIGdldFBhcmFtZXRlckJ5TmFtZShuYW1lKSB7IHJldHVybiB0aGlzLnBhcmFtZXRlcnMuZ2V0UGFyYW1ldGVyQnlOYW1lKG5hbWUpOyB9XG4gICAgZ2V0UGFyYW1ldGVyT2JqZWN0KCkgeyByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzLmdldFBhcmFtZXRlck9iamVjdCgpOyB9XG4gICAgc2V0UGFyYW1ldGVyQnlOYW1lKG5hbWUsIHZhbHVlLCB1cGRhdGVJbnRlcmZhY2VzID0gdHJ1ZSkgeyByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzLnNldFBhcmFtZXRlckJ5TmFtZShuYW1lLCB2YWx1ZSwgdXBkYXRlSW50ZXJmYWNlcyk7IH1cbiAgICBzZXRQYXJhbWV0ZXJzQnlPYmplY3Qob2JqZWN0LCB1cGRhdGVJbnRlcmZhY2VzKSB7IHJldHVybiB0aGlzLnBhcmFtZXRlcnMuc2V0UGFyYW1ldGVyc0J5T2JqZWN0KG9iamVjdCwgdXBkYXRlSW50ZXJmYWNlcyk7IH1cbiAgICBhZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICByZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBpc1JlYWR5UHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgICB9XG4gICAgbG9hZGluZ1Byb2dyZXNzJCgpIHtcbiAgICAgICAgcmV0dXJuIG9mKHtcbiAgICAgICAgICAgIG51bWJlck9mQXNzZXRzOiAwLFxuICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgbnVtYmVyT2ZBc3NldHNMb2FkZWQ6IDBcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBvd25lcigpIHsgcmV0dXJuIHRoaXMucGx1Z2luT3duZXI7IH1cbiAgICBnZXQgbnVtSW5wdXRzKCkgeyByZXR1cm4gdGhpcy5pbnB1dExpc3QubGVuZ3RoOyB9XG4gICAgZ2V0IG51bU91dHB1dHMoKSB7IHJldHVybiB0aGlzLm91dHB1dExpc3QubGVuZ3RoOyB9XG4gICAgZ2V0IG51bVBhcmFtZXRlcnMoKSB7IHJldHVybiB0aGlzLnBhcmFtZXRlcnMubnVtUGFyYW1ldGVyczsgfVxuICAgIGdldCBpbnB1dHMoKSB7IHJldHVybiB0aGlzLmlucHV0TGlzdDsgfVxuICAgIGdldCBvdXRwdXRzKCkgeyByZXR1cm4gdGhpcy5vdXRwdXRMaXN0OyB9XG4gICAgZ2V0IHByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcygpIHsgcmV0dXJuIHRoaXMuZGVsYXlTYW1wbGVzOyB9XG4gICAgc2V0IHByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcyhzYW1wbGVzKSB7IHRoaXMuc2V0UHJvY2Vzc2luZ0RlbGF5QXNTYW1wbGVzKHNhbXBsZXMpOyB9XG4gICAgZ2V0IHByb2Nlc3NpbmdEZWxheUFzU2Vjb25kcygpIHsgcmV0dXJuIHRoaXMuZGVsYXlTYW1wbGVzIC8gdGhpcy5mYWN0b3J5LmNvbnRleHQuc2FtcGxlUmF0ZTsgfVxuICAgIHNldCBwcm9jZXNzaW5nRGVsYXlBc1NlY29uZHMoc2Vjb25kcykgeyB0aGlzLnNldFByb2Nlc3NpbmdEZWxheUFzU2Vjb25kcyhzZWNvbmRzKTsgfVxuICAgIGdldCBUcmFja0RhdGEoKSB7IHZhciBfYTsgcmV0dXJuIChfYSA9IHRoaXMucGx1Z2luT3duZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5UcmFja0RhdGE7IH1cbn1cbiIsImltcG9ydCB7IFBsdWdpbkFzc2V0IH0gZnJvbSBcIi4uLy4uL0ZhY3RvcnkvUGx1Z2luQXNzZXRzL1BsdWdpbkFzc2V0XCI7XG5pbXBvcnQgeyBQbHVnaW5QYXJhbWV0ZXIgfSBmcm9tIFwiLi9QbHVnaW5QYXJhbWV0ZXJcIjtcbmV4cG9ydCBjbGFzcyBBc3NldFBhcmFtZXRlciBleHRlbmRzIFBsdWdpblBhcmFtZXRlciB7XG4gICAgY29uc3RydWN0b3Iob3duZXIsIG5hbWUsIHZpc2libGVOYW1lLCBleHBvc2VkID0gdHJ1ZSkge1xuICAgICAgICBzdXBlcihvd25lciwgbmFtZSwgXCJTdHJpbmdcIiwgdmlzaWJsZU5hbWUsIGV4cG9zZWQpO1xuICAgIH1cbiAgICBsb2FkQXNzZXQoKSB7XG4gICAgICAgIHRoaXMubG9hZEFzc2V0UHJvbWlzZSA9IHRoaXMuc2VsZWN0ZWRBc3NldC5mZXRjaCgpXG4gICAgICAgICAgICAudGhlbigoYnVmZmVyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvQnVmZmVyID0gYnVmZmVyO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEFzc2V0LnJlZ2lzdGVyVG9QbHVnaW4odGhpcy5vd25lcik7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub25sb2FkQ2FsbGJhY2sgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxvYWRDYWxsYmFjayhidWZmZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub25lcnJvckNhbGxiYWNrID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRoaXMub25lcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5sb2FkQXNzZXRQcm9taXNlO1xuICAgIH1cbiAgICBzZXRWYWx1ZSh2LCB1cGRhdGVJbnRlcmZhY2VzID0gdHJ1ZSkge1xuICAgICAgICBsZXQgbmV3U2VsZWN0ZWRBc3NldDtcbiAgICAgICAgaWYgKHYgaW5zdGFuY2VvZiBQbHVnaW5Bc3NldCkge1xuICAgICAgICAgICAgbmV3U2VsZWN0ZWRBc3NldCA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHYgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHYgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIG5ld1NlbGVjdGVkQXNzZXQgPSB0aGlzLm93bmVyLmZhY3RvcnkucGx1Z2luQXNzZXRzLmZpbmRBc3NldEJ5SWQoTnVtYmVyKHYpKTtcbiAgICAgICAgICAgIGlmIChuZXdTZWxlY3RlZEFzc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZEFzc2V0ID0gdGhpcy5vd25lci5mYWN0b3J5LnBsdWdpbkFzc2V0cy5maW5kQXNzZXRCeVVybCh2LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHYuaGFzT3duUHJvcGVydHkoJ2Fzc2V0JykpIHtcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZEFzc2V0ID0gdGhpcy5vd25lci5mYWN0b3J5LnBsdWdpbkFzc2V0cy5maW5kQXNzZXRCeVVybCh2LmFzc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHYuaGFzT3duUHJvcGVydHkoJ2lkJykpIHtcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZEFzc2V0ID0gdGhpcy5vd25lci5mYWN0b3J5LnBsdWdpbkFzc2V0cy5maW5kQXNzZXRCeUlkKHYuaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdTZWxlY3RlZEFzc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIk5vIGFzc2V0IGdpdmVuLCBcIiwgdik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEFzc2V0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQXNzZXQgPT09IHVuZGVmaW5lZCB8fCB0aGlzLnNlbGVjdGVkQXNzZXQuaWQgIT0gbmV3U2VsZWN0ZWRBc3NldC5pZCkge1xuICAgICAgICAgICAgLy8gYXNzZXQgaGFzIGNoYW5nZWQgdXJsLlxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRBc3NldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEFzc2V0LmRlcmVnaXN0ZXJGcm9tUGx1Z2luKHRoaXMub3duZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEFzc2V0ID0gbmV3U2VsZWN0ZWRBc3NldDtcbiAgICAgICAgICAgIHRoaXMubG9hZEFzc2V0KCk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJQYXJhbWV0ZXJTZXQodXBkYXRlSW50ZXJmYWNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkQXNzZXQ7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgfVxuICAgIGdldFJlc291cmNlKCkge1xuICAgICAgICBpZiAodGhpcy5sb2FkQXNzZXRQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkQXNzZXRQcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZEFzc2V0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkQXNzZXQudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgZ2V0UGFyYW1ldGVyT2JqZWN0KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2VsZWN0ZWRBc3NldCA/IHRoaXMuc2VsZWN0ZWRBc3NldC50b0pTT04oKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGxvYWRlZDogKHRoaXMuYXVkaW9CdWZmZXIgIT09IHVuZGVmaW5lZCksXG4gICAgICAgICAgICB2aXNpYmxlTmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgdHlwZTogXCJBc3NldFBhcmFtZXRlclwiLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldCBvbmxvYWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9ubG9hZENhbGxiYWNrO1xuICAgIH1cbiAgICBzZXQgb25sb2FkKGYpIHtcbiAgICAgICAgdGhpcy5vbmxvYWRDYWxsYmFjayA9IGY7XG4gICAgfVxuICAgIGdldCBvbmVycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vbmVycm9yQ2FsbGJhY2s7XG4gICAgfVxuICAgIHNldCBvbmVycm9yKGYpIHtcbiAgICAgICAgdGhpcy5vbmVycm9yQ2FsbGJhY2sgPSBmO1xuICAgIH1cbiAgICBnZXQgaXNSZWFkeVByb21pc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvYWRBc3NldFByb21pc2U7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gYEFzc2V0YDtcbiAgICB9XG4gICAgZ2V0IGJ1ZmZlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXVkaW9CdWZmZXI7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRBc3NldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRBc3NldC5pZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0IHZhbHVlKHYpIHtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2LCB0cnVlKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQbHVnaW5QYXJhbWV0ZXIgfSBmcm9tIFwiLi9QbHVnaW5QYXJhbWV0ZXJcIjtcbi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbmV4cG9ydCBjbGFzcyBCdXR0b25QYXJhbWV0ZXIgZXh0ZW5kcyBQbHVnaW5QYXJhbWV0ZXIge1xuICAgIGNvbnN0cnVjdG9yKG93bmVyLCBuYW1lLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCA9IHRydWUpIHtcbiAgICAgICAgc3VwZXIob3duZXIsIG5hbWUsIFwiQnV0dG9uXCIsIHZpc2libGVOYW1lLCBleHBvc2VkKTtcbiAgICAgICAgdGhpcy5vbmNsaWNrRnVuY3Rpb24gPSAoKSA9PiB7IH07XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgfVxuICAgIGdldFBhcmFtZXRlck9iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZpc2libGVOYW1lOiB0aGlzLnZpc2libGVOYW1lLFxuICAgICAgICAgICAgdHlwZTogXCJCdXR0b25QYXJhbWV0ZXJcIixcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZVxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiQnV0dG9uXCI7XG4gICAgfVxuICAgIDtcbiAgICBnZXQgb25jbGljaygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub25jbGlja0Z1bmN0aW9uO1xuICAgIH1cbiAgICBzZXQgb25jbGljayhmKSB7XG4gICAgICAgIHRoaXMub25jbGlja0Z1bmN0aW9uID0gZjtcbiAgICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gaXNQbHVnaW5CYXNlUGFyYW1ldGVyKG9iamVjdCkge1xuICAgIHJldHVybiAnZ2V0UGFyYW1ldGVyT2JqZWN0JyBpbiBvYmplY3Q7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNQbHVnaW5QYXJhbWV0ZXIob2JqZWN0KSB7XG4gICAgcmV0dXJuIGlzUGx1Z2luQmFzZVBhcmFtZXRlcihvYmplY3QpICYmICdzZXRWYWx1ZScgaW4gb2JqZWN0O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzQXV0b21hdGVkUGx1Z2luUGFyYW1ldGVyKG9iamVjdCkge1xuICAgIHJldHVybiBpc1BsdWdpblBhcmFtZXRlcihvYmplY3QpICYmICdnZXRWYWx1ZUF0VGltZVBvaW50JyBpbiBvYmplY3Q7XG59XG4iLCIvKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5pbXBvcnQgeyBQbHVnaW5QYXJhbWV0ZXIgfSBmcm9tIFwiLi9QbHVnaW5QYXJhbWV0ZXJcIjtcbmltcG9ydCB7IFBhcmFtZXRlclN0ZXBBdXRvbWF0aW9uIH0gZnJvbSBcIi4vUGFyYW1ldGVyQXV0b21hdGlvblwiO1xuZXhwb3J0IGNsYXNzIExpc3RQYXJhbWV0ZXIgZXh0ZW5kcyBQbHVnaW5QYXJhbWV0ZXIge1xuICAgIGNvbnN0cnVjdG9yKG93bmVyLCBuYW1lLCBfZGVmYXVsdFZhbHVlLCBsaXN0T2ZWYWx1ZXMsIHRvU3RyaW5nRnVuYywgdmlzaWJsZU5hbWUsIGV4cG9zZWQgPSB0cnVlKSB7XG4gICAgICAgIHN1cGVyKG93bmVyLCBuYW1lLCBcIkJ1dHRvblwiLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgIHRoaXMuX2RlZmF1bHRWYWx1ZSA9IF9kZWZhdWx0VmFsdWU7XG4gICAgICAgIHRoaXMubGlzdE9mVmFsdWVzID0gbGlzdE9mVmFsdWVzO1xuICAgICAgICB0aGlzLnRvU3RyaW5nRnVuYyA9IHRvU3RyaW5nRnVuYztcbiAgICAgICAgdGhpcy5saXN0SW5kZXggPSBsaXN0T2ZWYWx1ZXMuaW5kZXhPZihfZGVmYXVsdFZhbHVlKTtcbiAgICB9XG4gICAgc2V0Vih2LCB1cGRhdGVJbnRlcmZhY2VzID0gdHJ1ZSkge1xuICAgICAgICBjb25zdCBpID0gdGhpcy5saXN0T2ZWYWx1ZXMuaW5kZXhPZih2KTtcbiAgICAgICAgaWYgKGkgPT09IHVuZGVmaW5lZCB8fCBpIDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgKFwiTm90IGluIGxpc3QgcmFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYm91bmRBdWRpb1BhcmFtKSB7XG4gICAgICAgICAgICB0aGlzLmJvdW5kQXVkaW9QYXJhbS52YWx1ZSA9IHRoaXMudXBkYXRlKHYpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmxpc3RJbmRleCAhPT0gaSkge1xuICAgICAgICAgICAgdGhpcy5saXN0SW5kZXggPSBpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyUGFyYW1ldGVyU2V0KHVwZGF0ZUludGVyZmFjZXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHJpZ2dlcigpO1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0T2ZWYWx1ZXNbdGhpcy5saXN0SW5kZXhdO1xuICAgIH1cbiAgICBpc0F1dG9tYXRhYmxlKCkge1xuICAgICAgICBpZiAoIXRoaXMuYXV0b21hdGFibGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aGlzLnR5cGV9IGlzIG5vdCBhdXRvbWF0YWJsZWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgIH1cbiAgICBzZXRWYWx1ZSh2KSB7XG4gICAgICAgIHRoaXMuc2V0Vih2LCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgfVxuICAgIGluY3JlbWVudCgpIHtcbiAgICAgICAgdmFyIHYgPSB0aGlzLmxpc3RJbmRleCArIDE7XG4gICAgICAgIGlmICh2ID49IHRoaXMubGlzdE9mVmFsdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdiA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsdWUodGhpcy5saXN0T2ZWYWx1ZXNbdGhpcy5saXN0SW5kZXhdKTtcbiAgICB9XG4gICAgZGVjcmVtZW50KCkge1xuICAgICAgICB2YXIgdiA9IHRoaXMubGlzdEluZGV4IC0gMTtcbiAgICAgICAgaWYgKHYgPCAwKSB7XG4gICAgICAgICAgICB2ID0gdGhpcy5saXN0T2ZWYWx1ZXMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWx1ZSh0aGlzLmxpc3RPZlZhbHVlc1t0aGlzLmxpc3RJbmRleF0pO1xuICAgIH1cbiAgICBhZGRPcHRpb25Ub0xpc3QodCkge1xuICAgICAgICBpZiAodGhpcy5saXN0T2ZWYWx1ZXMuaW5jbHVkZXModCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RPZlZhbHVlcy5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RPZlZhbHVlcztcbiAgICB9XG4gICAgZGVsZXRlT3B0aW9uRnJvbUxpc3QodCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMubGlzdE9mVmFsdWVzLmluZGV4T2YodCk7XG4gICAgICAgIGNvbnN0IF92YWx1ZSA9IHRoaXMubGlzdE9mVmFsdWVzW3RoaXMubGlzdEluZGV4XTtcbiAgICAgICAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVtb3ZlZFZhbHVlID0gdGhpcy5saXN0T2ZWYWx1ZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgaWYgKF92YWx1ZSA9PT0gcmVtb3ZlZFZhbHVlWzBdKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RJbmRleCA9IHRoaXMubGlzdEluZGV4ICUgdGhpcy5saXN0T2ZWYWx1ZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5saXN0SW5kZXggPSB0aGlzLmxpc3RPZlZhbHVlcy5pbmRleE9mKF92YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdE9mVmFsdWVzO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdiA9IHRoaXMudmFsdWU7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy50b1N0cmluZ0Z1bmMgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZ0Z1bmModik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHYudG9TdHJpbmcgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdi50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh2KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRQYXJhbWV0ZXJPYmplY3QoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMubGlzdE9mVmFsdWVzLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLl9kZWZhdWx0VmFsdWUsXG4gICAgICAgICAgICBtaW5pbXVtOiAwLFxuICAgICAgICAgICAgbWF4aW11bTogdGhpcy5saXN0T2ZWYWx1ZXMubGVuZ3RoLFxuICAgICAgICAgICAgdmlzaWJsZU5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIHR5cGU6IFwiTGlzdFBhcmFtZXRlclwiLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldFZhbHVlQXRUaW1lUG9pbnQodGltZSkge1xuICAgICAgICBpZiAodGhpcy5pc0F1dG9tYXRhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb24uZ2V0VmFsdWVBdFRpbWVQb2ludCh0aW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGFydCh0aW1lLCBjb250ZXh0VGltZSkge1xuICAgICAgICBpZiAodGhpcy5pc0F1dG9tYXRhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb24uc3RhcnQodGltZSwgY29udGV4dFRpbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoY29udGV4dFRpbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvbWF0YWJsZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRvbWF0aW9uLnN0b3AoY29udGV4dFRpbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJpbmRUb0F1ZGlvUGFyYW0oYXApIHtcbiAgICAgICAgaWYgKGFwIGluc3RhbmNlb2YgQXVkaW9QYXJhbSkge1xuICAgICAgICAgICAgdGhpcy5hdWRpb1BhcmFtZXRlciA9IGFwO1xuICAgICAgICAgICAgdGhpcy5hdWRpb1BhcmFtZXRlci52YWx1ZSA9IHRoaXMudXBkYXRlKHRoaXMubGlzdE9mVmFsdWVzW3RoaXMubGlzdEluZGV4XSk7XG4gICAgICAgICAgICBpZiAoYXAuc2V0VmFsdWVBdFRpbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9tYXRpb24gPSBuZXcgUGFyYW1ldGVyU3RlcEF1dG9tYXRpb24odGhpcywgdGhpcy5hdWRpb1BhcmFtZXRlciwgMCwgdGhpcy5saXN0VmFsdWVzLmxlbmd0aCwgdGhpcy50b1N0cmluZ0Z1bmMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQ2Fubm90IGJpbmQgYXV0b21hdGlvbiBhcyBBdWRpb1BhcmFtZXRlciBpcyBub3QgYXV0b21hdGFibGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJBcmd1bWVudCAxIGlzIG5vdCBhIHZhbGlkIEF1ZGlvUGFyYW1ldGVyIG9iamVjdFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiTGlzdFwiO1xuICAgIH1cbiAgICBnZXQgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgICBnZXQgbGlzdFZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdE9mVmFsdWVzO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIGlmICh0aGlzLmF1ZGlvUGFyYW1ldGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFuc2xhdGUodGhpcy5hdWRpb1BhcmFtZXRlci52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdE9mVmFsdWVzW3RoaXMubGlzdEluZGV4XTtcbiAgICB9XG4gICAgc2V0IHZhbHVlKHYpIHtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2KTtcbiAgICB9XG4gICAgZ2V0IGJvdW5kQXVkaW9QYXJhbSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXVkaW9QYXJhbWV0ZXI7XG4gICAgfVxuICAgIGdldCBhdXRvbWF0YWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0b21hdGlvbiAhPT0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBnZXQgYXV0b21hdGlvblBvaW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0b21hdGlvbjtcbiAgICB9XG4gICAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb24uZW5hYmxlZDtcbiAgICB9XG4gICAgc2V0IGVuYWJsZWQoZSkge1xuICAgICAgICB0aGlzLmF1dG9tYXRpb24uZW5hYmxlZCA9IChlID09PSB0cnVlKTtcbiAgICB9XG59XG4iLCIvKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5pbXBvcnQgeyBQbHVnaW5QYXJhbWV0ZXIgfSBmcm9tIFwiLi9QbHVnaW5QYXJhbWV0ZXJcIjtcbmltcG9ydCB7IFBhcmFtZXRlckxpbmVhckF1dG9tYXRpb24gfSBmcm9tIFwiLi9QYXJhbWV0ZXJBdXRvbWF0aW9uXCI7XG5leHBvcnQgY2xhc3MgTnVtYmVyUGFyYW1ldGVyIGV4dGVuZHMgUGx1Z2luUGFyYW1ldGVyIHtcbiAgICBjb25zdHJ1Y3Rvcihvd25lciwgbmFtZSwgZGVmYXVsdFZhbHVlLCBtaW5pbXVtLCBtYXhpbXVtLCB0b1N0cmluZ0Z1bmMsIHZpc2libGVOYW1lLCBleHBvc2VkID0gdHJ1ZSkge1xuICAgICAgICBzdXBlcihvd25lciwgbmFtZSwgXCJOdW1iZXJcIiwgdmlzaWJsZU5hbWUsIGV4cG9zZWQpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdGhpcy5taW5pbXVtID0gbWluaW11bTtcbiAgICAgICAgdGhpcy5tYXhpbXVtID0gbWF4aW11bTtcbiAgICAgICAgdGhpcy50b1N0cmluZ0Z1bmMgPSB0b1N0cmluZ0Z1bmM7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiTnVtYmVyXCI7XG4gICAgICAgIHRoaXMuX3N0ZXBTaXplID0gMDtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICB9XG4gICAgc2V0VmFsdWUodiwgdXBkYXRlSW50ZXJmYWNlcyA9IHRydWUpIHtcbiAgICAgICAgaWYgKHRoaXMuYXV0b21hdGlvbiAmJiB0aGlzLmF1dG9tYXRpb24uZW5hYmxlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGlvbiBpcyBlbmFibGVkLCBjYW5ub3Qgc2V0IHRoZSB2YWx1ZSFcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWluaW11bSkge1xuICAgICAgICAgICAgdiA9IE1hdGgubWF4KHYsIHRoaXMubWluaW11bSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWF4aW11bSkge1xuICAgICAgICAgICAgdiA9IE1hdGgubWluKHYsIHRoaXMubWF4aW11bSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3N0ZXBTaXplID4gMCkge1xuICAgICAgICAgICAgdiA9IE1hdGgucm91bmQodiAvIHRoaXMuX3N0ZXBTaXplKTtcbiAgICAgICAgICAgIHYgPSB2ICogdGhpcy5fc3RlcFNpemU7XG4gICAgICAgIH1cbiAgICAgICAgdiA9IHRoaXMudXBkYXRlKHYpO1xuICAgICAgICBpZiAodGhpcy5hdWRpb1BhcmFtZXRlcikge1xuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b21hdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm93bmVyLmZhY3RvcnkuY29udGV4dC5zdGF0ZSA9PSAnc3VzcGVuZGVkJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvUGFyYW1ldGVyLnZhbHVlID0gdjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXVkaW9QYXJhbWV0ZXIuc2V0VmFsdWVBdFRpbWUodiwgdGhpcy5vd25lci5mYWN0b3J5LmNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYXVkaW9QYXJhbWV0ZXIudmFsdWUgPSB2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl92YWx1ZSAhPT0gdikge1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2O1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyUGFyYW1ldGVyU2V0KHVwZGF0ZUludGVyZmFjZXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHJpZ2dlcigpO1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgfVxuICAgIGdldFZhbHVlQXRUaW1lUG9pbnQodGltZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRvbWF0aW9uLmdldFZhbHVlQXRUaW1lUG9pbnQodGltZSk7XG4gICAgfVxuICAgIHN0YXJ0KHRpbWUsIGNvbnRleHRUaW1lKSB7XG4gICAgICAgIHRoaXMuYXV0b21hdGlvbi5zdGFydCh0aW1lLCBjb250ZXh0VGltZSk7XG4gICAgfVxuICAgIHN0b3AodGltZSkge1xuICAgICAgICB0aGlzLmF1dG9tYXRpb24uc3RvcCh0aW1lKTtcbiAgICB9XG4gICAgYmluZFRvQXVkaW9QYXJhbShhcCkge1xuICAgICAgICBpZiAodHlwZW9mIGFwID09IFwib2JqZWN0XCIgJiYgYXAudmFsdWUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvUGFyYW1ldGVyID0gYXA7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvUGFyYW1ldGVyLnZhbHVlID0gdGhpcy51cGRhdGUodGhpcy5fdmFsdWUpO1xuICAgICAgICAgICAgaWYgKGFwLnNldFZhbHVlQXRUaW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvbWF0aW9uID0gbmV3IFBhcmFtZXRlckxpbmVhckF1dG9tYXRpb24odGhpcywgdGhpcy5hdWRpb1BhcmFtZXRlciwgdGhpcy5taW5pbXVtLCB0aGlzLm1heGltdW0sIHRoaXMudG9TdHJpbmdGdW5jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhbm5vdCBiaW5kIGF1dG9tYXRpb24gYXMgQXVkaW9QYXJhbWV0ZXIgaXMgbm90IGF1dG9tYXRhYmxlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXJndW1lbnQgMSBpcyBub3QgYSB2YWxpZCBBdWRpb1BhcmFtZXRlciBvYmplY3RcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHYgPSB0aGlzLnZhbHVlO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMudG9TdHJpbmdGdW5jID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmdGdW5jKHYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh2KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRQYXJhbWV0ZXJPYmplY3QoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5kZWZhdWx0VmFsdWUsXG4gICAgICAgICAgICBtaW5pbXVtOiB0aGlzLm1pbmltdW0sXG4gICAgICAgICAgICBtYXhpbXVtOiB0aGlzLm1heGltdW0sXG4gICAgICAgICAgICB2aXNpYmxlTmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgdHlwZTogXCJOdW1iZXJQYXJhbWV0ZXJcIixcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZVxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIGlmICh0aGlzLmF1ZGlvUGFyYW1ldGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvbWF0aW9uICYmIHRoaXMuYXV0b21hdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMub3duZXIuZmFjdG9yeS5nZXRDdXJyZW50UHJvZ3JhbVRpbWUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRvbWF0aW9uLmdldEN1cnJlbnRUaW1lVmFsdWUodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFuc2xhdGUodGhpcy5hdWRpb1BhcmFtZXRlci52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgICBzZXQgdmFsdWUodikge1xuICAgICAgICB0aGlzLnNldFZhbHVlKHYsIHRydWUpO1xuICAgIH1cbiAgICBnZXQgc3RlcFNpemUoKSB7IHJldHVybiB0aGlzLl9zdGVwU2l6ZTsgfVxuICAgIHNldCBzdGVwU2l6ZShuKSB7XG4gICAgICAgIGlmICghaXNGaW5pdGUobikgfHwgbiA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgc3RlcCBzaXplXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0ZXBTaXplID0gbjtcbiAgICB9XG4gICAgZ2V0IGJvdW5kQXVkaW9QYXJhbSgpIHsgcmV0dXJuIHRoaXMuYXVkaW9QYXJhbWV0ZXI7IH1cbiAgICBnZXQgYXV0b21hdGFibGUoKSB7IHJldHVybiB0aGlzLmF1dG9tYXRpb24gIT09IHVuZGVmaW5lZDsgfVxuICAgIGdldCBhdXRvbWF0aW9uUG9pbnRzKCkgeyByZXR1cm4gdGhpcy5hdXRvbWF0aW9uOyB9XG4gICAgZ2V0IGVuYWJsZWQoKSB7IHZhciBfYTsgcmV0dXJuIChfYSA9IHRoaXMuYXV0b21hdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVuYWJsZWQ7IH1cbiAgICBzZXQgZW5hYmxlZCh0KSB7XG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLmF1dG9tYXRpb24uZW5hYmxlZCA9ICh0ID09PSB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbmNsYXNzIFRpbWVQb2ludCB7XG4gICAgY29uc3RydWN0b3Iob3duZXIsIF90aW1lLCBfdmFsdWUsIHRvU3RyaW5nRnVuYykge1xuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgIHRoaXMuX3RpbWUgPSBfdGltZTtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBfdmFsdWU7XG4gICAgICAgIHRoaXMudG9TdHJpbmdGdW5jID0gdG9TdHJpbmdGdW5jO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuX3RpbWUgIT0gXCJudW1iZXJcIiB8fCAhaXNGaW5pdGUodGhpcy5fdGltZSkgfHwgdGhpcy5fdGltZSA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgQ29uc3RydWN0b3I6IFRpbWUgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuX3ZhbHVlICE9IFwibnVtYmVyXCIgfHwgIWlzRmluaXRlKHRoaXMuX3ZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBDb25zdHJ1Y3RvcjogVmFsdWUgbXVzdCBiZSBhIG51bWJlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRWYWx1ZSh2KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdiAhPSBcIm51bWJlclwiIHx8ICFpc0Zpbml0ZSh2KSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiVmFsdWUgbXVzdCBiZSBhIG51bWJlclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxuICAgIHNldFRpbWUodCkge1xuICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJudW1iZXJcIiAmJiBpc0Zpbml0ZSh0KSAmJiB0ID49IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSB0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl90aW1lO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRvU3RyaW5nRnVuYyA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nRnVuYyh0aGlzLl92YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0cmluZyh0aGlzLl92YWx1ZSk7XG4gICAgfVxuICAgIGdldCB0aW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lO1xuICAgIH1cbiAgICBzZXQgdGltZSh0KSB7XG4gICAgICAgIHRoaXMuc2V0VGltZSh0KTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgICB9XG4gICAgc2V0IHZhbHVlKHYpIHtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2KTtcbiAgICB9XG59XG5jbGFzcyBUaW1lUG9pbnRMaXN0IHtcbiAgICBjb25zdHJ1Y3RvcihtaW5fdmFsdWUsIG1heF92YWx1ZSwgdG9TdHJpbmdGdW5jKSB7XG4gICAgICAgIHRoaXMudG9TdHJpbmdGdW5jID0gdG9TdHJpbmdGdW5jO1xuICAgICAgICB0aGlzLmF1dG9tYXRpb25Qb2ludHMgPSBbXTtcbiAgICAgICAgaWYgKHR5cGVvZiBtaW5fdmFsdWUgIT0gXCJudW1iZXJcIiB8fCAhaXNGaW5pdGUobWluX3ZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBDb25zdHJ1Y3RvcjogbWluX3ZhbHVlIGJlIGEgbnVtYmVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgbWF4X3ZhbHVlICE9IFwibnVtYmVyXCIgfHwgIWlzRmluaXRlKG1heF92YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IChcIkludmFsaWQgQ29uc3RydWN0b3I6IG1heF92YWx1ZSBiZSBhIG51bWJlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWluX3ZhbHVlID09IG1heF92YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBDb25zdHJ1Y3RvcjogbWF4X3ZhbHVlIGNhbm5vdCBlcXVhbCB0byBtaW5fdmFsdWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1heF92YWx1ZSA8IG1pbl92YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgKFwiSW52YWxpZCBDb25zdHJ1Y3RvcjogbWluX3ZhbHVlIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gbWF4X3ZhbHVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubWluaW11bSA9IG1pbl92YWx1ZTtcbiAgICAgICAgdGhpcy5tYXhpbXVtID0gbWF4X3ZhbHVlO1xuICAgIH1cbiAgICBnZXRQb2ludEF0VGltZSh0aW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb25Qb2ludHMuZmluZCgocCkgPT4ge1xuICAgICAgICAgICAgcC50aW1lID09IHRpbWU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYXNQb2ludEF0VGltZSh0aW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFBvaW50QXRUaW1lKHRpbWUpICE9PSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHNvcnRQb2ludHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb25Qb2ludHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgaWYgKGEudGltZSA+IGIudGltZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaW5zZXJ0UG9pbnQodGltZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aW1lICE9IFwibnVtYmVyXCIgfHwgIWlzRmluaXRlKHRpbWUpIHx8IHRpbWUgPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJUaW1lIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPSBcIm51bWJlclwiIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IChcIlZhbHVlIG11c3QgYmUgYSBudW1iZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzUG9pbnRBdFRpbWUodGltZSkpIHtcbiAgICAgICAgICAgIHRocm93IChcIkFscmVhZHkgYSB2YWx1ZSBlbnRyeSBhdCB0aW1lIFwiICsgdGltZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBvaW50ID0gbmV3IFRpbWVQb2ludCh0aGlzLCB0aW1lLCB2YWx1ZSwgdGhpcy50b1N0cmluZ0Z1bmMpO1xuICAgICAgICB0aGlzLmF1dG9tYXRpb25Qb2ludHMucHVzaChwb2ludCk7XG4gICAgICAgIHRoaXMuYXV0b21hdGlvblBvaW50cyA9IHRoaXMuc29ydFBvaW50cygpO1xuICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgfVxuICAgIGdldFBvaW50cyhzdGFydF90aW1lLCBlbmRfdGltZSkge1xuICAgICAgICBpZiAoc3RhcnRfdGltZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzdGFydF90aW1lID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5kX3RpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZW5kX3RpbWUgPSBJbmZpbml0eTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hdXRvbWF0aW9uUG9pbnRzLmZpbHRlcihmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludC50aW1lID49IHN0YXJ0X3RpbWUgJiYgcG9pbnQudGltZSA8IGVuZF90aW1lO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGVsZXRlUG9pbnQodGltZSkge1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmF1dG9tYXRpb25Qb2ludHMuZmluZEluZGV4KGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50LnRpbWUgPT0gdGltZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmF1dG9tYXRpb25Qb2ludHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hdXRvbWF0aW9uUG9pbnRzLmxlbmd0aDtcbiAgICB9XG4gICAgZ2V0U3RhdGljVmFsdWVBc1N0cmluZyh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy50b1N0cmluZ0Z1bmMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nRnVuYyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XG4gICAgfVxuICAgIGdldFZhbHVlQXRUaW1lUG9pbnQodGltZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQb2ludEF0VGltZSh0aW1lKTtcbiAgICB9XG4gICAgdXBkYXRlUG9pbnQodGltZSwgb3B0aW9ucykge1xuICAgICAgICBjb25zdCBwb2ludCA9IHRoaXMuYXV0b21hdGlvblBvaW50cy5maW5kKHBvaW50ID0+IHBvaW50LnRpbWUgPT0gdGltZSk7XG4gICAgICAgIGlmIChwb2ludCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnRpbWUgPT0gXCJudW1iZXJcIiAmJiBvcHRpb25zLnRpbWUgIT0gcG9pbnQudGltZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1BvaW50QXRUaW1lKHRpbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQSB0aW1lLXBvaW50IGFscmVhZHkgZXhpc3RzIGF0ICR7U3RyaW5nKG9wdGlvbnMudGltZSl9IHNlY29uZHNgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50LnRpbWUgPSBvcHRpb25zLnRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b21hdGlvblBvaW50cyA9IHRoaXMuc29ydFBvaW50cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBvaW50LnZhbHVlID0gb3B0aW9ucy52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgfVxuICAgIGdldCBsZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb25Qb2ludHMubGVuZ3RoO1xuICAgIH1cbn1cbmNsYXNzIFBhcmFtZXRlckF1dG9tYXRpb24gZXh0ZW5kcyBUaW1lUG9pbnRMaXN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXIsIG1pbl92YWx1ZSwgbWF4X3ZhbHVlLCB0b1N0cmluZ0Z1bmMpIHtcbiAgICAgICAgc3VwZXIobWluX3ZhbHVlLCBtYXhfdmFsdWUsIHRvU3RyaW5nRnVuYyk7XG4gICAgICAgIHRoaXMucGFyYW1ldGVyID0gcGFyYW1ldGVyO1xuICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgZW5hYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNFbmFibGVkO1xuICAgIH1cbiAgICBzZXQgZW5hYmxlZCh0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gKHQgPT09IHRydWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcmFtZXRlckxpbmVhckF1dG9tYXRpb24gZXh0ZW5kcyBQYXJhbWV0ZXJBdXRvbWF0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcihvd25lciwgcGFyYW1ldGVyLCBtaW5fdmFsdWUsIG1heF92YWx1ZSwgdG9TdHJpbmdGdW5jKSB7XG4gICAgICAgIHN1cGVyKHBhcmFtZXRlciwgbWluX3ZhbHVlLCBtYXhfdmFsdWUsIHRvU3RyaW5nRnVuYyk7XG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICB9XG4gICAgbGluZWFySW50ZXJwb2xhdGlvbih0aW1lLCBwb2ludEEsIHBvaW50Qikge1xuICAgICAgICBsZXQgdDEgPSBwb2ludEEudGltZTtcbiAgICAgICAgbGV0IHQyID0gcG9pbnRCLnRpbWU7XG4gICAgICAgIHRpbWUgLT0gdDE7XG4gICAgICAgIHQyIC09IHQxO1xuICAgICAgICB0MSA9IDA7XG4gICAgICAgIGNvbnN0IHAgPSB0aW1lIC8gdDI7XG4gICAgICAgIHJldHVybiBwb2ludEEudmFsdWUgKiAoMSAtIHApICsgcG9pbnRCLnZhbHVlICogcDtcbiAgICB9XG4gICAgZ2V0Q3VycmVudFRpbWVWYWx1ZSh0aW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRpb25Qb2ludHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm93bmVyLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF1dG9tYXRpb25Qb2ludHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb25Qb2ludHNbMF0udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0UG9pbnQgPSB0aGlzLmF1dG9tYXRpb25Qb2ludHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgbmV4dFBvaW50KSB7XG4gICAgICAgICAgICBpZiAobmV4dFBvaW50LnRpbWUgPD0gdGltZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0UG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMuYXV0b21hdGlvblBvaW50c1swXSk7XG4gICAgICAgIHZhciBzZWNvbmRQb2ludCA9IHRoaXMuYXV0b21hdGlvblBvaW50cy5maW5kKGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50LnRpbWUgPiBmaXJzdFBvaW50LnRpbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2Vjb25kUG9pbnQgPT09IHVuZGVmaW5lZCB8fCBmaXJzdFBvaW50LnRpbWUgPiB0aW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyc3RQb2ludC52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5saW5lYXJJbnRlcnBvbGF0aW9uKHRpbWUsIGZpcnN0UG9pbnQsIHNlY29uZFBvaW50KTtcbiAgICB9XG4gICAgc3RhcnQodGltZSwgY29udGV4dFRpbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3NpdGlvbiA9IHRoaXMub3duZXIudXBkYXRlKHRoaXMuZ2V0Q3VycmVudFRpbWVWYWx1ZSh0aW1lKSk7XG4gICAgICAgICAgICB0aGlzLnBhcmFtZXRlci5zZXRWYWx1ZUF0VGltZShzdGFydFBvc2l0aW9uLCBjb250ZXh0VGltZSk7XG4gICAgICAgICAgICB0aGlzLmF1dG9tYXRpb25Qb2ludHMuZm9yRWFjaCgocCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwLnRpbWUgPiB0aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBwLnRpbWUgLSB0aW1lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2ID0gdGhpcy5vd25lci51cGRhdGUocC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyYW1ldGVyLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHYsIHQgKyBjb250ZXh0VGltZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcChjb250ZXh0VGltZSkge1xuICAgICAgICBpZiAoY29udGV4dFRpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29udGV4dFRpbWUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyYW1ldGVyLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyhjb250ZXh0VGltZSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcmFtZXRlclN0ZXBBdXRvbWF0aW9uIGV4dGVuZHMgUGFyYW1ldGVyQXV0b21hdGlvbiB7XG4gICAgY29uc3RydWN0b3Iob3duZXIsIHBhcmFtZXRlciwgbWluX3ZhbHVlLCBtYXhfdmFsdWUsIHRvU3RyaW5nRnVuYykge1xuICAgICAgICBzdXBlcihwYXJhbWV0ZXIsIG1pbl92YWx1ZSwgbWF4X3ZhbHVlLCB0b1N0cmluZ0Z1bmMpO1xuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XG4gICAgfVxuICAgIGdldEN1cnJlbnRUaW1lVmFsdWUodGltZSkge1xuICAgICAgICBpZiAodGhpcy5hdXRvbWF0aW9uUG9pbnRzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJObyBhdXRvbWF0aW9uIHBvaW50cyBhdmFpbGFibGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b21hdGlvblBvaW50cy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXV0b21hdGlvblBvaW50c1swXS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZWFyZXN0UG9pbnQgPSB0aGlzLmF1dG9tYXRpb25Qb2ludHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgbmV4dFBvaW50KSB7XG4gICAgICAgICAgICBpZiAobmV4dFBvaW50LnRpbWUgPD0gdGltZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0UG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMuYXV0b21hdGlvblBvaW50c1swXSk7XG4gICAgICAgIHJldHVybiBuZWFyZXN0UG9pbnQudmFsdWU7XG4gICAgfVxuICAgIHN0YXJ0KHRpbWUsIGNvbnRleHRUaW1lKSB7XG4gICAgICAgIHZhciBzdGFydFBvc2l0aW9uID0gdGhpcy5vd25lci51cGRhdGUodGhpcy5nZXRDdXJyZW50VGltZVZhbHVlKHRpbWUpKTtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXIuc2V0VmFsdWVBdFRpbWUoc3RhcnRQb3NpdGlvbiwgY29udGV4dFRpbWUpO1xuICAgICAgICB0aGlzLmF1dG9tYXRpb25Qb2ludHMuZm9yRWFjaChwID0+IHtcbiAgICAgICAgICAgIGlmIChwLnRpbWUgPiB0aW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBwLnRpbWUgLSB0aW1lO1xuICAgICAgICAgICAgICAgIHZhciB2ID0gdGhpcy5vd25lci51cGRhdGUocC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXIuc2V0VmFsdWVBdFRpbWUodiwgdCArIGNvbnRleHRUaW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0b3AoY29udGV4dFRpbWUpIHtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXIuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKGNvbnRleHRUaW1lKTtcbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUGx1Z2luUGFyYW1ldGVyIHtcbiAgICBjb25zdHJ1Y3Rvcihvd25lciwgX25hbWUsIGRhdGFUeXBlLCBfdmlzaWJsZU5hbWUsIF9leHBvc2VkID0gdHJ1ZSkge1xuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgIHRoaXMuX25hbWUgPSBfbmFtZTtcbiAgICAgICAgdGhpcy5fdmlzaWJsZU5hbWUgPSBfdmlzaWJsZU5hbWU7XG4gICAgICAgIHRoaXMuX2V4cG9zZWQgPSBfZXhwb3NlZDtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldCA9IG5ldyBFdmVudFRhcmdldCgpO1xuICAgICAgICB0aGlzLl91cGRhdGVGdW5jdGlvbiA9ICh2KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdjtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fdHJhbnNsYXRlRnVuY3Rpb24gPSAodikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3RyaWdnZXJGdW5jdGlvbiA9ICgpID0+IHsgfTtcbiAgICAgICAgdmFyIHVwZGF0ZSwgdHJhbnNsYXRlLCB0cmlnZ2VyO1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBuZXcgRXZlbnRUYXJnZXQoKTtcbiAgICAgICAgdXBkYXRlID0gdHJhbnNsYXRlID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICB9O1xuICAgICAgICB0cmlnZ2VyID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgIH1cbiAgICBkZXN0cm95KCkgeyB9XG4gICAgc2V0VmFsdWUodikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBzZXQgdGhpcyBwYXJhbWV0ZXInKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlBsdWdpblBhcmFtZXRlclwiO1xuICAgIH1cbiAgICA7XG4gICAgZ2V0UGFyYW1ldGVyT2JqZWN0KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgdmlzaWJsZU5hbWU6IHRoaXMudmlzaWJsZU5hbWUsXG4gICAgICAgICAgICB0eXBlOiBcIlBsdWdpblBhcmFtZXRlclwiXG4gICAgICAgIH07XG4gICAgfVxuICAgIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHRyaWdnZXJQYXJhbWV0ZXJTZXQodXBkYXRlSW50ZXJmYWNlcyA9IHRydWUpIHtcbiAgICAgICAgaWYgKHVwZGF0ZUludGVyZmFjZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdXBkYXRlSW50ZXJmYWNlcyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIHBhcmFtZXRlcjogdGhpcy5nZXRQYXJhbWV0ZXJPYmplY3QoKSxcbiAgICAgICAgICAgICAgICB1cGRhdGVJbnRlcmZhY2VzOiB1cGRhdGVJbnRlcmZhY2VzXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJwYXJhbWV0ZXJzZXRcIiwgb3B0cykpO1xuICAgIH1cbiAgICBiaW5kVG9BdWRpb1BhcmFtKGFwKSB7XG4gICAgICAgIHRocm93IChcIkNhbm5vdCBiaW5kIHRoaXMgcGFyYW1ldGVyIHR5cGUgdG8gYW4gYXVkaW8gcGFyYW1ldGVyXCIpO1xuICAgIH1cbiAgICBnZXQgYm91bmRBdWRpb1BhcmFtKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgfVxuICAgIGdldCB2aXNpYmxlTmFtZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Zpc2libGVOYW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy5fdmlzaWJsZU5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlzaWJsZU5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBleHBvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZXhwb3NlZDtcbiAgICB9XG4gICAgc2V0IGV4cG9zZWQoZSkge1xuICAgICAgICB0aGlzLl9leHBvc2VkID0gZSA9PT0gdHJ1ZTtcbiAgICB9XG4gICAgZ2V0IHVwZGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUZ1bmN0aW9uO1xuICAgIH1cbiAgICBzZXQgdXBkYXRlKGYpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlRnVuY3Rpb24gPSBmO1xuICAgIH1cbiAgICBnZXQgdHJhbnNsYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNsYXRlRnVuY3Rpb247XG4gICAgfVxuICAgIHNldCB0cmFuc2xhdGUoZikge1xuICAgICAgICB0aGlzLl90cmFuc2xhdGVGdW5jdGlvbiA9IGY7XG4gICAgfVxuICAgIGdldCB0cmlnZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJpZ2dlckZ1bmN0aW9uO1xuICAgIH1cbiAgICBzZXQgdHJpZ2dlcihmKSB7XG4gICAgICAgIHRoaXMuX3RyaWdnZXJGdW5jdGlvbiA9IGY7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUGx1Z2luUGFyYW1ldGVyIH0gZnJvbSBcIi4vUGx1Z2luUGFyYW1ldGVyXCI7XG5leHBvcnQgY2xhc3MgU3RyaW5nUGFyYW1ldGVyIGV4dGVuZHMgUGx1Z2luUGFyYW1ldGVyIHtcbiAgICBjb25zdHJ1Y3Rvcihvd25lciwgbmFtZSwgZGVmYXVsdFZhbHVlLCBtYXhMZW5ndGgsIHRvU3RyaW5nRnVuYywgdmlzaWJsZU5hbWUsIGV4cG9zZWQgPSB0cnVlKSB7XG4gICAgICAgIHN1cGVyKG93bmVyLCBuYW1lLCBcIlN0cmluZ1wiLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICB0aGlzLm1heExlbmd0aCA9IG1heExlbmd0aDtcbiAgICAgICAgdGhpcy50b1N0cmluZ0Z1bmMgPSB0b1N0cmluZ0Z1bmM7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiU3RyaW5nXCI7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgICBzZXRWYWx1ZSh2LCB1cGRhdGVJbnRlcmZhY2VzID0gdHJ1ZSkge1xuICAgICAgICBsZXQgbmV3VmFsdWU7XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSB2O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tYXhMZW5ndGggJiYgbmV3VmFsdWUubGVuZ3RoID4gdGhpcy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU3RyaW5nIGxvbmdlciB0aGFuICR7dGhpcy5tYXhMZW5ndGh9IGNoYXJhY3RlcnNgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ib3VuZEF1ZGlvUGFyYW0pIHtcbiAgICAgICAgICAgIHRoaXMuYm91bmRBdWRpb1BhcmFtLnZhbHVlID0gdGhpcy51cGRhdGUodik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3ZhbHVlICE9PSB2KSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHY7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJQYXJhbWV0ZXJTZXQodXBkYXRlSW50ZXJmYWNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHsgfVxuICAgIGJpbmRUb0F1ZGlvUGFyYW0oYXApIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcCA9PSBcIm9iamVjdFwiICYmIGFwLnZhbHVlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5hdWRpb1BhcmFtZXRlciA9IGFwO1xuICAgICAgICAgICAgdGhpcy5hdWRpb1BhcmFtZXRlci52YWx1ZSA9IHRoaXMudXBkYXRlKHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFyZ3VtZW50IDEgaXMgbm90IGEgdmFsaWQgQXVkaW9QYXJhbWV0ZXIgb2JqZWN0XCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCB2ID0gdGhpcy5fdmFsdWU7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy50b1N0cmluZ0Z1bmMgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZ0Z1bmMuY2FsbCh0aGlzLCB2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFBhcmFtZXRlck9iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLmRlZmF1bHRWYWx1ZSxcbiAgICAgICAgICAgIG1heExlbmd0aDogdGhpcy5tYXhMZW5ndGgsXG4gICAgICAgICAgICB2aXNpYmxlTmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgdHlwZTogXCJTdHJpbmdQYXJhbWV0ZXJcIixcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZVxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIGlmICh0aGlzLmJvdW5kQXVkaW9QYXJhbSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNsYXRlKHRoaXMuYm91bmRBdWRpb1BhcmFtLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxuICAgIHNldCB2YWx1ZSh0KSB7IHRoaXMuc2V0VmFsdWUodCwgdHJ1ZSk7IH1cbiAgICBnZXQgYm91bmRBdWRpb1BhcmFtKCkgeyByZXR1cm4gdGhpcy5hdWRpb1BhcmFtZXRlcjsgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuaW1wb3J0IHsgUGx1Z2luUGFyYW1ldGVyIH0gZnJvbSBcIi4vUGx1Z2luUGFyYW1ldGVyXCI7XG5pbXBvcnQgeyBQYXJhbWV0ZXJTdGVwQXV0b21hdGlvbiB9IGZyb20gXCIuL1BhcmFtZXRlckF1dG9tYXRpb25cIjtcbmV4cG9ydCBjbGFzcyBTd2l0Y2hQYXJhbWV0ZXIgZXh0ZW5kcyBQbHVnaW5QYXJhbWV0ZXIge1xuICAgIGNvbnN0cnVjdG9yKG93bmVyLCBuYW1lLCBkZWZhdWx0VmFsdWUsIG1pblN0YXRlLCBtYXhTdGF0ZSwgdG9TdHJpbmdGdW5jLCB2aXNpYmxlTmFtZSwgZXhwb3NlZCA9IHRydWUpIHtcbiAgICAgICAgc3VwZXIob3duZXIsIG5hbWUsIFwiTnVtYmVyXCIsIHZpc2libGVOYW1lLCBleHBvc2VkKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHRoaXMubWluU3RhdGUgPSBtaW5TdGF0ZTtcbiAgICAgICAgdGhpcy5tYXhTdGF0ZSA9IG1heFN0YXRlO1xuICAgICAgICB0aGlzLnRvU3RyaW5nRnVuYyA9IHRvU3RyaW5nRnVuYztcbiAgICAgICAgdGhpcy50eXBlID0gXCJTd2l0Y2hcIjtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICB9XG4gICAgc2V0VmFsdWUodiwgdXBkYXRlSW50ZXJmYWNlcyA9IHRydWUpIHtcbiAgICAgICAgaWYgKHYgPCB0aGlzLm1pblN0YXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTZXQgdmFsdWUgaXMgbGVzcyB0aGFuIFwiICsgdGhpcy5taW5TdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHYgPiB0aGlzLm1heFN0YXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTZXQgdmFsdWUgaXMgZ3JlYXRlciB0aGFuIFwiICsgdGhpcy5tYXhTdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXVkaW9QYXJhbWV0ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9QYXJhbWV0ZXIudmFsdWUgPSB0aGlzLnVwZGF0ZSh2KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fdmFsdWUgIT09IHYpIHtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gdjtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlclBhcmFtZXRlclNldCh1cGRhdGVJbnRlcmZhY2VzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyaWdnZXIoKTtcbiAgICAgICAgcmV0dXJuIHY7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7IH1cbiAgICBpbmNyZW1lbnQoKSB7XG4gICAgICAgIGxldCB2ID0gdGhpcy5fdmFsdWUgLSAxO1xuICAgICAgICBpZiAodiA8IHRoaXMubWluU3RhdGUpIHtcbiAgICAgICAgICAgIHYgPSB0aGlzLm1heFN0YXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHYpO1xuICAgIH1cbiAgICBkZWNyZW1lbnQoKSB7XG4gICAgICAgIGxldCB2ID0gdGhpcy5fdmFsdWUgLSAxO1xuICAgICAgICBpZiAodiA8IHRoaXMubWluU3RhdGUpIHtcbiAgICAgICAgICAgIHYgPSB0aGlzLm1heFN0YXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHYpO1xuICAgIH1cbiAgICBiaW5kVG9BdWRpb1BhcmFtKGFwKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXAgPT0gXCJvYmplY3RcIiAmJiBhcC52YWx1ZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9QYXJhbWV0ZXIgPSBhcDtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9QYXJhbWV0ZXIudmFsdWUgPSB0aGlzLnVwZGF0ZSh0aGlzLl92YWx1ZSk7XG4gICAgICAgICAgICBpZiAoYXAuc2V0VmFsdWVBdFRpbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9tYXRpb24gPSBuZXcgUGFyYW1ldGVyU3RlcEF1dG9tYXRpb24odGhpcywgdGhpcy5hdWRpb1BhcmFtZXRlciwgdGhpcy5taW5TdGF0ZSwgdGhpcy5tYXhTdGF0ZSwgdGhpcy50b1N0cmluZ0Z1bmMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiQ2Fubm90IGJpbmQgYXV0b21hdGlvbiBhcyBBdWRpb1BhcmFtZXRlciBpcyBub3QgYXV0b21hdGFibGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBcmd1bWVudCAxIGlzIG5vdCBhIHZhbGlkIEF1ZGlvUGFyYW1ldGVyIG9iamVjdFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdiA9IHRoaXMuX3ZhbHVlO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMudG9TdHJpbmdGdW5jID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmdGdW5jLmNhbGwodGhpcywgdik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFBhcmFtZXRlck9iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLmRlZmF1bHRWYWx1ZSxcbiAgICAgICAgICAgIG1pbmltdW06IHRoaXMubWluU3RhdGUsXG4gICAgICAgICAgICBtYXhpbXVtOiB0aGlzLm1heFN0YXRlLFxuICAgICAgICAgICAgdmlzaWJsZU5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIHR5cGU6IFwiU3dpdGNoUGFyYW1ldGVyXCIsXG4gICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICBpZiAodGhpcy5hdWRpb1BhcmFtZXRlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNsYXRlKHRoaXMuYXVkaW9QYXJhbWV0ZXIudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gICAgc2V0IHZhbHVlKHYpIHsgdGhpcy5zZXRWYWx1ZSh2LCB0cnVlKTsgfVxuICAgIGdldCBib3VuZEF1ZGlvUGFyYW0oKSB7IHJldHVybiB0aGlzLmF1ZGlvUGFyYW1ldGVyOyB9XG4gICAgZ2V0IGF1dG9tYXRhYmxlKCkgeyByZXR1cm4gdGhpcy5hdXRvbWF0aW9uICE9PSB1bmRlZmluZWQ7IH1cbiAgICBnZXQgYXV0b21hdGlvblBvaW50cygpIHsgcmV0dXJuIHRoaXMuYXV0b21hdGlvbjsgfVxuICAgIGdldCBlbmFibGVkKCkgeyB2YXIgX2E7IHJldHVybiAoX2EgPSB0aGlzLmF1dG9tYXRpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5lbmFibGVkOyB9XG4gICAgc2V0IGVuYWJsZWQodCkge1xuICAgICAgICBpZiAodGhpcy5hdXRvbWF0YWJsZSkge1xuICAgICAgICAgICAgdGhpcy5hdXRvbWF0aW9uLmVuYWJsZWQgPSAodCA9PT0gdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0VmFsdWVBdFRpbWVQb2ludCh0aW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dG9tYXRpb24uZ2V0VmFsdWVBdFRpbWVQb2ludCh0aW1lKTtcbiAgICB9XG4gICAgc3RhcnQodGltZSwgY29udGV4dFRpbWUpIHtcbiAgICAgICAgdGhpcy5hdXRvbWF0aW9uLnN0YXJ0KHRpbWUsIGNvbnRleHRUaW1lKTtcbiAgICB9XG4gICAgc3RvcCh0aW1lKSB7XG4gICAgICAgIHRoaXMuYXV0b21hdGlvbi5zdG9wKHRpbWUpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFBsdWdpblBhcmFtZXRlciB9IGZyb20gXCIuL1BsdWdpblBhcmFtZXRlclwiO1xuZXhwb3J0IGNsYXNzIFVSTFBhcmFtZXRlciBleHRlbmRzIFBsdWdpblBhcmFtZXRlciB7XG4gICAgY29uc3RydWN0b3Iob3duZXIsIG5hbWUsIGRlZmF1bHRWYWx1ZSwgbWF4TGVuZ3RoLCB0b1N0cmluZ0Z1bmMsIHZpc2libGVOYW1lLCBleHBvc2VkID0gdHJ1ZSkge1xuICAgICAgICBzdXBlcihvd25lciwgbmFtZSwgXCJTdHJpbmdcIiwgdmlzaWJsZU5hbWUsIGV4cG9zZWQpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdGhpcy5tYXhMZW5ndGggPSBtYXhMZW5ndGg7XG4gICAgICAgIHRoaXMudG9TdHJpbmdGdW5jID0gdG9TdHJpbmdGdW5jO1xuICAgICAgICB0aGlzLnR5cGUgPSBcIlVSTFwiO1xuICAgIH1cbiAgICBnZXRSZXNvdXJjZSh0eXBlKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc291cmNlT2JqZWN0ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZU9iamVjdCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICB4aHIub3BlbihcIkdFVFwiLCB0aGlzLl92YWx1ZSk7XG4gICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiB4aHIuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGUudGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogeGhyLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiZXJyb3JcIlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogeGhyLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwidGltZW91dFwiXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlc291cmNlT2JqZWN0O1xuICAgIH1cbiAgICBzZXRWYWx1ZSh2LCB1cGRhdGVJbnRlcmZhY2VzID0gdHJ1ZSkge1xuICAgICAgICBpZiAodGhpcy5tYXhMZW5ndGggJiYgdi5sZW5ndGggPiB0aGlzLm1heExlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTdHJpbmcgbG9uZ2VyIHRoYW4gJHt0aGlzLm1heExlbmd0aH0gY2hhcmFjdGVyc2ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl92YWx1ZSAhPT0gdikge1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZU9iamVjdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gdjtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlclBhcmFtZXRlclNldCh1cGRhdGVJbnRlcmZhY2VzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyaWdnZXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRvU3RyaW5nRnVuYyA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nRnVuYy5jYWxsKHRoaXMsIHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRQYXJhbWV0ZXJPYmplY3QoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5kZWZhdWx0VmFsdWUsXG4gICAgICAgICAgICBtYXhMZW5ndGg6IHRoaXMubWF4TGVuZ3RoLFxuICAgICAgICAgICAgdmlzaWJsZU5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIHR5cGU6IFwiVVJMUGFyYW1ldGVyXCIsXG4gICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkgeyByZXR1cm4gdGhpcy5fdmFsdWU7IH1cbiAgICA7XG4gICAgc2V0IHZhbHVlKHQpIHsgdGhpcy5zZXRWYWx1ZSh0KTsgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuaW1wb3J0IHsgT3V0cHV0Tm9kZSB9IGZyb20gXCIuLi8uLi9FeHRyYWN0b3JzL091dHB1dE5vZGVcIjtcbmV4cG9ydCBjbGFzcyBTdWJGYWN0b3J5RmVhdHVyZVNlbmRlciB7XG4gICAgY29uc3RydWN0b3Iob3duZXIsIEZhY3RvcnlGZWF0dXJlTWFwKSB7XG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgdGhpcy5GYWN0b3J5RmVhdHVyZU1hcCA9IEZhY3RvcnlGZWF0dXJlTWFwO1xuICAgICAgICB0aGlzLm91dHB1dE5vZGVzID0gW107XG4gICAgICAgIHRoaXMuRmFjdG9yeUZlYXR1cmVNYXAuY3JlYXRlU291cmNlTWFwKHRoaXMsIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIHVwZGF0ZUZlYXR1cmVzKGZlYXR1cmVPYmplY3QsIG91dHB1dEluZGV4ID0gMCkge1xuICAgICAgICBpZiAodGhpcy5vdXRwdXROb2Rlc1tvdXRwdXRJbmRleF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKG91dHB1dEluZGV4ID4gMSkge1xuICAgICAgICAgICAgICAgIHRocm93IChcIlJlcXVlc3RlZCBhbiBvdXRwdXQgdGhhdCBkb2VzIG5vdCBleGlzdFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub3V0cHV0Tm9kZXNbb3V0cHV0SW5kZXhdID0gbmV3IE91dHB1dE5vZGUodGhpcywgdGhpcy5vd25lci5jaGFpblN0YXJ0LCBvdXRwdXRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgc2kgPSAwOyBzaSA8IGZlYXR1cmVPYmplY3QubGVuZ3RoOyBzaSsrKSB7XG4gICAgICAgICAgICBsZXQgZXh0cmFjdG9yID0gdGhpcy5vdXRwdXROb2Rlc1tvdXRwdXRJbmRleF0uZmluZEV4dHJhY3RvcihmZWF0dXJlT2JqZWN0W3NpXS5mcmFtZVNpemUpO1xuICAgICAgICAgICAgaWYgKCFleHRyYWN0b3IpIHtcbiAgICAgICAgICAgICAgICBleHRyYWN0b3IgPSB0aGlzLm91dHB1dE5vZGVzW291dHB1dEluZGV4XS5hZGRFeHRyYWN0b3IoZmVhdHVyZU9iamVjdFtzaV0uZnJhbWVTaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4dHJhY3Rvci5zZXRGZWF0dXJlcyhmZWF0dXJlT2JqZWN0W3NpXS5mZWF0dXJlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgO1xuICAgIHJlam9pbkV4dHJhY3RvcnMoKSB7XG4gICAgICAgIGZvciAoY29uc3Qgb3V0cHV0Tm9kZSBvZiB0aGlzLm91dHB1dE5vZGVzKSB7XG4gICAgICAgICAgICBvdXRwdXROb2RlLnJlam9pbkV4dHJhY3RvcnMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3N0RmVhdHVyZXMoZmVhdHVyZU9iamVjdCkge1xuICAgICAgICAvKlxuICAgICAgICAgICAgQ2FsbGVkIGJ5IHRoZSBpbmRpdmlkdWFsIGV4dHJhY3RvciBpbnN0YW5jZXM6XG4gICAgICAgICAgICBmZWF0dXJlT2JqZWN0ID0geydmcmFtZVNpemUnOiBmcmFtZVNpemUsXG4gICAgICAgICAgICAnb3V0cHV0SW5kZXgnOiBvdXRwdXRJbmRleCxcbiAgICAgICAgICAgICdyZXN1bHRzJzpbXX1cbiAgICAgICAgKi9cbiAgICAgICAgdGhpcy5GYWN0b3J5RmVhdHVyZU1hcC5wb3N0RmVhdHVyZXMoe1xuICAgICAgICAgICAgJ3BsdWdpbic6IHRoaXMsXG4gICAgICAgICAgICAnb3V0cHV0SW5kZXgnOiBmZWF0dXJlT2JqZWN0Lm91dHB1dEluZGV4LFxuICAgICAgICAgICAgJ2ZyYW1lU2l6ZSc6IGZlYXR1cmVPYmplY3QuZnJhbWVTaXplLFxuICAgICAgICAgICAgJ3Jlc3VsdHMnOiBmZWF0dXJlT2JqZWN0LnJlc3VsdHNcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIDtcbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLkZhY3RvcnlGZWF0dXJlTWFwLmRlbGV0ZVNvdXJjZU1hcCh0aGlzKTtcbiAgICB9XG59XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbmltcG9ydCB7IExpbmtlZFN0b3JlIH0gZnJvbSBcIi4uLy4uL0xpbmtlZFN0b3JlXCI7XG5pbXBvcnQgeyBTdWJGYWN0b3J5RmVhdHVyZVNlbmRlciB9IGZyb20gXCIuL1N1YkZhY3RvcnlGZWF0dXJlU2VuZGVyL2luZGV4XCI7XG52YXIgQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZTtcbihmdW5jdGlvbiAoQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZSkge1xuICAgIEF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyU3RhdGVbQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZVtcIlJFQURZXCJdID0gMF0gPSBcIlJFQURZXCI7XG4gICAgQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZVtBdWRpb1BsdWdpbkNoYWluTWFuYWdlclN0YXRlW1wiQ0xPU0VEXCJdID0gMV0gPSBcIkNMT1NFRFwiO1xufSkoQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZSB8fCAoQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZSA9IHt9KSk7XG5leHBvcnQgY2xhc3MgQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKFBsdWdpbkZhY3RvcnksIGNoYWluU3RhcnQsIGNoYWluU3RvcCkge1xuICAgICAgICB0aGlzLlBsdWdpbkZhY3RvcnkgPSBQbHVnaW5GYWN0b3J5O1xuICAgICAgICB0aGlzLmNoYWluU3RhcnQgPSBjaGFpblN0YXJ0O1xuICAgICAgICB0aGlzLmNoYWluU3RvcCA9IGNoYWluU3RvcDtcbiAgICAgICAgdGhpcy5wbHVnaW5fbGlzdCA9IFtdO1xuICAgICAgICB0aGlzLnN0YXRlID0gQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZS5SRUFEWTtcbiAgICAgICAgdGhpcy5kZWxheVNhbXBsZXMgPSAwO1xuICAgICAgICB0aGlzLmZlYXR1cmVTZW5kZXIgPSBuZXcgU3ViRmFjdG9yeUZlYXR1cmVTZW5kZXIodGhpcywgdGhpcy5QbHVnaW5GYWN0b3J5LkZlYXR1cmVNYXApO1xuICAgICAgICB0aGlzLnNlbWFudGljU3RvcmVzID0gW107XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBuZXcgRXZlbnRUYXJnZXQoKTtcbiAgICAgICAgdGhpcy5mYWN0b3J5TmFtZSA9ICcnO1xuICAgICAgICB0aGlzLlRyYWNrRGF0YSA9IG5ldyBMaW5rZWRTdG9yZShcIlRyYWNrXCIpO1xuICAgICAgICBjaGFpblN0YXJ0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgY2hhaW5TdGFydC5jb25uZWN0KGNoYWluU3RvcCk7XG4gICAgfVxuICAgIHJlYnVpbGQoKSB7XG4gICAgICAgIGxldCBpID0gMCwgbCA9IHRoaXMucGx1Z2luX2xpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgd2hpbGUgKGkgPCBsKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IHRoaXMucGx1Z2luX2xpc3RbaSsrXTtcbiAgICAgICAgICAgIGNvbnN0IG5leHROb2RlID0gdGhpcy5wbHVnaW5fbGlzdFtpXTtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlLnJlY29ubmVjdChuZXh0Tm9kZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaXNvbGF0ZSgpIHtcbiAgICAgICAgdGhpcy5wbHVnaW5fbGlzdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICAgICAgICBlLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGN1dENoYWluKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luX2xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhaW5TdGFydC5kaXNjb25uZWN0KHRoaXMucGx1Z2luX2xpc3RbMF0uaW5wdXQpO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luX2xpc3RbdGhpcy5wbHVnaW5fbGlzdC5sZW5ndGggLSAxXS5vdXRwdXQuZGlzY29ubmVjdCh0aGlzLmNoYWluU3RvcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYWluU3RhcnQuZGlzY29ubmVjdCh0aGlzLmNoYWluU3RvcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ2NvdWxkIG5vdCBkaXNjb25uZWN0IHBsdWdpbiBjaGFpbiEnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgam9pbkNoYWluKCkge1xuICAgICAgICBpZiAodGhpcy5wbHVnaW5fbGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmNoYWluU3RhcnQuY29ubmVjdCh0aGlzLnBsdWdpbl9saXN0WzBdLmlucHV0KTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luX2xpc3RbdGhpcy5wbHVnaW5fbGlzdC5sZW5ndGggLSAxXS5vdXRwdXQuY29ubmVjdCh0aGlzLmNoYWluU3RvcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNoYWluU3RhcnQuY29ubmVjdCh0aGlzLmNoYWluU3RvcCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mZWF0dXJlU2VuZGVyLnJlam9pbkV4dHJhY3RvcnMoKTtcbiAgICB9XG4gICAgYnVpbGROZXdQbHVnaW4ocHJvdG90eXBlT2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZS5DTE9TRUQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdWJGYWN0b3J5IGhhcyBiZWVuIGRlc3Ryb3llZCEgQ2Fubm90IGFkZCBuZXcgcGx1Z2luc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB5aWVsZCBwcm90b3R5cGVPYmplY3QuY3JlYXRlUGx1Z2luSW5zdGFuY2UodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldERlbGF5Q29tcGVuc2F0aW9uKCkge1xuICAgICAgICBsZXQgc3VtID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgdGhpcy5wbHVnaW5fbGlzdCkge1xuICAgICAgICAgICAgaWYgKCFwbHVnaW4uaXNCeXBhc3NlZCgpKSB7XG4gICAgICAgICAgICAgICAgc3VtICs9IHBsdWdpbi5ub2RlLnByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VtO1xuICAgIH1cbiAgICBieXBhc3NQbHVnaW4ocGx1Z2luX2luc3RhbmNlLCBzdGF0ZSkge1xuICAgICAgICAvLyBDaGVjayBpcyBhIG1lbWJlciBvZiB0aGlzIGNoYWluXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbl9saXN0LmluY2x1ZGVzKHBsdWdpbl9pbnN0YW5jZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcGx1Z2luX2luc3RhbmNlLmJ5cGFzcyhzdGF0ZSk7XG4gICAgfVxuICAgIGdldFByb3RvdHlwZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlBsdWdpbkZhY3RvcnkuZ2V0UHJvdG90eXBlcygpO1xuICAgIH1cbiAgICBnZXRGYWN0b3J5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5QbHVnaW5GYWN0b3J5O1xuICAgIH1cbiAgICA7XG4gICAgZGVzdHJveShyZWNvbm5lY3QgPSBmYWxzZSkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZS5SRUFEWSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwbHVnaW5JbnN0YW5jZW8gb2YgdGhpcy5wbHVnaW5fbGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveVBsdWdpbihwbHVnaW5JbnN0YW5jZW8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jaGFpblN0YXJ0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIGlmIChyZWNvbm5lY3QgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYWluU3RhcnQuY29ubmVjdCh0aGlzLmNoYWluU3RvcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZlYXR1cmVTZW5kZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IEF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyU3RhdGUuQ0xPU0VEO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVBsdWdpbihwcm90b3R5cGVPYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBBdWRpb1BsdWdpbkNoYWluTWFuYWdlclN0YXRlLkNMT1NFRCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBub2RlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBub2RlID0geWllbGQgdGhpcy5idWlsZE5ld1BsdWdpbihwcm90b3R5cGVPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY3V0Q2hhaW4oKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luX2xpc3QucHVzaChub2RlKTtcbiAgICAgICAgICAgIHRoaXMuaXNvbGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5yZWJ1aWxkKCk7XG4gICAgICAgICAgICB0aGlzLmpvaW5DaGFpbigpO1xuICAgICAgICAgICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwiYWx0ZXJkZWxheVwiLCB0aGlzKTtcbiAgICAgICAgICAgIG5vZGUubm9kZS5vbmxvYWRlZC5jYWxsKG5vZGUubm9kZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURlbGF5Q29tcGVuc2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiY2hhbmdlXCIpKTtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmVtb3ZlUGx1Z2luKHBsdWdpbl9vYmplY3QpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IEF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyU3RhdGUuQ0xPU0VEKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5nZXRQbHVnaW5JbmRleChwbHVnaW5fb2JqZWN0KTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHRoaXMuY3V0Q2hhaW4oKTtcbiAgICAgICAgICAgIHBsdWdpbl9vYmplY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFsdGVyZGVsYXlcIiwgdGhpcyk7XG4gICAgICAgICAgICBwbHVnaW5fb2JqZWN0Lm5vZGUuc3RvcC5jYWxsKHBsdWdpbl9vYmplY3Qubm9kZSk7XG4gICAgICAgICAgICBwbHVnaW5fb2JqZWN0Lm5vZGUub251bmxvYWRlZC5jYWxsKHBsdWdpbl9vYmplY3Qubm9kZSk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbl9saXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLmlzb2xhdGUoKTtcbiAgICAgICAgICAgIHRoaXMucmVidWlsZCgpO1xuICAgICAgICAgICAgdGhpcy5qb2luQ2hhaW4oKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsYXlDb21wZW5zYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJjaGFuZ2VcIikpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRlc3Ryb3lQbHVnaW4ocGx1Z2luX29iamVjdCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJTdGF0ZS5DTE9TRUQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbW92ZVBsdWdpbihwbHVnaW5fb2JqZWN0KTtcbiAgICAgICAgdGhpcy5QbHVnaW5GYWN0b3J5LmRlbGV0ZVBsdWdpbihwbHVnaW5fb2JqZWN0KTtcbiAgICAgICAgdGhpcy51cGRhdGVEZWxheUNvbXBlbnNhdGlvbigpO1xuICAgIH1cbiAgICBnZXRQbHVnaW5zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW5fbGlzdDtcbiAgICB9XG4gICAgZ2V0QWxsUGx1Z2lucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUGx1Z2luRmFjdG9yeS5nZXRBbGxQbHVnaW5zT2JqZWN0KCk7XG4gICAgfVxuICAgIDtcbiAgICBnZXRQbHVnaW5JbmRleChwbHVnaW5fb2JqZWN0KSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBBdWRpb1BsdWdpbkNoYWluTWFuYWdlclN0YXRlLkNMT1NFRCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnBsdWdpbl9saXN0LmluZGV4T2YocGx1Z2luX29iamVjdCk7XG4gICAgfVxuICAgIG1vdmVQbHVnaW4ocGx1Z2luX29iamVjdCwgbmV3X2luZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBBdWRpb1BsdWdpbkNoYWluTWFuYWdlclN0YXRlLkNMT1NFRCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLlBsdWdpbkZhY3RvcnkuZ2V0QWxsUGx1Z2lucygpLmluY2x1ZGVzKHBsdWdpbl9vYmplY3QpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGx1Z2luIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5nZXRQbHVnaW5JbmRleChwbHVnaW5fb2JqZWN0KTtcbiAgICAgICAgbGV0IG9iajtcbiAgICAgICAgdGhpcy5jdXRDaGFpbigpO1xuICAgICAgICB0aGlzLmlzb2xhdGUoKTtcbiAgICAgICAgaWYgKHBsdWdpbl9vYmplY3Qubm9kZS5vd25lciAhPT0gdGhpcykge1xuICAgICAgICAgICAgLy8gRGlmZmVyZW50IHN1Yi1mYWN0b3J5XG4gICAgICAgICAgICBwbHVnaW5fb2JqZWN0Lm5vZGUub3duZXIucmVtb3ZlUGx1Z2luKHBsdWdpbl9vYmplY3QpO1xuICAgICAgICAgICAgcGx1Z2luX29iamVjdC5ub2RlLmNoYW5nZU93bmVyKHRoaXMpO1xuICAgICAgICAgICAgb2JqID0gW3BsdWdpbl9vYmplY3RdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb2JqID0gdGhpcy5wbHVnaW5fbGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgcGx1Z2luX29iamVjdC5ub2RlLm9udW5sb2FkZWQuY2FsbChwbHVnaW5fb2JqZWN0Lm5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdfaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luX2xpc3QgPSBvYmouY29uY2F0KHRoaXMucGx1Z2luX2xpc3QpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5ld19pbmRleCA+PSB0aGlzLnBsdWdpbl9saXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW5fbGlzdCA9IHRoaXMucGx1Z2luX2xpc3QuY29uY2F0KG9iaik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBob2xkTG93ID0gdGhpcy5wbHVnaW5fbGlzdC5zbGljZSgwLCBuZXdfaW5kZXgpO1xuICAgICAgICAgICAgY29uc3QgaG9sZEhpZ2ggPSB0aGlzLnBsdWdpbl9saXN0LnNsaWNlKG5ld19pbmRleCk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbl9saXN0ID0gaG9sZExvdy5jb25jYXQob2JqLmNvbmNhdChob2xkSGlnaCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVidWlsZCgpO1xuICAgICAgICB0aGlzLmpvaW5DaGFpbigpO1xuICAgICAgICBwbHVnaW5fb2JqZWN0Lm5vZGUub25sb2FkZWQuY2FsbChwbHVnaW5fb2JqZWN0Lm5vZGUpO1xuICAgICAgICB0aGlzLnVwZGF0ZURlbGF5Q29tcGVuc2F0aW9uKCk7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJjaGFuZ2VcIikpO1xuICAgIH1cbiAgICBjb3B5UGx1Z2luKHBsdWdpbl9vYmplY3QsIGNvcHlfaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmIChjb3B5X2luZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb3B5X2luZGV4ID0gdGhpcy5wbHVnaW5fbGlzdC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvcHlfaW5kZXggIT0gXCJudW1iZXJcIiB8fCBjb3B5X2luZGV4IDwgMCB8fCBjb3B5X2luZGV4ID4gdGhpcy5wbHVnaW5fbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoXCJQbHVnaW4gY29weSBpbmRleCBvdXRzaWRlIG9mIHRoZSBjaGFpbiBzY29wZS5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbm9kZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbm9kZSA9IHlpZWxkIHRoaXMuYnVpbGROZXdQbHVnaW4ocGx1Z2luX29iamVjdC5wcm90b3R5cGVPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbHVnaW4gZGlkIG5vdCBnZXQgY3JlYXRlZCEgQWJvcnRpbmdcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLm5vZGUucGFyYW1ldGVycy5zZXRQYXJhbWV0ZXJzQnlPYmplY3QocGx1Z2luX29iamVjdC5ub2RlLnBhcmFtZXRlcnMuZ2V0UGFyYW1ldGVyT2JqZWN0KCksIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuY3V0Q2hhaW4oKTtcbiAgICAgICAgICAgIHRoaXMuaXNvbGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW5fbGlzdC5zcGxpY2UoY29weV9pbmRleCwgMCwgbm9kZSk7XG4gICAgICAgICAgICB0aGlzLnJlYnVpbGQoKTtcbiAgICAgICAgICAgIHRoaXMuam9pbkNoYWluKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURlbGF5Q29tcGVuc2F0aW9uKCk7XG4gICAgICAgICAgICBub2RlLm5vZGUub25sb2FkZWQuY2FsbChub2RlLm5vZGUpO1xuICAgICAgICAgICAgdGhpcy5ldmVudFRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImNoYW5nZVwiKSk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGR1cGxpY2F0ZUF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyKHNvdXJjZUF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBzb3VyY2VBdWRpb1BsdWdpbkNoYWluTWFuYWdlci5nZXRQbHVnaW5zKCkpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNvcHlQbHVnaW4ocGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmVjdXJzaXZlUHJvY2Vzc2luZyhiYXNlLCBsaXN0KSB7XG4gICAgICAgIGNvbnN0IGwgPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gbGlzdFtpXTtcbiAgICAgICAgICAgIGJhc2VbZW50cnkubmFtZV0uYXBwbHkoYmFzZSwgZW50cnkucGFyYW1ldGVycyk7XG4gICAgICAgICAgICBpZiAoZW50cnkuZmVhdHVyZXMgJiYgZW50cnkuZmVhdHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVjdXJzaXZlUHJvY2Vzc2luZyhiYXNlLnJlc3VsdFtlbnRyeS5uYW1lXSwgZW50cnkuZmVhdHVyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZURlbGF5Q29tcGVuc2F0aW9uKCkge1xuICAgICAgICBjb25zdCBzdW0gPSB0aGlzLmdldERlbGF5Q29tcGVuc2F0aW9uKCk7XG4gICAgICAgIGlmICh0aGlzLmRlbGF5U2FtcGxlcyAhPSBzdW0pIHtcbiAgICAgICAgICAgIHRoaXMuZGVsYXlTYW1wbGVzID0gc3VtO1xuICAgICAgICAgICAgdGhpcy5ldmVudFRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImFsdGVyZGVsYXlcIikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRlbGF5U2FtcGxlcztcbiAgICB9XG4gICAgaGFuZGxlRXZlbnQoZSkge1xuICAgICAgICBpZiAoZS50eXBlID09IFwiYWx0ZXJkZWxheVwiKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURlbGF5Q29tcGVuc2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICB9XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICB9XG4gICAgZ2V0IFNlc3Npb25EYXRhKCkgeyByZXR1cm4gdGhpcy5QbHVnaW5GYWN0b3J5LlNlc3Npb25EYXRhOyB9XG4gICAgZ2V0IFVzZXJEYXRhKCkgeyByZXR1cm4gdGhpcy5QbHVnaW5GYWN0b3J5LlVzZXJEYXRhOyB9XG4gICAgZ2V0IHByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcygpIHsgcmV0dXJuIHRoaXMudXBkYXRlRGVsYXlDb21wZW5zYXRpb24oKTsgfVxuICAgIGdldCBwcm9jZXNzaW5nRGVsYXlBc1NlY29uZHMoKSB7IHJldHVybiB0aGlzLnByb2Nlc3NpbmdEZWxheUFzU2FtcGxlcyAvIHRoaXMuUGx1Z2luRmFjdG9yeS5jb250ZXh0LnNhbXBsZVJhdGU7IH1cbn1cbiIsImltcG9ydCB7IFRpbWVEYXRhIH0gZnJvbSBcImpzLXh0cmFjdFwiO1xuZXhwb3J0IGNsYXNzIEV4dHJhY3RvciB7XG4gICAgY29uc3RydWN0b3IocGFyZW50LCBmcmFtZVNpemUpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuZnJhbWVTaXplID0gZnJhbWVTaXplO1xuICAgICAgICB0aGlzLmZlYXR1cmVzID0gW107XG4gICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMucGFyZW50Lm91dHB1dC5jb250ZXh0O1xuICAgICAgICB0aGlzLmFuYWx5c2VyID0gcGFyZW50Lm91dHB1dC5jb250ZXh0LmNyZWF0ZUFuYWx5c2VyKCk7XG4gICAgICAgIHRoaXMuYW5hbHlzZXIuZmZ0U2l6ZSA9IGZyYW1lU2l6ZTtcbiAgICAgICAgcGFyZW50Lm91dHB1dC5jb25uZWN0KHRoaXMuYW5hbHlzZXIpO1xuICAgIH1cbiAgICBnZXRYdHJhY3REYXRhKCkge1xuICAgICAgICBpZiAodGhpcy50aW1lRGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVEYXRhID0gbmV3IFRpbWVEYXRhKHRoaXMuYW5hbHlzZXIuZmZ0U2l6ZSwgdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRzdCA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5hbmFseXNlci5mZnRTaXplKTtcbiAgICAgICAgaWYgKHRoaXMuYW5hbHlzZXIuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5hbmFseXNlci5nZXRGbG9hdFRpbWVEb21haW5EYXRhKGRzdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5hbmFseXNlci5mZnRTaXplKTtcbiAgICAgICAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKHZpZXcpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmFuYWx5c2VyLmZmdFNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgIGRzdFtpXSA9IHZpZXdbaV07XG4gICAgICAgICAgICAgICAgZHN0W2ldID0gKGRzdFtpXSAvIDEyNy41KSAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50aW1lRGF0YS5jb3B5RGF0YUZyb20oZHN0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZURhdGE7XG4gICAgfVxuICAgIGZyYW1lQ2FsbGJhY2soKSB7XG4gICAgICAgIC8vIFBlcmZvcm0gYSBjYWxsYmFjayBvbiBlYWNoIGZyYW1lXG4gICAgICAgIC8vIFRoZSBmdW5jdGlvbiBjYWxsYmFjayBoYXMgdGhlIGFyZ3VtZW50cyAoY3VycmVudF9mcmFtZSwgcHJldmlvdXNfZnJhbWUsIHByZXZpb3VzX3Jlc3VsdClcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tPYmplY3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFja09iamVjdCA9IHRoaXMucGFyZW50Lm91dHB1dC5jb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3Nvcih0aGlzLmFuYWx5c2VyLmZmdFNpemUsIDEsIDEpO1xuICAgICAgICAgICAgdGhpcy5hbmFseXNlci5jb25uZWN0KHRoaXMuY2FsbGJhY2tPYmplY3QpO1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFja09iamVjdC5vbmF1ZGlvcHJvY2VzcyA9IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudF9mcmFtZSA9IHRoaXMuZ2V0WHRyYWN0RGF0YSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICdudW1iZXJPZkNoYW5uZWxzJzogMSxcbiAgICAgICAgICAgICAgICAgICAgJ3Jlc3VsdHMnOiBbXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgbWVzc2FnZS5yZXN1bHRzWzBdID0ge1xuICAgICAgICAgICAgICAgICAgICAnY2hhbm5lbCc6IDAsXG4gICAgICAgICAgICAgICAgICAgICdyZXN1bHRzJzogW11cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdEZlYXR1cmVzKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgZS5vdXRwdXRCdWZmZXIubnVtYmVyT2ZDaGFubmVscyAmJiBjIDwgZS5pbnB1dEJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzOyBjKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZS5vdXRwdXRCdWZmZXIuY29weVRvQ2hhbm5lbChlLmlucHV0QnVmZmVyLmdldENoYW5uZWxEYXRhKGMpLCBjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIC8vIEZvciBjaHJvbWUgYW5kIG90aGVyIGVmZmljaWVuY3kgYnJvd3NlcnNcbiAgICAgICAgaWYgKCF0aGlzLmZvb0dhaW4pIHtcbiAgICAgICAgICAgIHRoaXMuZm9vR2FpbiA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgICAgICAgICB0aGlzLmZvb0dhaW4uZ2Fpbi52YWx1ZSA9IDA7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrT2JqZWN0LmNvbm5lY3QodGhpcy5mb29HYWluKTtcbiAgICAgICAgICAgIHRoaXMuZm9vR2Fpbi5jb25uZWN0KHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xlYXJDYWxsYmFjaygpIHtcbiAgICAgICAgLy90aGlzID09PSBFeHRyYWN0b3JcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tPYmplY3QpIHtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tPYmplY3QuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5mb29HYWluLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuZm9vR2FpbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tPYmplY3Qub25hdWRpb3Byb2Nlc3MgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrT2JqZWN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEZlYXR1cmVzKGZlYXR1cmVMaXN0KSB7XG4gICAgICAgIHRoaXMuZmVhdHVyZXMgPSBmZWF0dXJlTGlzdDtcbiAgICAgICAgaWYgKHRoaXMuZmVhdHVyZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQ2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZnJhbWVDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlam9pbkV4dHJhY3RvcigpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQub3V0cHV0LmNvbm5lY3QodGhpcy5leHRyYWN0b3IpO1xuICAgIH1cbiAgICBwb3N0RmVhdHVyZXMocmVzdWx0c0pTT04pIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICAgICAgJ291dHB1dEluZGV4JzogdGhpcy5wYXJlbnQuaW5kZXgsXG4gICAgICAgICAgICAnZnJhbWVTaXplJzogdGhpcy5mcmFtZVNpemUsXG4gICAgICAgICAgICAncmVzdWx0cyc6IHJlc3VsdHNKU09OXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucGFyZW50LnBvc3RGZWF0dXJlcyhvYmopO1xuICAgIH1cbiAgICBnZXQgZXh0cmFjdG9yKCkgeyByZXR1cm4gdGhpcy5hbmFseXNlcjsgfVxufVxuIiwiaW1wb3J0IHsgRXh0cmFjdG9yIH0gZnJvbSBcIi4vRXh0cmFjdG9yXCI7XG5pbXBvcnQgeyBXb3JrZXJFeHRyYWN0b3IgfSBmcm9tIFwiLi9Xb3JrZXJFeHRyYWN0b3JcIjtcbmV4cG9ydCBjbGFzcyBPdXRwdXROb2RlIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQsIG91dHB1dCwgaW5kZXgpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMub3V0cHV0ID0gb3V0cHV0O1xuICAgICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHRoaXMuZXh0cmFjdG9ycyA9IFtdO1xuICAgIH1cbiAgICBhZGRFeHRyYWN0b3IoZnJhbWVTaXplKSB7XG4gICAgICAgIGxldCBvYmo7XG4gICAgICAgIGlmICh3aW5kb3cuV29ya2VyKSB7XG4gICAgICAgICAgICBvYmogPSBuZXcgV29ya2VyRXh0cmFjdG9yKHRoaXMsIGZyYW1lU2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvYmogPSBuZXcgRXh0cmFjdG9yKHRoaXMsIGZyYW1lU2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5leHRyYWN0b3JzLnB1c2gob2JqKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgZmluZEV4dHJhY3RvcihmcmFtZVNpemUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdG9ycy5maW5kKChlKSA9PiBlLmZyYW1lU2l6ZSA9PT0gZnJhbWVTaXplKTtcbiAgICB9XG4gICAgZGVsZXRlRXh0cmFjdG9yKGZyYW1lU2l6ZSkge1xuICAgICAgICBjb25zdCBleHRyYWN0b3IgPSB0aGlzLmZpbmRFeHRyYWN0b3IoZnJhbWVTaXplKTtcbiAgICAgICAgaWYgKGV4dHJhY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmV4dHJhY3RvcnMuaW5kZXhPZihleHRyYWN0b3IpO1xuICAgICAgICAgICAgdGhpcy5leHRyYWN0b3JzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVqb2luRXh0cmFjdG9ycygpIHtcbiAgICAgICAgdGhpcy5leHRyYWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucmVqb2luRXh0cmFjdG9yKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwb3N0RmVhdHVyZXMocmVzdWx0T2JqZWN0KSB7XG4gICAgICAgIHRoaXMucGFyZW50LnBvc3RGZWF0dXJlcyhyZXN1bHRPYmplY3QpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBXb3JrZXJFeHRyYWN0b3Ige1xuICAgIGNvbnN0cnVjdG9yKHBhcmVudCwgZnJhbWVTaXplKSB7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLmZyYW1lU2l6ZSA9IGZyYW1lU2l6ZTtcbiAgICAgICAgdGhpcy53b3JrZXIgPSBuZXcgV29ya2VyKFwiLi4vZmVhdHVyZS13b3JrZXIuanNcIiwgeyB0eXBlOiBcIm1vZHVsZVwiIH0pO1xuICAgICAgICB0aGlzLmZlYXR1cmVzID0gW107XG4gICAgICAgIHRoaXMuYW5hbHlzZXIgPSBwYXJlbnQub3V0cHV0LmNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGZyYW1lU2l6ZSwgcGFyZW50Lm91dHB1dC5udW1iZXJPZk91dHB1dHMsIDEpO1xuICAgICAgICBwYXJlbnQub3V0cHV0LmNvbm5lY3QodGhpcy5hbmFseXNlcik7XG4gICAgICAgIHRoaXMud29ya2VyLm9uZXJyb3IgPSAoZXJyb3JFdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvckV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53b3JrZXIub25tZXNzYWdlID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmRhdGEuc3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3BvbnNlKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZS5kYXRhLnN0YXRlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHRyYWN0b3Iub25hdWRpb3Byb2Nlc3MgPSB0aGlzLm9uYXVkaW9jYWxsYmFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgb25hdWRpb2NhbGxiYWNrKGUpIHtcbiAgICAgICAgdmFyIGMsIGZyYW1lcyA9IFtdO1xuICAgICAgICBmb3IgKGMgPSAwOyBjIDwgZS5pbnB1dEJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzOyBjKyspIHtcbiAgICAgICAgICAgIGZyYW1lc1tjXSA9IGUuaW5wdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoYyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53b3JrZXIucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgJ3N0YXRlJzogMixcbiAgICAgICAgICAgICdmcmFtZXMnOiBmcmFtZXNcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlc3BvbnNlKG1zZykge1xuICAgICAgICB0aGlzLnBvc3RGZWF0dXJlcyhtc2cuZGF0YS5yZXNwb25zZSk7XG4gICAgfVxuICAgIHBvc3RGZWF0dXJlcyhyZXN1bHRzSlNPTikge1xuICAgICAgICBjb25zdCBvYmogPSB7XG4gICAgICAgICAgICAnb3V0cHV0SW5kZXgnOiB0aGlzLnBhcmVudC5pbmRleCxcbiAgICAgICAgICAgICdmcmFtZVNpemUnOiB0aGlzLmZyYW1lU2l6ZSxcbiAgICAgICAgICAgICdyZXN1bHRzJzogcmVzdWx0c0pTT05cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wYXJlbnQucG9zdEZlYXR1cmVzKG9iaik7XG4gICAgfVxuICAgIHJlam9pbkV4dHJhY3RvcigpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQub3V0cHV0LmNvbm5lY3QodGhpcy5leHRyYWN0b3IpO1xuICAgIH1cbiAgICA7XG4gICAgc2V0RmVhdHVyZXMoZmVhdHVyZUxpc3QpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgY29uZmlnTWVzc2FnZSA9IHtcbiAgICAgICAgICAgICdzdGF0ZSc6IDEsXG4gICAgICAgICAgICAnc2FtcGxlUmF0ZSc6IHRoaXMucGFyZW50Lm91dHB1dC5jb250ZXh0LnNhbXBsZVJhdGUsXG4gICAgICAgICAgICAnZmVhdHVyZUxpc3QnOiBmZWF0dXJlTGlzdCxcbiAgICAgICAgICAgICdudW1DaGFubmVscyc6IHRoaXMucGFyZW50Lm91dHB1dC5udW1iZXJPZk91dHB1dHMsXG4gICAgICAgICAgICAnZnJhbWVTaXplJzogdGhpcy5mcmFtZVNpemVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5mZWF0dXJlcyA9IGZlYXR1cmVMaXN0O1xuICAgICAgICBpZiAoZmVhdHVyZUxpc3QgJiYgZmVhdHVyZUxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoeyAnc3RhdGUnOiAwIH0pO1xuICAgICAgICAgICAgdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoY29uZmlnTWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmV4dHJhY3Rvci5vbmF1ZGlvcHJvY2VzcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZXh0cmFjdG9yKCkgeyByZXR1cm4gdGhpcy5hbmFseXNlcjsgfVxufVxuIiwiaW1wb3J0IHsgdW5pcXVlTWVyZ2VBcnJheSB9IGZyb20gXCIuLi8uLi91dGlsaXR5L3VuaXF1ZU1lcmdlQXJyYXlcIjtcbmNsYXNzIEZyYW1lU2l6ZVRvRmVhdHVyZXMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnJlY2VpdmVyTWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICByZXF1ZXN0RmVhdHVyZXMoZnJhbWVTaXplLCByZWNlaXZlciwgZmVhdHVyZXMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjZWl2ZXJNYXAuaGFzKGZyYW1lU2l6ZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLnJlY2VpdmVyTWFwLnNldChmcmFtZVNpemUsIG5ldyBNYXAoKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVjZWl2ZXJNYXBGZWF0dXJlcyA9IHRoaXMucmVjZWl2ZXJNYXAuZ2V0KGZyYW1lU2l6ZSk7XG4gICAgICAgIGlmIChyZWNlaXZlck1hcEZlYXR1cmVzLmhhcyhyZWNlaXZlcikpIHtcbiAgICAgICAgICAgIHJlY2VpdmVyTWFwRmVhdHVyZXMuc2V0KHJlY2VpdmVyLCB1bmlxdWVNZXJnZUFycmF5KHJlY2VpdmVyTWFwRmVhdHVyZXMuZ2V0KHJlY2VpdmVyKSwgZmVhdHVyZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlY2VpdmVyTWFwRmVhdHVyZXMuc2V0KHJlY2VpdmVyLCBmZWF0dXJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm93IGdldCBhbGwgdGhlIGZlYXR1cmVzIHdlIG5lZWQgdG8gZXhwb3J0XG4gICAgICAgIGxldCBhbGxGZWF0dXJlcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IFtyZWNlaXZlciwgcmVjZWl2ZXJGZWF0dXJlc10gb2YgcmVjZWl2ZXJNYXBGZWF0dXJlcykge1xuICAgICAgICAgICAgYWxsRmVhdHVyZXMgPSB1bmlxdWVNZXJnZUFycmF5KHJlY2VpdmVyRmVhdHVyZXMsIGFsbEZlYXR1cmVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxsRmVhdHVyZXM7XG4gICAgfVxuICAgIHJldm9rZUFsbEZlYXR1cmVzKGZyYW1lU2l6ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXZva2VGZWF0dXJlcyhmcmFtZVNpemUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgcmV2b2tlQWxsUmVjZWl2ZXJGZWF0dXJlcyhmcmFtZVNpemUsIHJlY2VpdmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJldm9rZUZlYXR1cmVzKGZyYW1lU2l6ZSwgcmVjZWl2ZXIsIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIHJldm9rZUZlYXR1cmVzKGZyYW1lU2l6ZSwgcmVjZWl2ZXIsIGZlYXR1cmVzVG9SZW1vdmUpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjZWl2ZXJNYXAuaGFzKGZyYW1lU2l6ZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVjZWl2ZXJNYXBGZWF0dXJlcyA9IHRoaXMucmVjZWl2ZXJNYXAuZ2V0KGZyYW1lU2l6ZSk7XG4gICAgICAgIGlmIChyZWNlaXZlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBJZiByZWNlaXZlciBpcyB1bmRlZmluZWQsIHRoZW4gd2UgYXJlIGtpbGxpbmcgdGhlIHdob2xlIGZyYW1lU2l6ZSBtYXBcbiAgICAgICAgICAgIGZvciAoY29uc3QgW3JlY2VpdmVyRnJvbU1hcCwgcmVjZWl2ZXJGZWF0dXJlc10gb2YgcmVjZWl2ZXJNYXBGZWF0dXJlcykge1xuICAgICAgICAgICAgICAgIHRoaXMucmV2b2tlRmVhdHVyZXMoZnJhbWVTaXplLCByZWNlaXZlckZyb21NYXAsIHJlY2VpdmVyRmVhdHVyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmVhdHVyZXMoZnJhbWVTaXplKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVjZWl2ZXJNYXBGZWF0dXJlcy5oYXMocmVjZWl2ZXIpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZlYXR1cmVMaXN0ID0gcmVjZWl2ZXJNYXBGZWF0dXJlcy5nZXQocmVjZWl2ZXIpO1xuICAgICAgICBpZiAoZmVhdHVyZXNUb1JlbW92ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBJZiBmZWF0dXJlcyBpcyB1bmRlZmluZWQsIHJlbW92ZSBhbGwgZmVhdHVyZXNcbiAgICAgICAgICAgIC8vIEJ1dCwgYW4gZW1wdHkgbGlzdCBpcyB2YWxpZFxuICAgICAgICAgICAgZmVhdHVyZXNUb1JlbW92ZSA9IGZlYXR1cmVMaXN0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlZHVjZWRGZWF0dXJlTGlzdCA9IGZlYXR1cmVMaXN0LmZpbHRlcihmZWF0dXJlID0+IGZlYXR1cmVzVG9SZW1vdmUuaW5jbHVkZXMoZmVhdHVyZSkgPT09IGZhbHNlKTtcbiAgICAgICAgaWYgKHJlZHVjZWRGZWF0dXJlTGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vIEhhdmUgbm8gZmVhdHVyZXMhXG4gICAgICAgICAgICByZWNlaXZlck1hcEZlYXR1cmVzLmRlbGV0ZShyZWNlaXZlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZWNlaXZlck1hcEZlYXR1cmVzLnNldChyZWNlaXZlciwgcmVkdWNlZEZlYXR1cmVMaXN0KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZW1haW5pbmdGZWF0dXJlcyA9IHRoaXMuZ2V0RmVhdHVyZXMoZnJhbWVTaXplKTtcbiAgICAgICAgaWYgKHJlbWFpbmluZ0ZlYXR1cmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgLy8gVGhlIGZyYW1lU2l6ZSBoYXMgbm8gZmVhdHVyZXMgbGVmdFxuICAgICAgICAgICAgdGhpcy5yZWNlaXZlck1hcC5kZWxldGUoZnJhbWVTaXplKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVtYWluaW5nRmVhdHVyZXM7XG4gICAgfVxuICAgIGdldEZlYXR1cmVzKGZyYW1lU2l6ZSkge1xuICAgICAgICBjb25zdCByZWNlaXZlck1hcEZlYXR1cmVzID0gdGhpcy5yZWNlaXZlck1hcC5nZXQoZnJhbWVTaXplKTtcbiAgICAgICAgaWYgKHJlY2VpdmVyTWFwRmVhdHVyZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIGxldCBhbGxGZWF0dXJlcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IFtyZWNlaXZlciwgcmVjZWl2ZXJGZWF0dXJlc10gb2YgcmVjZWl2ZXJNYXBGZWF0dXJlcykge1xuICAgICAgICAgICAgYWxsRmVhdHVyZXMgPSB1bmlxdWVNZXJnZUFycmF5KHJlY2VpdmVyRmVhdHVyZXMsIGFsbEZlYXR1cmVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxsRmVhdHVyZXM7XG4gICAgfVxufVxuY2xhc3MgU291cmNlTWFwIHtcbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2UpIHtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMub3V0cHV0TWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXRPdXRwdXRNYXAob3V0cHV0SW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0cHV0TWFwLmdldChvdXRwdXRJbmRleCk7XG4gICAgfVxuICAgIGtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dE1hcC5rZXlzKCk7XG4gICAgfVxuICAgIHZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0cHV0TWFwLnZhbHVlcygpO1xuICAgIH1cbiAgICBlbnRyaWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXRNYXAuZW50cmllcygpO1xuICAgIH1cbiAgICBnZXRGZWF0dXJlcyhvdXRwdXRJbmRleCwgZnJhbWVTaXplKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHRoaXMuZ2V0T3V0cHV0TWFwKG91dHB1dEluZGV4KTtcbiAgICAgICAgaWYgKG91dHB1dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQuZ2V0RmVhdHVyZXMoZnJhbWVTaXplKTtcbiAgICB9XG4gICAgZ2V0T3JBZGRPdXRwdXRNYXAob3V0cHV0SW5kZXgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gdGhpcy5nZXRPdXRwdXRNYXAob3V0cHV0SW5kZXgpO1xuICAgICAgICBpZiAob3V0cHV0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3V0cHV0TWFwLnNldChvdXRwdXRJbmRleCwgbmV3IEZyYW1lU2l6ZVRvRmVhdHVyZXMoKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRPdXRwdXRNYXAob3V0cHV0SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHJlcXVlc3RGZWF0dXJlcyhvdXRwdXRJbmRleCwgZnJhbWVTaXplLCBmZWF0dXJlcywgcmVjZWl2ZXIpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gdGhpcy5nZXRPckFkZE91dHB1dE1hcChvdXRwdXRJbmRleCk7XG4gICAgICAgIGNvbnN0IGZlYXR1cmVSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgb3V0cHV0SW5kZXg6IG91dHB1dEluZGV4LFxuICAgICAgICAgICAgZnJhbWVTaXplOiBmcmFtZVNpemUsXG4gICAgICAgICAgICBmZWF0dXJlczogW11cbiAgICAgICAgfTtcbiAgICAgICAgZmVhdHVyZVJlcXVlc3QuZmVhdHVyZXMgPSBvdXRwdXQucmVxdWVzdEZlYXR1cmVzKGZyYW1lU2l6ZSwgcmVjZWl2ZXIsIGZlYXR1cmVzKTtcbiAgICAgICAgdGhpcy5zb3VyY2UudXBkYXRlRmVhdHVyZXMoW2ZlYXR1cmVSZXF1ZXN0XSk7XG4gICAgfVxuICAgIHJldm9rZUZlYXR1cmVzKG91dHB1dEluZGV4LCBmcmFtZVNpemUsIHJlY2VpdmVyLCBmZWF0dXJlc1RvUmVtb3ZlKSB7XG4gICAgICAgIGlmIChvdXRwdXRJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IF9vdXRwdXRJbmRleCBvZiB0aGlzLm91dHB1dE1hcC5rZXlzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJldm9rZUZlYXR1cmVzKF9vdXRwdXRJbmRleCwgZnJhbWVTaXplLCByZWNlaXZlciwgZmVhdHVyZXNUb1JlbW92ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gdGhpcy5nZXRPdXRwdXRNYXAob3V0cHV0SW5kZXgpO1xuICAgICAgICBpZiAob3V0cHV0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJhbWVTaXplID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgX2ZyYW1lU2l6ZSBvZiBvdXRwdXQucmVjZWl2ZXJNYXAua2V5cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXZva2VGZWF0dXJlcyhvdXRwdXRJbmRleCwgX2ZyYW1lU2l6ZSwgcmVjZWl2ZXIsIGZlYXR1cmVzVG9SZW1vdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZlYXR1cmVSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgb3V0cHV0SW5kZXg6IG91dHB1dEluZGV4LFxuICAgICAgICAgICAgZnJhbWVTaXplOiBmcmFtZVNpemUsXG4gICAgICAgICAgICBmZWF0dXJlczogW11cbiAgICAgICAgfTtcbiAgICAgICAgZmVhdHVyZVJlcXVlc3QuZmVhdHVyZXMgPSBvdXRwdXQucmV2b2tlRmVhdHVyZXMoZnJhbWVTaXplLCByZWNlaXZlciwgZmVhdHVyZXNUb1JlbW92ZSk7XG4gICAgICAgIGlmIChmZWF0dXJlUmVxdWVzdC5mZWF0dXJlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMub3V0cHV0TWFwLmRlbGV0ZShvdXRwdXRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zb3VyY2UudXBkYXRlRmVhdHVyZXMoW2ZlYXR1cmVSZXF1ZXN0XSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEZlYXR1cmVNYXAge1xuICAgIGNvbnN0cnVjdG9yKGZhY3RvcnkpIHtcbiAgICAgICAgdGhpcy5mYWN0b3J5ID0gZmFjdG9yeTtcbiAgICAgICAgdGhpcy5NYXBwaW5ncyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZmluZE9yQ3JlYXRlU291cmNlUmVxdWVzdE1hcChwbHVnaW5TZW5kZXIpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdHMgPSB0aGlzLk1hcHBpbmdzLmdldChwbHVnaW5TZW5kZXIpO1xuICAgICAgICBpZiAocmVxdWVzdHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdE1hcCA9IG5ldyBTb3VyY2VNYXAocGx1Z2luU2VuZGVyKTtcbiAgICAgICAgICAgIHRoaXMuTWFwcGluZ3Muc2V0KHBsdWdpblNlbmRlciwgcmVxdWVzdE1hcCk7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdE1hcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVxdWVzdHM7XG4gICAgfVxuICAgIHJlcXVlc3RGZWF0dXJlcyhyZXF1ZXN0b3IsIHBsdWdpblNlbmRlciwgZmVhdHVyZU9iamVjdCkge1xuICAgICAgICAvLyBHcmFiIGFueSBleGlzdGluZyBtYXAgb3IgYnVpbGQgYSBuZXcgb25lXG4gICAgICAgIC8vcGx1Z2luU2VuZGVyLnVwZGF0ZUZlYXR1cmVzKFtmZWF0dXJlT2JqZWN0XSk7XG4gICAgICAgIGNvbnN0IHNvdXJjZU1hcCA9IHRoaXMuZmluZE9yQ3JlYXRlU291cmNlUmVxdWVzdE1hcChwbHVnaW5TZW5kZXIpO1xuICAgICAgICBzb3VyY2VNYXAucmVxdWVzdEZlYXR1cmVzKGZlYXR1cmVPYmplY3Qub3V0cHV0SW5kZXgsIGZlYXR1cmVPYmplY3QuZnJhbWVTaXplLCBmZWF0dXJlT2JqZWN0LmZlYXR1cmVzLCByZXF1ZXN0b3IpO1xuICAgIH1cbiAgICA7XG4gICAgZGVsZXRlRmVhdHVyZXNGcm9tU291cmNlKHNvdXJjZSkge1xuICAgICAgICAvLyBUaGlzIHdpbGwgaW1lZGlhdGVseSBraWxsIHRoZSBzb3VyY2VcbiAgICAgICAgLy8gVXNlZCB3aGVuIGRlbGV0aW5nIHRoZSBwbHVnaW4hXG4gICAgICAgIGNvbnN0IHNvdXJjZU1hcCA9IHRoaXMuTWFwcGluZ3MuZ2V0KHNvdXJjZSk7XG4gICAgICAgIGlmIChzb3VyY2VNYXAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNvdXJjZU1hcC5yZXZva2VGZWF0dXJlcygpO1xuICAgICAgICB0aGlzLk1hcHBpbmdzLmRlbGV0ZShzb3VyY2UpO1xuICAgIH1cbiAgICBkZWxldGVGZWF0dXJlcyhyZXF1ZXN0b3IsIHBsdWdpblNlbmRlciwgZmVhdHVyZU9iamVjdCkge1xuICAgICAgICBpZiAocGx1Z2luU2VuZGVyID09PSB1bmRlZmluZWQgJiYgZmVhdHVyZU9iamVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBCb3JrIGV2ZXJ5dGhpbmcgdG8gdGhpcyBwbHVnaW4hXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNvdXJjZU1hcCBvZiB0aGlzLk1hcHBpbmdzLnZhbHVlcygpKSB7XG4gICAgICAgICAgICAgICAgc291cmNlTWFwLnJldm9rZUZlYXR1cmVzKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCByZXF1ZXN0b3IsIHVuZGVmaW5lZCk7IC8vIFdpbGwgYm9yayBhbnkgbGlzdHMgd2l0aCB0aGF0IHJlcXVlc3RvclxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc291cmNlTWFwID0gdGhpcy5NYXBwaW5ncy5nZXQocGx1Z2luU2VuZGVyKTtcbiAgICAgICAgICAgIGlmIChzb3VyY2VNYXAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERlcGVuZGluZyBvbiB0aGUgbGV2ZWwgb2YgaW5mbyBpbiBmZWF0dXJlT2JqZWN0Li4uXG4gICAgICAgICAgICBzb3VyY2VNYXAucmV2b2tlRmVhdHVyZXMoZmVhdHVyZU9iamVjdCA9PT0gbnVsbCB8fCBmZWF0dXJlT2JqZWN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmZWF0dXJlT2JqZWN0Lm91dHB1dEluZGV4LCBmZWF0dXJlT2JqZWN0ID09PSBudWxsIHx8IGZlYXR1cmVPYmplY3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZlYXR1cmVPYmplY3QuZnJhbWVTaXplLCByZXF1ZXN0b3IsIGZlYXR1cmVPYmplY3QgPT09IG51bGwgfHwgZmVhdHVyZU9iamVjdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZmVhdHVyZU9iamVjdC5mZWF0dXJlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgO1xuICAgIGdldEZlYXR1cmVMaXN0KHJlcXVlc3RvciwgcGx1Z2luU2VuZGVyKSB7IH1cbiAgICA7XG4gICAgcG9zdEZlYXR1cmVzKGZlYXR1cmVPYmplY3QpIHtcbiAgICAgICAgLy8gUmVjZWl2ZSBmcm9tIHRoZSBTZW5kZXIgb2JqZWN0c1xuICAgICAgICAvLyBUcmlnZ2VyIGRpc3RyaWJ1dGVkIHNlYXJjaCBmb3IgcmVzdWx0cyB0cmFuc21pc3Npb25cbiAgICAgICAgLy8gRmlyc3QgZ2V0IHRoZSBpbnN0YW5jZSBtYXBwaW5nIGZvciBvdXRwdXQvZnJhbWVcbiAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5NYXBwaW5ncy5nZXQoZmVhdHVyZU9iamVjdC5zb3VyY2UpO1xuICAgICAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG91dHB1dE1hcCA9IHNvdXJjZS5nZXRPdXRwdXRNYXAoZmVhdHVyZU9iamVjdC5vdXRwdXRJbmRleCk7XG4gICAgICAgIGlmIChvdXRwdXRNYXAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgW3JlY2VpdmVyLCBmZWF0dXJlc10gb2Ygb3V0cHV0TWFwLnJlY2VpdmVyTWFwLmdldChmZWF0dXJlT2JqZWN0LmZyYW1lU2l6ZSkpIHtcbiAgICAgICAgICAgIC8vIFJpZ2h0IG5vdyBqdXN0IHNlbmQgYWxsIGZlYXR1cmVzIGFyb3VuZFxuICAgICAgICAgICAgcmVjZWl2ZXIucG9zdEZlYXR1cmVzKGZlYXR1cmVPYmplY3QpO1xuICAgICAgICB9XG4gICAgfVxuICAgIDtcbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbmltcG9ydCB7IFN5bnRoZXNpc2VyQmFzZVBsdWdpbiB9IGZyb20gXCIuLi9TeW50aGVzaXNlckJhc2VQbHVnaW4vaW5kZXhcIjtcbmV4cG9ydCBjbGFzcyBNaWRpU3ludGhlc2lzSW5zdGFuY2Uge1xuICAgIGNvbnN0cnVjdG9yKG5vZGUpIHtcbiAgICAgICAgdGhpcy5ub2RlID0gbm9kZTtcbiAgICAgICAgdGhpcy5vdXRwdXQgPSB0aGlzLm5vZGUuY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgICAgIHRoaXMubm9kZS5nZXRPdXRwdXRzKClbMF0uY29ubmVjdCh0aGlzLm91dHB1dCk7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMubm9kZS5kZXN0cm95KCk7XG4gICAgfVxuICAgIDtcbiAgICBnZXQgcHJvdG90eXBlT2JqZWN0KCkgeyByZXR1cm4gdGhpcy5ub2RlLnByb3RvdHlwZU9iamVjdDsgfVxuICAgIGdldCBleHRlcm5hbEludGVyZmFjZSgpIHsgcmV0dXJuIHRoaXMubm9kZS5leHRlcm5hbEludGVyZmFjZTsgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGlzTWlkaVN5bnRoZXNpc0luc3RhbmNlKG9iamVjdCkge1xuICAgIHJldHVybiBvYmplY3Qubm9kZSBpbnN0YW5jZW9mIFN5bnRoZXNpc2VyQmFzZVBsdWdpbjtcbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgTGlua2VkU3RvcmUgfSBmcm9tICcuLi9MaW5rZWRTdG9yZSc7XG5leHBvcnQgY2xhc3MgTWlkaVN5bnRoZXNpc2VySG9zdCB7XG4gICAgY29uc3RydWN0b3IoZmFjdG9yeSkge1xuICAgICAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5O1xuICAgICAgICB0aGlzLmV2ID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG4gICAgICAgIHRoaXMuY29ubmVjdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5TZXNzaW9uRGF0YSA9IHRoaXMuZmFjdG9yeS5TZXNzaW9uRGF0YTtcbiAgICAgICAgdGhpcy5Vc2VyRGF0YSA9IHRoaXMuZmFjdG9yeS5Vc2VyRGF0YTtcbiAgICAgICAgdGhpcy5UcmFja0RhdGEgPSBuZXcgTGlua2VkU3RvcmUoXCJUcmFja1wiKTtcbiAgICB9XG4gICAgdW5sb2FkU3ludGhlc2lzZXJTbG90KCkge1xuICAgICAgICBpZiAodGhpcy5taWRpU3ludGhTbG90KSB7XG4gICAgICAgICAgICB0aGlzLm1pZGlTeW50aFNsb3Qubm9kZS5jYW5jZWxBbGxFdmVudHModGhpcy5mYWN0b3J5LmNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJ1aWxkTmV3U3ludGhlc2lzZXJPYmplY3QocHJvdG90eXBlT2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnVubG9hZFN5bnRoZXNpc2VyU2xvdCgpO1xuICAgICAgICAgICAgdGhpcy5mYWN0b3J5LmRlbGV0ZVBsdWdpbih0aGlzLm1pZGlTeW50aFNsb3QpO1xuICAgICAgICAgICAgaWYgKHByb3RvdHlwZU9iamVjdC5oYXNNaWRpSW5wdXQgPT0gZmFsc2UgfHwgcHJvdG90eXBlT2JqZWN0Lmhhc01pZGlPdXRwdXQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3RvdHlwZSBpcyBub3QgYSBNaWRpU3ludGhlc2lzIHR5cGUuIGhhc01pZGlJbnB1dCBtdXN0IGJlIHRydWUgYW5kIGhhc01pZGlPdXRwdXQgbXVzdCBiZSBmYWxzZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB5aWVsZCBwcm90b3R5cGVPYmplY3QuY3JlYXRlUGx1Z2luSW5zdGFuY2UodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXYuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXYucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIGNvbm5lY3QoZGVzdGluYXRpb25Ob2RlLCBvdXRwdXQsIGlucHV0KSB7XG4gICAgICAgIGlmIChkZXN0aW5hdGlvbk5vZGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgKFwiTXVzdCBkZWZpbmUgYW4gQXVkaW9Ob2RlIG9iamVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBleGlzdHMgPSB0aGlzLmNvbm5lY3Rpb25zLmZpbmQoKGNvbm4pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBjb25uLmRlc3RpbmF0aW9uTm9kZSA9PSBkZXN0aW5hdGlvbk5vZGUgJiYgY29ubi5vdXRwdXQgPT0gb3V0cHV0ICYmIGNvbm4uaW5wdXQgPT0gaW5wdXQ7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uTm9kZTogZGVzdGluYXRpb25Ob2RlLFxuICAgICAgICAgICAgICAgIG91dHB1dDogb3V0cHV0LFxuICAgICAgICAgICAgICAgIGlucHV0OiBpbnB1dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJNSURJIFN5bnRoZXNpc2VyIGlzIG5vdCBsb2FkZWQsIGNvbm5lY3Rpb25zIHdpbGwgYmUgdmFsaWRhdGVkIG9uIGxvYWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1pZGlTeW50aFNsb3Qubm9kZS5jb25uZWN0KGRlc3RpbmF0aW9uTm9kZSwgb3V0cHV0LCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdChkZXN0aW5hdGlvbk5vZGUsIG91dHB1dCwgaW5wdXQpIHtcbiAgICAgICAgaWYgKGRlc3RpbmF0aW9uTm9kZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5taWRpU3ludGhTbG90KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9ucyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbk5vZGUgPT0gXCJudW1iZXJcIiAmJiB0eXBlb2Ygb3V0cHV0ID09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIG91dHB1dCA9IGRlc3RpbmF0aW9uTm9kZTtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uTm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbnMgPSB0aGlzLmNvbm5lY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoY29ubikge1xuICAgICAgICAgICAgICAgIGlmIChjb25uLm91dHB1dCA9PSBvdXRwdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdChjb25uLmRlc3RpbmF0aW9uTm9kZSwgY29ubi5vdXRwdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbk5vZGUgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb3V0cHV0ID09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbnMgPSB0aGlzLmNvbm5lY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoY29ubikge1xuICAgICAgICAgICAgICAgIGlmIChjb25uLmRlc3RpbmF0aW9uTm9kZSA9PSBkZXN0aW5hdGlvbk5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdChjb25uLmRlc3RpbmF0aW9uTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGRlc3RpbmF0aW9uTm9kZSA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvdXRwdXQgPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9ucyA9IHRoaXMuY29ubmVjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChjb25uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm4uZGVzdGluYXRpb25Ob2RlID09IGRlc3RpbmF0aW9uTm9kZSAmJiBjb25uLm91dHB1dCA9PSBvdXRwdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdChjb25uLmRlc3RpbmF0aW9uTm9kZSwgY29ubi5vdXRwdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbk5vZGUgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb3V0cHV0ID09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGlucHV0ID09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbnMgPSB0aGlzLmNvbm5lY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoY29ubikge1xuICAgICAgICAgICAgICAgIGlmIChjb25uLmRlc3RpbmF0aW9uTm9kZSA9PSBkZXN0aW5hdGlvbk5vZGUgJiYgY29ubi5vdXRwdXQgPT0gb3V0cHV0ICYmIGNvbm4uaW5wdXQgPT0gaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuZGlzY29ubmVjdChjb25uLmRlc3RpbmF0aW9uTm9kZSwgY29ubi5vdXRwdXQsIGNvbm4uaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNjaGVkdWxlRXZlbnQobXNnLCB0KSB7XG4gICAgICAgIGlmICh0aGlzLm1pZGlTeW50aFNsb3QpIHtcbiAgICAgICAgICAgIHRoaXMubWlkaVN5bnRoU2xvdC5ub2RlLnNjaGVkdWxlRXZlbnQobXNnLCB0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IChcIk1JREkgU3ludGhlc2lzZXIgbm90IGxvYWRlZFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYW5jZWxBbGxFdmVudHModCkge1xuICAgICAgICBpZiAodGhpcy5taWRpU3ludGhTbG90KSB7XG4gICAgICAgICAgICB0aGlzLm1pZGlTeW50aFNsb3Qubm9kZS5jYW5jZWxBbGxFdmVudHModCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJNSURJIFN5bnRoZXNpc2VyIG5vdCBsb2FkZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICh0aGlzLm1pZGlTeW50aFNsb3QpIHtcbiAgICAgICAgICAgIHRoaXMubWlkaVN5bnRoU2xvdC5ub2RlLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJNSURJIFN5bnRoZXNpc2VyIG5vdCBsb2FkZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMubWlkaVN5bnRoU2xvdCkge1xuICAgICAgICAgICAgdGhpcy5taWRpU3ludGhTbG90Lm5vZGUuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgKFwiTUlESSBTeW50aGVzaXNlciBub3QgbG9hZGVkXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxvYWRNaWRpU3ludGhlc2lzZXJNb2R1bGUocHJvdG90eXBlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAocHJvdG90eXBlLmhhc01pZGlJbnB1dCA9PSBmYWxzZSB8fCBwcm90b3R5cGUuaGFzTWlkaU91dHB1dCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvdG90eXBlIGlzIG5vdCBhIE1pZGlTeW50aGVzaXMgdHlwZS4gaGFzTWlkaUlucHV0IG11c3QgYmUgdHJ1ZSBhbmQgaGFzTWlkaU91dHB1dCBtdXN0IGJlIGZhbHNlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG5vZGU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSB5aWVsZCB0aGlzLmJ1aWxkTmV3U3ludGhlc2lzZXJPYmplY3QocHJvdG90eXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGx1Z2luIGRpZCBub3QgZ2V0IGNyZWF0ZWQhIEFib3J0aW5nXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgO1xuICAgICAgICAgICAgbm9kZS5ub2RlLm9ubG9hZGVkLmNhbGwobm9kZS5ub2RlKTtcbiAgICAgICAgICAgIHRoaXMubWlkaVN5bnRoU2xvdCA9IG5vZGU7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGNvbm4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pZGlTeW50aFNsb3Qubm9kZS5jb25uZWN0KGNvbm4uZGVzdGluYXRpb25Ob2RlLCBjb25uLm91dHB1dCwgY29ubi5pbnB1dCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZXYuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJsb2FkZWRcIikpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWlkaVN5bnRoU2xvdDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMudW5sb2FkU3ludGhlc2lzZXJTbG90KCk7XG4gICAgICAgIHRoaXMuY29ubmVjdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBtaWRpU3ludGhlc2lzZXIoKSB7IHJldHVybiB0aGlzLm1pZGlTeW50aFNsb3Q7IH1cbn1cbiIsIi8qZXNsaW50LWVudiBicm93c2VyICovXG4vKiBqc2hpbnQgZXN2ZXJzaW9uOjYgKi9cbmNsYXNzIFBsdWdpbkFzc2V0IHtcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW5Bc3NldE1hbmFnZXIsIGlkLCBuYW1lLCB1cmwsIGltYWdlX3VybCwgcGFjaywgX2Fzc2V0T2JqZWN0KSB7XG4gICAgICAgIHRoaXMucGx1Z2luQXNzZXRNYW5hZ2VyID0gcGx1Z2luQXNzZXRNYW5hZ2VyO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuaW1hZ2VfdXJsID0gaW1hZ2VfdXJsO1xuICAgICAgICB0aGlzLnBhY2sgPSBwYWNrO1xuICAgICAgICB0aGlzLl9hc3NldE9iamVjdCA9IF9hc3NldE9iamVjdDtcbiAgICAgICAgdGhpcy51c2VkQnkgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuYXNzZXRVUkwgPSBuZXcgVVJMKHVybCwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XG4gICAgfVxuICAgIGFib3J0U2NoZWR1bGVGb3JDbGVhbnVwKCkge1xuICAgICAgICBpZiAodGhpcy5hc3NldENsZWFudXBJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuYXNzZXRDbGVhbnVwSWQpO1xuICAgICAgICAgICAgdGhpcy5hc3NldENsZWFudXBJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzY2hlZHVsZUZvckNsZWFudXAoKSB7XG4gICAgICAgIGlmICh0aGlzLmFzc2V0Q2xlYW51cElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFzc2V0Q2xlYW51cElkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fYXNzZXRPYmplY3QgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuYXNzZXRDbGVhbnVwSWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0sIDEwMDAwKTtcbiAgICB9XG4gICAgZmV0Y2hBc3NldCgpIHtcbiAgICAgICAgdGhpcy5hYm9ydFNjaGVkdWxlRm9yQ2xlYW51cCgpO1xuICAgICAgICB0aGlzLmZldGNoUHJvbWlzZSA9IHRoaXMucGx1Z2luQXNzZXRNYW5hZ2VyLmZldGNoQXNzZXRGdW5jdGlvbih0aGlzKVxuICAgICAgICAgICAgLnRoZW4oKGFiKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9hc3NldE9iamVjdCA9IGFiO1xuICAgICAgICAgICAgdGhpcy5mZXRjaFByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXNzZXRPYmplY3Q7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmZXRjaCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2Fzc2V0T2JqZWN0IGluc3RhbmNlb2YgQXVkaW9CdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYXNzZXRPYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZmV0Y2hQcm9taXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hBc3NldCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoUHJvbWlzZTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4geyBhc3NldDogdGhpcy5hc3NldFVSTC5wYXRobmFtZSB9O1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCkpO1xuICAgIH1cbiAgICByZWdpc3RlclRvUGx1Z2luKHBsdWdpbikge1xuICAgICAgICB0aGlzLmFib3J0U2NoZWR1bGVGb3JDbGVhbnVwKCk7XG4gICAgICAgIHRoaXMudXNlZEJ5LmFkZChwbHVnaW4pO1xuICAgIH1cbiAgICBkZXJlZ2lzdGVyRnJvbVBsdWdpbihwbHVnaW4pIHtcbiAgICAgICAgdGhpcy51c2VkQnkuZGVsZXRlKHBsdWdpbik7XG4gICAgICAgIGlmICh0aGlzLnVzZWRCeS5zaXplID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlRm9yQ2xlYW51cCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB1cmwoKSB7IHJldHVybiB0aGlzLmFzc2V0VVJMLmhyZWY7IH1cbiAgICBnZXQgYXNzZXRPYmplY3QoKSB7IHJldHVybiB0aGlzLmFzc2V0T2JqZWN0OyB9XG4gICAgZ2V0IGZldGNoZWQoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fYXNzZXRPYmplY3QgaW5zdGFuY2VvZiBBdWRpb0J1ZmZlciB8fCB0aGlzLmZldGNoUHJvbWlzZSAhPT0gdW5kZWZpbmVkKTtcbiAgICB9XG59XG5leHBvcnQgeyBQbHVnaW5Bc3NldCB9O1xuIiwiLyplc2xpbnQtZW52IGJyb3dzZXIgKi9cbi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBQbHVnaW5Bc3NldHNMaXN0IH0gZnJvbSBcIi4vUGx1Z2luQXNzZXRzTGlzdFwiO1xuaW1wb3J0IHsgZmV0Y2hBc3NldEFzQXJyYXlCdWZmZXIgfSBmcm9tIFwiLi9kZWZhdWx0QXNzZXRGZXRjaFwiO1xuZnVuY3Rpb24gZmluZFBhY2tCeU5hbWUoYXNzZXRQYWNrTGlzdCwgbmFtZSkge1xuICAgIHJldHVybiBhc3NldFBhY2tMaXN0LmZpbmQoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgcmV0dXJuIGwubmFtZSA9PSBuYW1lO1xuICAgIH0pO1xufVxuZXhwb3J0IGNsYXNzIFBsdWdpbkFzc2V0TWFuYWdlciB7XG4gICAgY29uc3RydWN0b3IoZmFjdG9yeUNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5mYWN0b3J5Q29udGV4dCA9IGZhY3RvcnlDb250ZXh0O1xuICAgICAgICB0aGlzLmFzc2V0RmV0Y2hGdW5jdGlvbiA9IGZldGNoQXNzZXRBc0FycmF5QnVmZmVyO1xuICAgICAgICB0aGlzLmFzc2V0UGFja3MgPSBbXTtcbiAgICB9XG4gICAgZmluZFBhY2tCeU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hc3NldFBhY2tzLmZpbmQobCA9PiBsLm5hbWUgPT0gbmFtZSk7XG4gICAgfVxuICAgIGFkZFBhY2tUb0xpc3QoaWQsIG5hbWUsIGltYWdlX3VybCwgcmVzb3VyY2VUeXBlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJhZGRBc3NldFVybFRvTGlzdCBBcmd1bWVudC0xIG11c3QgYmUgYSB0eXBlIG9mIHN0cmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maW5kUGFja0J5TmFtZShuYW1lKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQYWNrIHdpdGggbmFtZSAke25hbWV9IGFscmVhZHkgaW4gdGhpcyBsaXN0YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXNzZXRQYWNrID0gbmV3IFBsdWdpbkFzc2V0c0xpc3QodGhpcywgaWQsIG5hbWUsIGltYWdlX3VybCwgcmVzb3VyY2VUeXBlKTtcbiAgICAgICAgdGhpcy5hc3NldFBhY2tzLnB1c2goYXNzZXRQYWNrKTtcbiAgICAgICAgcmV0dXJuIGFzc2V0UGFjaztcbiAgICB9XG4gICAgcmVtb3ZlQXNzZXRQYWNrRnJvbUxpc3QoYXNzZXRQYWNrKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5hc3NldFBhY2tzLmluZGV4T2YoYXNzZXRQYWNrKTtcbiAgICAgICAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hc3NldFBhY2tzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXNzZXRQYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICByZXR1cm4gdGhpcy5hc3NldFBhY2tzO1xuICAgIH1cbiAgICByZW1vdmVBc3NldFBhY2tGcm9tTGlzdEJ5TmFtZShuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBcInJlbW92ZUFzc2V0VXJsRnJvbUxpc3QgQXJndW1lbnQtMSBtdXN0IGJlIGEgdHlwZSBvZiBzdHJpbmdcIjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhc3NldCA9IHRoaXMuZmluZFBhY2tCeU5hbWUobmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUFzc2V0UGFja0Zyb21MaXN0KGFzc2V0KTtcbiAgICB9XG4gICAgaW1wb3J0RnJvbUFzc2V0TGlzdHMob2xkQ29udGV4dCkge1xuICAgICAgICBvbGRDb250ZXh0LmFzc2V0UGFja3MuZm9yRWFjaCgob3JpZ2luYWxBc3NldFBhY2spID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRleHRQYWNrID0gdGhpcy5hZGRQYWNrVG9MaXN0KG9yaWdpbmFsQXNzZXRQYWNrLmlkLCBvcmlnaW5hbEFzc2V0UGFjay5uYW1lLCBvcmlnaW5hbEFzc2V0UGFjay5pbWFnZV91cmwsIG9yaWdpbmFsQXNzZXRQYWNrLnJlc291cmNlVHlwZSk7XG4gICAgICAgICAgICBvcmlnaW5hbEFzc2V0UGFjay5hc3NldE9iamVjdHMuZm9yRWFjaCgob3JpZ2luYWxBc3NldCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBhc3NldE9iamVjdDtcbiAgICAgICAgICAgICAgICBpZiAob3JpZ2luYWxBc3NldC5hc3NldE9iamVjdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0T2JqZWN0ID0gdGhpcy5mYWN0b3J5Q29udGV4dC5jb250ZXh0LmNyZWF0ZUJ1ZmZlcihvcmlnaW5hbEFzc2V0LmFzc2V0T2JqZWN0Lm51bWJlck9mQ2hhbm5lbHMsIG9yaWdpbmFsQXNzZXQuYXNzZXRPYmplY3QubGVuZ3RoLCBvcmlnaW5hbEFzc2V0LmFzc2V0T2JqZWN0LnNhbXBsZVJhdGUpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzc2V0T2JqZWN0Lm51bWJlck9mQ2hhbm5lbHM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRPYmplY3QuY29weVRvQ2hhbm5lbChvcmlnaW5hbEFzc2V0LmFzc2V0T2JqZWN0LmdldENoYW5uZWxEYXRhKGkpLCBpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lkLCBuYW1lLCB1cmwsIGltYWdlX3VybCwgYXNzZXRPYmplY3RcbiAgICAgICAgICAgICAgICBuZXdDb250ZXh0UGFjay5hZGRBc3NldFVybFRvTGlzdChvcmlnaW5hbEFzc2V0LmlkLCBvcmlnaW5hbEFzc2V0Lm5hbWUsIG9yaWdpbmFsQXNzZXQudXJsLCBvcmlnaW5hbEFzc2V0LmltYWdlX3VybCwgYXNzZXRPYmplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXREZWZhdWx0QXNzZXRGZXRjaEZ1bmN0aW9uKGZ1bmMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYXNzZXRGZXRjaEZ1bmN0aW9uID0gZnVuYztcbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaEFzc2V0RnVuY3Rpb24oYXNzZXRPYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGFiID0geWllbGQgdGhpcy5hc3NldEZldGNoRnVuY3Rpb24oYXNzZXRPYmplY3QpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkIHRoaXMuZmFjdG9yeUNvbnRleHQuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoYWIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0QWxsQXNzZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hc3NldFBhY2tzLm1hcChsID0+IGwuYXNzZXRPYmplY3RzKS5mbGF0KCk7XG4gICAgfVxuICAgIGdldEFsbEFzc2V0c0J5UmVzb3VyY2VUeXBlKHJlc291cmNlVHlwZSkge1xuICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlVHlwZSA9PSBcInN0cmluZ1wiICYmIHJlc291cmNlVHlwZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hc3NldFBhY2tzLmZpbHRlcigobGlzdCkgPT4gbGlzdC5yZXNvdXJjZVR5cGUgPT0gcmVzb3VyY2VUeXBlKS5tYXAobCA9PiBsLmFzc2V0T2JqZWN0cykuZmxhdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsQXNzZXRzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmluZEFzc2V0QnlVcmwodXJsKSB7XG4gICAgICAgIGNvbnN0IGZ1bGxVcmwgPSBuZXcgVVJMKHVybCwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbEFzc2V0cygpLmZpbmQoKGFzc2V0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZ1bGxVcmwgPSBuZXcgVVJMKGFzc2V0LnVybCwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XG4gICAgICAgICAgICByZXR1cm4gKGZ1bGxVcmwuaG9zdG5hbWUgPT09IGFzc2V0RnVsbFVybC5ob3N0bmFtZSAmJiBmdWxsVXJsLnBhdGhuYW1lID09PSBhc3NldEZ1bGxVcmwucGF0aG5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZmluZEFzc2V0QnlJZChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxBc3NldHMoKS5maW5kKChhc3NldCkgPT4gYXNzZXQuaWQgPT09IGlkKTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5hc3NldEZldGNoRnVuY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxufVxuIiwiLyplc2xpbnQtZW52IGJyb3dzZXIgKi9cbi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xuaW1wb3J0IHsgUGx1Z2luQXNzZXQgfSBmcm9tIFwiLi9QbHVnaW5Bc3NldFwiO1xuY2xhc3MgUGx1Z2luQXNzZXRzTGlzdCB7XG4gICAgY29uc3RydWN0b3IocGx1Z2luQXNzZXRNYW5hZ2VyLCBpZCwgbmFtZSwgaW1hZ2VfdXJsLCByZXNvdXJjZVR5cGUpIHtcbiAgICAgICAgdGhpcy5wbHVnaW5Bc3NldE1hbmFnZXIgPSBwbHVnaW5Bc3NldE1hbmFnZXI7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5pbWFnZV91cmwgPSBpbWFnZV91cmw7XG4gICAgICAgIHRoaXMucmVzb3VyY2VUeXBlID0gcmVzb3VyY2VUeXBlO1xuICAgICAgICB0aGlzLmFzc2V0T2JqZWN0cyA9IFtdO1xuICAgIH1cbiAgICBmaW5kQXNzZXRCeVVybCh1cmwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXRPYmplY3RzLmZpbmQoKGFzc2V0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYXNzZXQudXJsID09IHVybDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZEFzc2V0VXJsVG9MaXN0KGlkLCBuYW1lLCB1cmwsIGltYWdlX3VybCwgYXNzZXRPYmplY3QpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgIT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYWRkQXNzZXRVcmxUb0xpc3QgQXJndW1lbnQtMiBtdXN0IGJlIGEgdHlwZSBvZiBzdHJpbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmluZEFzc2V0QnlVcmwodXJsKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVUkwgJHt1cmx9IGFscmVhZHkgaW4gdGhpcyBsaXN0YCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hc3NldE9iamVjdHMucHVzaChuZXcgUGx1Z2luQXNzZXQodGhpcy5wbHVnaW5Bc3NldE1hbmFnZXIsIGlkLCBuYW1lLCB1cmwsIGltYWdlX3VybCwgdGhpcywgYXNzZXRPYmplY3QpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXRPYmplY3RzO1xuICAgIH1cbiAgICByZW1vdmVBc3NldEZyb21MaXN0KGFzc2V0KSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5hc3NldE9iamVjdHMuZmluZEluZGV4KChsaXN0T2JqZWN0cykgPT4gYXNzZXQudXJsID09IGxpc3RPYmplY3RzLnVybCk7XG4gICAgICAgIGlmIChpbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXNzZXQgbm90IGluIHRoaXMgbGlzdFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFzc2V0T2JqZWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICByZXR1cm4gdGhpcy5hc3NldE9iamVjdHM7XG4gICAgfVxuICAgIHJlbW92ZUFzc2V0VXJsRnJvbUxpc3QodXJsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInJlbW92ZUFzc2V0VXJsRnJvbUxpc3QgQXJndW1lbnQtMSBtdXN0IGJlIGEgdHlwZSBvZiBzdHJpbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXNzZXQgPSB0aGlzLmZpbmRBc3NldEJ5VXJsKHVybCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUFzc2V0RnJvbUxpc3QoYXNzZXQpO1xuICAgIH1cbiAgICA7XG59XG5leHBvcnQgeyBQbHVnaW5Bc3NldHNMaXN0IH07XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmZXRjaEFzc2V0QXNBcnJheUJ1ZmZlcihhc3NldE9iamVjdCkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGNvbnN0IHIgPSB5aWVsZCBmZXRjaChhc3NldE9iamVjdC51cmwpO1xuICAgICAgICByZXR1cm4geWllbGQgci5hcnJheUJ1ZmZlcigpO1xuICAgIH0pO1xufVxuIiwiLy8gVGhpcyBkZWZpbmVzIGEgbWFzdGVyIG9iamVjdCBmb3IgaG9sZGluZyBhbGwgdGhlIHBsdWdpbnMgYW5kIGNvbW11bmljYXRpbmdcbi8vIFRoaXMgb2JqZWN0IHdpbGwgYWxzbyBoYW5kbGUgY3JlYXRpb24gYW5kIGRlc3RydWN0aW9uIG9mIHBsdWdpbnNcbi8qZ2xvYmFscyBQcm9taXNlLCBkb2N1bWVudCwgY29uc29sZSwgTGlua2VkU3RvcmUsIFdvcmtlciwgd2luZG93LCBYTUxIdHRwUmVxdWVzdCAqL1xuLyplc2xpbnQtZW52IGJyb3dzZXIgKi9cbi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBMaW5rZWRTdG9yZSB9IGZyb20gJy4uL0xpbmtlZFN0b3JlJztcbmltcG9ydCB7IFBsdWdpbkFzc2V0TWFuYWdlciB9IGZyb20gJy4vUGx1Z2luQXNzZXRzL1BsdWdpbkFzc2V0TWFuYWdlcic7XG5pbXBvcnQgeyBQbHVnaW5Qcm90b3R5cGUgfSBmcm9tIFwiLi9QbHVnaW5Qcm90b3R5cGVcIjtcbmltcG9ydCB7IEZlYXR1cmVNYXAgfSBmcm9tIFwiLi9GZWF0dXJlTWFwL2luZGV4XCI7XG5pbXBvcnQgeyBBdWRpb1BsdWdpbkNoYWluTWFuYWdlciB9IGZyb20gXCIuL0F1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyL2luZGV4XCI7XG5pbXBvcnQgeyBNaWRpU3ludGhlc2lzZXJIb3N0IH0gZnJvbSBcIi4vTWlkaVN5bnRoZXNpc2VySG9zdFwiO1xuaW1wb3J0IHsgUGx1Z2luVXNlckludGVyZmFjZU1lc3NhZ2VIdWIgfSBmcm9tIFwiLi9QbHVnaW5Vc2VySW50ZXJmYWNlTWVzc2FnZUh1YlwiO1xuaW1wb3J0IHsgaXNQbHVnaW5JbnN0YW5jZSB9IGZyb20gJy4vUGx1Z2luSW5zdGFuY2UnO1xuaW1wb3J0IHsgaXNNaWRpU3ludGhlc2lzSW5zdGFuY2UgfSBmcm9tICcuL01pZGlTeW50aGVzaXNJbnN0YW5jZSc7XG5leHBvcnQgY2xhc3MgUGx1Z2luRmFjdG9yeSB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgcm9vdFVSTCkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLnJvb3RVUkwgPSByb290VVJMO1xuICAgICAgICB0aGlzLnBsdWdpbl9wcm90b3R5cGVzID0gW107XG4gICAgICAgIHRoaXMuYXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJzID0gW107XG4gICAgICAgIHRoaXMuc3ludGhlc2lzZXJIb3N0cyA9IFtdO1xuICAgICAgICB0aGlzLnBsdWdpbnNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYXVkaW9TdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuUGx1Z2luR1VJID0gbmV3IFBsdWdpblVzZXJJbnRlcmZhY2VNZXNzYWdlSHViKHRoaXMpO1xuICAgICAgICB0aGlzLnN0b3JlcyA9IFtdO1xuICAgICAgICB0aGlzLlNlc3Npb25EYXRhID0gbmV3IExpbmtlZFN0b3JlKFwiU2Vzc2lvblwiKTtcbiAgICAgICAgdGhpcy5Vc2VyRGF0YSA9IG5ldyBMaW5rZWRTdG9yZShcIlVzZXJcIik7XG4gICAgICAgIHRoaXMuRmVhdHVyZU1hcCA9IG5ldyBGZWF0dXJlTWFwKHRoaXMpO1xuICAgICAgICB0aGlzLnBsdWdpbkFzc2V0cyA9IG5ldyBQbHVnaW5Bc3NldE1hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMuZGVzdHJveUF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyID0gZnVuY3Rpb24gKFN1YkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuYXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJzLmZpbmRJbmRleChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ID09PSB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LCBTdWJGYWN0b3J5KTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb1BsdWdpbkNoYWluTWFuYWdlcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBTdWJGYWN0b3J5LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29weUZhY3RvcnkoZmFjdG9yeSwgbmV3Y29udGV4dCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgQkZhY3RvcnkgPSBuZXcgUGx1Z2luRmFjdG9yeShuZXdjb250ZXh0LCB0aGlzLnJvb3RVUkwpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBwcm90byBvZiB0aGlzLnBsdWdpbl9wcm90b3R5cGVzKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgQkZhY3RvcnkuYWRkUHJvdG90eXBlKHByb3RvLnByb3RvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEJGYWN0b3J5LnBsdWdpbkFzc2V0cy5pbXBvcnRGcm9tQXNzZXRMaXN0cyh0aGlzLnBsdWdpbkFzc2V0cyk7XG4gICAgICAgICAgICByZXR1cm4gQkZhY3Rvcnk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwbHVnaW5BdWRpb1N0YXJ0KG5vZGUsIHByb2dyYW1fdGltZSwgY29udGV4dF90aW1lKSB7XG4gICAgICAgIG5vZGUuc3RhcnQuY2FsbChub2RlLCBwcm9ncmFtX3RpbWUsIGNvbnRleHRfdGltZSk7XG4gICAgICAgIG5vZGUucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJOYW1lcygpLmZvckVhY2goZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHZhciBwID0gbm9kZS5wYXJhbWV0ZXJzLmdldFBhcmFtZXRlckJ5TmFtZShuKTtcbiAgICAgICAgICAgIGlmIChwLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBwLnN0YXJ0KHByb2dyYW1fdGltZSwgY29udGV4dF90aW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHBsdWdpbkF1ZGlvU3RvcChub2RlKSB7XG4gICAgICAgIGNvbnN0IGN0ID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICBub2RlLnN0b3AuY2FsbChub2RlLCBjdCk7XG4gICAgICAgIG5vZGUucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJOYW1lcygpLmZvckVhY2goZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHZhciBwID0gbm9kZS5wYXJhbWV0ZXJzLmdldFBhcmFtZXRlckJ5TmFtZShuKTtcbiAgICAgICAgICAgIGlmIChwLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBwLnN0b3AoY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdHJpZ2dlckF1ZGlvU3RhcnQocHJvZ3JhbV90aW1lLCBjb250ZXh0X3RpbWUpIHtcbiAgICAgICAgdGhpcy5wbHVnaW5zTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbkF1ZGlvU3RhcnQobi5ub2RlLCBwcm9ncmFtX3RpbWUsIGNvbnRleHRfdGltZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB0cmlnZ2VyQXVkaW9TdG9wKCkge1xuICAgICAgICB0aGlzLnBsdWdpbnNMaXN0LmZvckVhY2goZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luQXVkaW9TdG9wKG4ubm9kZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXN0cm95RmFjdG9yeSgpIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyQXVkaW9TdG9wKCk7XG4gICAgICAgIGZvciAoY29uc3Qgc3ViRmFjdG9yeSBvZiBBcnJheS5mcm9tKHRoaXMuYXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJzKSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95QXVkaW9QbHVnaW5DaGFpbk1hbmFnZXIoc3ViRmFjdG9yeSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBzeW50aGVzaXNlckhvc3Qgb2YgQXJyYXkuZnJvbSh0aGlzLnN5bnRoZXNpc2VySG9zdHMpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lNaWRpU3ludGhlc2lzZXJIb3N0KHN5bnRoZXNpc2VySG9zdCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgQXJyYXkuZnJvbSh0aGlzLnBsdWdpbnNMaXN0KSkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVQbHVnaW4ocGx1Z2luKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHByb3RvdHlwZSBvZiBBcnJheS5mcm9tKHRoaXMucGx1Z2luX3Byb3RvdHlwZXMpKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVByb3RvdHlwZShwcm90b3R5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGx1Z2luQXNzZXRzLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgO1xuICAgIGxvYWRQcm90b3R5cGVNb2R1bGUocmVzb3VyY2VPYmplY3QsIG11c3RNb2R1bGUgPSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgbGV0IG1vZHVsZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBnbG9iYWwuZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZ2xvYmFsLmRlZmluZS5hbWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gZ2xvYmFsLnJlcXVpcmUocmVzb3VyY2VPYmplY3QudXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGdsb2JhbC5tb2R1bGUgPT0gXCJvYmplY3RcIiAmJiBnbG9iYWwubW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gKGdsb2JhbC5yZXF1aXJlKHJlc291cmNlT2JqZWN0LnVybCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGxvYWQgdXNpbmcgcmVxdWlyZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRQcm90b3R5cGUobW9kdWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIklzIG5vdCBhIG1vZHVsZSBwbHVnaW5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobXVzdE1vZHVsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgbG9hZCB1c2luZyBtb2R1bGFyIHN5c3RlbXNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgbG9hZCB1c2luZyBtb2R1bGFyIHN5c3RlbXNcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxvYWRQbHVnaW5TY3JpcHQocmVzb3VyY2VPYmplY3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIDtcbiAgICBsb2FkUmVzb3VyY2UocmVzb3VyY2VPYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzb3VyY2VPYmplY3QgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFcnJvclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiByZXNvdXJjZU9iamVjdC51cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZXNvdXJjZU9iamVjdC51cmwgbXVzdCBiZSBhIHN0cmluZ1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiByZXNvdXJjZU9iamVjdC50ZXN0ICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZXNvdXJjZU9iamVjdC50ZXN0IG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVzb3VyY2VPYmplY3QudGVzdCgpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlICE9PSBmYWxzZSAmJiByZXNwb25zZSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInJlc291cmNlT2JqZWN0LnRlc3QgbXVzdCByZXR1cm4gdHJ1ZSBvciBmYWxzZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcmVzb3VyY2VPYmplY3QudHlwZSkge1xuICAgICAgICAgICAgICAgIHJlc291cmNlT2JqZWN0LnR5cGUgPSBcImphdmFzY3JpcHRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc291cmNlT2JqZWN0LnR5cGUgPSByZXNvdXJjZU9iamVjdC50eXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBzd2l0Y2ggKHJlc291cmNlT2JqZWN0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiamF2YXNjcmlwdFwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmxvYWRSZXNvdXJjZShyZXNvdXJjZU9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvdXJjZU9iamVjdC5yZXR1cm5PYmplY3QgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaGFzT3duUHJvcGVydHkocmVzb3VyY2VPYmplY3QucmV0dXJuT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAod2luZG93W3Jlc291cmNlT2JqZWN0LnJldHVybk9iamVjdF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdHlwZSBcIiArIFN0cmluZyhyZXNvdXJjZU9iamVjdC50eXBlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICA7XG4gICAgbG9hZFBsdWdpblNjcmlwdChyZXNvdXJjZU9iamVjdCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHJlc291cmNlT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvdXJjZU9iamVjdC5yZXR1cm5PYmplY3QgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwicmVzb3VyY2VPYmplY3QucmV0dXJuT2JqZWN0IG11c3QgYmUgdGhlIG5hbWUgb2YgdGhlIHByb3RvdHlwZSBmdW5jdGlvblwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcGx1Z2luID0geWllbGQgdGhpcy5sb2FkUmVzb3VyY2UocmVzb3VyY2VPYmplY3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCB0aGlzLmFkZFByb3RvdHlwZShwbHVnaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgO1xuICAgIGluamVjdFByb3RvdHlwZShwcm90b3R5cGVFeGVjdXRhYmxlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvdG90eXBlRXhlY3V0YWJsZSAhPSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IChcIkludmFsaWQgZXhlY3V0YWJsZSBmdW5jdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRQcm90b3R5cGUocHJvdG90eXBlRXhlY3V0YWJsZSk7XG4gICAgfVxuICAgIDtcbiAgICBhZGRQcm90b3R5cGUocGx1Z2luX3Byb3RvKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcGx1Z2luX3Byb3RvICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBQcm90b3R5cGUgbXVzdCBiZSBhIGZ1bmN0aW9uIVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgcGx1Z2luX3Byb3RvLnByb3RvdHlwZS5uYW1lICE9PSBcInN0cmluZ1wiIHx8IHBsdWdpbl9wcm90by5wcm90b3R5cGUubmFtZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1hbGZvcm1lZCBwbHVnaW4uIE5hbWUgbm90IGRlZmluZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHBsdWdpbl9wcm90by5wcm90b3R5cGUudmVyc2lvbiAhPT0gXCJzdHJpbmdcIiB8fCBwbHVnaW5fcHJvdG8ucHJvdG90eXBlLnZlcnNpb24ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYWxmb3JtZWQgcGx1Z2luLiBWZXJzaW9uIG5vdCBkZWZpbmVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBwbHVnaW5fcHJvdG8ucHJvdG90eXBlLnVuaXF1ZUlEICE9PSBcInN0cmluZ1wiIHx8IHBsdWdpbl9wcm90by5wcm90b3R5cGUudW5pcXVlSUQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYWxmb3JtZWQgcGx1Z2luLiB1bmlxdWVJRCBub3QgZGVmaW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0ZXN0T2JqID0ge1xuICAgICAgICAgICAgJ3Byb3RvJzogcGx1Z2luX3Byb3RvLFxuICAgICAgICAgICAgJ25hbWUnOiBwbHVnaW5fcHJvdG8ucHJvdG90eXBlLm5hbWUsXG4gICAgICAgICAgICAndmVyc2lvbic6IHBsdWdpbl9wcm90by5wcm90b3R5cGUudmVyc2lvbixcbiAgICAgICAgICAgICd1bmlxdWVJRCc6IHBsdWdpbl9wcm90by5wcm90b3R5cGUudW5pcXVlSURcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5wbHVnaW5fcHJvdG90eXBlcy5maW5kKChlKSA9PiB7XG4gICAgICAgICAgICBsZXQgbWF0Y2ggPSAwO1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJhbSBpbiB0ZXN0T2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVbcGFyYW1dID09PSB0aGlzW3BhcmFtXSkge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtYXRjaCA9PT0gNDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChvYmopIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBwbHVnaW4gbXVzdCBiZSB1bmlxdWUhXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1BsdWdpblByb3RvdHB5ZSA9IG5ldyBQbHVnaW5Qcm90b3R5cGUocGx1Z2luX3Byb3RvLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wbHVnaW5fcHJvdG90eXBlcy5wdXNoKG5ld1BsdWdpblByb3RvdHB5ZSk7XG4gICAgICAgIHJldHVybiBuZXdQbHVnaW5Qcm90b3RweWU7XG4gICAgfVxuICAgIDtcbiAgICBkZWxldGVQcm90b3R5cGUocGx1Z2luX3Byb3RvKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wbHVnaW5fcHJvdG90eXBlcy5pbmRleE9mKHBsdWdpbl9wcm90byk7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBsdWdpbl9wcm90b3R5cGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIDtcbiAgICBnZXRQcm90b3R5cGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW5fcHJvdG90eXBlcztcbiAgICB9XG4gICAgO1xuICAgIGdldEF1ZGlvUGx1Z2luUHJvdG90eXBlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luX3Byb3RvdHlwZXMuZmlsdGVyKGZ1bmN0aW9uIChwcm90bykge1xuICAgICAgICAgICAgcmV0dXJuIHByb3RvLmhhc01pZGlJbnB1dCA9PSBmYWxzZSAmJiBwcm90by5oYXNNaWRpT3V0cHV0ID09IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgO1xuICAgIGdldE1pZGlTeW50aFByb3RvdHlwZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsdWdpbl9wcm90b3R5cGVzLmZpbHRlcihmdW5jdGlvbiAocHJvdG8pIHtcbiAgICAgICAgICAgIHJldHVybiBwcm90by5oYXNNaWRpSW5wdXQgPT0gdHJ1ZSAmJiBwcm90by5oYXNNaWRpT3V0cHV0ID09IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgO1xuICAgIGdldE1pZGlQbHVnaW5Qcm90b3R5cGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW5fcHJvdG90eXBlcy5maWx0ZXIoZnVuY3Rpb24gKHByb3RvKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvdG8uaGFzTWlkaUlucHV0ID09IHRydWUgJiYgcHJvdG8uaGFzTWlkaU91dHB1dCA9PSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgO1xuICAgIGdldEFsbFBsdWdpbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsdWdpbnNMaXN0O1xuICAgIH1cbiAgICA7XG4gICAgZ2V0QWxsUGx1Z2luc09iamVjdCgpIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICAgICAgJ2ZhY3RvcnknOiB0aGlzLFxuICAgICAgICAgICAgJ2F1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2Vycyc6IFtdXG4gICAgICAgIH07XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hdWRpb1BsdWdpbkNoYWluTWFuYWdlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG9iai5hdWRpb1BsdWdpbkNoYWluTWFuYWdlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgJ3N1YkZhY3RvcnknOiB0aGlzLmF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2Vyc1tpXSxcbiAgICAgICAgICAgICAgICAncGx1Z2lucyc6IHRoaXMuYXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJzW2ldLmdldFBsdWdpbnMoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgO1xuICAgIGNyZWF0ZUF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyKGNoYWluU3RhcnQsIGNoYWluU3RvcCkge1xuICAgICAgICBjb25zdCBub2RlID0gbmV3IEF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyKHRoaXMsIGNoYWluU3RhcnQsIGNoYWluU3RvcCk7XG4gICAgICAgIHRoaXMuYXVkaW9QbHVnaW5DaGFpbk1hbmFnZXJzLnB1c2gobm9kZSk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgICA7XG4gICAgZHVwbGljYXRlQXVkaW9QbHVnaW5DaGFpbk1hbmFnZXIoc291cmNlQ2hhaW5NYW5hZ2VyLCBjaGFpblN0YXJ0LCBjaGFpblN0b3ApIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLmNyZWF0ZUF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyKGNoYWluU3RhcnQsIGNoYWluU3RvcCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBsdWdpbl9vYmplY3Qgb2Ygc291cmNlQ2hhaW5NYW5hZ2VyLmdldFBsdWdpbnMoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1BsdWdpbiA9IHlpZWxkIG5vZGUuY3JlYXRlUGx1Z2luKHBsdWdpbl9vYmplY3QucHJvdG90eXBlT2JqZWN0KTtcbiAgICAgICAgICAgICAgICBuZXdQbHVnaW4ubm9kZS5wYXJhbWV0ZXJzLnNldFBhcmFtZXRlcnNCeU9iamVjdChwbHVnaW5fb2JqZWN0Lm5vZGUucGFyYW1ldGVycy5nZXRQYXJhbWV0ZXJPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICA7XG4gICAgY3JlYXRlTWlkaVN5bnRoZXNpc2VySG9zdChmYWN0b3J5KSB7XG4gICAgICAgIGlmIChmYWN0b3J5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZhY3RvcnkgPSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhvc3QgPSBuZXcgTWlkaVN5bnRoZXNpc2VySG9zdChmYWN0b3J5KTtcbiAgICAgICAgdGhpcy5zeW50aGVzaXNlckhvc3RzLnB1c2goaG9zdCk7XG4gICAgICAgIHJldHVybiBob3N0O1xuICAgIH1cbiAgICA7XG4gICAgZGVzdHJveU1pZGlTeW50aGVzaXNlckhvc3QoaG9zdCkge1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnN5bnRoZXNpc2VySG9zdHMuZmluZEluZGV4KGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCA9PT0gdGhpcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LCBob3N0KTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3ludGhlc2lzZXJIb3N0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgaG9zdC5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgO1xuICAgIHJlZ2lzdGVyUGx1Z2luSW5zdGFuY2UoaW5zdGFuY2UpIHtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luc0xpc3QuZmluZChwID0+IHAgPT09IGluc3RhbmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGx1Z2luIEluc3RhbmNlIG5vdCB1bmlxdWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wbHVnaW5zTGlzdC5wdXNoKGluc3RhbmNlKTtcbiAgICAgICAgaWYgKHRoaXMuYXVkaW9TdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0X3RpbWUgPSB0aGlzLmNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICBjb25zdCBwcm9ncmFtX3RpbWUgPSB0aGlzLmdldEN1cnJlbnRQcm9ncmFtVGltZSgpO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW5BdWRpb1N0YXJ0KGluc3RhbmNlLm5vZGUsIHByb2dyYW1fdGltZSwgY29udGV4dF90aW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgO1xuICAgIGRlbGV0ZVBsdWdpbihwbHVnaW4pIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbnNMaXN0LmluZGV4T2YocGx1Z2luKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIC8vIEFsc28gY2hlY2sgaXQgaXNuJ3Qgcm9ndWUgYXR0YWNoZWQgdG8gYSBwbHVnaW4gY2hhaW5cbiAgICAgICAgICAgIGlmIChpc1BsdWdpbkluc3RhbmNlKHBsdWdpbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2Vycy5mb3JFYWNoKChzdWJGYWN0b3J5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJGYWN0b3J5LmdldFBsdWdpbnMoKS5pbmNsdWRlcyhwbHVnaW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJGYWN0b3J5LnJlbW92ZVBsdWdpbihwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc01pZGlTeW50aGVzaXNJbnN0YW5jZShwbHVnaW4pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zeW50aGVzaXNlckhvc3RzLmZvckVhY2goaG9zdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChob3N0Lm1pZGlTeW50aGVzaXNlciA9PT0gcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0LnVubG9hZFN5bnRoZXNpc2VyU2xvdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBsdWdpbnNMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICBwbHVnaW4ubm9kZS5kZWxldGUoKTtcbiAgICAgICAgICAgIHBsdWdpbi5ub2RlLmV4dGVybmFsSW50ZXJmYWNlLmNsb3NlV2luZG93cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEN1cnJlbnRQcm9ncmFtVGltZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXVkaW9TdGFydGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lIC0gdGhpcy5hdWRpb1N0YXJ0Q29udGV4dFRpbWUgKyB0aGlzLmF1ZGlvU3RhcnRQcm9ncmFtVGltZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1ZGlvU3RhcnRQcm9ncmFtVGltZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRDdXJyZW50UHJvZ3JhbVRpbWUodGltZSkge1xuICAgICAgICBpZiAodGhpcy5hdWRpb1N0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk11c3Qgc3RvcCBwbGF5YmFjayB0byBzZXQgdGhlIGN1cnJlbnQgcHJvZ3JhbSB0aW1lXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdGltZSA9PSBcIm51bWJlclwiICYmIHRpbWUgPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5hdWRpb1N0YXJ0UHJvZ3JhbVRpbWUgPSB0aW1lO1xuICAgICAgICAgICAgdGhpcy5QbHVnaW5HVUkucG9sbEFsbFBsdWdpbnMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhdWRpb1N0YXJ0KHByb2dyYW1fdGltZSwgY29udGV4dF90aW1lKSB7XG4gICAgICAgIGlmIChjb250ZXh0X3RpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29udGV4dF90aW1lID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9ncmFtX3RpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvZ3JhbV90aW1lID0gMDtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkFzc3VtaW5nIHN0YXJ0IHRpbWUgYXQgMFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuYXVkaW9TdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnNldEN1cnJlbnRQcm9ncmFtVGltZShwcm9ncmFtX3RpbWUpO1xuICAgICAgICAgICAgdGhpcy5hdWRpb1N0YXJ0Q29udGV4dFRpbWUgPSBjb250ZXh0X3RpbWU7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJBdWRpb1N0YXJ0KHByb2dyYW1fdGltZSwgY29udGV4dF90aW1lKTtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9TdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhdWRpb1N0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLmF1ZGlvU3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyQXVkaW9TdG9wKCk7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvU3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVN0b3JlKHN0b3JlTmFtZSkge1xuICAgICAgICBsZXQgbm9kZSA9IHRoaXMuZmluZFN0b3JlKHN0b3JlTmFtZSk7XG4gICAgICAgIGlmIChub2RlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5vZGUgPSBuZXcgTGlua2VkU3RvcmUoc3RvcmVOYW1lKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmVzLnB1c2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuICAgIDtcbiAgICBnZXRTdG9yZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JlcztcbiAgICB9XG4gICAgO1xuICAgIGZpbmRTdG9yZShzdG9yZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmVzLmZpbmQoYSA9PiBhLm5hbWUgPT09IHN0b3JlTmFtZSk7XG4gICAgfVxuICAgIDtcbiAgICBjcmVhdGVGYWN0b3J5Q29weShjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHlGYWN0b3J5KHRoaXMsIGNvbnRleHQpO1xuICAgIH1cbiAgICBnZXQgaGFzQXVkaW9TdGFydGVkKCkgeyByZXR1cm4gdGhpcy5hdWRpb1N0YXJ0ZWQ7IH1cbiAgICBnZXQgcGx1Z2luUm9vdFVSTCgpIHsgcmV0dXJuIHRoaXMucm9vdFVSTDsgfVxuICAgIHNldCBwbHVnaW5Sb290VVJMKHQpIHsgdGhpcy5yb290VVJMID0gdDsgfVxuICAgIGdldCBzdWJGYWN0b3JpZXMoKSB7IHJldHVybiB0aGlzLmF1ZGlvUGx1Z2luQ2hhaW5NYW5hZ2VyczsgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuaW1wb3J0IHsgQXVkaW9QbHVnaW4gfSBmcm9tIFwiLi4vQmFzZVBsdWdpbi9BdWRpb1BsdWdpblwiO1xuLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuZXhwb3J0IGNsYXNzIFBsdWdpbkluc3RhbmNlIHtcbiAgICBjb25zdHJ1Y3Rvcihub2RlKSB7XG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIHRoaXMuX2J5cGFzc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXYgPSBuZXcgRXZlbnRUYXJnZXQoKTtcbiAgICAgICAgdGhpcy5faW4gPSB0aGlzLm5vZGUuY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgICAgIHRoaXMuX291dCA9IHRoaXMubm9kZS5jb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICAgICAgdGhpcy5faW4uY29ubmVjdCh0aGlzLm5vZGUuZ2V0SW5wdXRzKClbMF0pO1xuICAgICAgICB0aGlzLm5vZGUuZ2V0T3V0cHV0cygpWzBdLmNvbm5lY3QodGhpcy5fb3V0KTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJwYXJhbWV0ZXJzZXRcIiwgdGhpcyk7XG4gICAgICAgIHRoaXMubm9kZS5hZGRFdmVudExpc3RlbmVyKFwiYWx0ZXJkZWxheVwiLCB0aGlzKTtcbiAgICB9XG4gICAgYnlwYXNzRW5hYmxlKCkge1xuICAgICAgICB0aGlzLl9pbi5kaXNjb25uZWN0KCk7XG4gICAgICAgIHRoaXMuX2luLmNvbm5lY3QodGhpcy5fb3V0KTtcbiAgICAgICAgdGhpcy5ub2RlLmdldE91dHB1dHMoKVswXS5kaXNjb25uZWN0KHRoaXMuX291dCk7XG4gICAgICAgIHRoaXMuX2J5cGFzc2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5wcm9jZXNzaW5nRGVsYXlBc1NhbXBsZXMgIT0gMCkge1xuICAgICAgICAgICAgdGhpcy5ldi5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImFsdGVyZGVsYXlcIikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXYuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJieXBhc3NlZFwiKSk7XG4gICAgfVxuICAgIGJ5cGFzc0Rpc2FibGUoKSB7XG4gICAgICAgIHRoaXMuX2luLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgdGhpcy5faW4uY29ubmVjdCh0aGlzLm5vZGUuZ2V0SW5wdXRzKClbMF0pO1xuICAgICAgICB0aGlzLm5vZGUuZ2V0T3V0cHV0cygpWzBdLmNvbm5lY3QodGhpcy5fb3V0KTtcbiAgICAgICAgdGhpcy5fYnlwYXNzZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS5wcm9jZXNzaW5nRGVsYXlBc1NhbXBsZXMgIT0gMCkge1xuICAgICAgICAgICAgdGhpcy5ldi5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImFsdGVyZGVsYXlcIikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXYuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJieXBhc3NlZFwiKSk7XG4gICAgfVxuICAgIGJ5cGFzcyhzdGF0ZSkge1xuICAgICAgICBzdGF0ZSA9IChzdGF0ZSA9PT0gdHJ1ZSk7XG4gICAgICAgIGlmIChzdGF0ZSA9PT0gdGhpcy5fYnlwYXNzZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ieXBhc3NlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuYnlwYXNzRW5hYmxlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ5cGFzc0Rpc2FibGUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYnlwYXNzZWQ7XG4gICAgfVxuICAgIGlzQnlwYXNzZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXBhc3NlZDtcbiAgICB9XG4gICAgcmVjb25uZWN0KG5ld19uZXh0KSB7XG4gICAgICAgIHRoaXMuY29ubmVjdChuZXdfbmV4dCk7XG4gICAgfVxuICAgIGNvbm5lY3QobmV3X25leHQpIHtcbiAgICAgICAgaWYgKHRoaXMubmV4dF9ub2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdfbmV4dCAhPT0gdW5kZWZpbmVkICYmIG5ld19uZXh0LmlucHV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dF9ub2RlID0gbmV3X25leHQ7XG4gICAgICAgICAgICB0aGlzLl9vdXQuY29ubmVjdCh0aGlzLm5leHRfbm9kZS5pbnB1dCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIGlmICh0aGlzLm5leHRfbm9kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9vdXQuZGlzY29ubmVjdCh0aGlzLm5leHRfbm9kZS5pbnB1dCk7XG4gICAgICAgICAgICB0aGlzLm5leHRfbm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLm5vZGUuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhcmFtZXRlcnNldFwiLCB0aGlzKTtcbiAgICAgICAgdGhpcy5ub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhbHRlcmRlbGF5XCIsIHRoaXMpO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChlKSB7XG4gICAgICAgIHRoaXMuZXYuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoZS50eXBlKSk7XG4gICAgfVxuICAgIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXYuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXYucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfVxuICAgIGdldCBpbnB1dCgpIHsgcmV0dXJuIHRoaXMuX2luOyB9XG4gICAgZ2V0IG91dHB1dCgpIHsgcmV0dXJuIHRoaXMuX291dDsgfVxuICAgIGdldCBieXBhc3NlZCgpIHsgcmV0dXJuIHRoaXMuX2J5cGFzc2VkOyB9XG4gICAgZ2V0IHByb3RvdHlwZU9iamVjdCgpIHsgcmV0dXJuIHRoaXMubm9kZS5wcm90b3R5cGVPYmplY3Q7IH1cbiAgICBnZXQgZXh0ZXJuYWxJbnRlcmZhY2UoKSB7IHJldHVybiB0aGlzLm5vZGUuZXh0ZXJuYWxJbnRlcmZhY2U7IH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1BsdWdpbkluc3RhbmNlKG9iamVjdCkge1xuICAgIHJldHVybiBvYmplY3Qubm9kZSBpbnN0YW5jZW9mIEF1ZGlvUGx1Z2luO1xufVxuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG4vKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5pbXBvcnQgeyBQbHVnaW5JbnN0YW5jZSB9IGZyb20gXCIuL1BsdWdpbkluc3RhbmNlXCI7XG5pbXBvcnQgeyBNaWRpU3ludGhlc2lzSW5zdGFuY2UgfSBmcm9tIFwiLi9NaWRpU3ludGhlc2lzSW5zdGFuY2VcIjtcbmNsYXNzIEJhc2VQbHVnaW5Qcm90b3R5cGUge1xuICAgIGNvbnN0cnVjdG9yKHByb3RvLCBmYWN0b3J5KSB7XG4gICAgICAgIHRoaXMucHJvdG8gPSBwcm90bztcbiAgICAgICAgdGhpcy5mYWN0b3J5ID0gZmFjdG9yeTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7IHJldHVybiB0aGlzLnByb3RvLnByb3RvdHlwZS5uYW1lOyB9XG4gICAgZ2V0IHZlcnNpb24oKSB7IHJldHVybiB0aGlzLnByb3RvLnByb3RvdHlwZS52ZXJzaW9uOyB9XG4gICAgZ2V0IHVuaXF1ZUlEKCkgeyByZXR1cm4gdGhpcy5wcm90by5wcm90b3R5cGUudW5pcXVlSUQ7IH1cbiAgICBnZXQgaGFzTWlkaUlucHV0KCkgeyByZXR1cm4gKHRoaXMucHJvdG8ucHJvdG90eXBlLmhhc01pZGlJbnB1dCB8fCBmYWxzZSk7IH1cbiAgICBnZXQgaGFzTWlkaU91dHB1dCgpIHsgcmV0dXJuICh0aGlzLnByb3RvLnByb3RvdHlwZS5oYXNNaWRpT3V0cHV0IHx8IGZhbHNlKTsgfVxufVxuZXhwb3J0IGNsYXNzIFBsdWdpblByb3RvdHlwZSBleHRlbmRzIEJhc2VQbHVnaW5Qcm90b3R5cGUge1xuICAgIGNvbnN0cnVjdG9yKHByb3RvLCBmYWN0b3J5KSB7XG4gICAgICAgIHN1cGVyKHByb3RvLCBmYWN0b3J5KTtcbiAgICAgICAgdGhpcy5wcm90byA9IHByb3RvO1xuICAgICAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5O1xuICAgIH1cbiAgICBjcmVhdGVQbHVnaW5JbnN0YW5jZShvd25lcikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcGx1Z2luID0gbmV3IHRoaXMucHJvdG8odGhpcy5mYWN0b3J5LCBvd25lcik7XG4gICAgICAgICAgICBpZiAocGx1Z2luLmluaXRpYWxpc2UpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCBwbHVnaW4uaW5pdGlhbGlzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBQbHVnaW5JbnN0YW5jZShwbHVnaW4pO1xuICAgICAgICAgICAgdGhpcy5mYWN0b3J5LnJlZ2lzdGVyUGx1Z2luSW5zdGFuY2Uobm9kZSk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc2VyUHJvdG90eXBlIGV4dGVuZHMgQmFzZVBsdWdpblByb3RvdHlwZSB7XG4gICAgY29uc3RydWN0b3IocHJvdG8sIGZhY3RvcnkpIHtcbiAgICAgICAgc3VwZXIocHJvdG8sIGZhY3RvcnkpO1xuICAgICAgICB0aGlzLnByb3RvID0gcHJvdG87XG4gICAgICAgIHRoaXMuZmFjdG9yeSA9IGZhY3Rvcnk7XG4gICAgfVxuICAgIGNyZWF0ZVBsdWdpbkluc3RhbmNlKG93bmVyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSBuZXcgdGhpcy5wcm90byh0aGlzLmZhY3RvcnksIG93bmVyKTtcbiAgICAgICAgICAgIGlmIChwbHVnaW4uaW5pdGlhbGlzZSkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHBsdWdpbi5pbml0aWFsaXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbmV3IE1pZGlTeW50aGVzaXNJbnN0YW5jZShwbHVnaW4pO1xuICAgICAgICAgICAgdGhpcy5mYWN0b3J5LnJlZ2lzdGVyUGx1Z2luSW5zdGFuY2Uobm9kZSk7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuZXhwb3J0IGNsYXNzIFBsdWdpblVzZXJJbnRlcmZhY2VNZXNzYWdlSHViIHtcbiAgICBjb25zdHJ1Y3RvcihmYWN0b3J5KSB7XG4gICAgICAgIHRoaXMuZmFjdG9yeSA9IGZhY3Rvcnk7XG4gICAgICAgIHRoaXMuZGVmYXVsdF9pbnRlcmZhY2UgPSB7XG4gICAgICAgICAgICBzcmM6IFwianNhcF9kZWZhdWx0Lmh0bWxcIixcbiAgICAgICAgICAgIHdpZHRoOiBcIjUwMHB4XCIsXG4gICAgICAgICAgICBoZWlnaHQ6IFwiNTAwcHhcIlxuICAgICAgICB9O1xuICAgIH1cbiAgICBidWlsZFBsdWdpbkludGVyZmFjZShwbHVnaW5fb2JqZWN0LCBpbnRlcmZhY2Vfb2JqZWN0KSB7XG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gICAgICAgIGlmcmFtZS5zcmMgPSBpbnRlcmZhY2Vfb2JqZWN0LnNyYztcbiAgICAgICAgaWYgKGludGVyZmFjZV9vYmplY3Qud2lkdGgpIHtcbiAgICAgICAgICAgIGlmcmFtZS53aWR0aCA9IGludGVyZmFjZV9vYmplY3Qud2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGludGVyZmFjZV9vYmplY3QuaGVpZ2h0KSB7XG4gICAgICAgICAgICBpZnJhbWUuaGVpZ2h0ID0gaW50ZXJmYWNlX29iamVjdC5oZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWZyYW1lLnN0eWxlLmJvcmRlciA9IFwiMFwiO1xuICAgICAgICAvL2lmcmFtZS5jb250ZW50V2luZG93LnBsdWdpbkluc3RhbmNlID0gcGx1Z2luX29iamVjdDtcbiAgICAgICAgcmV0dXJuIGlmcmFtZTtcbiAgICB9XG4gICAgc3Bhd25QbHVnaW5XaW5kb3cocGx1Z2luX29iamVjdCwgaW50ZXJmYWNlX29iamVjdCwgb3B0cykge1xuICAgICAgICBjb25zdCB3ID0gd2luZG93Lm9wZW4oaW50ZXJmYWNlX29iamVjdC5zcmMsIHBsdWdpbl9vYmplY3QubmFtZSwgb3B0cyk7XG4gICAgICAgIHBsdWdpbl9vYmplY3QuZXh0ZXJuYWxJbnRlcmZhY2UucmVnaXN0ZXJXaW5kb3codyk7XG4gICAgICAgIHJldHVybiB3O1xuICAgIH1cbiAgICBzZXREZWZhdWx0SW50ZXJmYWNlKHNyYywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLmRlZmF1bHRfaW50ZXJmYWNlID0ge1xuICAgICAgICAgICAgc3JjOiBzcmMsXG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0X2ludGVyZmFjZTtcbiAgICB9XG4gICAgcG9sbEFsbFBsdWdpbnMoKSB7XG4gICAgICAgIHRoaXMuZmFjdG9yeS5nZXRBbGxQbHVnaW5zKCkuZm9yRWFjaChmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICAgICAgICBwbHVnaW4ubm9kZS5leHRlcm5hbEludGVyZmFjZS51cGRhdGVJbnRlcmZhY2VzKHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCIvLyBTdG9yZSBmb3IgdGhlIHNlbWFudGljIHRlcm1zLCBlYWNoIHN0b3JlIGhvbGRzIGl0cyBvd24gZGF0YSB0cmVlXG4vLyBUZXJtcyBhcmUgYWRkZWQgYXMga2V5L3ZhbHVlIHBhcmlzIHRvIGEgcm9vdCBub2RlXG5leHBvcnQgY2xhc3MgTGlua2VkU3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKHN0b3JlTmFtZSkge1xuICAgICAgICB0aGlzLnN0b3JlTmFtZSA9IHN0b3JlTmFtZTtcbiAgICAgICAgdGhpcy5ldCA9IG5ldyBFdmVudFRhcmdldCgpO1xuICAgIH1cbiAgICBvYmplY3RUb1hNTChvYmosIHJvb3QsIGRvYykge1xuICAgICAgICAvLyBVc2VkIGlmIGFuIG9iamVjdCB3YXMgcGFzc2VkIGFzIGEgdGVybSB2YWx1ZVxuICAgICAgICBmb3IgKGNvbnN0IHRlcm0gb2Ygb2JqLmtleXMoKSkge1xuICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eSh0ZXJtKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gb2JqW3Rlcm1dO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZW50cnkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcm9vdC5zZXRBdHRyaWJ1dGUodGVybSwgZW50cnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZW50cnkgPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgICAgICByb290LnNldEF0dHJpYnV0ZSh0ZXJtLCBlbnRyeS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkb2NOb2RlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBMaW5rZWRTdG9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jTm9kZSA9IGVudHJ5LnRvWE1MKGRvYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2NOb2RlID0gZG9jLmNyZWF0ZUVsZW1lbnQodGVybSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByb290LmFwcGVuZENoaWxkKGRvY05vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVudHJ5IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFycmF5VG9YTUwoZW50cnksIGRvY05vZGUsIGRvYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9iamVjdFRvWE1MKGVudHJ5LCBkb2NOb2RlLCBkb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvb3QuYXBwZW5kQ2hpbGQoZG9jTm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGFycmF5VG9YTUwoYXJyLCByb290LCBkb2MpIHtcbiAgICAgICAgLy8gVXNlZCB0byBjb252ZXJ0IGFuIGFycmF5IHRvIGEgbGlzdCBvZiBYTUwgZW50cmllc1xuICAgICAgICB2YXIgYWxsX251bWJlcnMgPSB0cnVlLCBhbGxfc3RyaW5ncyA9IHRydWUsIGksIGwgPSBhcnIubGVuZ3RoO1xuICAgICAgICBhbGxfbnVtYmVycyA9IGFyci5ldmVyeShmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhID09PSBcIm51bWJlclwiO1xuICAgICAgICB9KTtcbiAgICAgICAgYWxsX3N0cmluZ3MgPSBhcnIuZXZlcnkoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYSA9PT0gXCJzdHJpbmdcIjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChhbGxfbnVtYmVycyB8fCBhbGxfc3RyaW5ncykge1xuICAgICAgICAgICAgLy8gQW4gYXJyYXkgb2YgbnVtYmVycyBvciBzdHJpbmdzXG4gICAgICAgICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoYSwgaSkge1xuICAgICAgICAgICAgICAgIHJvb3Quc2V0QXR0cmlidXRlKFwiaW5kZXgtXCIgKyBpLCBhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gQW4gYXJyYXkgb2Ygb2JqZWN0c1xuICAgICAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGEsIGkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ2YWx1ZVwiKTtcbiAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShcImluZGV4XCIsIGkpO1xuICAgICAgICAgICAgICAgIHRoaXMub2JqZWN0VG9YTUwoYSwgbm9kZSwgZG9jKTtcbiAgICAgICAgICAgICAgICByb290LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5ldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICB9XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5ldC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgICB9XG4gICAgc2V0VGVybSh0ZXJtLCB2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHRlcm0gIT09IFwic3RyaW5nXCIgfHwgdGVybS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IChcInRlcm0gbXVzdCBiZSBhIHN0cmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvb3Quc2V0KHRlcm0sIHZhbHVlKTtcbiAgICAgICAgdGhpcy5ldC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImFsdGVyZWRcIiwgeyBkZXRhaWw6IHsgdGVybTogdGVybSwgdmFsdWU6IHZhbHVlIH0gfSkpO1xuICAgIH1cbiAgICBzZXRUZXJtcyh0ZXJtc09iamVjdCkge1xuICAgICAgICBpZiAodHlwZW9mIHRlcm1zT2JqZWN0ICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJzZXRUZXJtcyB0YWtlcyBhbiBvYmplY3Qgb2YgdGVybS92YWx1ZSBwYWlyc1wiKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHRlcm0gaW4gdGVybXNPYmplY3QpIHtcbiAgICAgICAgICAgIGlmICh0ZXJtc09iamVjdC5oYXNPd25Qcm9wZXJ0eSh0ZXJtKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVybSh0ZXJtLCB0ZXJtc09iamVjdFt0ZXJtXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVsZXRlVGVybSh0ZXJtKSB7XG4gICAgICAgIHRoaXMuc2V0VGVybSh0ZXJtLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBnZXRUZXJtKHRlcm0pIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0ZXJtICE9PSBcInN0cmluZ1wiIHx8IHRlcm0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyAoXCJ0ZXJtIG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5nZXQodGVybSk7XG4gICAgfVxuICAgIGhhc1Rlcm0odGVybSkge1xuICAgICAgICBpZiAodHlwZW9mIHRlcm0gIT09IFwic3RyaW5nXCIgfHwgdGVybS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IChcInRlcm0gbXVzdCBiZSBhIHN0cmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yb290Lmhhcyh0ZXJtKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnJvb3QpKTtcbiAgICB9XG4gICAgdG9YTUwoZG9jKSB7XG4gICAgICAgIGxldCBub2RlO1xuICAgICAgICBpZiAoIWRvYykge1xuICAgICAgICAgICAgZG9jID0gZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlRG9jdW1lbnQobnVsbCwgdGhpcy5zdG9yZU5hbWUsIG51bGwpO1xuICAgICAgICAgICAgbm9kZSA9IGRvYy5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUgPSBkb2MuY3JlYXRlRWxlbWVudCh0aGlzLnN0b3JlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYmplY3RUb1hNTCh0aGlzLnJvb3QsIG5vZGUsIGRvYyk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmVOYW1lO1xuICAgIH1cbiAgICBzZXQgbmFtZShuZXdOYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLnN0b3JlTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOYW1lIGlzIGFscmVhZHkgc2V0XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RvcmVOYW1lID0gbmV3TmFtZTtcbiAgICB9XG59XG4iLCIvKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5pbXBvcnQgeyBCYXNlUGx1Z2luIH0gZnJvbSBcIi4uL0Jhc2VQbHVnaW4vaW5kZXhcIjtcbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNlckJhc2VQbHVnaW4gZXh0ZW5kcyBCYXNlUGx1Z2luIHtcbiAgICBjb25zdHJ1Y3RvcihmYWN0b3J5LCBwbHVnaW5Pd25lciwgcHJvdG90eXBlT2JqZWN0KSB7XG4gICAgICAgIHN1cGVyKGZhY3RvcnksIHBsdWdpbk93bmVyLCBwcm90b3R5cGVPYmplY3QpO1xuICAgICAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5O1xuICAgICAgICB0aGlzLnByb3RvdHlwZU9iamVjdCA9IHByb3RvdHlwZU9iamVjdDtcbiAgICAgICAgdGhpcy5oYXNXYXJuZWRTY2hlZHVsZU5vdFNldCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmhhc1dhcm5lZENhbmNlbE5vdFNldCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVkaXRvclR5cGUgPSBcInJvbGxcIjtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5jYW5jZWxBbGxFdmVudHMoKTtcbiAgICB9XG4gICAgYWRkSW5wdXQoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBhZGQgaW5wdXQgdG8gdHlwZSBcXFwiU3ludGhlc2lzZXJCYXNlUGx1Z2luXFxcIlwiKTtcbiAgICB9XG4gICAgZGVsZXRlSW5wdXQoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBkZWxldGUgaW5wdXQgdG8gdHlwZSBcXFwiU3ludGhlc2lzZXJCYXNlUGx1Z2luXFxcIlwiKTtcbiAgICB9XG4gICAgc2NoZWR1bGVFdmVudChtc2csIGNvbnRleHRUaW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNXYXJuZWRTY2hlZHVsZU5vdFNldCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiV0FSTklORyAtIC5zY2hlZHVsZUV2ZW50IGlzIG5vdCBvdmVycmlkZGVuXCIpO1xuICAgICAgICAgICAgdGhpcy5oYXNXYXJuZWRTY2hlZHVsZU5vdFNldCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2FuY2VsQWxsRXZlbnRzKGNvbnRleHRUaW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNXYXJuZWRDYW5jZWxOb3RTZXQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIldBUk5JTkcgLSAuY2FuY2VsQWxsRXZlbnRzIGlzIG5vdCBvdmVycmlkZGVuXCIpO1xuICAgICAgICAgICAgdGhpcy5oYXNXYXJuZWRDYW5jZWxOb3RTZXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEVkaXRvclR5cGUodHlwZSkge1xuICAgICAgICBpZiAodHlwZSA9PSBcInJvbGxcIiB8fCB0eXBlID09IFwibGluZVwiIHx8IHR5cGUgPT0gXCJzZXF1ZW5jZXJcIikge1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JUeXBlID0gdHlwZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5lZGl0b3JUeXBlO1xuICAgIH1cbiAgICBnZXRFZGl0b3JUeXBlKCkgeyByZXR1cm4gdGhpcy5lZGl0b3JUeXBlOyB9XG4gICAgaXNOb3RlQWN0aXZlKG4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuID09IFwibnVtYmVyXCIgJiYgbiA+PSAwICYmIG4gPCAxMjgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEFjdGl2ZU5vdGVQcm9wZXJ0aWVzKCkge1xuICAgICAgICBjb25zdCBvYmogPSBbXTtcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCAxMjg7IG4rKykge1xuICAgICAgICAgICAgb2JqLnB1c2goe1xuICAgICAgICAgICAgICAgIGNvZGU6IG4sXG4gICAgICAgICAgICAgICAgbmFtZTogdGhpcy5taWRpTm90ZVRvTmFtZShuKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgbWlkaU5vdGVUb0ZyZXF1ZW5jeShtKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdygyLjAsIChtIC0gNjkpIC8gMTIpICogNDQwO1xuICAgIH1cbiAgICBmcmVxdWVuY3lUb01pZGlOb3RlKGYpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTIuMCAqIE1hdGgubG9nMihmIC8gNDQwKSkgKyA2OTtcbiAgICB9XG4gICAgbWlkaU5vdGVUb05hbWUobSkge1xuICAgICAgICBjb25zdCBub3RlcyA9IFtcIkFcIiwgXCJBI1wiLCBcIkJcIiwgXCJDXCIsIFwiQyNcIiwgXCJEXCIsIFwiRCNcIiwgXCJFXCIsIFwiRlwiLCBcIkYjXCIsIFwiR1wiLCBcIkcjXCJdO1xuICAgICAgICBjb25zdCByb290ID0gbSAtIDIxO1xuICAgICAgICBjb25zdCBvY3RhdmUgPSBNYXRoLmZsb29yKHJvb3QgLyAxMik7XG4gICAgICAgIGNvbnN0IG5vdGUgPSBNYXRoLmZsb29yKChyb290ICsgMzYpICUgMTIpO1xuICAgICAgICByZXR1cm4gbm90ZXNbbm90ZV0gKyBTdHJpbmcob2N0YXZlKTtcbiAgICB9XG4gICAgbm90ZU5hbWVUb01pZGkobikge1xuICAgICAgICBjb25zdCBub3RlcyA9IFtcIkFcIiwgXCJBI1wiLCBcIkJcIiwgXCJDXCIsIFwiQyNcIiwgXCJEXCIsIFwiRCNcIiwgXCJFXCIsIFwiRlwiLCBcIkYjXCIsIFwiR1wiLCBcIkcjXCJdO1xuICAgICAgICBjb25zdCBvY3RhdmUgPSBOdW1iZXIobi5zbGljZShuLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgY29uc3Qgbm90ZSA9IG5vdGVzLmluZGV4T2Yobi5zbGljZSgwLCBuLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgcmV0dXJuIG9jdGF2ZSAqIDEyICsgbm90ZSArIDIxO1xuICAgIH1cbiAgICBub3RlTmFtZVRvTUlESShuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vdGVOYW1lVG9NaWRpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1N5bnRoZXNpc2VyQmFzZVBsdWdpbihvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0LmlucHV0cy5sZW5ndGggPT09IDAgJiYgb2JqZWN0Lm91dHB1dHMubGVuZ3RoID4gMCAmJiBgc2NoZWR1bGVFdmVudGAgaW4gb2JqZWN0O1xufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIHVuaXF1ZU1lcmdlQXJyYXkoYSwgYikge1xuICAgIGNvbnN0IG91dHB1dCA9IFtdO1xuICAgIGZvciAoY29uc3QgZW50cnkgb2YgYSkge1xuICAgICAgICBpZiAob3V0cHV0LmluY2x1ZGVzKGVudHJ5KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGVudHJ5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGIpIHtcbiAgICAgICAgaWYgKG91dHB1dC5pbmNsdWRlcyhlbnRyeSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBvdXRwdXQucHVzaChlbnRyeSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIi8vIFRoaXMgZGVmaW5lcyBhIG1hc3RlciBvYmplY3QgZm9yIGhvbGRpbmcgYWxsIHRoZSBwbHVnaW5zIGFuZCBjb21tdW5pY2F0aW5nXG4vLyBUaGlzIG9iamVjdCB3aWxsIGFsc28gaGFuZGxlIGNyZWF0aW9uIGFuZCBkZXN0cnVjdGlvbiBvZiBwbHVnaW5zXG4vKmdsb2JhbHMgUHJvbWlzZSwgZG9jdW1lbnQsIGNvbnNvbGUsIExpbmtlZFN0b3JlLCBXb3JrZXIsIHdpbmRvdywgWE1MSHR0cFJlcXVlc3QgKi9cbi8qZXNsaW50LWVudiBicm93c2VyICovXG4vKiBqc2hpbnQgZXN2ZXJzaW9uOjYgKi9cbmltcG9ydCB7IEJhc2VQbHVnaW4gfSBmcm9tICcuL0Jhc2VQbHVnaW4vaW5kZXgnO1xuaW1wb3J0IHsgU3ludGhlc2lzZXJCYXNlUGx1Z2luIH0gZnJvbSAnLi9TeW50aGVzaXNlckJhc2VQbHVnaW4vaW5kZXgnO1xuaW1wb3J0IHsgUGx1Z2luRmFjdG9yeSB9IGZyb20gXCIuL0ZhY3RvcnkvUGx1Z2luRmFjdG9yeVwiO1xuaW1wb3J0IHsgQXVkaW9QbHVnaW4gfSBmcm9tICcuL0Jhc2VQbHVnaW4vQXVkaW9QbHVnaW4nO1xuZXhwb3J0IHsgQXVkaW9QbHVnaW4sIEJhc2VQbHVnaW4sIFN5bnRoZXNpc2VyQmFzZVBsdWdpbiwgUGx1Z2luRmFjdG9yeSB9O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==